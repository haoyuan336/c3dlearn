System.register("chunks:///util/State.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var a,s,n;return{setters:[function(t){a=t.createClass,s=t.classCallCheck},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"309b9GENMFDhItBZDPdMuEd","State",void 0),t("State",function(){function t(){s(this,t),this.state="",this.handleMap={}}return a(t,[{key:"setState",value:function(t){if(this.state=t,this.handleMap[this.state]){for(var e=this.handleMap[this.state],a=[],s=1;s<arguments.length;s++)a.push(arguments[s]);for(var n=0;n<e.length;n++){var i=e[n];i.apply(this,a)}}}},{key:"getState",value:function(){return this.state}},{key:"addState",value:function(t,e){this.handleMap[t]?this.handleMap[t].push(e):this.handleMap[t]=[e]}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///GameController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js"],(function(e,t){var n,i,r,a,o,s,c,d,l,u,y,m,p,h,f,v,b,_,g,N,C,L,E,S,k,P;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_class3:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,i=e.inherits,r=e.classCallCheck,a=e.possibleConstructorReturn,o=e.getPrototypeOf,s=e.initializerDefineProperty,c=e.assertThisInitialized,d=e.createClass},function(e){l=e.cclegacy,u=e._decorator,y=e.Node,m=e.Prefab,p=e.instantiate,h=e.Component},function(e){f=e.State}],execute:function(){l._RF.push({},"5b4c0ApYS1B3bhehBCF/cvX","GameController",void 0),k=u.ccclass,P=u.property,e("GameController",(v=k("GameController"),b=P({type:y}),_=P({type:m}),v((S=E=function(e){function t(){var e,n;r(this,t);for(var i=arguments.length,d=new Array(i),l=0;l<i;l++)d[l]=arguments[l];return n=a(this,(e=o(t)).call.apply(e,[this].concat(d))),s(n,"pathNodeList",C,c(n)),s(n,"enemyPrefab",L,c(n)),n.state=new f,n.currentAddEnemyTime=0,n.addEnemyDuraction=4,n.enemyNodeList=[],n}return i(t,e),d(t,[{key:"start",value:function(){var e=this;this.state.addState("ready",(function(){console.log("enter state ",e.state.getState())})),this.state.setState("run")}},{key:"update",value:function(e){"run"===this.state.getState()&&(this.currentAddEnemyTime>this.addEnemyDuraction?(this.currentAddEnemyTime=0,this.addOneEnemy()):this.currentAddEnemyTime+=e)}},{key:"getCurrentEnemyNodeList",value:function(){return this.enemyNodeList}},{key:"addOneEnemy",value:function(){var e=this,t=p(this.enemyPrefab);t.parent=this.node.parent,t.emit("init-data",this.pathNodeList),t.on("destroy-self",(function(){for(var n=0;n<e.enemyNodeList.length;n++)e.enemyNodeList[n]===t&&e.enemyNodeList.splice(n,1)})),this.enemyNodeList.push(t)}}]),t}(h),E.accY=-20,E.enemyBeLockMaxNum=1,C=n((N=S).prototype,"pathNodeList",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=n(N.prototype,"enemyPrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=N))||g)),l._RF.pop()}}}));

System.register("chunks:///Enemy.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./GameController.js"],(function(t,e){var n,o,a,s,c,r,i,u,l,d,p,v,f,h,y,k;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){n=t.inherits,o=t.classCallCheck,a=t.possibleConstructorReturn,s=t.getPrototypeOf,c=t.createClass},function(t){r=t.cclegacy,i=t._decorator,u=t.v3,l=t.Tween,d=t.Vec3,p=t.Component},function(t){v=t.State},function(t){f=t.GameController}],execute:function(){r._RF.push({},"ac439Ca0GFJGrdHaYw+IQip","Enemy",void 0),k=i.ccclass,i.property,t("Enemy",(h=k("Enemy"),h(y=function(t){function e(){var t,n;o(this,e);for(var c=arguments.length,r=new Array(c),i=0;i<c;i++)r[i]=arguments[i];return(n=a(this,(t=s(e)).call.apply(t,[this].concat(r)))).pathList=[],n.state=new v,n.currentPathIndex=0,n.moveSpeed=1,n.beLockedMaxNum=f.enemyBeLockMaxNum,n.currentbeLockedCount=0,n}return n(e,t),c(e,[{key:"onLoad",value:function(){var t=this;this.node.on("init-data",(function(e){t.pathList=e;var n=e[0].getPosition();n.y=1,t.node.setPosition(n),t.node.scale=u(0,0,0);var o=new l(t.node);o.to(.2,{scale:u(1,1,1)}),o.call((function(){t.state.setState("run")})),o.start()})),this.state.addState("run",(function(){for(var e=new l(t.node),n=1;n<t.pathList.length;n++){var o=t.pathList[n-1].position,a=t.pathList[n].position,s=new d(a).subtract(o).length()/t.moveSpeed;e.to(s,{position:u(a.x,1,a.z)})}e.to(.2,{scale:u(0,0,0)}),e.call((function(){t.state.setState("over"),t.node.emit("destroy-self")})).delay(.2).call((function(){t.node.destroy()})),e.start()}))}},{key:"start",value:function(){}},{key:"getIsDead",value:function(){return"over"===this.state.getState()}},{key:"getIsCanLock",value:function(){return this.currentbeLockedCount<this.beLockedMaxNum}},{key:"setBeLocked",value:function(t){this.currentbeLockedCount++}},{key:"unSetBeLocked",value:function(t){this.currentbeLockedCount--}},{key:"update",value:function(t){}}]),e}(p))||y)),r._RF.pop()}}}));

System.register("chunks:///typescript.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var c,r,s,i,n,o,p,u,l,a,y;return t({_dec:void 0,_class:void 0}),{setters:[function(t){c=t.inherits,r=t.createClass,s=t.classCallCheck,i=t.possibleConstructorReturn,n=t.getPrototypeOf},function(t){o=t.cclegacy,p=t._decorator,u=t.Component}],execute:function(){o._RF.push({},"811405Zvc9D445rfiY0G6tw","typescript",void 0),y=p.ccclass,p.property,t("Typescript",(l=y("Typescript"),l(a=function(t){function e(){return s(this,e),i(this,n(e).apply(this,arguments))}return c(e,t),r(e,[{key:"start",value:function(){}}]),e}(u))||a)),o._RF.pop()}}}));

System.register("chunks:///Tower.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./GameController.js","./Enemy.js"],(function(t,e){var r,n,i,o,a,s,l,u,c,h,p,g,m,d,y,f,v,b,T,C,S,E,_,P,w,D,k,z,j,I;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(t){r=t.applyDecoratedDescriptor,n=t.inherits,i=t.classCallCheck,o=t.possibleConstructorReturn,a=t.getPrototypeOf,s=t.initializerDefineProperty,l=t.assertThisInitialized,u=t.createClass},function(t){c=t.cclegacy,h=t._decorator,p=t.Node,g=t.Prefab,m=t.v2,d=t.Vec3,y=t.instantiate,f=t.Component},function(t){v=t.State},function(t){b=t.GameController},function(t){T=t.Enemy}],execute:function(){c._RF.push({},"93965WLO/1GpoRxL0uoTS9a","Tower",void 0),j=h.ccclass,I=h.property,t("Tower",(C=j("Tower"),S=I({type:p}),E=I({type:g}),_=I({type:p}),C((D=r((w=function(t){function e(){var t,r;i(this,e);for(var n=arguments.length,u=new Array(n),c=0;c<n;c++)u[c]=arguments[c];return r=o(this,(t=a(e)).call.apply(t,[this].concat(u))),s(r,"gameController",D,l(r)),r.state=new v,r.currentTargetEnemy=null,r.currentShootTime=0,r.shootDuraction=1,s(r,"bulletPrefab",k,l(r)),s(r,"bulletStartPos",z,l(r)),r.currentShootDiraction=m(0,0),r}return n(e,t),u(e,[{key:"start",value:function(){this.state.setState("run")}},{key:"update",value:function(t){if("run"===this.state.getState()){if(null===this.currentTargetEnemy){for(var e=this.gameController.getComponent(b).getCurrentEnemyNodeList(),r=1e4,n=0;n<e.length;n++){var i=e[n];if(i.getComponent(T).getIsCanLock()&&!i.getComponent(T).getIsDead()){var o=new d(i.position).subtract(this.node.position).length();o<r&&(r=o,this.currentTargetEnemy=i)}}this.currentTargetEnemy&&this.currentTargetEnemy.getComponent(T).setBeLocked(this.node)}if(this.currentTargetEnemy)if(this.currentTargetEnemy.getComponent(T).getIsDead())this.currentTargetEnemy=null;else{this.currentShootDiraction=m(this.currentTargetEnemy.position.x,this.currentTargetEnemy.position.z).subtract(m(this.node.position.x,this.node.position.z));var a=this.currentShootDiraction.signAngle(m(0,-1));this.node.eulerAngles=new d(0,180*a/Math.PI,0)}this.currentTargetEnemy&&(this.currentShootTime>this.shootDuraction?(this.currentShootTime=0,this.shootOneBullet()):this.currentShootTime+=t)}}},{key:"shootOneBullet",value:function(){var t=y(this.bulletPrefab);t.parent=this.node.parent,t.active=!1,t.setPosition(this.bulletStartPos.worldPosition),t.active=!0,t.emit("init-data",{direction:this.currentShootDiraction,targetEnemy:this.currentTargetEnemy})}}]),e}(f)).prototype,"gameController",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=r(w.prototype,"bulletPrefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=r(w.prototype,"bulletStartPos",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=w))||P)),c._RF.pop()}}}));

System.register("chunks:///Bullet.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./GameController.js"],(function(t,e){var i,n,o,r,s,c,a,u,l,d,p,h,v,y,f,m,S,Y,g,_,b,C,x;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inherits,o=t.classCallCheck,r=t.possibleConstructorReturn,s=t.getPrototypeOf,c=t.initializerDefineProperty,a=t.assertThisInitialized,u=t.createClass},function(t){l=t.cclegacy,d=t._decorator,p=t.Node,h=t.v2,v=t.v3,y=t.Component},function(t){f=t.State},function(t){m=t.GameController}],execute:function(){l._RF.push({},"90e683Z9ntM7pLuSDO8IdqW","Bullet",void 0),C=d.ccclass,x=d.property,t("Bullet",(S=C("Bullet"),Y=x({type:p}),S((b=i((_=function(t){function e(){var t,i;o(this,e);for(var n=arguments.length,u=new Array(n),l=0;l<n;l++)u[l]=arguments[l];return(i=r(this,(t=s(e)).call.apply(t,[this].concat(u)))).state=new f,i.speedY=0,i.accY=m.accY,i.currentDirection=h(0,0),i.moveSpeed=20,i.currentInitSpeedY=6,i.currentCostAcc=-3,c(i,"bodyNode",b,a(i)),i.maxLeftTime=3,i}return n(e,t),u(e,[{key:"onLoad",value:function(){var t=this;this.node.on("init-data",(function(e){var i=e.direction;t.currentDirection=i;var n=e.targetEnemy;t.state.setState("run");var o=2*t.node.getPosition().y/t.accY*-1,r=Math.sqrt(o),s=h(t.node.position.x,t.node.position.z).subtract(h(n.position.x,n.position.z)).length();t.moveSpeed=s/r})),this.state.addState("sleep",(function(){t.bodyNode.active=!1})),this.scheduleOnce((function(){t.node.destroy()}),this.maxLeftTime)}},{key:"start",value:function(){}},{key:"update",value:function(t){if("run"===this.state.getState()){this.speedY+=this.accY*t;var e=this.node.position,i=e.y+this.speedY*t,n=this.currentDirection.normalize().multiplyScalar(this.moveSpeed*t);this.node.setPosition(v(e.x+n.x,i,e.z+n.y)),this.node.getPosition().y<=0&&(this.speedY=this.currentInitSpeedY,this.currentInitSpeedY+=this.currentCostAcc,this.currentInitSpeedY<0&&this.state.setState("sleep"))}}}]),e}(y)).prototype,"bodyNode",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=_))||g)),l._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../util/State.js","../GameController.js","../Enemy.js","../typescript.js","../Tower.js","../Bullet.js"],(function(t,n){return{setters:[function(t){},function(t){},function(t){},function(t){},function(t){},function(t){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/Scripts/util/State.js', 'chunks:///util/State.js');
  r('project:///assets/Scripts/GameController.js', 'chunks:///GameController.js');
  r('project:///assets/Scripts/Enemy.js', 'chunks:///Enemy.js');
  r('project:///assets/Scripts/typescript.js', 'chunks:///typescript.js');
  r('project:///assets/Scripts/Tower.js', 'chunks:///Tower.js');
  r('project:///assets/Scripts/Bullet.js', 'chunks:///Bullet.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});