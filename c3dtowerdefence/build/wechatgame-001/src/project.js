System.register("chunks:///AudioCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(o,i){var n,t,e,a,u,s,r,c,d,l,p,f,h,v,y,C,A,m,g,_,b,M;return o({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(o){n=o.applyDecoratedDescriptor,t=o.inherits,e=o.classCallCheck,a=o.possibleConstructorReturn,u=o.getPrototypeOf,s=o.initializerDefineProperty,r=o.assertThisInitialized,c=o.createClass},function(o){d=o.cclegacy,l=o._decorator,p=o.JsonAsset,f=o.AudioSourceComponent,h=o.loader,v=o.AudioClip,y=o.Component}],execute:function(){d._RF.push({},"7fa36dmnLhPGLldXsNYKbQR","AudioCtl",void 0),b=l.ccclass,M=l.property,o("AudioCtl",(C=b("AudioCtl"),A=M({type:p}),C((_=n((g=function(o){function i(){var o,n;e(this,i);for(var t=arguments.length,c=new Array(t),d=0;d<t;d++)c[d]=arguments[d];return(n=a(this,(o=u(i)).call.apply(o,[this].concat(c)))).audioSourcesCom=null,s(n,"gameConfigJsonAsset",_,r(n)),n.audioMap={},n}return t(i,o),c(i,[{key:"start",value:function(){var o=this;this.audioSourcesCom=this.node.getComponent(f);var i=this.gameConfigJsonAsset.json;for(var n in i){var t=i[n];for(var e in t){var a=t[e];e.indexOf("Audio")>-1&&a&&(this.audioMap[a]=a)}}var u=function(i){h.loadRes("音乐文件/"+i,v,(function(n,t){n||(o.audioMap[i]=t)}))};for(var s in this.audioMap)u(this.audioMap[s])}},{key:"onLoad",value:function(){var o=this;this.node.on("play-audio",(function(i,n){o.playAudio(i,n)})),this.node.on("player-button-click-audio",(function(){o.playAudio("按钮音效2",(function(){}))})),this.node.on("player-button-click-audio-2",(function(){o.playAudio("按钮音效2",(function(){}))})),this.node.on("play-bg-music",(function(){h.loadRes("音乐文件/背景音效",v,(function(o,i){}))}))}},{key:"playAudio",value:function(o,i){var n=this;o?this.audioMap[o]?(this.audioMap[o].on("ended",(function(){i&&i()})),this.audioSourcesCom.playOneShot(this.audioMap[o])):h.loadRes("音乐文件/"+o,v,(function(t,e){t||(n.audioMap[o]=e,e.on("ended",(function(){i&&i()})),n.audioSourcesCom.playOneShot(e))})):i&&i()}}]),i}(y)).prototype,"gameConfigJsonAsset",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=g))||m)),d._RF.pop()}}}));

System.register("chunks:///Data/PlayerData.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var r,n,a;return{setters:[function(e){r=e.createClass,n=e.classCallCheck},function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"3f2cezzOStAIpBjPLZ7+fqQ","PlayerData",void 0),e("PlayerData",function(){function e(t){n(this,e),this.currentSkillCount=2,this.currentActiveSkillCount=3,this.currentGoldCount=0,this.currentLevelNum=0,this.currentTowerLevelData=[],this.currentInitRedHeartCounnt=3,this.currentRedHeardCount=0,this.currentActiveEnemyMap={},this.currentPowerCount=0,this.gameConfig=null,this.gameConfig=t;var r=this.getLocalData("game-time");console.log("game time",r),r?(this.currentSkillCount=Number(this.getLocalData("current-skill-count")),this.currentActiveSkillCount=Number(this.getLocalData("current-active-skill-count")),this.currentLevelNum=Number(this.getLocalData("current-level-num")),this.currentPowerCount=Number(this.getLocalData("curent-power-count")),this.currentTowerLevelData=JSON.parse(this.getLocalData("tower-level-data")),this.currentInitRedHeartCounnt=Number(this.getLocalData("current-init-red-heart-count")),this.currentActiveEnemyMap=JSON.parse(this.getLocalData("active-enemy-list")),console.log("current active enemy map",this.currentActiveEnemyMap)):(this.setLocalData("game-time","1"),this.setLocalData("current-active-skill-count",this.currentActiveSkillCount+""),this.setLocalData("current-skill-count",this.currentSkillCount+""),this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt+""),this.setLocalData("active-enemy-list",JSON.stringify(this.currentActiveEnemyMap)),this.initTowerLevelLocalData(t)),this.currentRedHeardCount=this.currentInitRedHeartCounnt}return r(e,[{key:"initTowerLevelLocalData",value:function(e){var t=[];for(var r in e)"Tower"===e[r].Type&&t.push(e[r]);t=t.sort((function(e,t){return e.index-t.index}));for(var n=[],a=0;a<t.length;a++){var u=t[a],i={IconSprteFrame:u.IconSprteFrame,isActive:!1,currentLevel:0,TowerType:u.TowerType};a<2?(i.isActive=!0,i.currentLevel=1):(i.isActive=!1,i.currentLevel=0),n.push(i)}console.log("json",n),this.currentTowerLevelData=n,this.setLocalData("tower-level-data",JSON.stringify(n))}},{key:"clearLocalData",value:function(){localStorage.clear()}},{key:"getLocalData",value:function(e){return localStorage.getItem(e)}},{key:"setLocalData",value:function(e,t){localStorage.setItem(e,t)}},{key:"updateGoldCount",value:function(e){}},{key:"getCurrentGoldCount",value:function(){return this.currentGoldCount}},{key:"addGoldCount",value:function(e){this.currentGoldCount+=e}},{key:"initRedHeartCount",value:function(){this.currentRedHeardCount=this.currentInitRedHeartCounnt}},{key:"initCurrentGoldCount",value:function(){this.currentGoldCount=this.gameConfig["Level_"+this.currentLevelNum].InitGoldCount}},{key:"addOneNextLevel",value:function(){this.currentLevelNum++,14===this.currentLevelNum&&(this.currentLevelNum=0),this.setLocalData("current-level-num",this.currentLevelNum+"")}},{key:"activeTower",value:function(e){console.log("active tower index",e),console.log("current tower level data",this.currentTowerLevelData),this.currentTowerLevelData[e].isActive=!0,this.currentTowerLevelData[e].currentLevel=1,this.setLocalData("tower-level-data",JSON.stringify(this.currentTowerLevelData))}},{key:"getWeaponIsActive",value:function(e){return this.currentTowerLevelData[e].isActive}},{key:"getCurrentTowerLocalLevel",value:function(e){return this.currentTowerLevelData[e].currentLevel}},{key:"getCurrentTowersLocalLevelData",value:function(){return this.currentTowerLevelData}},{key:"updateTowerLocalLevel",value:function(e,t){this.currentTowerLevelData[e].currentLevel=t,this.setLocalData("tower-level-data",JSON.stringify(this.currentTowerLevelData))}},{key:"getFirstNeedToActiveTowerIndex",value:function(){for(var e=0,t=0;t<this.currentTowerLevelData.length;t++){if(!this.currentTowerLevelData[t].isActive){e=t;break}}return e}},{key:"getCurrentInitRedHeartCount",value:function(){return this.currentInitRedHeartCounnt}},{key:"getAddOneRedHeartCostGoldCount",value:function(){var e=this.getCurrentInitRedHeartCount();return(1+e)*e*e*100}},{key:"addLocalInitRedHeartCount",value:function(e){this.currentInitRedHeartCounnt+=e,this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt.toString())}},{key:"getCurrentRedHeartCount",value:function(){return this.currentRedHeardCount}},{key:"addRedHeartCount",value:function(e){this.currentRedHeardCount+=e}},{key:"getCurrentActiveTowerList",value:function(){for(var e=[],t=0;t<this.currentTowerLevelData.length;t++){this.currentTowerLevelData[t].isActive&&e.push(t)}return console.log("current active tower list",e),e}},{key:"getCurrentActiveEnemyMap",value:function(){return this.currentActiveEnemyMap}},{key:"getEnemyIsActive",value:function(e){return!!this.currentActiveEnemyMap[e]}},{key:"activeEnemy",value:function(e){return!this.currentActiveEnemyMap[e]&&(this.currentActiveEnemyMap[e]=!0,console.log("激活一个敌人",e),console.log("current active enemy map",this.currentActiveEnemyMap),this.setLocalData("active-enemy-list",JSON.stringify(this.currentActiveEnemyMap)),console.log("data = ",this.getLocalData("active-enemy-list")),!0)}},{key:"getIsShowed",value:function(e){return!!Boolean(this.getLocalData("set-object-showed"+e))}},{key:"setShowed",value:function(e){this.setLocalData("set-object-showed"+e,"true")}},{key:"getIsShowGuide",value:function(e){return Boolean(this.getLocalData("guide-step-"+e))}},{key:"setIsShowGuide",value:function(e){this.setLocalData("guide-step-"+e,"true")}},{key:"getQueryString",value:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),r=window.location.search.substr(1).match(t);return null!=r?unescape(r[2]):null}},{key:"addPowerCount",value:function(e){console.log("增加能量"),this.currentPowerCount+=e,this.setLocalData("curent-power-count",this.currentPowerCount.toString())}},{key:"getPowerCount",value:function(){return this.currentPowerCount}},{key:"recoverRedHeartCount",value:function(){this.currentRedHeardCount=this.currentInitRedHeartCounnt}}]),e}()),a._RF.pop()}}}));

System.register("chunks:///util/AdsController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,n){var s,i,o,t,d;return{setters:[function(e){s=e.createClass,i=e.classCallCheck},function(e){o=e.cclegacy,t=e.game,d=e.Game}],execute:function(){o._RF.push({},"00d1d2cCXdJEoYd5l9/lwHa","AdsController",void 0),e("AdsController",function(){function e(){var n=this;if(i(this,e),this.bannerAds=null,this.videoAds=null,this.videoIsReady=!1,this.videoCb=null,this.shareCb=null,!CC_DEBUG){var s=wx.getSystemInfoSync();console.log("sysy info",s),this.bannerAds=wx.createBannerAd({adUnitId:"adunit-76289691b92177e3",style:{left:5,top:200,width:300},adIntervals:30}),this.bannerAds.onResize((function(e){n.bannerAds.style.top=wx.getSystemInfoSync().windowHeight-e.height-5})),this.bannerAds.onError((function(e){})),this.bannerAds.onLoad((function(){})),this.videoAds=wx.createRewardedVideoAd({adUnitId:"adunit-155f48f473e48e1b"}),this.videoAds.load().then((function(){n.videoIsReady=!0})),this.videoAds.onError((function(){})),this.videoAds.onLoad((function(){n.videoIsReady=!0,console.log("视频广告拉去成功")})),this.videoAds.onClose((function(e){e&&e.isEnded||void 0===e?n.videoCb&&n.videoCb("succ"):n.videoCb&&n.videoCb("fail")}))}t.on(d.EVENT_SHOW,(function(){n.shareCb&&(n.shareCb(),n.shareCb=null)}))}return s(e,[{key:"watchVideoAds",value:function(){var e=this;return this.videoAds.show().catch((function(){e.videoAds.load().then((function(){e.videoAds.show()}))})),new Promise((function(n,s){e.videoCb=n}))}},{key:"getVideoIsReady",value:function(){return this.videoIsReady}},{key:"shareTo",value:function(){var e=this;return new Promise((function(n,s){wx.shareAppMessage({title:"快来帮我打败小怪兽吧！",imageUrl:"https://chutianba-1251688348.cos.ap-beijing.myqcloud.com/shouhuhuahures/tbkp.png"}),e.shareCb=n}))}},{key:"showBannerAds",value:function(){this.bannerAds&&this.bannerAds.show()}},{key:"hideBannerAds",value:function(){this.bannerAds&&this.bannerAds.hide()}}]),e}()),o._RF.pop()}}}));

System.register("chunks:///GameInstance.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Data/PlayerData.js","./util/AdsController.js"],(function(e,t){var a,n,l,i,u,o;return{setters:[function(e){a=e.createClass,n=e.classCallCheck},function(e){l=e.cclegacy},function(e){i=e.PlayerData},function(e){u=e.AdsController}],execute:function(){l._RF.push({},"ddfab6IJclHqK/eUCCKoZu8","GameInstance",void 0),e("GameInstance",o=function(){function e(){n(this,e),this.playerData=null,this.adsCtl=new u,this.gameCtlNode=null,this.uiCtlNode=null}return a(e,[{key:"setGameCtlNode",value:function(e,t){this.gameCtlNode=e,this.playerData=new i(t)}},{key:"getGameCtlNode",value:function(){return this.gameCtlNode}},{key:"getPlayerData",value:function(){return this.playerData}},{key:"setUICtlNode",value:function(e){this.uiCtlNode=e}},{key:"getUICtlNode",value:function(){return this.uiCtlNode}},{key:"playerClickShareButton",value:function(t){var a=this;return this.adsCtl.shareTo().then((function(){e.getInstance().getPlayerData().addPowerCount(t),a.gameCtlNode.emit("enter-next-level")}))}},{key:"playerClickRetryButton",value:function(){e.getInstance().getPlayerData().initRedHeartCount(),e.getInstance().getPlayerData().initCurrentGoldCount(),this.uiCtlNode.emit("update-gold-label",e.getInstance().getPlayerData().currentGoldCount),this.gameCtlNode.emit("retry-game")}},{key:"playerClickSaveLifeButton",value:function(){var e=this;return new Promise((function(t,a){e.adsCtl.watchVideoAds().then((function(a){"succ"===a&&(t(),e.gameCtlNode.emit("player-click-save-life-button"))}))}))}},{key:"addPowerCount",value:function(e){this.playerData.addPowerCount(e),this.uiCtlNode.emit("refer-current-power-label",this.playerData.currentPowerCount)}},{key:"addGoldCount",value:function(e){this.playerData.addGoldCount(e),this.uiCtlNode.emit("update-gold-label",e)}},{key:"newGame",value:function(){this.playerData.initRedHeartCount(),this.playerData.initCurrentGoldCount(),this.uiCtlNode.emit("update-gold-label")}},{key:"enterNextLevel",value:function(){this.playerData.addOneNextLevel(),this.playerData.initCurrentGoldCount(),this.playerData.initRedHeartCount(),this.uiCtlNode.emit("update-gold-label")}},{key:"showBannerAds",value:function(){this.adsCtl.showBannerAds()}},{key:"hideBannerAds",value:function(){this.adsCtl.hideBannerAds()}}],[{key:"getInstance",value:function(){return null===this.gameInstance&&(this.gameInstance=new e),this.gameInstance}}]),e}()),o.gameInstance=null,l._RF.pop()}}}));

System.register("chunks:///BaseObject.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./GameInstance.js"],(function(e,t){var o,i,n,s,a,r,u,c,l,y,h,p,v,d,T,b,g,m,j,k,f,A,C,L,I,R,w,S,B;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,s=e.possibleConstructorReturn,a=e.getPrototypeOf,r=e.initializerDefineProperty,u=e.assertThisInitialized,c=e.createClass},function(e){l=e.cclegacy,y=e._decorator,h=e.Node,p=e.CCFloat,v=e.isValid,d=e.v3,T=e.Quat,b=e.Vec3,g=e.Component},function(e){m=e.GameInstance}],execute:function(){l._RF.push({},"f047fSpjWxIyqfTRsf+Ksl/","BaseObject",void 0),S=y.ccclass,B=y.property,e("BaseObject",(j=S("BaseObject"),k=B({type:""}),f=B({type:h}),A=B({type:p}),j((I=o((L=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return o=s(this,(e=a(t)).call.apply(e,[this].concat(c))),r(o,"objectType",I,u(o)),r(o,"rootNode",R,u(o)),r(o,"animSpeedMulOffset",w,u(o)),o.currentLevel=1,o.baseGasNum=0,o.baseAttackNum=0,o.baseAttackRate=0,o.baseRotateAngle=0,o.rotateSpeed=0,o.baseGoldCount=0,o.buildCost=0,o.shootDuraction=0,o.baseAttackRange=0,o.towerUpdateMaxLevel=0,o.currentGasNum=0,o.moveSpeed=0,o.isCollisionGround=!1,o.leftTime=0,o.towerIndexType=0,o.iconSpriteFrame=null,o.activeCostGoldCount=0,o.enemyMoveType="walk",o.canAttackMoveTypeList=[],o.enemyBulletType=0,o.isCollisionDestroy=!1,o.enemyIndexType=0,o.isConlony=!1,o.bulletRecoverTime=0,o.needRecoverBullet=!1,o.attackType="normal",o.healthCount=0,o.objectName="无",o.desString="",o.shootAudio="",o.boomAudio="",o.showAudio="",o.walkAudio="",o.deadAudio="",o.readyAduio="",o}return i(t,e),c(t,[{key:"init",value:function(e,t,o,i){i&&(this.objectType=i),e[this.objectType].BaseGasNum&&(this.baseGasNum=e[this.objectType].BaseGasNum),this.currentGasNum=this.baseGasNum,e[this.objectType].MoveSpeed&&(this.moveSpeed=e[this.objectType].MoveSpeed),e[this.objectType].isCollisionGround&&(this.isCollisionGround=e[this.objectType].isCollisionGround),e[this.objectType].BaseAttackNum&&(this.baseAttackNum=e[this.objectType].BaseAttackNum),e[this.objectType].ShootRate&&(this.baseAttackRate=e[this.objectType].ShootRate,this.shootDuraction=1/this.getCurrentShootRate()),e[this.objectType].BaseRotateAngle&&(this.baseRotateAngle=e[this.objectType].BaseRotateAngle),e[this.objectType].LeftTime&&(this.leftTime=e[this.objectType].LeftTime),e[this.objectType].RotateSpeed&&(this.rotateSpeed=e[this.objectType].RotateSpeed),e[this.objectType].BaseGoldCount&&(this.baseGoldCount=e[this.objectType].BaseGoldCount),e[this.objectType].BuildCost&&(this.buildCost=e[this.objectType].BuildCost),e[this.objectType].AttackRange&&(this.baseAttackRange=e[this.objectType].AttackRange),e.TowerMaxLevel&&(this.towerUpdateMaxLevel=e.TowerMaxLevel),e[this.objectType].Index&&(this.towerIndexType=e[this.objectType].Index),e[this.objectType].IconSprteFrame&&(this.iconSpriteFrame=e[this.objectType].IconSprteFrame),e[this.objectType].ActiveCost&&(this.activeCostGoldCount=e[this.objectType].ActiveCost),e[this.objectType].MoveType&&(this.enemyMoveType=e[this.objectType].MoveType),e[this.objectType].CanAttackType&&(this.canAttackMoveTypeList=e[this.objectType].CanAttackType),e[this.objectType].EnemyBulletType&&(this.enemyBulletType=e[this.objectType].EnemyBulletType),e[this.objectType].isCollisionDestroy&&(this.isCollisionDestroy=e[this.objectType].isCollisionDestroy),e[this.objectType].EnemyIndex&&(this.enemyIndexType=e[this.objectType].EnemyIndex),e[this.objectType].Colony&&(this.isConlony=e[this.objectType].Colony),e[this.objectType].BulletRecoverTime&&(this.bulletRecoverTime=e[this.objectType].BulletRecoverTime),e[this.objectType].AttackType&&(this.attackType=e[this.objectType].AttackType),e[this.objectType].Name&&(this.objectName=e[this.objectType].Name),e[this.objectType].NeedRecoverBullet&&(this.needRecoverBullet=e[this.objectType].NeedRecoverBullet),e[this.objectType].HealthCount&&(this.healthCount=e[this.objectType].HealthCount),e[this.objectType].Des&&(this.desString=e[this.objectType].Des),e[this.objectType].ShootAudio&&(this.shootAudio=e[this.objectType].ShootAudio),e[this.objectType].BoomAudio&&(this.boomAudio=e[this.objectType].BoomAudio),e[this.objectType].ShowAudio&&(this.showAudio=e[this.objectType].ShowAudio),e[this.objectType].WalkAudio&&(this.walkAudio=e[this.objectType].WalkAudio),e[this.objectType].DeadAudio&&(this.deadAudio=e[this.objectType].DeadAudio),e[this.objectType].ReadyAduio&&(this.readyAduio=e[this.objectType].ReadyAduio)}},{key:"getBaseAttackDamage",value:function(){return this.baseAttackNum}},{key:"getCurrentAttackNum",value:function(){return this.baseAttackNum+1*(this.currentLevel+1)*this.currentLevel*.5+this.getLocalDamageNum()}},{key:"getLocalDamageNum",value:function(){var e=m.getInstance().getPlayerData().getCurrentTowerLocalLevel(this.towerIndexType);return(1+e)*e*.5}},{key:"getCurrentSkillRotateAngle",value:function(){return this.baseRotateAngle}},{key:"getCurrentShootRate",value:function(){var e=this.baseAttackRate;return(e*=1+this.currentLevel*this.currentLevel*.1)>10&&(e=10),e}},{key:"getCurrentGoldCount",value:function(){return this.baseGoldCount}},{key:"getCurrentLevel",value:function(){return this.currentLevel}},{key:"getUpdateCost",value:function(){var e=this.currentLevel+1;return this.buildCost+(1+e)*e*.5}},{key:"getUpdateLocalLevelCost",value:function(){var e=m.getInstance().getPlayerData().getCurrentTowerLocalLevel(this.towerIndexType);return Math.round(.5*Math.pow(e+1,2))}},{key:"getNextLocallevelAddDamage",value:function(){return m.getInstance().getPlayerData().getCurrentTowerLocalLevel(this.towerIndexType)+1}},{key:"getDestroyCount",value:function(){var e=this.buildCost,t=this.currentLevel;return Math.round(.8*(e+(1+t)*t*.5))}},{key:"updateLevel",value:function(){this.currentLevel++;var e=this.getCurrentShootRate();this.shootDuraction=1/e,this.bulletRecoverTime*=1-this.currentLevel*this.currentLevel*.1,this.bulletRecoverTime<.2&&(this.bulletRecoverTime=.2)}},{key:"getCurrentAttackRange",value:function(){var e=this.currentLevel;return this.baseAttackRange*(1+e*(e-.5)*.01)}},{key:"getTowerIsMax",value:function(){return this.currentLevel>=this.towerUpdateMaxLevel}},{key:"getIconSprteFrame",value:function(){return this.iconSpriteFrame}},{key:"getWeaponIsActive",value:function(){return m.getInstance().getPlayerData().getWeaponIsActive(this.towerIndexType)}},{key:"updateLocalLevel",value:function(e){var t=m.getInstance().getPlayerData().getCurrentTowerLocalLevel(this.towerIndexType);t+=e,m.getInstance().getPlayerData().updateTowerLocalLevel(this.towerIndexType,t)}},{key:"getActiveCostGoldCount",value:function(){return this.activeCostGoldCount}},{key:"activeWeapon",value:function(){m.getInstance().getPlayerData().activeTower(this.towerIndexType)}},{key:"getMoveType",value:function(){return this.enemyMoveType}},{key:"getCanAttackEnemy",value:function(e){if(!v(e))return!1;var o=e.getComponent(t);if(o)for(var i=o.getMoveType(),n=this.canAttackMoveTypeList,s=0;s<n.length;s++){if(n[s]===i)return!0}return!1}},{key:"getCanAttackMoveTypeList",value:function(){return this.canAttackMoveTypeList}},{key:"getIsBoss",value:function(){return this.objectType.indexOf("Boss")>-1}},{key:"getEnemyBulletType",value:function(){return this.enemyBulletType}},{key:"getIsCollisionDestroy",value:function(){return this.isCollisionDestroy}},{key:"getLookAtAngle",value:function(e,t){var o=d(e).subtract(t).normalize(),i=new T;return T.fromViewUp(i,o,b.UP),i}},{key:"getEnemyIsActive",value:function(){return m.getInstance().getPlayerData().getEnemyIsActive(this.objectType)}},{key:"getIsShowed",value:function(){return m.getInstance().getPlayerData().getIsShowed(this.objectType)}},{key:"setShowed",value:function(){m.getInstance().getPlayerData().setShowed(this.objectType)}},{key:"getIsColony",value:function(){return this.isConlony}},{key:"getBulletRecoverTime",value:function(){return this.bulletRecoverTime}},{key:"getMoveSpeed",value:function(){return this.moveSpeed}},{key:"getAttackType",value:function(){return this.attackType}},{key:"getObjectName",value:function(){return this.objectName}},{key:"getAttackSpeedLevel",value:function(){return this.currentLevel}},{key:"getIsNeedRecoverBullet",value:function(){return this.needRecoverBullet}},{key:"getHealthCount",value:function(){return this.healthCount}},{key:"getDesString",value:function(){return this.desString}},{key:"getBoomAudioStr",value:function(){return this.boomAudio}},{key:"getShowAudio",value:function(){return this.showAudio}}]),t}(g)).prototype,"objectType",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"default"}}),R=o(L.prototype,"rootNode",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=o(L.prototype,"animSpeedMulOffset",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),C=L))||C)),l._RF.pop()}}}));

System.register("chunks:///BossController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,o){var e,s,r,n,c,l,i,u,a,p,C;return t({_dec:void 0,_class:void 0}),{setters:[function(t){e=t.inherits,s=t.createClass,r=t.classCallCheck,n=t.possibleConstructorReturn,c=t.getPrototypeOf},function(t){l=t.cclegacy,i=t._decorator,u=t.Component}],execute:function(){l._RF.push({},"dcc66ytht5FMYgvOIQcQVvo","BossController",void 0),C=i.ccclass,i.property,t("BossController",(a=C("BossController"),a(p=function(t){function o(){return r(this,o),n(this,c(o).apply(this,arguments))}return e(o,t),s(o,[{key:"start",value:function(){}}]),o}(u))||p)),l._RF.pop()}}}));

System.register("chunks:///util/State.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var a,s,n;return{setters:[function(t){a=t.createClass,s=t.classCallCheck},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"309b9GENMFDhItBZDPdMuEd","State",void 0),t("State",function(){function t(){s(this,t),this.state="",this.handleMap={}}return a(t,[{key:"setState",value:function(t){if(this.state=t,this.handleMap[this.state]){for(var e=this.handleMap[this.state],a=[],s=1;s<arguments.length;s++)a.push(arguments[s]);for(var n=0;n<e.length;n++){var i=e[n];i.apply(this,a)}}}},{key:"getState",value:function(){return this.state}},{key:"addState",value:function(t,e){this.handleMap[t]?this.handleMap[t].push(e):this.handleMap[t]=[e]}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///util/BezierN.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,r){var e,n,o,i,l;return{setters:[function(t){e=t.createClass,n=t.classCallCheck},function(t){o=t.cclegacy,i=t._decorator,l=t.v3}],execute:function(){o._RF.push({},"e43e2vpRCtNoZCKx8bvmJ4Z","BezierN",void 0),i.ccclass,i.property,t("BezierN",function(){function t(r){n(this,t),this.controllerPointList=[],this.controllerPointList=r}return e(t,[{key:"getPointList",value:function(t){for(var r=this.controllerPointList.length,e=[1,1],n=3;n<r+1;n++){for(var o=[],i=0;i<e.length;i++)o.push(e[i]);e[0]=1,e[n-1]=1;for(var c=0;c<o.length-1;c++)e[c+1]=o[c]+o[c+1]}for(var s=[],a=0;a<t;a++){for(var u=a/t,h=l(0,0,0),f=0;f<r;f++){var v=r-1-f,p=f,g=e[f]*Math.pow(1-u,v)*Math.pow(u,p);h.add(l(this.controllerPointList[f]).multiplyScalar(g))}s.push(h)}return s}}],[{key:"getPathLength",value:function(t){for(var r=0,e=0;e<t.length;e++){if(0!==e)r+=l(t[e]).subtract(t[e-1]).length()}return r}}]),t}()),o._RF.pop()}}}));

System.register("chunks:///util/My2Array.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,u,i,s;return{setters:[function(t){n=t.createClass,u=t.classCallCheck},function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"5a822YVyJlDnb5+nCIOK0H/","My2Array",void 0),s=function(){function t(){u(this,t),this.numberList=[],this.heightNum=0}return n(t,[{key:"pushValue",value:function(t){this.numberList[this.numberList.length-1].push(t)}},{key:"pushList",value:function(t){this.numberList.push(t)}},{key:"getValue",value:function(t,e){if(!(e<0||t<0))return e>=this.numberList.length?null:t>=this.numberList[e].length?null:this.numberList[e][t]}},{key:"setValue",value:function(t,e,n){this.numberList[t][e]=n}},{key:"getHeightLength",value:function(){return this.numberList.length}},{key:"getWidthLength",value:function(){return this.numberList.length>0?this.numberList[0].length:0}},{key:"getValueWithLieIndex",value:function(t){return this.numberList[t]}},{key:"convertOneSpaceList",value:function(){for(var t=[],e=0;e<this.getHeightLength();e++)for(var n=0;n<this.getWidthLength();n++)t.push(this.numberList[e][n]);return t}}]),t}(),i._RF.pop(),t("default",s)}}}));

System.register("chunks:///GroundTiled/GroundTiled.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js"],(function(t,e){var r,n,s,i,c,a,u,o,l,p,h,d;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){r=t.inherits,n=t.classCallCheck,s=t.possibleConstructorReturn,i=t.getPrototypeOf,c=t.createClass},function(t){a=t.cclegacy,u=t._decorator,o=t.v2},function(t){l=t.BaseObject}],execute:function(){a._RF.push({},"75b72ybo0hO5rMJsDKDP6W5","GroundTiled",void 0),d=u.ccclass,u.property,t("GroundTiled",(p=d("GroundTiled"),p(h=function(t){function e(){var t,r;n(this,e);for(var c=arguments.length,a=new Array(c),u=0;u<c;u++)a[u]=arguments[u];return(r=s(this,(t=i(e)).call.apply(t,[this].concat(a)))).mapX=0,r.mapY=0,r.targetObjectList=[],r}return r(e,t),c(e,[{key:"getIsVoid",value:function(){return 0===this.targetObjectList.length}},{key:"setMapXY",value:function(t,e){this.mapX=t,this.mapY=e}},{key:"getMapXY",value:function(){return o(this.mapX,this.mapY)}},{key:"getTargetObjectList",value:function(){return this.targetObjectList}},{key:"setTargetObject",value:function(t){this.targetObjectList.push(t)}}]),e}(l))||h)),a._RF.pop()}}}));

System.register("chunks:///GroundMapCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/My2Array.js","./GroundTiled/GroundTiled.js"],(function(e,t){var i,r,o,n,a,s,u,d,l,p,h,c,f,v,m,g,y,b,w,M,T,_,C,z,L,P,x,k,H,E,G,N,W,A,I,S;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,r=e.inherits,o=e.classCallCheck,n=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,u=e.assertThisInitialized,d=e.createClass},function(e){l=e.cclegacy,p=e._decorator,h=e.Prefab,c=e.CCInteger,f=e.CCFloat,v=e.instantiate,m=e.v3,g=e.v2,y=e.Tween,b=e.find,w=e.Component},function(e){M=e.default},function(e){T=e.GroundTiled}],execute:function(){l._RF.push({},"44e5akPt5hEHpdS1j2qoO/6","GroundMapCtl",void 0),I=p.ccclass,S=p.property,e("GroundMapCtl",(_=I("GroundMapCtl"),C=S({type:h}),z=S({type:c}),L=S({type:c}),P=S({type:f}),x=S({type:h}),_((E=i((H=function(e){function t(){var e,i;o(this,t);for(var r=arguments.length,d=new Array(r),l=0;l<r;l++)d[l]=arguments[l];return i=n(this,(e=a(t)).call.apply(e,[this].concat(d))),s(i,"groundMapTiledPrefab",E,u(i)),s(i,"mapWidth",G,u(i)),s(i,"mapHeight",N,u(i)),s(i,"tiledSize",W,u(i)),i.mapNodeList=new M,i.obsNodeList=[],s(i,"treePrefab",A,u(i)),i.groundTiledEdageIndexList=[],i}return r(t,e),d(t,[{key:"start",value:function(){for(var e=0;e<this.mapHeight;e++){for(var t=[],i=0;i<this.mapWidth;i++){var r=v(this.groundMapTiledPrefab);r.parent=this.node;var o=m(-.5*(this.mapWidth-1)*this.tiledSize+i*this.tiledSize,-6,-.5*(this.mapHeight-1)*this.tiledSize+e*this.tiledSize);r.setPosition(o),r.active=!1,t.push(r)}this.mapNodeList.pushList(t)}for(var n=[],a=0;a<this.mapWidth;a++)n.push(g(a,0));for(var s=1;s<this.mapHeight;s++)n.push(g(this.mapWidth-1,s));for(var u=this.mapWidth-2;u>=0;u--)n.push(g(u,this.mapHeight-1));for(var d=this.mapHeight-2;d>0;d--)n.push(g(0,d));this.groundTiledEdageIndexList=n}},{key:"getInEdageIndexList",value:function(){return this.groundTiledEdageIndexList}},{key:"showTreeEnterAnim",value:function(e){return console.log("show tree enter anima"),new Promise((function(t,i){e.active=!0,e.scale=m(1,0,1);var r=new y(e);r.to(.2,{scale:m(1,1,1)},{easing:"elasticOut"}),r.call((function(){t()})),r.start()}))}},{key:"showGroundEnterAnim",value:function(){var e=this;return this.showGroundTiledEnterAnim().then((function(){for(var t=0;t<2;){var i=[0,e.mapHeight-1][Math.round(1*Math.random())],r=Math.round(Math.random()*(e.mapWidth-1)),o=e.mapNodeList.getValue(r,i);if(o){e.obsNodeList.push(g(r,i));var n=o;if(n&&n.getComponent(T)){var a=n.getComponent(T);if(a.getIsVoid()){var s=v(e.treePrefab);s.parent=e.node,a.setTargetObject(s),s.active=!1,s.position=m(n.position.x,0,n.position.z),e.showTreeEnterAnim(s),t++}}}}}))}},{key:"setTowerBuildBaseOnTiled",value:function(e,t,i){var r=this.mapNodeList.getValue(t,i);if(r){this.obsNodeList.push(g(t,i));var o=r;o&&o.getComponent(T)&&o.getComponent(T).setTargetObject(e)}}},{key:"showGroundTiledEnterAnim",value:function(){for(var e=g(Math.floor(this.mapWidth/2),Math.floor(this.mapHeight/2)+1),t=0,i=g(0,-1),r=1,o=0,n=0,a=[];e.x<=this.mapWidth+1&&e.y<=this.mapHeight+1&&e.x>=0&&e.y>=0;){for(var s=0;s<r;){s++;var u=this.mapNodeList.getValue(e.x,e.y);if(u){var d=u;d&&(a.push(this.showEnterAnim(d,n)),n++)}e.add(i)}var l=2*Math.PI/4*t;(i=g(0,1).rotate(l).normalize()).x=i.x<0&&Math.abs(i.x)<1?0:Math.floor(i.x),i.y=i.y<0&&Math.abs(i.y)<1?0:Math.floor(i.y),2==o&&(o=0,r++),o++,t++}return Promise.all(a)}},{key:"showEnterAnim",value:function(e,t){return new Promise((function(i,r){var o=new y(e),n=e.position;o.delay(.03*t),o.call((function(){e.active=!0,t%3==0&&b("GameController").emit("play-audio","drop")})),o.to(.4,{position:m(n.x,0,n.z)},{easing:"elasticOut"}),o.call((function(){i()})),o.start()}))}},{key:"getMapNodeList",value:function(){return this.mapNodeList}},{key:"getObsPosList",value:function(){return this.obsNodeList}},{key:"getMapSize",value:function(){return g(this.mapWidth,this.mapHeight)}}]),t}(w)).prototype,"groundMapTiledPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=i(H.prototype,"mapWidth",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),N=i(H.prototype,"mapHeight",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),W=i(H.prototype,"tiledSize",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),A=i(H.prototype,"treePrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=H))||k)),l._RF.pop()}}}));

System.register("chunks:///util/FindPathWithAStart.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./My2Array.js"],(function(t,e){var s,i,n,a,h;return{setters:[function(t){s=t.createClass,i=t.classCallCheck},function(t){n=t.cclegacy},function(t){a=t.default}],execute:function(){n._RF.push({},"9bae92/Z1FGnZ8sEkxwZFcp","FindPathWithAStart",void 0),h=function(){function t(e,s){i(this,t),this.x=0,this.y=0,this.isHaveObs=!1,this.gValue=0,this.hValue=0,this.parent=null,this.x=e,this.y=s}return s(t,[{key:"setParent",value:function(t){this.parent=t}},{key:"getFValue",value:function(){return this.gValue+this.hValue}},{key:"setObs",value:function(t){this.isHaveObs=t}}]),t}(),t("FindPathWithAStart",function(){function t(e,s,n){i(this,t),this.openList=[],this.closeList=[],this.mapNodeList=new a,this.statrNode=null,this.endNode=null;for(var r=e.getHeightLength(),u=e.getWidthLength(),o=0;o<r;o++){for(var l=new Array,c=0;c<u;c++)l.push(new h(c,o));this.mapNodeList.pushList(l)}this.statrNode=this.mapNodeList.getValue(s[0],s[1]),this.endNode=this.mapNodeList.getValue(n[0],n[1])}return s(t,[{key:"findPathList",value:function(){var t=[];for(this.openList.push(this.statrNode);this.openList.length>0;){var e=this.findMinFvalueNode(this.openList),s=this.openList.splice(e,1)[0];if(s.x===this.endNode.x&&s.y===this.endNode.y){var i=s.parent;for(t.push(s);i.x!==this.statrNode.x||i.y!==this.statrNode.y;)t.push(i),i=i.parent;break}this.closeList.push(s);for(var n=this.findNearbyNodeList(s,this.mapNodeList),a=0;a<n.length;a++){var h=n[a];this.checkIsInList(h,this.closeList)||(this.checkIsInList(h,this.openList)?h.parent.gValue<s.gValue&&(h.setParent(s),h.gValue=s.gValue+this.getDistance(h.parent,h),h.hValue=this.getDistance(h,this.endNode)):(h.setParent(s),h.gValue=s.gValue+this.getDistance(h.parent,h),h.hValue=this.getDistance(h,this.endNode),this.openList.push(h)))}}t=t.reverse();for(var r=[],u=0;u<t.length;u++)r.push([t[u].x,t[u].y]);return r}},{key:"getDistance",value:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"findNearbyNodeList",value:function(t,e){for(var s=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],i=[],n=0;n<s.length;n++){var a=s[n],h=t.x+a[0],r=t.y+a[1],u=e.getValue(h,r);u&&!u.isHaveObs&&i.push(u)}return i}},{key:"findMinFvalueNode",value:function(t){for(var e=Number.MAX_VALUE,s=null,i=0;i<t.length;i++){var n=t[i].getFValue();n<e&&(e=n,s=i)}return s}},{key:"checkIsInList",value:function(t,e){for(var s=0;s<e.length;s++){var i=e[s];if(i.x===t.x&&i.y===t.y)return!0}return!1}},{key:"updateObsData",value:function(t){for(var e=0;e<t.length;e++){var s=t[e];this.mapNodeList.getValue(s[0],s[1]).setObs(!0)}}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","../BaseObject.js","../util/State.js","../util/BezierN.js","../GroundMapCtl.js","../util/FindPathWithAStart.js"],(function(e,t){var n,o,a,i,s,r,u,l,c,h,d,m,g,p,f,v,y,C,k,A,N,b,M,w,B,S,L,z,P,I,T,x,O,G;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,a=e.classCallCheck,i=e.possibleConstructorReturn,s=e.getPrototypeOf,r=e.initializerDefineProperty,u=e.assertThisInitialized,l=e.createClass,c=e.get},function(e){h=e.cclegacy,d=e._decorator,m=e.Node,g=e.v3,p=e.find,f=e.SkeletalAnimationComponent,v=e.Tween,y=e.v2,C=e.Quat,k=e.Vec3,A=e.isValid,N=e.ProgressBarComponent},function(e){b=e.GameInstance},function(e){M=e.BaseObject},function(e){w=e.State},function(e){B=e.BezierN},function(e){S=e.GroundMapCtl},function(e){L=e.FindPathWithAStart}],execute:function(){h._RF.push({},"c8d3fW25B9NIZ69bxowfjcm","EnemyBase",void 0),O=d.ccclass,G=d.property,e("EnemyBase",(z=O("EnemyBase"),P=G({type:m}),z((x=n((T=function(e){function t(){var e,n;a(this,t);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return(n=i(this,(e=s(t)).call.apply(e,[this].concat(l)))).pathList=[],n.state=new w,n.currentPathIndex=0,n.beLockedMaxNum=10,n.currentbeLockedCount=0,n.cameraNode=null,n.healthBar=null,n.gameConfigJson=null,n.currentHealthCount=0,n.enemyCtlNode=null,n.currentMoveTw=null,n.groundMapCtl=null,n.beAttackedCb=null,n.bezierPathList=[],n.currentBoneAnimName="",n.enemyColonyCtl=null,r(n,"caidaiEffect",x,u(n)),n.bossHealthBar=null,n}return o(t,e),l(t,[{key:"init",value:function(e,n,o){c(s(t.prototype),"init",this).call(this,e),this.getMoveType().indexOf("Fly")>-1&&(this.node.position=g(this.node.position.x,10,this.node.position.z)),this.groundMapCtl=p("GameController").getComponent(S),this.gameConfigJson=e,this.beLockedMaxNum=this.gameConfigJson[this.objectType].BeLockedCount,this.currentHealthCount=this.healthCount;var a=this.getLookAtAngle(this.node.position,o);this.node.worldRotation=a}},{key:"enterShowBossEnter",value:function(){this.currentMoveTw&&this.currentMoveTw.stop()}},{key:"contiuePlayMoveAnim",value:function(){var e=this;this.currentMoveTw&&(this.rootNode.getComponent(f).getState(this.currentBoneAnimName).speed=3,this.scheduleOnce((function(){e.rootNode.getComponent(f).getState(e.currentBoneAnimName).speed=1}),3))}},{key:"showEnemyEnterAnim",value:function(e,t,n,o){var a=this,i=this.node;return this.enemyCtlNode=t,this.enemyCtlNode.on("frozen-all-enemy",this.forzenSelf.bind(this),this),new Promise((function(t,s){var r=new v(i);i.position;r.delay(.1*e),r.show(),r.call((function(){i.active=!0})),r.to(.1,{scale:g(1,1,1)}),r.call((function(){a.startRun(n,o),t()})),r.start()}))}},{key:"startRun",value:function(e,t){this.state.setState("run");var n=this.getMoveType();"Walk"===n?this.proceeWalkLogic(e,t):"Fly"===n&&(this.getIsColony()||this.processFlyLogic(e,t))}},{key:"processFlyLogic",value:function(e,t){var n=this;if(b.getInstance().getGameCtlNode().emit("play-audio",this.getShowAudio()),"run"===this.state.getState()){for(var o=this.groundMapCtl.getMapSize(),a=[y(e.x,e.y)],i=0;i<8;i++)a.push(y(Math.round(Math.random()*(o.x-1)),Math.round(Math.random()*(o.y-1))));a.push(t);for(var s=[],r=0;r<a.length;r++){var u=a[r],l=this.groundMapCtl.getMapNodeList().getValue(u.x,u.y);if(l){var c=l.position;s.push(g(c.x,10,c.z))}}var h=new B(s).getPointList(200);this.currentMoveTw=this.processMoveAction(h),this.currentMoveTw.call((function(){n.currentBoneAnimName="骨架|AttackAnim";n.rootNode.getComponent(f).getState("骨架|AttackAnim").length;n.shootOneBossBullet().then((function(){var e=[y(0,0),y(0,10),y(10,0),y(10,10)],o=Math.round(Math.random()*(e.length-1));n.processFlyLogic(e[o],t)}))})),this.currentMoveTw.start()}}},{key:"getOneRandomMapPos",value:function(){var e=this.groundMapCtl.getMapSize();return y(Math.round(Math.random()*(e.x-1)),Math.round(Math.random()*(e.y-1)))}},{key:"processMoveAction",value:function(e){for(var t=this,n=new v(this.node),o=function(n,o){var a=0;new C;if(0===o){a=g(t.node.position).subtract(e[o]).length()/t.moveSpeed,t.getLookAtAngle(t.node.position,e[o])}else{var i=g(e[o-1]).subtract(e[o]).length();t.getLookAtAngle(e[o-1],e[o]),a=i/t.moveSpeed}n.call((function(){t.node.lookAt(e[o])})),n.to(a,{position:e[o]}),n.call((function(){}))},a=0;a<e.length;a++)o(n,a);return n}},{key:"proceeWalkLogic",value:function(e,t){var n=this;if(b.getInstance().getGameCtlNode().emit("play-audio",this.getShowAudio()),"run"===this.state.getState()){for(var o=this.groundMapCtl.getMapNodeList(),a=this.groundMapCtl.getObsPosList(),i=new L(o,[e.x,e.y],[t.x,t.y]),s=[],r=0;r<a.length;r++){var u=a[r];s.push([u.x,u.y])}i.updateObsData(s);for(var l=i.findPathList(),c=[],h=0;h<l.length;h++){var d=l[h];c.push(this.groundMapCtl.getMapNodeList().getValue(d[0],d[1]).position)}var m=new B(c);this.bezierPathList=m.getPointList(50),this.bezierPathList=this.bezierPathList.slice(0,this.bezierPathList.length-5),this.node.position.equals(this.bezierPathList[this.bezierPathList.length-1])?(console.log("不用再走一遍逻辑了"),this.toBeAttack().then((function(){n.proceeWalkLogic(e,t)}))):(this.currentMoveTw=this.processMoveAction(this.bezierPathList),this.currentMoveTw.call((function(){n.toBeAttack().then((function(){n.proceeWalkLogic(e,t)}))})),this.currentMoveTw.start())}}},{key:"toBeAttack",value:function(){var e=this;return new Promise((function(t,n){e.currentBoneAnimName="骨架|AttackAnim";var o=e.rootNode.getComponent(f);o.play(e.currentBoneAnimName);var a=o.getState(e.currentBoneAnimName),i=a.length;a.repeatCount=1,b.getInstance().getGameCtlNode().emit("play-audio",e.shootAudio);var s=new v(e.node);s.delay(e.animSpeedMulOffset*i),s.call((function(){console.log("普通敌人发动攻击",e.getBaseAttackDamage()),b.getInstance().getGameCtlNode().emit("enemy-to-attacked",e.getBaseAttackDamage())})),s.delay((1-e.animSpeedMulOffset)*i),s.call((function(){t()})),s.start()}))}},{key:"getLookAtAngle",value:function(e,t){var n=g(e).subtract(t).normalize(),o=new C;return C.fromViewUp(o,n,k.UP),o}},{key:"forzenSelf",value:function(){if(this.currentMoveTw){this.currentMoveTw.stop(),this.state.setState("forzen");var e=this.rootNode.getComponent(f).getState(this.currentBoneAnimName);e&&e.pause()}}},{key:"shootOneBossBullet",value:function(){var e=this;return new Promise((function(t,n){e.currentBoneAnimName="骨架|AttackAnim";var o=e.rootNode.getComponent(f);o.play(e.currentBoneAnimName);var a=o.getState(e.currentBoneAnimName).length,i=new v(e.node);i.delay(e.animSpeedMulOffset*a),i.call((function(){e.enemyCtlNode.emit("boss-shoot-one-egg",e.node),b.getInstance().getGameCtlNode().emit("play-audio",e.shootAudio)})),i.delay((1-e.animSpeedMulOffset)*a),i.call((function(){e.currentBoneAnimName="骨架|MoveAnim",o.play(e.currentBoneAnimName),t&&t()})),i.start()}))}},{key:"onLoad",value:function(){var e=this;this.state.addState("over",(function(){e.enemyCtlNode.emit("remove-enemy-in-list",e.node),e.node.destroy()})),this.state.addState("to-dead",(function(){e.enemyCtlNode.emit("push-one-enemy-dead-data",e.objectType,e.healthCount),e.currentMoveTw&&e.currentMoveTw.stop();var t=new v(e.rootNode);e.unscheduleAllCallbacks(),t.by(.1,{scale:g(1,1,1)}),t.call((function(){e.deadAudio&&b.getInstance().getGameCtlNode().emit("play-audio",e.deadAudio),e.node.position=g(e.node.position.x,0,e.node.position.z),e.rootNode.active=!1,e.caidaiEffect.eulerAngles=g(0,360*Math.random(),0),g(e.node.position).subtract(g(0,0,0)).length()<18&&(e.caidaiEffect.active=!0),b.getInstance().getGameCtlNode().emit("show-add-gold-anim-effect",e.getCurrentGoldCount(),g(e.node.position.x,0,e.node.position.z))})),t.delay(1),t.call((function(){e.state.setState("over")})),t.start()})),this.state.addState("run",(function(){var t=e.rootNode.getComponent(f);t&&(e.currentBoneAnimName="骨架|MoveAnim",t.play(e.currentBoneAnimName)),e.playWalkAudio()})),this.node.on("be-attacked",(function(t){if("run"===e.state.getState()){e.beAttackedCb=t.cb,e.currentHealthCount-=t.baseAttackNum,e.objectType.indexOf("Boss")>-1&&b.getInstance().getUICtlNode().emit("update-boss-health-bar",e.currentHealthCount/e.healthCount);var n=t.baseGasNum;e.currentGasNum+=n;var o=new v(e.node);o.to(.05,{scale:g(1.05,.98,1.05)}),o.to(.05,{scale:g(1,1,1)}),o.start(),e.currentHealthCount<=0&&(e.currentHealthCount=0,e.beAttackedCb&&e.beAttackedCb(!0,e.getHealthCount()),e.state.setState("to-dead")),A(e.healthBar)&&(e.healthBar.getComponent(N).progress=e.currentHealthCount/e.healthCount)}}))}},{key:"start",value:function(){}},{key:"playWalkAudio",value:function(){var e=this;this.walkAudio&&b.getInstance().getGameCtlNode().emit("play-audio",this.walkAudio,(function(){"run"===e.state.getState()&&e.playWalkAudio()}))}},{key:"getIsDead",value:function(){return"over"===this.state.getState()||"to-dead"===this.state.getState()}},{key:"getIsCanLock",value:function(){return this.currentbeLockedCount<this.beLockedMaxNum}},{key:"setBeLocked",value:function(e){this.currentbeLockedCount++}},{key:"unSetBeLocked",value:function(e){this.currentbeLockedCount--}},{key:"update",value:function(e){this.enemyColonyCtl&&this.enemyColonyCtl.update(e)}},{key:"playBossEnterAnim",value:function(){var e=this;return b.getInstance().getUICtlNode().emit("show-boss-health-bar"),new Promise((function(t,n){for(var o=e.rootNode.getComponent(f),a=o.clips,i=void 0,s=0;s<a.length;s++){var r=a[s];"boss-show"===r.name&&(i=r)}i?(o.play("boss-show"),e.scheduleOnce((function(){t()}),i.length)):(o.play("骨架|MoveAnim"),e.scheduleOnce((function(){t()}),1))}))}},{key:"onDestroy",value:function(){this.enemyCtlNode&&A(this.enemyCtlNode)&&this.enemyCtlNode.off("frozen-all-enemy",this.forzenSelf,this),this.objectType.indexOf("Boss")>-1&&b.getInstance().getUICtlNode().emit("hide-boss-health-bar")}},{key:"getColonyComCtl",value:function(){return this.enemyColonyCtl}}]),t}(M)).prototype,"caidaiEffect",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=T))||I)),h._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyBullet.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","../BaseObject.js","../util/State.js"],(function(t,e){var i,a,n,s,c,o,r,l,d,u,f,h,p,y,v,m,g,E,_,S,k,B,P,b;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,a=t.inherits,n=t.classCallCheck,s=t.possibleConstructorReturn,c=t.getPrototypeOf,o=t.initializerDefineProperty,r=t.assertThisInitialized,l=t.createClass,d=t.get},function(t){u=t.cclegacy,f=t._decorator,h=t.Node,p=t.Tween,y=t.v3},function(t){v=t.GameInstance},function(t){m=t.BaseObject},function(t){g=t.State}],execute:function(){u._RF.push({},"17cf4gdnXZPP6GfTwWTkX9d","EnemyBullet",void 0),P=f.ccclass,b=f.property,t("EnemyBullet",(E=P("EnemyBullet"),_=b({type:h}),E((B=i((k=function(t){function e(){var t,i;n(this,e);for(var a=arguments.length,l=new Array(a),d=0;d<a;d++)l[d]=arguments[d];return(i=s(this,(t=c(e)).call.apply(t,[this].concat(l)))).state=new g,i.accY=-1,i.currentSpeed=0,i.endPos=null,o(i,"caidaiEffect",B,r(i)),i}return a(e,t),l(e,[{key:"start",value:function(){var t=this;this.state.addState("move-end",(function(){var e=new p(t.rootNode);e.to(.1,{scale:y(2,2,2)}),e.hide(),e.call((function(){v.getInstance().getGameCtlNode().emit("enemy-to-attacked",t.getBaseAttackDamage()),t.caidaiEffect.active=!0})),e.delay(.8+.5*Math.random()),e.call((function(){t.caidaiEffect.active=!1,t.node.destroy()})),e.start()}))}},{key:"init",value:function(t,i){d(c(e.prototype),"init",this).call(this,t),this.endPos=i,this.caidaiEffect.eulerAngles=y(0,360*Math.random(),0);var a=.2*Math.random()+.8;this.caidaiEffect.scale=y(a,a,a),this.state.setState("run")}},{key:"update",value:function(t){"run"===this.state.getState()&&(this.currentSpeed+=this.accY,this.node.position=y(this.node.position).add(y(0,this.currentSpeed*t,0)),this.node.position.y-this.endPos.y<1&&this.state.setState("move-end"))}}]),e}(m)).prototype,"caidaiEffect",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=k))||S)),u._RF.pop()}}}));

System.register("chunks:///EnemyController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./GameInstance.js","./util/State.js","./GroundTiled/GroundTiled.js","./GroundMapCtl.js","./Enemys/EnemyBase.js","./Enemys/EnemyBullet.js"],(function(e,t){var n,o,i,a,r,s,l,u,d,c,m,y,g,v,h,f,p,C,b,L,E,D,N,w,I,P,_,k,A,x,B,W,G,O,S,j,z,T,J,M,R,V,F,H,U,q,K,Q,X;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_temp:void 0}),{setters:[function(e){n=e.classCallCheck,o=e.applyDecoratedDescriptor,i=e.inherits,a=e.possibleConstructorReturn,r=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,c=e._decorator,m=e.JsonAsset,y=e.Prefab,g=e.Node,v=e.find,h=e.v3,f=e.Tween,p=e.CameraComponent,C=e.instantiate,b=e.Vec2,L=e.Component,E=e.isValid},function(e){D=e.GameInstance},function(e){N=e.State},function(e){w=e.GroundTiled},function(e){I=e.GroundMapCtl},function(e){P=e.EnemyBase},function(e){_=e.EnemyBullet}],execute:function(){d._RF.push({},"9eb73bkCLlAgoJJ0ubFFvcV","EnemyController",void 0),K=c.ccclass,Q=c.property,e("DeadEnemyObj",X=function e(t,o){n(this,e),this.enemyType="",this.dropGoldCount=0,this.enemyType=t,this.dropGoldCount=o}),e("EnemyController",(k=K("EnemyController"),A=Q({type:m}),x=Q({type:y}),B=Q({type:g}),W=Q({type:g}),G=Q({type:g}),O=Q({type:y}),S=Q({type:y}),j=Q({type:m}),k((J=o((T=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,u=new Array(i),d=0;d<i;d++)u[d]=arguments[d];return o=a(this,(e=r(t)).call.apply(e,[this].concat(u))),s(o,"gameConfigRes",J,l(o)),s(o,"enemysPrefabList",M,l(o)),o.gameConfig=null,o.currentWaveIndex=0,o.waveData=null,o.state=new N,o.addEnemyDuraction=1,o.enemyNodeList=[],o.currentRandomEnemyTypeList=[],s(o,"startPosNodeList",R,l(o)),o.endPos=null,s(o,"enemyHealthBarCtlNode",V,l(o)),s(o,"cameraNode",F,l(o)),s(o,"bosssPrefabList",H,l(o)),s(o,"enemyBulletPrefabList",U,l(o)),o.allWaveAddOverCb=null,o.allEnemyDeadCb=null,o.boosIsLive=!1,o.currentLevelDeadEnemyDataList=[],o.uiControllerNode=null,o.isAddedBoss=!1,s(o,"gameConfigJsonAsset",q,l(o)),o}return i(t,e),u(t,[{key:"onLoad",value:function(){var e=this;this.node.on("destroy-all-enemy",(function(t){for(var n=0,o=0;o<e.enemyNodeList.length;o++){var i=e.enemyNodeList[o];n+=i.getComponent(P).getCurrentGoldCount(),i.destroy()}e.enemyNodeList=[],t&&t(n)})),this.node.on("init-level-label",(function(){e.node.emit("refer-current-wave-level",D.getInstance().getPlayerData().currentLevelNum,0)})),this.node.on("boss-shoot-one-egg",this.bossShootOneEgg.bind(this)),this.node.on("remove-enemy-in-list",this.removeEnemyInList.bind(this)),this.node.on("push-one-enemy-dead-data",this.pushOneEnemyDeadData.bind(this))}},{key:"start",value:function(){var e=this;this.uiControllerNode=v("Canvas"),this.gameConfig=this.gameConfigRes.json,this.endPos=h(0,0,0),this.schedule((function(){if("start-add-enemy"===e.state.getState()){var t=e.waveData.EnemyType;if(D.getInstance().getUICtlNode().emit("refer-current-wave-level",D.getInstance().getPlayerData().currentLevelNum,e.currentWaveIndex),e.currentWaveIndex<=t.length-2){var n=t[e.currentWaveIndex];e.addOneWaveEnemy(n),e.currentWaveIndex++}else if(e.currentWaveIndex===t.length-1){var o=t[e.currentWaveIndex];e.addOneBossEnemy(o).then((function(){return e.currentWaveIndex++,new Promise((function(t,n){e.allEnemyDeadCb=t}))})).then((function(){console.log("游戏胜利"),"game-lose"!==e.state.getState()&&(e.state.setState("game-win"),e.uiControllerNode.emit("show-end-dialog",D.getInstance().getPlayerData().currentLevelNum,(function(){D.getInstance().getGameCtlNode().emit("show-game-win-layer",e.currentLevelDeadEnemyDataList)})))})),e.state.setState("add-boss-state")}else console.log("敌人增加完毕"),e.state.setState("add-enemy-end")}}),4)}},{key:"playBossEnterAnim",value:function(e){var t=this;return new Promise((function(n,o){var i=e.getComponent(P);i?i.playBossEnterAnim().then((function(){n()})):t.scheduleOnce((function(){n()}),1)}))}},{key:"startGame",value:function(){var e=this;this.currentLevelDeadEnemyDataList=[],this.currentWaveIndex=0,this.waveData=this.gameConfigJsonAsset.json["Level_"+D.getInstance().getPlayerData().currentLevelNum],D.getInstance().getUICtlNode().emit("refer-current-wave-level",D.getInstance().getPlayerData().currentLevelNum,this.currentWaveIndex),this.uiControllerNode.emit("show-start-dialog",D.getInstance().getPlayerData().currentLevelNum,(function(){e.uiControllerNode.emit("show-guide",(function(){e.uiControllerNode.emit("show-guide",(function(){e.scheduleOnce((function(){e.state.setState("start-add-enemy")}),2.5)}))}))}))}},{key:"continueGame",value:function(){var e=this;this.currentWaveIndex--,this.waveData=this.gameConfigJsonAsset.json["Level_"+D.getInstance().getPlayerData().currentLevelNum],this.state.setState("start-add-enemy"),Promise.all([new Promise((function(t,n){e.allWaveAddOverCb=t})),new Promise((function(t,n){e.allEnemyDeadCb=t}))]).then((function(){console.log("游戏胜利"),D.getInstance().getGameCtlNode().emit("show-game-win-layer",e.currentLevelDeadEnemyDataList)}))}},{key:"pushOneEnemyDeadData",value:function(e,t){var n=new X(e,t);this.currentLevelDeadEnemyDataList.push(n),D.getInstance().getPlayerData().activeEnemy(n.enemyType)&&D.getInstance().getUICtlNode().emit("refer-enemy-info-cell",n.enemyType)}},{key:"gemeLose",value:function(){this.state.setState("game-lose")}},{key:"pauseGame",value:function(){}},{key:"showCameraBackAnim",value:function(){var e=this;return new Promise((function(t,n){var o=new f(e.cameraNode);o.to(.5,{position:h(30,42,30),eulerAngles:h(-45,45,0)}),o.call((function(){t()})),o.start(),new f(e.cameraNode.getComponent(p)).to(.5,{orthoHeight:22}).start()}))}},{key:"addOneBossEnemy",value:function(e){var t=this;return new Promise((function(n,o){t.scheduleOnce((function(){if("game-lose"!==t.state.getState()){var o=t.node.getComponent(I).getInEdageIndexList(),i=o[Math.round(Math.random()*(o.length-1))],a=t.node.getComponent(I).getMapNodeList().getValue(i.x,i.y),r=e[0].type,s=C(t.bosssPrefabList[r]);return s.parent=t.node,s.position=h(a.position.x,0,a.position.z),s.active=!1,s.getComponent(P).init(t.gameConfigJsonAsset.json,a.position,t.endPos),t.enemyNodeList.push(s),t.playBossEnterAnim(s).then((function(){t.node.emit("enter-continue-play-move-anim"),s.getComponent(P).showEnemyEnterAnim(1,t.node,i,new b(5,5)),n()}))}n()}),5)}))}},{key:"addOneWaveEnemy",value:function(e){for(var t=this,n=[],o=this.node.getComponent(I).getInEdageIndexList(),i=this.node.getComponent(I).getMapNodeList(),a=0;a<e.length;a++)e[a].count;for(var r=[],s=0;s<e.length;s++)for(var l=e[s],u=0;u<l.count;u++)r.push(l.type);var d=Math.round(Math.random()*o.length);0===this.currentWaveIndex&&0===D.getInstance().getPlayerData().currentLevelNum&&(d=0);for(var c=function(e,a){var r=d+e;r>=o.length&&(r-=o.length);var s=o[r],l=i.getValue(s.x,s.y);if(E(l)&&l.getComponent(w)&&l.getComponent(w).getIsVoid()){var u=C(t.enemysPrefabList[a]);u.parent=t.node,u.position=h(l.position.x,0,l.position.z),u.active=!1,u.getComponent(P).init(t.gameConfig,l.position,t.endPos),t.enemyNodeList.push(u),n.push(u.getComponent(P).showEnemyEnterAnim(e,t.node,s,new b(5,5)))}},m=0;m<r.length;m++)c(m,r[m]);return Promise.all(n)}},{key:"removeEnemyInList",value:function(e){for(var t=0;t<this.enemyNodeList.length;t++){this.enemyNodeList[t].uuid===e.uuid&&this.enemyNodeList.splice(t,1)}0===this.enemyNodeList.length&&this.allEnemyDeadCb&&(this.allEnemyDeadCb(),this.allEnemyDeadCb=null)}},{key:"getCurrentEnemyNodeList",value:function(){return this.enemyNodeList}},{key:"frozenAllEnemy",value:function(){this.state.setState("game-over"),this.node.emit("frozen-all-enemy")}},{key:"bossShootOneEgg",value:function(e){var t=e.getComponent(P);if(t){var n=t.getEnemyBulletType(),o=C(this.enemyBulletPrefabList[n]);o.parent=this.node,o.position=e.position,o.getComponent(_).init(this.gameConfigJsonAsset.json,this.endPos)}}},{key:"getDeadEnemyData",value:function(){return this.currentLevelDeadEnemyDataList}}]),t}(L)).prototype,"gameConfigRes",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(T.prototype,"enemysPrefabList",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=o(T.prototype,"startPosNodeList",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=o(T.prototype,"enemyHealthBarCtlNode",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=o(T.prototype,"cameraNode",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(T.prototype,"bosssPrefabList",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),U=o(T.prototype,"enemyBulletPrefabList",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),q=o(T.prototype,"gameConfigJsonAsset",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=T))||z)),d._RF.pop()}}}));

System.register("chunks:///BulletBase.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./GameInstance.js","./BaseObject.js","./util/State.js","./util/BezierN.js","./Enemys/EnemyBase.js","./EnemyController.js"],(function(e,t){var o,i,n,s,a,r,l,c,d,u,h,p,f,g,m,y,v,b,S,w,C,k,B,E,N,P,z,T,A,D,I,_,M,j,x,G;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,s=e.possibleConstructorReturn,a=e.getPrototypeOf,r=e.initializerDefineProperty,l=e.assertThisInitialized,c=e.createClass,d=e.get},function(e){u=e.cclegacy,h=e._decorator,p=e.Prefab,f=e.v3,g=e.Quat,m=e.Vec3,y=e.ColliderComponent,v=e.isValid,b=e.Tween,S=e.instantiate},function(e){w=e.GameInstance},function(e){C=e.BaseObject},function(e){k=e.State},function(e){B=e.BezierN},function(e){E=e.EnemyBase},function(e){N=e.EnemyController}],execute:function(){u._RF.push({},"90e683Z9ntM7pLuSDO8IdqW","BulletBase",void 0),x=h.ccclass,G=h.property,e("BulletBase",(P=x("BulletBase"),z=G({type:p}),T=G({type:p}),A=G({type:p}),P((_=o((I=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,c=new Array(i),d=0;d<i;d++)c[d]=arguments[d];return(o=s(this,(e=a(t)).call.apply(e,[this].concat(c)))).state=new k,o.speedY=0,o.currentDirection=f(0,0),o.currentInitSpeedY=6,o.currentCostAcc=-3,o.maxLeftTime=1+Math.random(),o.colliderComponent=null,o.gameConfigJson={},o.targetTowerBase=null,o.targetEnemyNode=null,o.movePathList=[],o.currentSpeedY=10,r(o,"exporeEffectPrefab",_,l(o)),r(o,"daodanweijiPrefab",M,l(o)),r(o,"baozhaEffectPrefab",j,l(o)),o.moveState=new k,o}return i(t,e),c(t,[{key:"onLoad",value:function(){this.state.addState("sleep",(function(){}))}},{key:"init",value:function(e,o){var i=this;if(d(a(t.prototype),"init",this).call(this,e),this.baseAttackNum+=o.baseAttackNum,this.targetTowerBase=o.targetTower,o&&o.direction){var n=o.direction;this.currentDirection=f(n);var s=f(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);this.currentDirection.add(s);var r=new g;g.fromViewUp(r,f(n).multiplyScalar(-1).normalize(),m.UP),this.node.worldRotation=r,this.state.setState("run")}var l=o.targetEnemy;if(l&&(this.targetEnemyNode=l),this.gameConfigJson=e,this.colliderComponent=this.node.getComponent(y),this.colliderComponent.on("onTriggerEnter",this.onTriggerEnter.bind(this)),this.scheduleOnce((function(){i.node.destroy()}),this.leftTime),"Bezier"===this.getMoveType())if(v(this.targetEnemyNode)){var c=this.targetEnemyNode.position,u=f(this.node.position).add(c).multiplyScalar(.5).add(f(0,15,0)),h=[this.node.position,u,c];this.movePathList=new B(h).getPointList(50);var p=this.processMove(this.movePathList);p.call((function(){i.state.setState("run"),i.moveState.setState("bezier-end")})),p.start()}else this.node.destroy();else this.state.setState("run")}},{key:"processMove",value:function(e){for(var t=new b(this.node),o=1;o<e.length;o++)this.processPosAndQuat(t,e[o],e[o-1]);return t}},{key:"processPosAndQuat",value:function(e,t,o){var i=this,n=f(o).subtract(t).length()/this.getMoveSpeed();e.call((function(){i.node.lookAt(t)})),e.to(n,{position:t})}},{key:"onTriggerEnter",value:function(e){var t=this;if("SkyDown"!==this.getMoveType()){var o=e.otherCollider;if(v(o)&&v(o.node)&&o.node.name.indexOf("Wall")>1&&(console.log(" other collier node",o.node.name),this.node.destroy()),o&&o.getComponent(E)&&!o.getComponent(E).getIsDead()){if(console.log("base attack num",this.baseAttackNum),this.getIsCollisionDestroy())if(w.getInstance().getGameCtlNode().emit("play-audio",this.getBoomAudioStr()),this.state.setState("enter-to-destroy"),v(this.exporeEffectPrefab)){this.rootNode.active=!1;var i=S(this.exporeEffectPrefab);i.parent=this.node;var n=new b(i);n.by(.1,{scale:f(1,1,1)}),n.call((function(){t.node.destroy()})),n.start()}else this.node.destroy();o.node.emit("be-attacked",{baseAttackNum:this.baseAttackNum,baseGasNum:this.baseGasNum,cb:function(e,o){console.log("是否死了",e),t.targetTowerBase&&t.targetTowerBase.enemyDeadByThis(e,o)}})}}}},{key:"start",value:function(){}},{key:"update",value:function(e){var t=this;if("run"===this.state.getState())if("Bezier"===this.getMoveType())if(v(this.targetEnemyNode)){var o=f(this.targetEnemyNode.position).add(f(0,2,0)).subtract(this.node.position);this.node.position=f(this.node.position).add(o.multiplyScalar(.2*e*this.getMoveSpeed())),"bezier-end"===this.moveState.getState()&&this.node.lookAt(this.targetEnemyNode.position)}else this.node.destroy();else if("SkyDown"===this.getMoveType()){if(this.currentSpeedY+=2,this.currentSpeedY%10==0){var i=S(this.daodanweijiPrefab);i.parent=this.node.parent,i.position=this.node.position;var n=new b(i);n.by(.2,{scale:f(1,1,1)}),n.call((function(){i.destroy()})),n.start()}if(this.node.position=f(this.node.position).add(f(0,e*this.currentSpeedY,0)),this.node.position.y>30){this.state.setState("move-over"),this.node.position=f(this.node.position.x,30,this.node.position.z);var s=this.checkDownPos();if(v(s)){console.log("end pos",s),this.node.position=f(s.x,30,s.z),this.rootNode.scale=f(1,-1,1);var a=new b(this.node);a.to(.6,{position:s}),a.call((function(){t.showBaozhaEffect()})),a.start()}else this.node.destroy()}}else{var r=this.node.position,l=this.currentDirection.normalize().multiplyScalar(this.moveSpeed*e);l.y<0&&(l.y=0),this.node.setPosition(f(r.x+l.x,r.y+l.y,r.z+l.z)),this.node.getPosition().y<=0&&this.isCollisionGround&&(this.currentInitSpeedY+=this.currentCostAcc,this.currentInitSpeedY<0&&this.state.setState("sleep"))}}},{key:"checkDownPos",value:function(){var e=w.getInstance().getGameCtlNode().getComponent(N).getCurrentEnemyNodeList();if(0!==e.length){for(var t=[],o=0;o<e.length;o++){var i=e[o];if(v(i)&&!i.getComponent(E).getIsDead()){for(var n=[],s=0;s<e.length;s++){var a=e[s];if(i.uuid!==a.uuid&&!a.getComponent(E).getIsDead()){var r=f(i.position).subtract(a.position).length();n.push(r)}}n=(n=n.sort((function(e,t){return e-t}))).slice(0,Math.min(3,n.length));for(var l=0,c=0;c<n.length;c++)l+=n[c];t.push({node:i,dis:l})}}return(t=t.sort((function(e,t){return e.dis-t.dis}))).length>0&&v(t[0].node)?t[0].node.position:null}this.node.destroy()}},{key:"showBaozhaEffect",value:function(){var e=this,t=S(this.exporeEffectPrefab);t.position=this.node.position,t.parent=this.node.parent,w.getInstance().getGameCtlNode().emit("play-audio",this.boomAudio);var o=new b(t);o.by(.3,{scale:f(5,5,5)}),o.call((function(){e.rangeAttackEnemy(t),t.destroy()})),o.start()}},{key:"rangeAttackEnemy",value:function(e){for(var t=this,o=w.getInstance().getGameCtlNode().getComponent(N).getCurrentEnemyNodeList(),i=function(e){console.log("攻击敌人"),e.emit("be-attacked",{baseAttackNum:t.getCurrentAttackNum(),baseGasNum:0,cb:function(e,o){console.log("被打死了的 回调",v(t.targetTowerBase)),t.targetTowerBase&&t.targetTowerBase.enemyDeadByThis(e,o)}})},n=0;n<o.length;n++){var s=o[n],a=f(s.position).subtract(e.position).length();a<10&&(console.log("dis",a),i(s))}this.node.destroy()}}]),t}(C)).prototype,"exporeEffectPrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(I.prototype,"daodanweijiPrefab",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(I.prototype,"baozhaEffectPrefab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=I))||D)),u._RF.pop()}}}));

System.register("chunks:///ChooseWeaponInfoRateCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js"],(function(t,e){var r,o,i,n,a,s,u,c,l,p,d,h,f,v,y,m,C,g,_,b,S,B,I,R,w,P,x,L,k,z,F;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(t){r=t.applyDecoratedDescriptor,o=t.inherits,i=t.classCallCheck,n=t.possibleConstructorReturn,a=t.getPrototypeOf,s=t.initializerDefineProperty,u=t.assertThisInitialized,c=t.createClass},function(t){l=t.cclegacy,p=t._decorator,d=t.Node,h=t.SpriteFrame,f=t.v2,v=t.v3,y=t.find,m=t.Tween,C=t.Component},function(t){g=t.State}],execute:function(){l._RF.push({},"6601aZ3NHFPo42l2cZ4+0Lq","ChooseWeaponInfoRateCtl",void 0),z=p.ccclass,F=p.property,t("ChooseWeaponInfoRateCtl",(_=z("ChooseWeaponInfoRateCtl"),b=F({type:d}),S=F({type:h}),B=F({type:h}),I=F({type:d}),_((P=r((w=function(t){function e(){var t,r;i(this,e);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return r=n(this,(t=a(e)).call.apply(t,[this].concat(c))),s(r,"rateButtonList",P,u(r)),s(r,"rateButtonSpriteFrameLight",x,u(r)),s(r,"rateButtonSpriteFrameGray",L,u(r)),s(r,"rateButtonParentNode",k,u(r)),r.currentRateIndex=0,r.state=new g,r}return o(e,t),c(e,[{key:"start",value:function(){for(var t=this,e=0;e<this.rateButtonList.length;e++){var r=this.rateButtonList[e],o=f(0,1).rotate(2*Math.PI*1/3*e-2*Math.PI*270/360).normalize().multiplyScalar(80);r.position=v(o.x,o.y,0)}this.state.addState("wait",(function(){console.log("current rate index",t.currentRateIndex),t.node.emit("refer-choose-rate-cost",t.getCurrentChooseRate())})),this.state.setState("wait")}},{key:"onButtonClick",value:function(t,e){var r=this;if(y("GameController").emit("player-button-click-audio"),e.indexOf("rate")>-1){if(console.log("旋转按钮"),"wait"!==this.state.getState())return;this.currentRateIndex++;var o=this.currentRateIndex%3*120;this.state.setState("move");for(var i=[],n=0;n<this.rateButtonList.length;n++){var a=this.rateButtonList[n],s=f(0,1).rotate(2*Math.PI*1/3*n-2*Math.PI*(270+o)/360).normalize().multiplyScalar(80);i.push(this.moveToAction(a,s))}Promise.all(i).then((function(){r.state.setState("wait")}))}}},{key:"moveToAction",value:function(t,e){return new Promise((function(r,o){var i=new m(t);i.to(.2,{position:v(e.x,e.y,0)}),i.call((function(){r()})),i.start()}))}},{key:"getCurrentChooseRate",value:function(){return[1,10,100][this.currentRateIndex%3]}}]),e}(C)).prototype,"rateButtonList",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=r(w.prototype,"rateButtonSpriteFrameLight",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=r(w.prototype,"rateButtonSpriteFrameGray",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=r(w.prototype,"rateButtonParentNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=w))||R)),l._RF.pop()}}}));

System.register("chunks:///Effect/WinGoldAnimEffect.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js"],(function(t,e){var n,o,i,a,l,s,c,r,u,d,f,p,m,h,v,C;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){n=t.inherits,o=t.classCallCheck,i=t.possibleConstructorReturn,a=t.getPrototypeOf,l=t.createClass},function(t){s=t.cclegacy,c=t._decorator,r=t.SkeletalAnimationComponent,u=t.v3,d=t.find,f=t.Tween,p=t.Component},function(t){m=t.GameInstance}],execute:function(){s._RF.push({},"2ee3e+XrHFJlYuGFP9mqdRS","WinGoldAnimEffect",void 0),C=c.ccclass,c.property,t("WinGoldAnimEffect",(h=C("WinGoldAnimEffect"),h(v=function(t){function e(){var t,n;o(this,e);for(var l=arguments.length,s=new Array(l),c=0;c<l;c++)s[c]=arguments[c];return(n=i(this,(t=a(e)).call.apply(t,[this].concat(s)))).goldCount=0,n.skelete=null,n}return n(e,t),l(e,[{key:"start",value:function(){var t=this.node.getComponent(r);if(this.skelete=t,t){var e=t.defaultClip;t.getState(e.name).repeatCount=1,t.play(e.name)}}},{key:"setGoldCount",value:function(t,e){var n=this,o=u(this.node.position).subtract(u(-25,10,0)).length()/50;this.goldCount=t,d("GameController").emit("play-audio","金币掉落1");var i=new f(this.node);i.delay(3),i.to(o,{position:u(-25,10,0)}),i.call((function(){m.getInstance().addGoldCount(t),n.node.destroy()})),i.start()}}]),e}(p))||v)),s._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyColonyCom.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/BezierN.js","./EnemyBase.js"],(function(t,e){var i,r,o,s,n,a,h,u,c,l;return{setters:[function(t){i=t.createClass,r=t.classCallCheck},function(t){o=t.cclegacy,s=t._decorator,n=t.Vec3,a=t.v3,h=t.Quat,u=t.Tween},function(t){c=t.BezierN},function(t){l=t.EnemyBase}],execute:function(){o._RF.push({},"dd328sjHD1OM4+6gaUYeHWb","EnemyColonyCom",void 0),s.ccclass,s.property,t("EnemyColonyCom",function(){function t(e,i,o){r(this,t),this.currentCheckDuraction=0,this.currentMoveDir=new n(Math.random()-.5,Math.random()-.5,Math.random()-.5),this.targetNode=null,this.currentNodeList=[],this.isFirstTargetNode=!1,this.movePathList=null,this.currentMoveTw=null,this.fenliForceWeight=10,this.juheliForceWeight=1,this.duilieliWeight=1,this.floowerfirstNodeWeight=5,this.fenliDistance=4,this.juheDistance=6,this.duilieDistance=60,this.currentPathListIndex=0,this.movePathList=new c(o).getPointList(200),this.targetNode=i,this.currentNodeList=e}return i(t,[{key:"update",value:function(t){if(!this.isFirstTargetNode){var e=this.processCheckDir().normalize();this.currentMoveDir=a(this.currentMoveDir).add(e.multiplyScalar(t)),this.targetNode.position=a(this.targetNode.position).add(a(this.currentMoveDir).multiplyScalar(t));var i=new h;h.fromViewUp(i,a(this.currentMoveDir).normalize().multiplyScalar(-1),n.UP);var r=new h;h.lerp(r,new h(this.targetNode.rotation),i,t),this.targetNode.rotation=r}}},{key:"processLisanForce",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.uuid!==this.targetNode.uuid&&i.getComponent(l).getColonyComCtl())a(i.position).subtract(this.targetNode.position).length()<this.fenliDistance&&t.push(i)}if(t.length>0){for(var r=a(0,0,0),o=0;o<t.length;o++){var s=t[o].position,n=a(this.targetNode.position).subtract(s);r.add(n)}return r.multiplyScalar(this.fenliForceWeight),r}return a(0,0,0)}},{key:"processJuHeForce",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.getComponent(l).getColonyComCtl())a(i.position).subtract(this.targetNode.position).length()>this.juheDistance&&t.push(i)}for(var r=a(0,0,0),o=0;o<t.length;o++){var s=t[o].position;r.add(s)}return t.length>0?(r=r.multiplyScalar(1/t.length),a(r).subtract(this.targetNode.position).multiplyScalar(this.juheliForceWeight)):a(0,0,0)}},{key:"processDuiLieForce",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.getComponent(l).getColonyComCtl())a(i.position).subtract(this.targetNode.position).length()<=this.duilieDistance&&t.push(i)}var r=a(0,0,0);if(t.length>0){for(var o=0;o<t.length;o++){var s=t[o].getComponent(l);r.add(s.getColonyComCtl().getCurrentMoveDir())}return r.multiplyScalar(this.duilieliWeight*(1/t.length))}return a(0,0,0)}},{key:"processCheckDir",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.getComponent(l).getColonyComCtl()&&(t.push(i),1===t.length)){if(t[0].uuid===this.targetNode.uuid)return this.isFirstTargetNode=!0,this.processMoveTween(),a(0,0,0);break}}var r=this.processByFirstNodeForce(t[0]),o=this.processLisanForce(),s=this.processDuiLieForce(),n=this.processJuHeForce();return o.add(s).add(n).add(r)}},{key:"processByFirstNodeForce",value:function(t){return a(t.position).subtract(this.targetNode.position).multiplyScalar(this.floowerfirstNodeWeight)}},{key:"processMoveTween",value:function(){var t=new u(this.targetNode);this.currentMoveTw=t,t.set({position:this.movePathList[0]});for(var e=function(t,e,i){var r=a(i).subtract(e).length(),o=a(e).subtract(i).normalize(),s=new h;h.fromViewUp(s,o,n.UP),t.to(r/5,{position:e,rotation:s})},i=1;i<this.movePathList.length-1;i++){e(t,this.movePathList[i],this.movePathList[i+1])}new u(this.targetNode).repeatForever(t).start()}},{key:"processPathListDir",value:function(){}},{key:"getCurrentMoveDir",value:function(){return this.currentMoveDir}}]),t}()),o._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyCube.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./EnemyBase.js"],(function(e,n){var t,s,c,r,u,i,o,a,l,p;return e({_dec:void 0,_class:void 0}),{setters:[function(e){t=e.inherits,s=e.classCallCheck,c=e.possibleConstructorReturn,r=e.getPrototypeOf},function(e){u=e.cclegacy,i=e._decorator},function(e){o=e.EnemyBase}],execute:function(){u._RF.push({},"ac439Ca0GFJGrdHaYw+IQip","EnemyCube",void 0),p=i.ccclass,i.property,e("EnemyCube",(a=p("EnemCube"),a(l=function(e){function n(){return s(this,n),c(this,r(n).apply(this,arguments))}return t(n,e),n}(o))||l)),u._RF.pop()}}}));

System.register("chunks:///Enemys/WinGold.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,o,s,c,r,i,l,u,a,p,d;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,o=t.createClass,s=t.classCallCheck,c=t.possibleConstructorReturn,r=t.getPrototypeOf},function(t){i=t.cclegacy,l=t._decorator,u=t.Component}],execute:function(){i._RF.push({},"cf9deP2StlNm75zKMIn6aZo","WinGold",void 0),d=l.ccclass,l.property,t("WinGold",(a=d("WinGold"),a(p=function(t){function e(){return s(this,e),c(this,r(e).apply(this,arguments))}return n(e,t),o(e,[{key:"start",value:function(){}}]),e}(u))||p)),i._RF.pop()}}}));

System.register("chunks:///TowerBuildBase/TowerBuildBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,o){var t,r,i,n,l,a,s,u,d,c,h,f,m,p,g,y,w,v,C,B,b,T,k;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inherits,i=e.classCallCheck,n=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,c=e._decorator,h=e.Node,f=e.find,m=e.CameraComponent,p=e.SkeletalAnimationComponent,g=e.isValid,y=e.Component}],execute:function(){d._RF.push({},"bf2b5yrz6pN7ZEPmB5V4xlb","TowerBuildBase",void 0),T=c.ccclass,k=c.property,e("TowerBuildBase",(w=T("TowerBuildBase"),v=k({type:h}),w((b=t((B=function(e){function o(){var e,t;i(this,o);for(var r=arguments.length,u=new Array(r),d=0;d<r;d++)u[d]=arguments[d];return(t=n(this,(e=l(o)).call.apply(e,[this].concat(u)))).cameraNodeCom=null,t.gameController=null,t.targetTower=null,a(t,"arrowGuide",b,s(t)),t}return r(o,e),u(o,[{key:"onLoad",value:function(){}},{key:"start",value:function(){this.gameController=f("GameController"),this.cameraNodeCom=f("Camera").getComponent(m),this.gameController.on("touch-screen-to-3d",this.touchScreenTo3d.bind(this),this),this.gameController.on("destroy-all-tower-build-base",this.destroyTowerBuildBase.bind(this),this),this.gameController.on("frozen-tower-build-base",this.forzenTowerBuildBase.bind(this),this)}},{key:"forzenTowerBuildBase",value:function(){var e=this.arrowGuide.getComponent(p),o=e.defaultClip;e.getState(o.name).pause()}},{key:"touchScreenTo3d",value:function(e){if(!g(this.targetTower))for(var o=0;o<e.length;o++){var t=e[o];t.collider.node&&t.collider.node.uuid===this.node.uuid&&(console.log("点中了此塔的基座"),this.gameController.emit("touch-base-build-base",this.node),this.gameController.emit("player-button-click-audio-2"))}}},{key:"onDestroy",value:function(){this.gameController.off("destroy-all-tower-build-base",this.destroyTowerBuildBase,this),this.gameController.off("touch-screen-to-3d",this.touchScreenTo3d,this),this.gameController.off("frozen-tower-build-base",this.forzenTowerBuildBase,this)}},{key:"destroyTowerBuildBase",value:function(){this.node.destroy()}},{key:"unSetTargetTower",value:function(e){this.targetTower=void 0,this.node.active=!0}},{key:"setTargetTower",value:function(e){this.targetTower=e,this.node.active=!1}}]),o}(y)).prototype,"arrowGuide",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=B))||C)),d._RF.pop()}}}));

System.register("chunks:///TowerBuildBaseCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./GameInstance.js","./GroundMapCtl.js"],(function(e,t){var n,i,o,r,s,a,l,u,c,d,p,f,g,v,h,w,B,m,y,C,b,T,_,P,z,A,j,N;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,i=e.inherits,o=e.classCallCheck,r=e.possibleConstructorReturn,s=e.getPrototypeOf,a=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,d=e._decorator,p=e.Prefab,f=e.JsonAsset,g=e.v2,v=e.instantiate,h=e.v3,w=e.Tween,B=e.Component},function(e){m=e.GameInstance},function(e){y=e.GroundMapCtl}],execute:function(){c._RF.push({},"09d8fCuijNMwIzg+sejpSkn","TowerBuildBaseCtl",void 0),j=d.ccclass,N=d.property,e("TowerBuildBaseCtl",(C=j("TowerBuildBaseCtl"),b=N({type:p}),T=N({type:f}),C((z=n((P=function(e){function t(){var e,n;o(this,t);for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return n=r(this,(e=s(t)).call.apply(e,[this].concat(u))),a(n,"towerBuildBasePrefab",z,l(n)),a(n,"gameConfigJsonAsset",A,l(n)),n.groundTiledNodeList=null,n}return i(t,e),u(t,[{key:"showTowerBuildBaseEnterAnim",value:function(){var e=m.getInstance().getPlayerData().currentLevelNum,t=this.gameConfigJsonAsset.json["Level_"+e].TowerBuildPos;this.groundTiledNodeList=this.node.getComponent(y).getMapNodeList();for(var n=[],i=0;i<t.length;i++){var o=t[i],r=g(o[0],o[1]),s=this.groundTiledNodeList.getValue(r.x,r.y),a=v(this.towerBuildBasePrefab);a.parent=this.node,a.position=h(s.position.x,20,s.position.z),this.node.getComponent(y).setTowerBuildBaseOnTiled(a,r.x,r.y),n.push(this.showEnterAnim(a,i))}return Promise.all(n)}},{key:"showEnterAnim",value:function(e,t){return e.active=!1,new Promise((function(n,i){var o=new w(e),r=e.position;o.delay(.2*t),o.call((function(){e.active=!0})),o.to(.5,{position:h(r.x,0,r.z)},{easing:"bounceOut"}),o.call((function(){m.getInstance().getGameCtlNode().emit("play-audio","drop"),n()})),o.start()}))}},{key:"frozenAllTowerBuildBase",value:function(){this.node.emit("frozen-tower-build-base")}}]),t}(B)).prototype,"towerBuildBasePrefab",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(P.prototype,"gameConfigJsonAsset",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=P))||_)),c._RF.pop()}}}));

System.register("chunks:///Towers/TowerBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","../BaseObject.js","../util/State.js","../Enemys/EnemyBase.js","../EnemyController.js","../BulletBase.js","../TowerBuildBase/TowerBuildBase.js"],(function(e,t){var n,o,i,r,a,s,l,u,c,d,g,h,f,m,p,y,v,k,T,w,C,A,B,b,S,N,E,I,R,P,D,O,z,G,_,x,L,j,M,F,U,V,H,Q;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass,c=e.get},function(e){d=e.cclegacy,g=e._decorator,h=e.Prefab,f=e.Node,m=e.CCFloat,p=e.v3,y=e.SkeletalAnimationComponent,v=e.isValid,k=e.Tween,T=e.instantiate,w=e.Vec3,C=e.v2,A=e.Quat},function(e){B=e.GameInstance},function(e){b=e.BaseObject},function(e){S=e.State},function(e){N=e.EnemyBase},function(e){E=e.EnemyController},function(e){I=e.BulletBase},function(e){R=e.TowerBuildBase}],execute:function(){d._RF.push({},"93965WLO/1GpoRxL0uoTS9a","TowerBase",void 0),H=g.ccclass,Q=g.property,e("TowerBase",(P=H("TowerBase"),D=Q({type:h}),O=Q({type:f}),z=Q({type:f}),G=Q({type:m}),_=Q({type:f}),P((j=n((L=function(e){function t(){var e,n;i(this,t);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return(n=r(this,(e=a(t)).call.apply(e,[this].concat(u)))).state=new S,n.currentTargetEnemy=null,n.currentShootTime=0,s(n,"bulletPrefab",j,l(n)),s(n,"bulletStartPosList",M,l(n)),s(n,"weaponBaseNode",F,l(n)),n.currentShootDiraction=p(0,0,0),n.gameConfig=null,s(n,"attackAnimEventTimeOffset",U,l(n)),n.towerBuildBase=null,s(n,"attackRangeNode",V,l(n)),n.currentShootBulletIndex=0,n.isShooting=!1,n}return o(t,e),u(t,[{key:"init",value:function(e){c(a(t.prototype),"init",this).call(this,e),this.gameConfig=e,console.log("tower base init"),this.node.emit("init",e)}},{key:"start",value:function(){var e=this;console.log("tower base start"),this.state.setState("run"),B.getInstance().getGameCtlNode().on("touch-screen-to-3d",this.touchScreenTo3d.bind(this),this),B.getInstance().getGameCtlNode().on("destroy-all-tower",this.destroyAllTower.bind(this),this),this.state.addState("releas-skill",(function(){e.currentTargetEnemy&&(e.currentTargetEnemy=null),e.node.emit("release-skill",(function(){e.state.setState("run")}))})),this.state.addState("destroy",(function(){var t=e.rootNode.getComponent(y),n=p(2*Math.random(),0,2*Math.random());if(t){var o=t.getState("骨架|todestroy");o?(o.repeatCount=1,t.play("骨架|todestroy"),e.scheduleOnce((function(){e.towerBuildBase&&e.towerBuildBase.getComponent(R).unSetTargetTower(e.node),B.getInstance().getGameCtlNode().emit("show-add-gold-anim-effect",e.getDestroyCount(),p(e.node.position.x,0,e.node.position.z).add(n)),e.node.destroy()}),o.length)):(e.node.destroy(),e.towerBuildBase&&(e.towerBuildBase.getComponent(R).unSetTargetTower(e.node),B.getInstance().getGameCtlNode().emit("show-add-gold-anim-effect",e.getDestroyCount(),p(e.node.position.x,0,e.node.position.z).add(n))))}else e.node.destroy(),e.towerBuildBase&&(e.towerBuildBase.getComponent(R).unSetTargetTower(e.node),B.getInstance().getGameCtlNode().emit("show-add-gold-anim-effect",e.getDestroyCount(),p(e.node.position.x,0,e.node.position.z).add(n)))}))}},{key:"destroyAllTower",value:function(){this.node.destroy()}},{key:"touchScreenTo3d",value:function(e){if(console.log("射线检测到了 tower"),"run"===this.state.getState())for(var t=0;t<e.length;t++){if(e[t].collider.node.uuid===this.node.uuid){B.getInstance().getGameCtlNode().emit("touch-tower",this.node);break}}}},{key:"onDestroy",value:function(){console.log("销毁"),B.getInstance().getGameCtlNode().off("touch-screen-to-3d",this.touchScreenTo3d,this),B.getInstance().getGameCtlNode().off("destroy-all-tower",this.destroyAllTower,this)}},{key:"toDestroy",value:function(){this.state.setState("destroy")}},{key:"update",value:function(e){var t=this;if("run"===this.state.getState()){var n=this.getAttackType();if("normal"===n){var o=this.findSingleEnemy(e);if(v(o)){if(this.isShooting)return;this.isShooting=!0,this.shootOneBullet(this.getCurrentAttackRate(),this.currentShootDiraction,this.getCurrentAttackNum()).then((function(){t.scheduleOnce((function(){t.isShooting=!1}),t.shootDuraction)}))}}else if("Range"===n){var i=this.findRangeEnemy(e);if(v(i)){if(this.isShooting)return;this.isShooting=!0,this.playOneTimeAttackAnim().then((function(){return t.createOneGuideMissile()})).then((function(){t.scheduleOnce((function(){t.isShooting=!1}),t.shootDuraction)}))}}else if("Auto"===n){var r=this.findSingleEnemy(e);if(v(r)){if(v(this.rootNode)&&(this.rootNode.lookAt(this.currentTargetEnemy.position),this.rootNode.eulerAngles.x<0&&(this.rootNode.eulerAngles=p(0,this.rootNode.eulerAngles.y,this.rootNode.eulerAngles.z))),this.weaponBaseNode&&(this.weaponBaseNode.lookAt(this.currentTargetEnemy.position),this.weaponBaseNode.eulerAngles=p(0,this.weaponBaseNode.eulerAngles.y,this.rootNode.eulerAngles.z)),this.isShooting)return;this.isShooting=!0;var a=this.rootNode.getComponent(y),s=a.getState("骨架|AttackAnim"),l=new k(this.node);l.delay(.1),l.call((function(){a.play("骨架|AttackAnim")})),B.getInstance().getGameCtlNode().emit("play-audio",this.shootAudio);for(var u=function(e){e.call((function(){var e=p(t.currentShootDiraction);v(t.currentTargetEnemy)&&!t.currentTargetEnemy.getComponent(N).getIsDead()&&t.createOneTimeBullet(e).then((function(){}))})),e.delay(.1)},c=0;c<10;c++)u(l);l.call((function(){s.stop()})),l.delay(this.shootDuraction),l.call((function(){t.isShooting=!1})),l.start()}}}}},{key:"playOneTimeAttackAnim",value:function(){var e=this;return new Promise((function(t,n){var o=e.rootNode.getComponent(y),i=o.getState("骨架|AttackAnim");i.repeatCount=1,o.play("骨架|AttackAnim");var r=i.length;console.log("length",r),i.speed=1,e.readyAduio&&B.getInstance().getGameCtlNode().emit("play-audio",e.readyAduio);var a=new k(e.node);a.delay(r*e.attackAnimEventTimeOffset),a.call((function(){t()})),a.delay(r*(1-e.attackAnimEventTimeOffset)),a.call((function(){})),a.start()}))}},{key:"findRangeEnemy",value:function(e){if(null!==this.currentTargetEnemy)return v(this.currentTargetEnemy)&&!this.currentTargetEnemy.getComponent(N).getIsDead()?this.currentTargetEnemy:(this.currentTargetEnemy=null,null);for(var t=B.getInstance().getGameCtlNode().getComponent(E).getCurrentEnemyNodeList(),n=0;n<t.length;n++){var o=t[n];if(v(o)&&this.getCanAttackEnemy(o)&&o.getComponent(N).getIsCanLock()&&!o.getComponent(N).getIsDead())if(p(this.node.position).subtract(o.position).length()<this.getCurrentAttackRange())return this.currentTargetEnemy=o,o}}},{key:"createOneGuideMissile",value:function(){var e=this;return new Promise((function(t,n){console.log("创建一枚导弹");var o=e.bulletStartPosList[0],i=new k(o),r=p(o.position);i.by(.4,{position:p(0,4,0)}),i.call((function(){o.active=!1;var t=T(e.bulletPrefab);t.parent=e.node.parent,t.position=o.worldPosition,t.getComponent(I).init(e.gameConfig,{baseAttackNum:e.getCurrentAttackNum(),targetTower:e}),B.getInstance().getGameCtlNode().emit("play-audio",e.shootAudio)})),i.delay(.8),i.call((function(){o.position=r,o.active=!0,t()})),i.start()}))}},{key:"findSingleEnemy",value:function(e){if(null===this.currentTargetEnemy){for(var t=B.getInstance().getGameCtlNode().getComponent(E).getCurrentEnemyNodeList(),n=1e4,o=void 0,i=0;i<t.length;i++){var r=t[i];if(v(r)&&r.getComponent(N).getIsCanLock()&&!r.getComponent(N).getIsDead()&&this.getCanAttackEnemy(r)){var a=new w(r.position).subtract(this.node.position).length();a<n&&(n=a,o=r)}}if(o)C(o.position.x,o.position.z).subtract(C(this.node.position.x,this.node.position.z)).length()<this.getCurrentAttackRange()&&(this.currentTargetEnemy=o)}if(v(this.currentTargetEnemy))if("normal"===this.getAttackType()&&this.rootNode&&(this.rootNode.lookAt(this.currentTargetEnemy.position),this.rootNode.eulerAngles.x<0&&(this.rootNode.eulerAngles=p(0,this.rootNode.eulerAngles.y,this.rootNode.eulerAngles.z))),this.currentTargetEnemy.getComponent(N)&&this.currentTargetEnemy.getComponent(N).getIsDead())this.currentTargetEnemy=null;else if(this.currentShootDiraction=p(this.currentTargetEnemy.position).subtract(p(this.node.position)),"normal"===this.getAttackType()){var s=new A,l=p(this.currentShootDiraction.x,0,this.currentShootDiraction.z).normalize();A.fromViewUp(s,l,w.UP);var u=new A;A.lerp(u,this.node.rotation,s,.2),this.node.rotation=s}if(v(this.currentTargetEnemy)){if(C(this.currentTargetEnemy.position.x,this.currentTargetEnemy.position.z).subtract(C(this.node.position.x,this.node.position.z)).length()>this.getCurrentAttackRange())return this.currentTargetEnemy=null,null}else this.currentTargetEnemy=null;return this.currentTargetEnemy}},{key:"getCurrentAttackRate",value:function(){return this.baseAttackRate}},{key:"shootOneBullet",value:function(e,t,n){var o=this;return new Promise((function(e,n){var i=[];o.rootNode&&i.push(o.rootNode),o.weaponBaseNode&&i.push(o.weaponBaseNode);var r=!1;if(o.getBulletRecoverTime()>0)for(var a=0;a<o.bulletStartPosList.length;a++){if(o.bulletStartPosList[a].active){r=!0;break}}else r=!0;if(r){for(var s=0,l=0;l<i.length;l++){var u=i[l].getComponent(y);if(u){var c=u.getState("骨架|AttackAnim");u.play("骨架|AttackAnim"),c.repeatCount=1;var d=(o.getAttackSpeedLevel()+10)/10;c.speed=d,s=c.length*(1/d)}}console.log("shoot one bullet length",s),o.scheduleOnce((function(){B.getInstance().getGameCtlNode().emit("play-audio",o.shootAudio),o.createOneTimeBullet(t).then((function(){e()}))}),s*o.attackAnimEventTimeOffset)}else e()}))}},{key:"createOneTimeBullet",value:function(e){var t=this;return console.log("创建一枚导弹"),new Promise((function(n,o){n();for(var i=function(n){var o=t.bulletStartPosList[n];if(o.active){var i=T(t.bulletPrefab);if(i.parent=t.node.parent,i.active=!1,i.setPosition(o.worldPosition),i.active=!0,i.getComponent(I).init(t.gameConfig,{direction:e,targetEnemy:t.currentTargetEnemy,baseAttackNum:t.getCurrentAttackNum(),targetTower:t}),t.getIsNeedRecoverBullet()){o.active=!1,t.currentShootBulletIndex++,t.currentShootBulletIndex===t.bulletStartPosList.length&&(t.currentShootBulletIndex=0);var r=p(o.position),a=new k(o),s=p(o.position).subtract(p(0,.3,-.3));return"Range"===t.getAttackType()&&(s=p(o.position).subtract(p(0,-1,0))),a.set({position:s}),a.delay(t.getBulletRecoverTime()),a.call((function(){o.active=!0})),a.to(.2,{position:r}),a.start(),"break"}}},r=t.currentShootBulletIndex;r<t.bulletStartPosList.length;r++){if("break"===i(r))break}}))}},{key:"enemyDeadByThis",value:function(e,t){console.log("敌人被此塔打死了"),e&&B.getInstance().getUICtlNode().emit("show-add-power-anim-effect",t,this.node.position)}},{key:"releaseSkill",value:function(){console.log("release skill",this.objectType),this.state.setState("releas-skill")}},{key:"setTowerBuildBase",value:function(e){this.towerBuildBase=e}},{key:"updateLevel",value:function(){c(a(t.prototype),"updateLevel",this).call(this)}},{key:"showAttackRange",value:function(){var e=this.getCurrentAttackRange();console.log("attack range",e),this.attackRangeNode.active=!0;var t=new k(this.attackRangeNode);t.to(.1,{scale:p(2*e,2*e,2*e)}),t.start()}},{key:"closeAttackRange",value:function(){var e=this,t=new k(this.attackRangeNode);t.to(.1,{scale:p(1,1,1)}),t.call((function(){e.attackRangeNode.active=!1})),t.start()}}]),t}(b)).prototype,"bulletPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(L.prototype,"bulletStartPosList",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=n(L.prototype,"weaponBaseNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=n(L.prototype,"attackAnimEventTimeOffset",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),V=n(L.prototype,"attackRangeNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=L))||x)),d._RF.pop()}}}));

System.register("chunks:///Home/HomeIcon.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js"],(function(e,t){var o,r,n,i,s,a,c,u,l,d,p,f,v,h,y,H,m,_,g,I,S;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,s=e.getPrototypeOf,a=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){l=e.cclegacy,d=e._decorator,p=e.Node,f=e.v3,v=e.Component},function(e){h=e.State}],execute:function(){l._RF.push({},"8213do7DSVI0IEO26O7s126","HomeIcon",void 0),I=d.ccclass,S=d.property,e("HomeIcon",(y=I("HomeIcon"),H=S({type:p}),y((g=o((_=function(e){function t(){var e,o;n(this,t);for(var r=arguments.length,u=new Array(r),l=0;l<r;l++)u[l]=arguments[l];return o=i(this,(e=s(t)).call.apply(e,[this].concat(u))),a(o,"redHeartNode",g,c(o)),o.state=new h,o}return r(t,e),u(t,[{key:"start",value:function(){this.state.setState("run")}},{key:"frozenHomeIcon",value:function(){this.state.setState("frozen")}},{key:"freeHomeIconn",value:function(){this.state.setState("run")}},{key:"update",value:function(e){"run"===this.state.getState()&&(this.redHeartNode.eulerAngles=this.redHeartNode.eulerAngles.add(f(0,1,0)))}}]),t}(v)).prototype,"redHeartNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=_))||m)),l._RF.pop()}}}));

System.register("chunks:///GameController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/AdsController.js","./GameInstance.js","./util/State.js","./GroundMapCtl.js","./EnemyController.js","./Effect/WinGoldAnimEffect.js","./TowerBuildBase/TowerBuildBase.js","./TowerBuildBaseCtl.js","./Towers/TowerBase.js","./Home/HomeIcon.js"],(function(e,t){var n,o,a,i,r,s,l,u,c,d,m,g,f,h,p,y,C,v,I,w,b,B,N,P,G,S,k,A,_,U,H,L,T,E,z,D,j,R,x,J,O,F,M,W,V,Y,q,X,K,Q,Z,$,ee;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_class3:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,a=e.classCallCheck,i=e.possibleConstructorReturn,r=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,d=e._decorator,m=e.Node,g=e.JsonAsset,f=e.Prefab,h=e.Tween,p=e.v3,y=e.PhysicsSystem,C=e.instantiate,v=e.isValid,I=e.SkeletalAnimationComponent,w=e.Component},function(e){b=e.AdsController},function(e){B=e.GameInstance},function(e){N=e.State},function(e){P=e.GroundMapCtl},function(e){G=e.EnemyController},function(e){S=e.WinGoldAnimEffect},function(e){k=e.TowerBuildBase},function(e){A=e.TowerBuildBaseCtl},function(e){_=e.TowerBase},function(e){U=e.HomeIcon}],execute:function(){c._RF.push({},"5b4c0ApYS1B3bhehBCF/cvX","GameController",void 0),$=d.ccclass,ee=d.property,e("GameController",(H=$("GameController"),L=ee({type:m}),T=ee({type:g}),E=ee({type:f}),z=ee({type:m}),D=ee({type:m}),j=ee({type:m}),R=ee({type:f}),x=ee({type:f}),H((Z=Q=function(e){function t(){var e,n;a(this,t);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return n=i(this,(e=r(t)).call.apply(e,[this].concat(u))),s(n,"enemyHealthBarCtlNode",F,l(n)),s(n,"gameConfigJson",M,l(n)),s(n,"towersPrefabList",W,l(n)),s(n,"startGameButton",V,l(n)),n.state=new N,s(n,"plate",Y,l(n)),s(n,"gameStartButtonBase",q,l(n)),s(n,"homeIconPrefab",X,l(n)),n.homeIconNode=null,s(n,"goldAnim3dPrefab",K,l(n)),n.homeIconTw=null,n.adsCtl=new b,n}return o(t,e),u(t,[{key:"onLoad",value:function(){B.getInstance().setGameCtlNode(this.node,this.gameConfigJson.json);var e=new h(this.plate);e.repeatForever(new h(this.plate).to(20,{eulerAngles:p(0,360,0)}).set({eulerAngles:p(0,0,0)})),e.start(),this.node.on("show-game-win-layer",this.gameWin.bind(this)),this.node.on("player-click-next-level-button",this.enterNextLevel.bind(this)),this.node.on("enter-next-level",this.enterNextLevel.bind(this)),this.node.on("retry-game",this.playerClickRetryButton.bind(this)),this.node.on("player-click-save-life-button",this.playerClickSaveLifeButton.bind(this)),this.node.on("enemy-to-attacked",this.enemyAttacked.bind(this)),this.node.on("show-add-gold-anim-effect",this.showAddGoldAnimEffect.bind(this))}},{key:"playerClickSaveLifeButton",value:function(e){var t=this;this.node.emit("destroy-all-enemy",(function(e){t.showHomeIconEnterAnim().then((function(){B.getInstance().getPlayerData().recoverRedHeartCount(),B.getInstance().getUICtlNode().emit("refer-red-heart-label"),t.state.setState("run"),t.node.getComponent(G).continueGame()}))}))}},{key:"playerClickShareButton",value:function(e){var t=this;return new Promise((function(n,o){t.adsCtl.shareTo().then((function(){B.getInstance().addPowerCount(e),n()}))}))}},{key:"playerClickRetryButton",value:function(){var e=this;this.enterGame().then((function(){B.getInstance().getUICtlNode().emit("refer-red-heart-label"),e.node.emit("update-gold-label",B.getInstance().getPlayerData().getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(G).startGame()}))}},{key:"start",value:function(){var e=this;y.instance.enable=!0,this.state.addState("ready",(function(){console.log("enter state ",e.state.getState())})),this.state.setState("ready"),this.node.on("build-one-tower",(function(t,n){if(B.getInstance().getUICtlNode().emit("complete-current-guide"),t<e.towersPrefabList.length){var o=C(e.towersPrefabList[t]);o.parent=e.node,o.getComponent(_).init(e.gameConfigJson.json);var a=p(n.position.x,0,n.position.z);o.setPosition(a),n.getComponent(k).setTargetTower(o),o.getComponent(_).setTowerBuildBase(n)}})),this.state.addState("play-start-button-anim",(function(){B.getInstance().getUICtlNode().emit("complete-current-guide"),e.node.emit("play-audio","按钮音效"),e.node.emit("play-bg-music"),e.playStatrButtonPressAnim().then((function(){return new Promise((function(t,n){new h(e.startGameButton).by(1,{position:p(0,-10,0)}).call((function(){console.log("play over"),e.startGameButton.destroy(),t()})).start()}))})).then((function(){var t=new h(e.gameStartButtonBase);return t.to(.2,{scale:p(0,0,0)}),t.call((function(){e.gameStartButtonBase.destroy()})),t.start(),e.node.getComponent(P).showGroundEnterAnim()})).then((function(){return e.enterGame()})).then((function(){return e.showUIEnterAnim()})).then((function(){e.state.setState("run"),e.node.getComponent(G).startGame(),B.getInstance().newGame()}))})),this.state.addState("game-loss",(function(){console.log("进入游戏失败的状态"),B.getInstance().getUICtlNode().emit("close-weapon-info-layer"),e.node.getComponent(G).gemeLose(),e.node.getComponent(G).frozenAllEnemy(),e.node.getComponent(A).frozenAllTowerBuildBase(),e.homeIconNode.getComponent(U).frozenHomeIcon();var t=e.node.getComponent(G).getDeadEnemyData();e.scheduleOnce((function(){B.getInstance().getUICtlNode().emit("show-game-loss-ui",t,e.adsCtl.getVideoIsReady())}),.6)}))}},{key:"showUIEnterAnim",value:function(){return new Promise((function(e,t){B.getInstance().getUICtlNode().emit("show-ui-enter-anim",(function(){e()}))}))}},{key:"showHomeIconEnterAnim",value:function(){var e=this;return new Promise((function(t,n){v(e.homeIconNode)||(e.homeIconNode=C(e.homeIconPrefab),e.homeIconNode.parent=e.node);var o=e.node.getComponent(P);if(o){var a=o.getMapNodeList().getValue(5,5);e.homeIconNode.position=p(a.position.x,20,a.position.z),e.homeIconNode.getComponent(U).freeHomeIconn(),a.active=!1;var i=new h(e.homeIconNode);e.homeIconNode.active=!0,i.call((function(){a.active=!0})),i.to(2,{position:p(a.position.x,0,a.position.z)},{easing:"quadOut"}),i.call((function(){t()})),i.start()}}))}},{key:"playStatrButtonPressAnim",value:function(){var e=this;return new Promise((function(t,n){var o=e.startGameButton.getChildByName("StartGameButton").getComponent(I);if(o){var a=o.defaultClip,i=o.getState(a.name);i.repeatCount=1;var r=i.length;o.play(a.name),e.scheduleOnce((function(){console.log("播放完成"),t()}),r)}else t()}))}},{key:"playerTouch3dObject",value:function(e){if("ready"===this.state.getState())for(var t=0;t<e.length;t++){e[t].collider.node.uuid===this.startGameButton.uuid&&this.state.setState("play-start-button-anim")}else"run"===this.state.getState()&&this.node.emit("touch-screen-to-3d",y.instance.raycastResults)}},{key:"update",value:function(e){}},{key:"getGameConfig",value:function(){return this.gameConfigJson}},{key:"showAddGoldAnimEffect",value:function(e,t){var n=C(this.goldAnim3dPrefab);n.parent=this.node,n.getComponent(S).setGoldCount(e,this),n.position=t}},{key:"showBossEnterState",value:function(){this.node.emit("show-boss-enter-state")}},{key:"gameWin",value:function(e){B.getInstance().getUICtlNode().emit("close-all-ui"),B.getInstance().getUICtlNode().emit("close-weapon-info-layer"),"run"===this.state.getState()&&(this.state.setState("show-game-result"),B.getInstance().getUICtlNode().emit("show-game-win-ui",e))}},{key:"enterNextLevel",value:function(){var e=this;B.getInstance().enterNextLevel(),0===B.getInstance().getPlayerData().currentLevelNum?B.getInstance().getUICtlNode().emit("show-game-end-info-layer",(function(){e.enterGame().then((function(){B.getInstance().getPlayerData().recoverRedHeartCount(),B.getInstance().getUICtlNode().emit("refer-red-heart-label"),e.node.emit("update-gold-label",B.getInstance().getPlayerData().getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(G).startGame()}))})):(console.log("进入下一关"),this.enterGame().then((function(){B.getInstance().getPlayerData().recoverRedHeartCount(),B.getInstance().getUICtlNode().emit("refer-red-heart-label"),e.node.emit("update-gold-label",B.getInstance().getPlayerData().getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(G).startGame()})))}},{key:"enterGame",value:function(){var e=this;return new Promise((function(t,n){v(e.homeIconNode)&&(e.homeIconNode.active=!1),e.node.emit("destroy-all-tower"),e.node.emit("destroy-all-tower-build-base"),e.node.emit("destroy-all-enemy"),e.node.emit("init-level-label"),e.node.getComponent(A).showTowerBuildBaseEnterAnim().then((function(){return e.showHomeIconEnterAnim()})).then((function(){return e.showCurrentLevelIconAnim()})).then((function(){t()}))}))}},{key:"showCurrentLevelIconAnim",value:function(){return new Promise((function(e,t){B.getInstance().getUICtlNode().emit("show-current-level-icon-anim",(function(){e&&e()}))}))}},{key:"enemyAttacked",value:function(e){(console.log("敌人发动了攻击",e),"run"===this.state.getState())&&(B.getInstance().getPlayerData().getCurrentRedHeartCount()>0&&(B.getInstance().getPlayerData().addRedHeartCount(-1),B.getInstance().getUICtlNode().emit("refer-red-heart-label"),0===B.getInstance().getPlayerData().getCurrentRedHeartCount()&&(console.log("游戏结束"),this.state.setState("game-loss"))))}},{key:"referRedHeardUI",value:function(){B.getInstance().getUICtlNode().emit("refer-red-heart-label")}},{key:"referPowerCountLabel",value:function(){B.getInstance().getUICtlNode().emit("refer-current-power-label",B.getInstance().getPlayerData().currentPowerCount)}}]),t}(w),Q.accY=-1,Q.enemyBeLockMaxNum=1,F=n((O=Z).prototype,"enemyHealthBarCtlNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(O.prototype,"gameConfigJson",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=n(O.prototype,"towersPrefabList",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=n(O.prototype,"startGameButton",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=n(O.prototype,"plate",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=n(O.prototype,"gameStartButtonBase",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=n(O.prototype,"homeIconPrefab",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=n(O.prototype,"goldAnim3dPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=O))||J)),c._RF.pop()}}}));

System.register("chunks:///SkillComponent/CrazyRotateSkill.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../Towers/TowerBase.js"],(function(e,t){var o,n,r,a,i,l,s,c,u,d,p,h,v,f,g,y,C,k,b,w,R,S;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,d=e._decorator,p=e.Node,h=e.Tween,v=e.v3},function(e){f=e.BaseObject},function(e){g=e.TowerBase}],execute:function(){u._RF.push({},"621d4adyJFG1KkUA3lbByt0","CrazyRotateSkill",void 0),R=d.ccclass,S=d.property,e("CrazyRotateSkill",(y=R("CrazyRotateSkill"),C=S({type:p}),y((w=o((b=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,c=new Array(n),u=0;u<n;u++)c[u]=arguments[u];return o=a(this,(e=i(t)).call.apply(e,[this].concat(c))),l(o,"weaponGunNode",w,s(o)),o}return n(t,e),c(t,[{key:"onLoad",value:function(){var e=this;this.node.on("init",(function(t,o){e.init(t,o)}))}},{key:"start",value:function(){var e=this,t=function(){for(var t=e.node.getComponent(g).bulletStartPosList,o=0;o<t.length;o++){var n=t[o],r=v(n.worldPosition).subtract(e.node.position),a=e.getCurrentAttackNum();e.node.getComponent(g).shootOneBullet(e.baseAttackRate+e.node.getComponent(f).baseAttackRate,r,a)}};this.node.on("release-skill",(function(o){var n=e.getCurrentShootRate()+e.node.getComponent(g).getCurrentShootRate();console.log("shoot rate",n);var r=1/n;e.schedule(t,r);var a=e.getCurrentSkillRotateAngle(),i=a/e.rotateSpeed,l=new h(e.node),s=Math.random()-.5;e.weaponGunNode&&(e.weaponGunNode.eulerAngles=v(0,0,0)),l.by(i,{eulerAngles:v(0,a*(s/Math.abs(s)),0)}),l.call((function(){e.unschedule(t),o&&o()})),l.start()}))}}]),t}(f)).prototype,"weaponGunNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=b))||k)),u._RF.pop()}}}));

System.register("chunks:///UI/AStartFindPath.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/My2Array.js"],(function(t,e){var o,n,r,i,s,a,h,u,l,c,d,p,v,y,f,g,m,L,C,P,N,M,x,V,b,k,A,T;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inherits,r=t.classCallCheck,i=t.possibleConstructorReturn,s=t.getPrototypeOf,a=t.initializerDefineProperty,h=t.assertThisInitialized,u=t.createClass},function(t){l=t.cclegacy,c=t._decorator,d=t.Node,p=t.Color,v=t.instantiate,y=t.v3,f=t.SpriteComponent,g=t.isValid,m=t.UITransformComponent,L=t.v2,C=t.Component},function(t){P=t.default}],execute:function(){l._RF.push({},"aee76uGSzxFLKJAvvNlf0aC","AStartFindPath",void 0),k=c.ccclass,A=c.property,T=function(){function t(e,o,n){r(this,t),this.x=0,this.y=0,this.node=null,this.parentNode=null,this.fValue=0,this.gValue=0,this.hValue=0,this.x=e,this.y=o,this.node=n}return u(t,[{key:"setParentNode",value:function(t){this.parentNode=t}}]),t}(),t("AStartFindPath",(N=k("AStartFindPath"),M=A({type:d}),N((b=o((V=function(t){function e(){var t,o;r(this,e);for(var n=arguments.length,u=new Array(n),l=0;l<n;l++)u[l]=arguments[l];return o=i(this,(t=s(e)).call.apply(t,[this].concat(u))),a(o,"pointNode",b,h(o)),o.my2dArray=null,o.obsColor=p.RED,o.startColor=p.BLUE,o.endColor=p.GREEN,o.currentTouchNode=null,o.openList=[],o.closeList=[],o.startObj=null,o.size=30,o.currentPathList=[],o.checkPointList=[],o}return n(e,t),u(e,[{key:"start",value:function(){var t=this,e=this.size,o=new P;this.my2dArray=o;for(var n=0;n<e;n++){for(var r=[],i=0;i<e;i++){var s=v(this.pointNode);s.active=!0,s.parent=this.node,s.position=y(-.5*(e-1)*22+22*i,-.5*(e-1)*22+22*n,0),r.push(new T(i,n,s))}o.pushList(r)}for(var a=0;a<30;a++)this.randomObs(e);var h=this.getRandomPoint(e);h.node.getComponent(f).color=this.startColor,this.startObj=h,this.node.on(d.EventType.TOUCH_START,(function(o){g(t.currentTouchNode)&&(t.currentTouchNode.node.getComponent(f).color=p.WHITE);var n=o.getUILocation();console.log("touch pos",n);for(var r=0;r<e;r++)for(var i=0;i<e;i++){var s=t.my2dArray.getValue(i,r).node;s.getComponent(m).getBoundingBoxToWorld().contains(n)&&(s.getComponent(f).color=t.endColor,t.currentTouchNode=t.my2dArray.getValue(i,r))}t.currentTouchNode&&(t.openList=[],t.closeList=[],t.processFindPath())}))}},{key:"processFValue",value:function(t,e){var o,n=null;return n=e||t.parentNode,o=t.parentNode.gValue+this.getDistance(t,n),t.gValue=o,t.hValue=this.getDistance(t,this.currentTouchNode),t.gValue+t.hValue}},{key:"getDistance",value:function(t,e){var o=Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2);return Math.sqrt(o)}},{key:"getNearPointObj",value:function(t){for(var e=t.x,o=t.y,n=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],r=[],i=0;i<n.length;i++){var s=e+n[i][0],a=o+n[i][1],h=this.my2dArray.getValue(s,a);h&&!h.node.getComponent(f).color.equals(this.obsColor)&&r.push(h)}return r}},{key:"processFindPath",value:function(){for(this.openList.push(this.startObj);this.openList.length>0;){var t=this.getFvalueMinNode();if(console.log("current obj",t),t.x===this.currentTouchNode.x&&t.y===this.currentTouchNode.y){if(console.log("找到了终点"),this.checkPointList.length>0)for(var e=0;e<this.checkPointList.length;e++){this.checkPointList[e].node.getComponent(f).color=p.WHITE}if(this.currentPathList.length>0)for(var o=0;o<this.currentPathList.length;o++){this.currentPathList[o].node.getComponent(f).color=p.WHITE}for(var n=[];t.x!==this.startObj.x||t.y!==this.startObj.y;)n.push(t.parentNode),(t=t.parentNode).node.getComponent(f).color=p.BLACK;return n.splice(n.length-1,1),void(this.currentPathList=n)}this.closeList.push(t);for(var r=this.getNearPointObj(t),i=0;i<r.length;i++){var s=r[i];if(!this.checkIsInCloseList(s))if(this.checkisInOpenList(s))this.processFValue(s,t)<s.fValue&&(s.setParentNode(t),s.fValue=this.processFValue(s));else s.setParentNode(t),s.fValue=this.processFValue(s),s.node.getComponent(f).color=p.GRAY,this.checkPointList.push(s),this.openList.push(s)}}}},{key:"checkisInOpenList",value:function(t){for(var e=0;e<this.openList.length;e++){var o=this.openList[e];if(o.x===t.x&&o.y===t.y)return!0}return!1}},{key:"checkIsInCloseList",value:function(t){for(var e=0;e<this.closeList.length;e++){var o=this.closeList[e];if(o.x===t.x&&o.y===t.y)return!0}return!1}},{key:"getFvalueMinNode",value:function(){for(var t=Number.MAX_VALUE,e=0,o=0;o<this.openList.length;o++){var n=this.openList[o];n.fValue<t&&(t=n.fValue,e=o)}return this.openList.splice(e,1)[0]}},{key:"getRandomPoint",value:function(t){var e=L(Math.round(Math.random()*(t-1)),Math.round(Math.random()*(t-1)));return this.my2dArray.getValue(e.x,e.y)}},{key:"randomObs",value:function(t){var e={x:Math.round(Math.random()*t-10)+5,y:Math.round(Math.random()*t-10)+5},o=L(0,1),n=[2*Math.PI*45/360,.5*Math.PI,Math.PI];o.rotate(n[Math.round(Math.random()*(n.length-1))]).normalize(),console.log("dir",o),o.x=Math.round(Math.abs(o.x))*Math.abs(o.x)/o.x,o.y=Math.round(Math.abs(o.y))*Math.abs(o.y)/o.y,console.log("dir",o);for(var r=0;r<4;r++){var i=L(o).multiplyScalar(r),s=L(e.x,e.y).add(i),a=this.my2dArray.getValue(s.x,s.y);a&&(a.node.getComponent(f).color=p.RED)}}}]),e}(C)).prototype,"pointNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=V))||x)),l._RF.pop()}}}));

System.register("chunks:///UI/DialogCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js"],(function(e,o){var i,t,n,a,r,l,c,s,d,u,g,v,p,f,h,y,D,b,m,L,C,w,_,P,I,N,O,A,k,x,z,B,T,j,F,J;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inherits,n=e.classCallCheck,a=e.possibleConstructorReturn,r=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,s=e.createClass},function(e){d=e.cclegacy,u=e._decorator,g=e.JsonAsset,v=e.Node,p=e.LabelComponent,f=e.loader,h=e.SpriteFrame,y=e.SpriteComponent,D=e.find,b=e.v3,m=e.Tween,L=e.Component},function(e){C=e.GameInstance}],execute:function(){d._RF.push({},"6cd17627e9OW6ntczLEzTI0","DialogCtl",void 0),F=u.ccclass,J=u.property,e("DialogCtl",(w=F("DialogCtl"),_=J({type:g}),P=J({type:v}),I=J({type:v}),N=J({type:v}),O=J({type:v}),w((x=i((k=function(e){function o(){var e,i;n(this,o);for(var t=arguments.length,s=new Array(t),d=0;d<t;d++)s[d]=arguments[d];return i=a(this,(e=r(o)).call.apply(e,[this].concat(s))),l(i,"dialogConfigJsonAsset",x,c(i)),l(i,"dialogBgNode",z,c(i)),l(i,"dialogLayer",B,c(i)),l(i,"dialogLabel",T,c(i)),l(i,"dialogPicNode",j,c(i)),i.currentLevelDialogData=[],i.currentDialogIndex=0,i.dialogOverCb=null,i}return t(o,e),s(o,[{key:"start",value:function(){var e=this;this.node.on("show-start-dialog",(function(o,i){console.log("展示开始对话的内容",o),e.dialogBgNode.active=!0,e.dialogLayer.active=!0,e.currentLevelDialogData=e.dialogConfigJsonAsset.json["Level_"+o].StartDialogList,e.currentDialogIndex=0,e.showOneDialog(),e.dialogOverCb=function(){e.closeDialogLayer().then((function(){i()}))}})),this.node.on("show-end-dialog",(function(o,i){console.log("展示开始对话的内容",o),e.dialogBgNode.active=!0,e.dialogLayer.active=!0,e.currentLevelDialogData=e.dialogConfigJsonAsset.json["Level_"+o].EndDialogList,e.currentDialogIndex=0,e.showOneDialog(),e.dialogOverCb=function(){e.closeDialogLayer().then((function(){i()}))}}))}},{key:"closeDialogLayer",value:function(){var e=this;return new Promise((function(o,i){e.showTLPOutAnim().then((function(){e.dialogBgNode.active=!1,e.dialogLayer.active=!1,e.dialogLabel.getComponent(p).string="",o()}))}))}},{key:"showOneDialog",value:function(){var e=this;if(this.currentDialogIndex>=this.currentLevelDialogData.length)this.dialogOverCb&&this.dialogOverCb();else{var o=this.currentLevelDialogData[this.currentDialogIndex],i="特朗普懂帝"+Math.round(4*Math.random());f.loadRes(i+"/spriteFrame",h,(function(i,t){i||e.showTLPEnterAnim().then((function(){e.dialogPicNode.getComponent(y).spriteFrame=t;var i=o.Text;e.dialogLabel.getComponent(p).string=i}))})),this.currentDialogIndex++}}},{key:"onButtonClick",value:function(e,o){switch(D("GameController").emit("player-button-click-audio"),o){case"next-button":console.log("下一步"),this.showOneDialog()}}},{key:"showTLPEnterAnim",value:function(){var e=this;return new Promise((function(o,i){if(C.getInstance().hideBannerAds(),e.dialogPicNode.position.x>-500)o();else{e.dialogPicNode.position=b(-1e3,-161.675,0);var t=new m(e.dialogPicNode);t.to(.2,{position:b(-407.421,-161,0)}),t.call((function(){o()})),t.start()}}))}},{key:"showTLPOutAnim",value:function(){var e=this;return new Promise((function(o,i){C.getInstance().showBannerAds();var t=new m(e.dialogPicNode);t.to(.2,{position:b(-1e3,-161,0)}),t.call((function(){o()})),t.start()}))}}]),o}(L)).prototype,"dialogConfigJsonAsset",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(k.prototype,"dialogBgNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(k.prototype,"dialogLayer",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=i(k.prototype,"dialogLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=i(k.prototype,"dialogPicNode",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=k))||A)),d._RF.pop()}}}));

System.register("chunks:///UI/EnemyHealthBarCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var n,r,a,o,i,l,c,u,s,p,d,y,f,m,v,h,_,C,b,B,g,H;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inherits,a=e.classCallCheck,o=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){s=e.cclegacy,p=e._decorator,d=e.Prefab,y=e.CameraComponent,f=e.Component}],execute:function(){s._RF.push({},"6dc3cXIfPpCN6tR8iLaqvBX","EnemyHealthBarCtl",void 0),g=p.ccclass,H=p.property,e("EnemyHealthBarCtl",(m=g("EnemyHealthBarCtl"),v=H({type:d}),h=H({type:y}),m((b=n((C=function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,u=new Array(r),s=0;s<r;s++)u[s]=arguments[s];return n=o(this,(e=i(t)).call.apply(e,[this].concat(u))),l(n,"enemyHealthBarPrefab",b,c(n)),l(n,"cameraNode",B,c(n)),n}return r(t,e),u(t,[{key:"onLoad",value:function(){this.node.on("add-one-enemy",(function(e){})),this.node.on("remove-one-enemy",(function(){}))}},{key:"start",value:function(){}},{key:"update",value:function(e){}}]),t}(f)).prototype,"enemyHealthBarPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(C.prototype,"cameraNode",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=C))||_)),s._RF.pop()}}}));

System.register("chunks:///UI/MonsterInfoLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var o,n,r,i,a,l,s,c,p,u,d,y,b,f,h,g,m,v,L,_,C,I,w,z,S,M,N,F,R,j,k,D,P,H,O;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass},function(e){p=e.cclegacy,u=e._decorator,d=e.Node,y=e.LabelComponent,b=e.loader,f=e.SpriteFrame,h=e.SpriteComponent,g=e.Component}],execute:function(){p._RF.push({},"19cfe434XNK0JMjRNGL9hyg","MonsterInfoLayer",void 0),H=u.ccclass,O=u.property,e("MonsterInfoLayer",(m=H("MonsterInfoLayer"),v=O({type:d}),L=O({type:d}),_=O({type:d}),C=O({type:d}),I=O({type:d}),w=O({type:d}),z=O({type:d}),m((N=o((M=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,c=new Array(n),p=0;p<n;p++)c[p]=arguments[p];return o=i(this,(e=a(t)).call.apply(e,[this].concat(c))),l(o,"nameLabel",N,s(o)),l(o,"speedLabel",F,s(o)),l(o,"healthCountLabel",R,s(o)),l(o,"storyLabel",j,s(o)),l(o,"monsterInfoLayer",k,s(o)),l(o,"spriteIconNode",D,s(o)),l(o,"storyLabelContent",P,s(o)),o}return n(t,e),c(t,[{key:"start",value:function(){var e=this;this.node.on("close-monster-info-layer",(function(){e.monsterInfoLayer.active=!1})),this.node.on("close-weapon-info-layer",(function(){e.monsterInfoLayer.active=!1}))}},{key:"showMonsterInfoLayer",value:function(e){var t=this;this.monsterInfoLayer.active=!0,this.nameLabel.getComponent(y).string=e.getObjectName(),this.healthCountLabel.getComponent(y).string=e.getHealthCount().toString(),this.speedLabel.getComponent(y).string=e.getMoveSpeed().toString()+"m/s",this.storyLabel.getComponent(y).string=e.getDesString(),this.storyLabelContent&&(this.storyLabelContent.height=-1*this.storyLabel.position.y+this.storyLabel.height+100),b.loadRes(e.getIconSprteFrame()+"/spriteFrame",f,(function(e,o){t.spriteIconNode.getComponent(h).spriteFrame=o}))}}]),t}(g)).prototype,"nameLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=o(M.prototype,"speedLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(M.prototype,"healthCountLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(M.prototype,"storyLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=o(M.prototype,"monsterInfoLayer",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=o(M.prototype,"spriteIconNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=o(M.prototype,"storyLabelContent",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=M))||S)),p._RF.pop()}}}));

System.register("chunks:///UI/EnemyInfoCellPrefab.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","../BaseObject.js","./MonsterInfoLayer.js"],(function(e,t){var n,o,i,r,s,l,c,a,u,f,p,d,y,h,m,I,v,C,g,b,w,N,_,k,j,P,E,F;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,s=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,a=e.createClass,u=e.get},function(e){f=e.cclegacy,p=e._decorator,d=e.Node,y=e.find,h=e.loader,m=e.SpriteFrame,I=e.SpriteComponent},function(e){v=e.GameInstance},function(e){C=e.BaseObject},function(e){g=e.MonsterInfoLayer}],execute:function(){f._RF.push({},"ede41pxC3ZOx6d6u8MOr8l/","EnemyInfoCellPrefab",void 0),E=p.ccclass,F=p.property,e("EnemyInfoCellPrefab",(b=E("EnemyInfoCellPrefab"),w=F({type:d}),N=F({type:d}),b((j=n((k=function(e){function t(){var e,n;i(this,t);for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return n=r(this,(e=s(t)).call.apply(e,[this].concat(a))),l(n,"enemyIconNode",j,c(n)),l(n,"newInfoTipsNode",P,c(n)),n.uiControllerNode=null,n}return o(t,e),a(t,[{key:"init",value:function(e,n){var o=this,i=n.enemyType;console.log("enemy type",i),this.uiControllerNode=y("Canvas"),u(s(t.prototype),"init",this).call(this,e,null,null,i),v.getInstance().getGameCtlNode().on("refer-enemy-info-cell",(function(){o.referUI()})),this.node.on("click",this.onButtonClick.bind(this),this),this.referUI()}},{key:"referUI",value:function(){var e=this,t=this.getEnemyIsActive();if(console.log("is active",t),t){var n=this.getIconSprteFrame();console.log("sprite frame icon str",n),h.loadRes(n+"/spriteFrame",m,(function(t,n){t||(e.enemyIconNode.getComponent(I).spriteFrame=n)})),this.getIsShowed()||(this.newInfoTipsNode.active=!0,this.uiControllerNode.emit("show-new-enemy-info-tips"))}}},{key:"onButtonClick",value:function(){y("GameController").emit("player-button-click-audio"),console.log("click"),this.getEnemyIsActive()&&(this.uiControllerNode.getComponent(g).showMonsterInfoLayer(this),this.newInfoTipsNode.active=!1,this.setShowed(),this.uiControllerNode.emit("show-new-enemy-info-tips"))}}]),t}(C)).prototype,"enemyIconNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=n(k.prototype,"newInfoTipsNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=k))||_)),f._RF.pop()}}}));

System.register("chunks:///UI/InfoLayerCtlBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js"],(function(e,t){var o,n,i,r,a,c,s,l,u,d,h,f,p,y,v,w,g,b,B,k,S,m,N,_,C,L,I,D,z,P;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,c=e.initializerDefineProperty,s=e.assertThisInitialized,l=e.createClass},function(e){u=e.cclegacy,d=e._decorator,h=e.Node,f=e.v3,p=e.view,y=e.Tween,v=e.SpriteComponent,w=e.Component},function(e){g=e.State}],execute:function(){u._RF.push({},"48a3c0EK8xEhbYTC0+7u64U","InfoLayerCtlBase",void 0),z=d.ccclass,P=d.property,e("InfoLayerCtlBase",(b=z("InfoLayerCtlBase"),B=P({type:h}),k=P({type:h}),S=P({type:h}),m=P({type:""}),b((C=o((_=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return o=r(this,(e=a(t)).call.apply(e,[this].concat(l))),c(o,"bectledLayerNode",C,s(o)),c(o,"blockBgNode",L,s(o)),c(o,"ctlShowButton",I,s(o)),c(o,"hideDir",D,s(o)),o.state=new g,o}return n(t,e),l(t,[{key:"start",value:function(){var e=this;this.bectledLayerNode.position=f(.5*this.bectledLayerNode.width*("Right"===this.hideDir?1:-1),0,0),this.state.setState("close"),this.state.addState("play-open-anim",(function(){console.log("播放武器信息ui打开的动画"),e.hideButton().then((function(){return e.showInfoLayerNode()})).then((function(){e.showBlockBgNode()})).then((function(){e.state.setState("open")}))})),this.state.addState("play-close-anim",(function(){e.hideBlockBgNode().then((function(){return e.hideInfoLayerNode()})).then((function(){return e.showCtlInfoButtonn()})).then((function(){e.state.setState("close")}))})),this.node.on("close-weapon-info-layer",(function(){"open"===e.state.getState()&&e.state.setState("play-close-anim")}))}},{key:"closeUICb",value:function(){}},{key:"showCtlInfoButtonn",value:function(){var e=this;return new Promise((function(t,o){var n=p.getVisibleSize().width,i=new y(e.ctlShowButton),r="Right"===e.hideDir?1:-1;i.to(.1,{position:f(.5*n*r-120*r,0,0)}),i.call((function(){t()})),i.start()}))}},{key:"hideInfoLayerNode",value:function(){var e=this;return new Promise((function(t,o){var n=new y(e.bectledLayerNode),i="Right"===e.hideDir?1:-1;n.to(.2,{position:f(.5*e.bectledLayerNode.width*i,0,0)}),n.call((function(){t()})),n.start()}))}},{key:"hideBlockBgNode",value:function(){var e=this;return new Promise((function(t,o){t(),e.blockBgNode.active=!1}))}},{key:"showInfoLayerNode",value:function(){var e=this;return new Promise((function(t,o){var n="Right"===e.hideDir?1:-1,i=(p.getVisibleSize().width-1280)/2,r=new y(e.bectledLayerNode);r.to(.2,{position:f(i*n,0,0)}),r.call((function(){t()})),r.start()}))}},{key:"showBlockBgNode",value:function(){var e=this;return new Promise((function(t,o){e.blockBgNode.active=!0;var n=new y(e.blockBgNode.getComponent(v));n.call((function(){t()})),n.start()}))}},{key:"hideButton",value:function(){var e=this,t=p.getVisibleSize().width;return new Promise((function(o,n){var i=new y(e.ctlShowButton),r="Right"===e.hideDir?1:-1;i.to(.1,{position:f(.5*t*r+100*r,0,0)}),i.call((function(){o()})),i.start()}))}},{key:"onButtonClick",value:function(e,t){switch(t){case"show-info-layer":console.log("武器信息按钮"),"close"===this.state.getState()&&(this.state.setState("play-open-anim"),this.node.emit("close-tower-menu-ui"));break;case"bg-node-click":console.log("背景节点点击 ",this.state.getState()),"open"===this.state.getState()&&this.state.setState("play-close-anim")}}}]),t}(w)).prototype,"bectledLayerNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=o(_.prototype,"blockBgNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=o(_.prototype,"ctlShowButton",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=o(_.prototype,"hideDir",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Right"}}),N=_))||N)),u._RF.pop()}}}));

System.register("chunks:///UI/EnemyInfoLayerCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","./EnemyInfoCellPrefab.js","./InfoLayerCtlBase.js"],(function(e,n){var o,t,i,r,a,l,s,f,c,y,p,u,d,m,v,I,C,h,g,b,_,E,N,P,w,k,j,B,M,A,L,T;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,f=e.createClass,c=e.get},function(e){y=e.cclegacy,p=e._decorator,u=e.JsonAsset,d=e.Node,m=e.Prefab,v=e.instantiate,I=e.v3},function(e){C=e.BaseObject},function(e){h=e.EnemyInfoCellPrefab},function(e){g=e.InfoLayerCtlBase}],execute:function(){y._RF.push({},"dd7e3sy4eVGxLt1hsBdjeJ6","EnemyInfoLayerCtl",void 0),L=p.ccclass,T=p.property,e("EnemyInfoLayerCtl",(b=L("EnemyInfoLayerCtl"),_=T({type:u}),E=T({type:d}),N=T({type:m}),P=T({type:d}),b((j=o((k=function(e){function n(){var e,o;i(this,n);for(var t=arguments.length,f=new Array(t),c=0;c<t;c++)f[c]=arguments[c];return o=r(this,(e=a(n)).call.apply(e,[this].concat(f))),l(o,"gameConfigJsonAsset",j,s(o)),l(o,"enemyInfoNodeParentNode",B,s(o)),l(o,"enemyInfoCellPrefab",M,s(o)),o.enemyInfoCellMap={},l(o,"newInfoTipsNode",A,s(o)),o}return t(n,e),f(n,[{key:"start",value:function(){var e=this;c(a(n.prototype),"start",this).call(this),this.initEnemyData(),this.node.on("refer-enemy-info-cell",(function(n){(console.log("enemy info cell map",e.enemyInfoCellMap),e.enemyInfoCellMap[n])&&e.enemyInfoCellMap[n].getComponent(h).referUI()})),this.node.on("show-new-enemy-info-tips",(function(){var n=!1;for(var o in e.newInfoTipsNode.active=!1,e.enemyInfoCellMap){var t=e.enemyInfoCellMap[o];if(!t.getComponent(C).getIsShowed()&&t.getComponent(C).getEnemyIsActive()){n=!0;break}}n&&(e.newInfoTipsNode.active=!0)}))}},{key:"closeUICb",value:function(){}},{key:"initEnemyData",value:function(){var e=this.gameConfigJsonAsset.json,n=[];for(var o in e){var t=e[o];o.indexOf("Boss")>-1&&n.push(t)}n=n.sort((function(e,n){return e.EnemyIndex-n.EnemyIndex}));for(var i=0;i<n.length;i++){var r=v(this.enemyInfoCellPrefab);r.parent=this.enemyInfoNodeParentNode;var a=n[i].EnemyType;r.getComponent(h).init(this.gameConfigJsonAsset.json,{enemyType:a}),r.getComponent(h).referUI();var l=i%3,s=Math.floor(i/3);r.position=I(100*l-100,-100*s-70,0),this.enemyInfoNodeParentNode.height=-1*r.position.y+70,this.enemyInfoCellMap[a]=r}}},{key:"referEnemyData",value:function(){}},{key:"onButtonClick",value:function(e,o){c(a(n.prototype),"onButtonClick",this).call(this,e,o),"bg-node-click"===o&&this.node.emit("close-monster-info-layer")}}]),n}(g)).prototype,"gameConfigJsonAsset",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=o(k.prototype,"enemyInfoNodeParentNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(k.prototype,"enemyInfoCellPrefab",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=o(k.prototype,"newInfoTipsNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=k))||w)),y._RF.pop()}}}));

System.register("chunks:///UI/EnterGameAnimCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var o,n,i,r,a,l,c,u,s,p,d,h,m,f,y,v,g,b,_,w,C,A,G,N,k,z,T,L;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){s=e.cclegacy,p=e._decorator,d=e.Node,h=e.find,m=e.UIOpacityComponent,f=e.Tween,y=e.Component}],execute:function(){s._RF.push({},"965ecmCN75I15VOe1C9JGA5","EnterGameAnimCtl",void 0),T=p.ccclass,L=p.property,e("EnterGameAnimCtl",(v=T("EnterGameAnimCtl"),g=L({type:d}),b=L({type:d}),_=L({type:d}),w=L({type:d}),v((G=o((A=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,u=new Array(n),s=0;s<n;s++)u[s]=arguments[s];return o=r(this,(e=a(t)).call.apply(e,[this].concat(u))),l(o,"logoLayer",G,c(o)),l(o,"logoNode",N,c(o)),l(o,"bgNode",k,c(o)),l(o,"healthGameTips",z,c(o)),o}return n(t,e),u(t,[{key:"start",value:function(){var e=this;this.logoLayer.active=!0,this.showAnim(this.healthGameTips,!1,1).then((function(){return e.showAnim(e.healthGameTips,!0,.01)})).then((function(){return e.showAnim(e.logoNode,!1,1)})).then((function(){return e.showAnim(e.logoNode,!0,.01)})).then((function(){return e.showAnim(e.bgNode,!0,.01)})).then((function(){e.logoLayer.on("click",(function(){h("GameController").emit("player-button-click-audio"),e.logoLayer.active=!1})),e.node.emit("show-guide")}))}},{key:"showAnim",value:function(e,t,o){var n=e.getComponent(m);return n.opacity=t?255:0,new Promise((function(e,i){var r=new f(n);r.to(1,{opacity:t?0:255}),r.delay(o),r.call((function(){e()})),r.start()}))}}]),t}(y)).prototype,"logoLayer",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=o(A.prototype,"logoNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=o(A.prototype,"bgNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(A.prototype,"healthGameTips",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=A))||C)),s._RF.pop()}}}));

System.register("chunks:///UI/GameWin/GameResultGoldCell.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(e,t){var n,o,i,r,l,a,s,c,u,p,d,m,y,C,b,f,v,g,h,_,G,F,I,w,L,R,N,j,k;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass,u=e.get},function(e){p=e.cclegacy,d=e._decorator,m=e.Node,y=e.LabelComponent,C=e.loader,b=e.SpriteFrame,f=e.isValid,v=e.SpriteComponent},function(e){g=e.BaseObject}],execute:function(){p._RF.push({},"00a24DEoTFIC42oXzjaFqsy","GameResultGoldCell",void 0),j=d.ccclass,k=d.property,e("GameResultGoldCell",(h=j("GameResultGoldCell"),_=k({type:m}),G=k({type:m}),F=k({type:m}),h((L=n((w=function(e){function t(){var e,n;i(this,t);for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];return n=r(this,(e=l(t)).call.apply(e,[this].concat(c))),a(n,"enemyIconNode",L,s(n)),a(n,"enemyCountLabel",R,s(n)),a(n,"winGoldCountLabel",N,s(n)),n}return o(t,e),c(t,[{key:"start",value:function(){}},{key:"init",value:function(e,n){var o=this,i=n.key;u(l(t.prototype),"init",this).call(this,e,null,null,i);var r=this.getIconSprteFrame();this.enemyCountLabel.getComponent(y).string=n.enemyCount+"",this.winGoldCountLabel.getComponent(y).string=n.winGoldCount+"",C.loadRes(r+"/spriteFrame",b,(function(e,t){!e&&f(o.enemyIconNode)&&(o.enemyIconNode.getComponent(v).spriteFrame=t)}))}},{key:"setData",value:function(e,t,n){var o=this;this.enemyCountLabel.getComponent(y).string=e+"",this.winGoldCountLabel.getComponent(y).string=t+"",C.loadRes(n+"/spriteFrame",b,(function(e,t){!e&&f(o.enemyIconNode)&&(o.enemyIconNode.getComponent(v).spriteFrame=t)}))}}]),t}(g)).prototype,"enemyIconNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(w.prototype,"enemyCountLabel",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=n(w.prototype,"winGoldCountLabel",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=w))||I)),p._RF.pop()}}}));

System.register("chunks:///util/Tool.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,o,l;return{setters:[function(t){n=t.createClass,o=t.classCallCheck},function(t){l=t.cclegacy}],execute:function(){l._RF.push({},"a5b9421aLlB+qBZsaa/3PZA","Tool",void 0),t("Tool",function(){function t(){o(this,t)}return n(t,null,[{key:"convertNumToK",value:function(t){for(var e=(t=Math.abs(t))+"",n=t,o=0;n>0;)n=Math.floor(n/1e3),o++;return(e=t/Math.pow(1e3,o-1)+"").length>4&&(e=e.substring(0,4)),o>=1&&(e+=["","K","M","B"][o-1]),e}}]),t}()),l._RF.pop()}}}));

System.register("chunks:///UI/GoldCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","../util/Tool.js"],(function(e,t){var r,o,n,i,a,l,d,u,c,s,p,f,b,v,g,y,C,h,L,m,_,G,w,N,P,z,I,H,E,k,D,T,B,R,j,S,A,F,K;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,o=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,d=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,s=e._decorator,p=e.Node,f=e.Tween,b=e.v3,v=e.LabelComponent,g=e.ProgressBarComponent,y=e.instantiate,C=e.view,h=e.Component},function(e){L=e.GameInstance},function(e){m=e.Tool}],execute:function(){c._RF.push({},"76e03n/eNtMAopLI1ZIiGNs","GoldCtl",void 0),F=s.ccclass,K=s.property,e("GoldCtl",(_=F("GoldCtl"),G=K({type:p}),w=K({type:p}),N=K({type:p}),P=K({type:p}),z=K({type:p}),I=K({type:p}),H=K({type:p}),_((D=r((k=function(e){function t(){var e,r;n(this,t);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return r=i(this,(e=a(t)).call.apply(e,[this].concat(u))),l(r,"goldsNode",D,d(r)),l(r,"currentLevelLabel",T,d(r)),l(r,"currentScoreLabel",B,d(r)),l(r,"currentGoldLabel",R,d(r)),l(r,"addGoldEffectLabel",j,d(r)),l(r,"redHeartProgressBar",S,d(r)),l(r,"redHeartCountLabel",A,d(r)),r.addGoldEffectNodeCount=0,r}return o(t,e),u(t,[{key:"start",value:function(){var e=this;this.node.on("refer-current-wave-level",(function(t,r){e.updateLevelLabel(t,r)})),this.node.on("update-gold-label",(function(t){e.updateGoldCountLabel(t)})),this.node.on("gold-not-enough",(function(){var t=new f(e.currentGoldLabel);t.to(.1,{scale:b(1.5,1.5,1.5)}),t.to(.1,{scale:b(1,1,1)}),t.start()})),this.node.on("refer-red-heart-label",(function(){var t=L.getInstance().getPlayerData().getCurrentRedHeartCount(),r=L.getInstance().getPlayerData().getCurrentInitRedHeartCount();e.redHeartCountLabel.getComponent(v).string=r+"/"+t;var o=t/r;e.redHeartProgressBar.getComponent(g).progress=o}))}},{key:"updateLevelLabel",value:function(e,t){this.currentLevelLabel.getComponent(v).string=e+1+"-"+(t+1)}},{key:"updateGoldCountLabel",value:function(e){var t=this,r=L.getInstance().getPlayerData().getCurrentGoldCount(),o=m.convertNumToK(r);if(this.currentGoldLabel.getComponent(v).string=o,e){if(this.addGoldEffectNodeCount>20)return;this.addGoldEffectNodeCount++;var n=y(this.addGoldEffectLabel);n.parent=this.goldsNode;var i="-";e>0&&(i="+");var a=m.convertNumToK(e);n.getComponent(v).string=i+a+"";var l=new f(n);l.by(.2,{position:b(0,20,0)}),l.delay(.5),l.by(.2,{position:b(0,20,0),opacity:-.5}),l.call((function(){n.destroy(),t.addGoldEffectNodeCount--})),l.start()}}},{key:"showEnterAnim",value:function(){var e=this,t=C.getVisibleSize().height;return console.log("播放金币ui的进场动画"),this.node.emit("refer-red-heart-label"),new Promise((function(r,o){var n=new f(e.goldsNode);n.to(.2,{position:b(0,.5*t-65,0)}),n.call((function(){r()})),n.start()}))}}]),t}(h)).prototype,"goldsNode",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=r(k.prototype,"currentLevelLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=r(k.prototype,"currentScoreLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=r(k.prototype,"currentGoldLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=r(k.prototype,"addGoldEffectLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=r(k.prototype,"redHeartProgressBar",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=r(k.prototype,"redHeartCountLabel",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=k))||E)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/MenuUIBase.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../util/State.js","../../Towers/TowerBase.js"],(function(t,e){var o,n,s,a,i,c,u,l,r,h,d,g,p,f,v,k;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){o=t.inherits,n=t.classCallCheck,s=t.possibleConstructorReturn,a=t.getPrototypeOf,i=t.createClass},function(t){c=t.cclegacy,u=t._decorator,l=t.isValid,r=t.Tween,h=t.v3,d=t.Component},function(t){g=t.State},function(t){p=t.TowerBase}],execute:function(){c._RF.push({},"22840YoTAVEEoGWokYeLlSX","MenuUIBase",void 0),k=u.ccclass,u.property,t("MenuUIBase",(f=k("MenuUIBase"),f(v=function(t){function e(){var t,o;n(this,e);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return(o=s(this,(t=a(e)).call.apply(t,[this].concat(c)))).state=new g,o.targetNode=null,o}return o(e,t),i(e,[{key:"init",value:function(t){this.state.addState("open-ui",this.openUI.bind(this)),this.state.addState("close-ui",this.closeUI.bind(this))}},{key:"open",value:function(t){console.log("打开"),l(this.targetNode)&&this.targetNode.getComponent(p)&&this.targetNode.uuid!==t.uuid&&this.targetNode.getComponent(p).closeAttackRange(),t.getComponent(p)&&t.getComponent(p).showAttackRange(),this.targetNode=t,this.state.setState("open-ui")}},{key:"close",value:function(){this.state.setState("close-ui")}},{key:"closeUI",value:function(){l(this.targetNode)&&this.targetNode.getComponent(p)&&this.targetNode.getComponent(p).closeAttackRange();var t=new r(this.node);t.to(.2,{scale:h(0,0,0)}),t.call((function(){})),t.start()}},{key:"openUI",value:function(){console.log("open ui"),this.node.active=!0;var t=new r(this.node);t.to(.2,{scale:h(1,1,1)}),t.call((function(){})),t.start()}}]),e}(d))||v)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerUITowerIcon.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(e,t){var i,o,r,n,s,l,c,a,u,d,p,h,y,f,w,b,g,v,m,T,C,_,A,I,L,B,j,k,N;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,s=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,a=e.createClass,u=e.get},function(e){d=e.cclegacy,p=e._decorator,h=e.Node,y=e.Prefab,f=e.isValid,w=e.instantiate,b=e.v3,g=e.LabelComponent},function(e){v=e.BaseObject}],execute:function(){d._RF.push({},"960c8xSpalMJZbfb3XktNJx","BuildTowerUITowerIcon",void 0),k=p.ccclass,N=p.property,e("BuildTowerUITowerIcon",(m=k("BuildTowerUITowerIcon"),T=N({type:h}),C=N({type:y}),_=N({type:h}),m((L=i((I=function(e){function t(){var e,i;r(this,t);for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return i=n(this,(e=s(t)).call.apply(e,[this].concat(a))),l(i,"costGoldLabel",L,c(i)),l(i,"towerShowAnimList",B,c(i)),l(i,"showTowerAnimLayer",j,c(i)),i.gameConfig=void 0,i.currentBuildCost=null,i.towerType=null,i.currentAnimNode=null,i}return o(t,e),a(t,[{key:"onLoad",value:function(){}},{key:"start",value:function(){}},{key:"init",value:function(e,i){this.gameConfig=i,this.towerType=e,f(this.currentAnimNode)&&this.currentAnimNode.destroy();var o=w(this.towerShowAnimList[e]);for(var r in this.currentAnimNode=o,o.scale=b(1,1,1),o.parent=this.showTowerAnimLayer,console.log("type",e),this.gameConfig)r.indexOf("Tower")>-1&&this.gameConfig[r].Index===e&&(this.objectType=r);console.log("object type",this.objectType),u(s(t.prototype),"init",this).call(this,this.gameConfig),this.costGoldLabel.getComponent(g).string=this.buildCost+""}},{key:"getCurrentBuildCost",value:function(){return this.buildCost}},{key:"getTowerType",value:function(){return this.towerType}}]),t}(v)).prototype,"costGoldLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(I.prototype,"towerShowAnimList",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=i(I.prototype,"showTowerAnimLayer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=I))||A)),d._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerMenuUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../GameInstance.js","./MenuUIBase.js","./BuildTowerUITowerIcon.js"],(function(e,t){var o,i,n,r,s,a,l,c,u,d,h,g,p,f,I,w,v,C,m,y,T,B,b,U,_,k,N,M;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,s=e.getPrototypeOf,a=e.initializerDefineProperty,l=e.assertThisInitialized,c=e.createClass,u=e.get},function(e){d=e.cclegacy,h=e._decorator,g=e.Prefab,p=e.instantiate,f=e.ButtonComponent,I=e.v3,w=e.v2,v=e.find,C=e.isValid},function(e){m=e.GameInstance},function(e){y=e.MenuUIBase},function(e){T=e.BuildTowerUITowerIcon}],execute:function(){d._RF.push({},"e6405P/+GFGaa0/qmo/iQAc","BuildTowerMenuUI",void 0),N=h.ccclass,M=h.property,e("BuildTowerMenuUI",(B=N("BuildTowerMenuUI"),b=M({type:g}),B((k=o((_=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return o=r(this,(e=s(t)).call.apply(e,[this].concat(c))),a(o,"buildTowerUITowerIcon",k,l(o)),o.gameConfig=null,o.towerIconNodeList=[],o}return i(t,e),c(t,[{key:"init",value:function(e){u(s(t.prototype),"init",this).call(this,e),this.gameConfig=e,this.referCurrentUI()}},{key:"referCurrentUI",value:function(){var e=m.getInstance().getPlayerData().getCurrentActiveTowerList(),t=e.length,o=t-this.towerIconNodeList.length;if(console.log("dis",o),o>0)for(var i=0;i<o;i++){var n=p(this.buildTowerUITowerIcon);n.addComponent(f),n.on("click",this.onButtonClick.bind(this)),n.parent=this.node,this.towerIconNodeList.push(n)}else if(o<0)for(var r=0;r<Math.abs(o);r++)this.towerIconNodeList.pop().destroy();for(var s=0;s<this.towerIconNodeList.length;s++){var a=this.towerIconNodeList[s];a.name="tower_"+e[s],a.getComponent(T).init(e[s],this.gameConfig);var l=60/a.width;a.scale=I(l,l,1);var c=w(0,1),u=(c=c.rotate(2*Math.PI/t*s).normalize()).multiplyScalar(75);a.setPosition(I(u.x,u.y,0))}console.log("build tower ui"),this.node.getChildByName("BuildTowerBgNode").on("click",this.onButtonClick.bind(this))}},{key:"onButtonClick",value:function(e,t){if(v("GameController").emit("player-button-click-audio"),"close"!==t)if("BuildTowerBgNode"===e.node.name)this.state.setState("close-ui");else{var o=e.node.getComponent(T);if(o){var i=o.getTowerType(),n=o.getCurrentBuildCost();n<=m.getInstance().getPlayerData().getCurrentGoldCount()&&C(this.targetNode)?(m.getInstance().addGoldCount(-1*n),this.state.setState("close-ui"),v("GameController").emit("build-one-tower",i,this.targetNode)):v("Canvas").emit("gold-not-enough")}}else this.state.setState("close-ui")}}]),t}(y)).prototype,"buildTowerUITowerIcon",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=_))||U)),d._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./MenuUIBase.js","./BuildTowerUITowerIcon.js"],(function(e,t){var o,i,r,n,l,s,a,c,u,d,h,p,g,f,w,C,v,I,m,y,T,B,U,b,_,k,N;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,c=e.createClass,u=e.get},function(e){d=e.cclegacy,h=e._decorator,p=e.Prefab,g=e.instantiate,f=e.ButtonComponent,w=e.v3,C=e.v2,v=e.find,I=e.isValid},function(e){m=e.MenuUIBase},function(e){y=e.BuildTowerUITowerIcon}],execute:function(){d._RF.push({},"e33afUUW/FG4pMfGRr03v2w","BuildTowerUI",void 0),k=h.ccclass,N=h.property,e("BuildTowerUI",(T=k("BuildTowerUI"),B=N({type:p}),T((_=o((b=function(e){function t(){var e,o;r(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return o=n(this,(e=l(t)).call.apply(e,[this].concat(c))),s(o,"buildTowerUITowerIcon",_,a(o)),o.gameConfig=null,o.towerIconNodeList=[],o}return i(t,e),c(t,[{key:"init",value:function(e,o){u(l(t.prototype),"init",this).call(this),this.gameController=o,this.gameConfig=e,this.referCurrentUI()}},{key:"referCurrentUI",value:function(){var e=this.gameController.playerData.getCurrentActiveTowerList(),t=e.length,o=t-this.towerIconNodeList.length;if(console.log("dis",o),o>0)for(var i=0;i<o;i++){var r=g(this.buildTowerUITowerIcon);r.addComponent(f),r.on("click",this.onButtonClick.bind(this)),r.parent=this.node,this.towerIconNodeList.push(r)}else if(o<0)for(var n=0;n<Math.abs(o);n++)this.towerIconNodeList.pop().destroy();for(var l=0;l<this.towerIconNodeList.length;l++){var s=this.towerIconNodeList[l];s.name="tower_"+e[l],s.getComponent(y).init(e[l],this.gameController,this.gameConfig);var a=60/s.width;s.scale=w(a,a,1);var c=C(0,1),u=(c=c.rotate(2*Math.PI/t*l).normalize()).multiplyScalar(75);s.setPosition(w(u.x,u.y,0))}console.log("build tower ui"),this.node.getChildByName("BuildTowerBgNode").on("click",this.onButtonClick.bind(this))}},{key:"onButtonClick",value:function(e,t){if(v("GameController").emit("player-button-click-audio"),"close"!==t)if("BuildTowerBgNode"===e.node.name)this.state.setState("close-ui");else{var o=e.node.getComponent(y);if(o){var i=o.getTowerType(),r=o.getCurrentBuildCost();r<=this.gameController.playerData.getCurrentGoldCount()&&I(this.targetNode)?(this.gameController.playerData.addGoldCount(-1*r),this.state.setState("close-ui"),v("GameController").emit("build-one-tower",i,this.targetNode)):v("Canvas").emit("gold-not-enough")}}else this.state.setState("close-ui")}}]),t}(m)).prototype,"buildTowerUITowerIcon",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=b))||U)),d._RF.pop()}}}));

System.register("chunks:///UI/Menu/UpdateTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../GameInstance.js","../../Towers/TowerBase.js","../../util/Tool.js","./MenuUIBase.js"],(function(e,t){var o,n,i,a,r,s,u,l,p,c,d,g,y,m,C,h,v,f,b,_,I,w,T,U,k,B,N,L,S,F,M,x,j,z,D;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,a=e.possibleConstructorReturn,r=e.getPrototypeOf,s=e.initializerDefineProperty,u=e.assertThisInitialized,l=e.createClass,p=e.get},function(e){c=e.cclegacy,d=e._decorator,g=e.Node,y=e.SpriteFrame,m=e.find,C=e.SpriteComponent,h=e.LabelComponent},function(e){v=e.GameInstance},function(e){f=e.TowerBase},function(e){b=e.Tool},function(e){_=e.MenuUIBase}],execute:function(){c._RF.push({},"18715njxPNA9Ie4NOUMTb2f","UpdateTowerUI",void 0),z=d.ccclass,D=d.property,e("UpdateTowerUI",(I=z("UpdateTowerUI"),w=D({type:g}),T=D({type:g}),U=D({type:y}),k=D({type:y}),B=D({type:g}),I((S=o((L=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,l=new Array(n),p=0;p<n;p++)l[p]=arguments[p];return o=a(this,(e=r(t)).call.apply(e,[this].concat(l))),s(o,"updateCostLabel",S,u(o)),s(o,"destroyWinLabel",F,u(o)),o.updateCostCount=null,o.destroyWinCount=null,s(o,"updateMaxLevelSpriteFrame",M,u(o)),s(o,"updateButtonSpriteFrame",x,u(o)),s(o,"updateButtonNode",j,u(o)),o}return n(t,e),l(t,[{key:"onLoad",value:function(){}},{key:"start",value:function(){}},{key:"init",value:function(e){p(r(t.prototype),"init",this).call(this,e)}},{key:"onButtonClick",value:function(e,t){m("GameController").emit("player-button-click-audio"),console.log("custom data",t);var o=v.getInstance().getPlayerData().getCurrentGoldCount();switch(t){case"bg":console.log("点中了背景"),this.state.setState("close-ui");break;case"update":if(this.targetNode.getComponent(f).getTowerIsMax())return;o>=this.updateCostCount?(v.getInstance().getPlayerData().addGoldCount(-1*this.updateCostCount),this.state.setState("close-ui"),this.targetNode.getComponent(f).updateLevel()):m("Canvas").emit("gold-not-enough");break;case"destroy":this.state.setState("close-ui"),this.targetNode.getComponent(f).toDestroy()}}},{key:"checkIsUpdateMax",value:function(){var e=this.targetNode.getComponent(f).getTowerIsMax();console.log("is max",e),e?(console.log("更新按钮 贴图"),this.updateButtonNode.getComponent(C).spriteFrame=this.updateMaxLevelSpriteFrame):this.updateButtonNode.getComponent(C).spriteFrame=this.updateButtonSpriteFrame}},{key:"open",value:function(e){p(r(t.prototype),"open",this).call(this,e),this.checkIsUpdateMax();var o=e.getComponent(f),n=o.getUpdateCost(),i=o.getDestroyCount();this.updateCostLabel.getComponent(h).string=b.convertNumToK(n)+"",this.destroyWinLabel.getComponent(h).string=b.convertNumToK(i)+"",this.updateCostCount=n,this.destroyWinCount=i}}]),t}(_)).prototype,"updateCostLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=o(L.prototype,"destroyWinLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(L.prototype,"updateMaxLevelSpriteFrame",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(L.prototype,"updateButtonSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(L.prototype,"updateButtonNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=L))||N)),c._RF.pop()}}}));

System.register("chunks:///UI/ShowGameEndInfoLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js"],(function(e,t){var o,i,n,a,s,r,c,l,u,h,d,f,p,y,v,w,g,m,b,_,S,I,k;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,a=e.possibleConstructorReturn,s=e.getPrototypeOf,r=e.initializerDefineProperty,c=e.assertThisInitialized,l=e.createClass},function(e){u=e.cclegacy,h=e._decorator,d=e.Node,f=e.v3,p=e.Component},function(e){y=e.State}],execute:function(){u._RF.push({},"e95faq7Uw1I9JEO8PddsgBN","ShowGameEndInfoLayer",void 0),I=h.ccclass,k=h.property,e("ShowGameEndInfoLayer",(v=I("ShowGameEndInfoLayer"),w=k({type:d}),g=k({type:d}),v((_=o((b=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,l=new Array(i),u=0;u<i;u++)l[u]=arguments[u];return o=a(this,(e=s(t)).call.apply(e,[this].concat(l))),r(o,"showGameInfoLayer",_,c(o)),r(o,"infoNode",S,c(o)),o.state=new y,o.clickBgCb=null,o}return i(t,e),l(t,[{key:"start",value:function(){var e=this;this.node.on("show-game-end-info-layer",(function(t){e.clickBgCb=t,e.startShow()}))}},{key:"startShow",value:function(){this.showGameInfoLayer.active=!0,this.state.setState("start-show")}},{key:"update",value:function(e){"start-show"===this.state.getState()&&(this.infoNode.position=f(this.infoNode.position.x,this.infoNode.position.y+40*e,this.infoNode.position.z))}},{key:"onButton",value:function(e,t){switch(t){case"bg-node":this.clickBgCb&&this.clickBgCb(),this.showGameInfoLayer.active=!1,this.state.setState("move-end")}}}]),t}(p)).prototype,"showGameInfoLayer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=o(b.prototype,"infoNode",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=b))||m)),u._RF.pop()}}}));

System.register("chunks:///UI/TouchScreenLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameController.js"],(function(e,t){var n,o,r,a,c,s,l,i,u,p,y,m,h,C,d,v;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){n=e.inherits,o=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,c=e.createClass},function(e){s=e.cclegacy,l=e._decorator,i=e.find,u=e.CameraComponent,p=e.Node,y=e.PhysicsSystem,m=e.Component},function(e){h=e.GameController}],execute:function(){s._RF.push({},"5c5e3+MsMZDYpvgjM8gmHSO","TouchScreenLayer",void 0),v=l.ccclass,l.property,e("TouchScreenLayer",(C=v("TouchScreenLayer"),C(d=function(e){function t(){var e,n;o(this,t);for(var c=arguments.length,s=new Array(c),l=0;l<c;l++)s[l]=arguments[l];return(n=r(this,(e=a(t)).call.apply(e,[this].concat(s)))).cameraNode=null,n.gameCtl=null,n}return n(t,e),c(t,[{key:"start",value:function(){var e=this;this.cameraNode=i("Camera").getComponent(u),this.gameCtl=i("GameController"),this.node.on(p.EventType.TOUCH_END,(function(t){var n=t.getLocation(),o=e.cameraNode.getComponent(u).screenPointToRay(n.x,n.y);y.instance.raycast(o,1,1e4,!0),y.instance.raycastResults&&i("GameController").getComponent(h).playerTouch3dObject(y.instance.raycastResults)}))}},{key:"update",value:function(e){}}]),t}(m))||d)),s._RF.pop()}}}));

System.register("chunks:///UI/TowerInfoLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var r,o,i,n,a,c,l,s,u,d,p,f,b,w,y,h,g,m,v,L,_,A,I,k,C,N,S,T,z,P,D,R,j,x,F,O,V,B,H,M;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,o=e.inherits,i=e.classCallCheck,n=e.possibleConstructorReturn,a=e.getPrototypeOf,c=e.initializerDefineProperty,l=e.assertThisInitialized,s=e.createClass},function(e){u=e.cclegacy,d=e._decorator,p=e.Node,f=e.Prefab,b=e.LabelComponent,w=e.isValid,y=e.instantiate,h=e.v3,g=e.Component}],execute:function(){u._RF.push({},"34c6bA7xiVOdLmFLwAjWo2Q","TowerInfoLayer",void 0),H=d.ccclass,M=d.property,e("TowerInfoLayer",(m=H("TowerInfoLayer"),v=M({type:p}),L=M({type:p}),_=M({type:p}),A=M({type:p}),I=M({type:p}),k=M({type:p}),C=M({type:p}),N=M({type:p}),S=M({type:f}),m((P=r((z=function(e){function t(){var e,r;i(this,t);for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];return r=n(this,(e=a(t)).call.apply(e,[this].concat(s))),c(r,"currentAttackDamageLabel",P,l(r)),c(r,"currentAttckRangeLabel",D,l(r)),c(r,"currentAttackSpeedLabel",R,l(r)),c(r,"towerNameLabel",j,l(r)),c(r,"attackTypeIconList",x,l(r)),c(r,"towerInfoLabel",F,l(r)),c(r,"towerInfoLayer",O,l(r)),c(r,"tower2dAnimNodePos",V,l(r)),c(r,"tower2dAnimPrefabList",B,l(r)),r.currentShowAnimNode=null,r}return o(t,e),s(t,[{key:"start",value:function(){var e=this;this.node.on("show-tower-info",this.setTowerData.bind(this),this),this.node.on("close-tower-info-layer",(function(){e.towerInfoLayer.active=!1})),this.node.on("refer-tower-info",this.referTowerInfo.bind(this),this),this.node.on("close-weapon-info-layer",(function(){e.towerInfoLayer.active=!1}))}},{key:"referTowerInfo",value:function(e){this.currentAttackDamageLabel.getComponent(b).string=e.getCurrentAttackNum().toString(),this.currentAttackSpeedLabel.getComponent(b).string=e.getCurrentShootRate().toFixed(1)+"/S",this.currentAttckRangeLabel.getComponent(b).string=Math.floor(e.getCurrentAttackRange()).toString(),this.towerNameLabel.getComponent(b).string=e.getObjectName(),this.towerInfoLabel.getComponent(b).string=e.getDesString();var t=e.towerIndexType;w(this.currentShowAnimNode)&&this.currentShowAnimNode.destroy();var r=y(this.tower2dAnimPrefabList[t]);r.parent=this.towerInfoLayer,r.position=h(this.tower2dAnimNodePos.position),this.currentShowAnimNode=r}},{key:"setTowerData",value:function(e){this.towerInfoLayer.active=!0,this.referTowerInfo(e)}}]),t}(g)).prototype,"currentAttackDamageLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=r(z.prototype,"currentAttckRangeLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=r(z.prototype,"currentAttackSpeedLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=r(z.prototype,"towerNameLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=r(z.prototype,"attackTypeIconList",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=r(z.prototype,"towerInfoLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=r(z.prototype,"towerInfoLayer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=r(z.prototype,"tower2dAnimNodePos",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=r(z.prototype,"tower2dAnimPrefabList",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=z))||T)),u._RF.pop()}}}));

System.register("chunks:///UI/typescript.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var s,c,r,n,i,o,p,u,l,a,y;return t({_dec:void 0,_class:void 0}),{setters:[function(t){s=t.inherits,c=t.createClass,r=t.classCallCheck,n=t.possibleConstructorReturn,i=t.getPrototypeOf},function(t){o=t.cclegacy,p=t._decorator,u=t.Component}],execute:function(){o._RF.push({},"22ae7b9IOpLNY3XMC2PMmpx","typescript",void 0),y=p.ccclass,p.property,t("Typescript",(l=y("Typescript"),l(a=function(t){function e(){return r(this,e),n(this,i(e).apply(this,arguments))}return s(e,t),c(e,[{key:"start",value:function(){}}]),e}(u))||a)),o._RF.pop()}}}));

System.register("chunks:///UI/SkillCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","../util/State.js","../Towers/TowerBase.js","../GameController.js"],(function(e,o){var t,i,n,r,l,s,a,c,u,d,p,f,v,h,m,k,g,y,w,b,C,_,N,T,S,P,R,B,z,I,E,L,A,F,x,U,D,j,G,O,H,V,J,M,W,Y,Z,q,K,Q,X,$;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,d=e._decorator,p=e.Prefab,f=e.SpriteFrame,v=e.Node,h=e.CCInteger,m=e.view,k=e.v3,g=e.find,y=e.CameraComponent,w=e.UITransformComponent,b=e.Tween,C=e.isValid,_=e.instantiate,N=e.Component},function(e){T=e.GameInstance},function(e){S=e.State},function(e){P=e.TowerBase},function(e){R=e.GameController}],execute:function(){u._RF.push({},"40520LpyUZJx6EmYjb+U/Iw","SkillCtl",void 0),X=d.ccclass,$=d.property,e("SkillCtl",(B=X("SkillCtl"),z=$({type:p}),I=$({type:f}),E=$({type:f}),L=$({type:v}),A=$({type:h}),F=$({type:v}),x=$({type:v}),U=$({type:v}),D=$({type:p}),j=$({type:v}),B((H=t((O=function(e){function o(){var e,t;n(this,o);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return t=r(this,(e=l(o)).call.apply(e,[this].concat(c))),s(t,"狂暴道具Prefab",H,a(t)),s(t,"狂暴道具SpriteFrameRed",V,a(t)),s(t,"狂暴道具SpriteFrameGray",J,a(t)),s(t,"skillsNode",M,a(t)),s(t,"currentSkillCount",W,a(t)),s(t,"skillRedBgList",Y,a(t)),s(t,"skillButtonNode",Z,a(t)),t.skillNodeList=[],t.currentTouchNode=null,t.cameraNodeCom=null,t.gameController=null,t.timeoutResolve=void 0,t.rayCheckResolve=void 0,t.targetTower=void 0,t.currentSkillPower=0,s(t,"skillPowerFullEffect",q,a(t)),t.state=new S,s(t,"addPowerAnim3dPrefab",K,a(t)),s(t,"skillDouIcon",Q,a(t)),t}return i(o,e),c(o,[{key:"onLoad",value:function(){}},{key:"start",value:function(){var e=this,o=m.getVisibleSize().width;this.skillButtonNode.position=k(.5*o+100,this.skillButtonNode.position.y,this.skillButtonNode.position.z),this.gameController=g("GameController").getComponent(R),this.gameController.node.on("touch-screen-to-3d",(function(o){for(var t=0;t<o.length;t++){var i=o[t];if(i.collider&&i.collider.node&&i.collider.node.getComponent(P)&&e.rayCheckResolve){e.targetTower=i.collider.node,e.rayCheckResolve("check-succ"),e.rayCheckResolve=void 0;break}}})),this.cameraNodeCom=g("Camera").getComponent(y),this.node.on(v.EventType.TOUCH_START,(function(o){console.log("touch start",o);var t=e.skillDouIcon.getComponent(w).getBoundingBoxToWorld(),i=o.getUILocation();t.contains(i)&&(console.log("点中了 技能点"),e.currentTouchNode=e.skillDouIcon,e.startCheckSkillNode())})),this.node.on(v.EventType.TOUCH_MOVE,(function(o){if(e.currentTouchNode){var t=o.getUILocation(),i=e.node.getComponent(w).convertToNodeSpaceAR(k(t.x,t.y,0));e.currentTouchNode.position=k(i.x,i.y,0)}})),this.node.on(v.EventType.TOUCH_END,(function(o){e.currentTouchNode&&(console.log("释放"),e.scheduleOnce((function(){e.timeoutResolve&&(e.timeoutResolve("timeout"),e.timeoutResolve=void 0)}),.1))})),this.node.on("show-add-power-anim-effect",this.showAddPowerAnimEffect.bind(this))}},{key:"startCheckSkillNode",value:function(){var e=this,o=[new Promise((function(o,t){e.rayCheckResolve=o})),new Promise((function(o,t){e.timeoutResolve=o}))];Promise.race(o).then((function(o){if("timeout"===o){console.log("超市了");var t=new b(e.currentTouchNode);t.to(.2,{position:e.skillButtonNode.position}),t.call((function(){e.currentTouchNode=void 0})),t.start()}else if(console.log("释放技能成功"),C(e.targetTower)){console.log("给目标塔发送消息，释放技能"),e.targetTower.getComponent(P).releaseSkill(),e.currentTouchNode.active=!1,e.currentTouchNode.position=e.skillButtonNode.position,e.skillPowerFullEffect.active=!1,e.currentSkillPower=0;for(var i=0;i<e.skillRedBgList.length;i++){var n=e.skillRedBgList[i];n.position=k(n.position.x,-80,n.position.z)}e.currentTouchNode=void 0}}))}},{key:"showEnterAnim",value:function(){var e=this;return new Promise((function(o,t){var i=m.getVisibleSize(),n=i.height;console.log("height",n);var r=new b(e.skillButtonNode);r.to(.2,{position:k(.5*i.width-110,e.skillButtonNode.position.y,e.skillButtonNode.position.z)}),r.call((function(){o(),e.state.setState("run")})),r.start()}))}},{key:"addSkillPower",value:function(e){T.getInstance().addPowerCount(e)}},{key:"showAddPowerAnimEffect",value:function(e,o){var t=this,i=_(this.addPowerAnim3dPrefab);i.parent=this.gameController.node,i.position=o;var n=new b(i);n.by(.4,{position:k(0,5,0)}),n.delay(.6),n.to(.6,{position:k(45,30,0)}),n.call((function(){i.destroy(),t.addSkillPower(e)})),n.start()}},{key:"update",value:function(e){if("run"===this.state.getState())for(var o=0;o<this.skillRedBgList.length;o++){var t=this.skillRedBgList[o];if(t.position=k(t.position.x+20*e,t.position.y,t.position.z),t.position.x>153){var i=0===o?1:0,n=this.skillRedBgList[i];t.position=k(n.position.x-152,n.position.y,n.position.z)}}}}]),o}(N)).prototype,"狂暴道具Prefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(O.prototype,"狂暴道具SpriteFrameRed",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(O.prototype,"狂暴道具SpriteFrameGray",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(O.prototype,"skillsNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(O.prototype,"currentSkillCount",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Y=t(O.prototype,"skillRedBgList",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Z=t(O.prototype,"skillButtonNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(O.prototype,"skillPowerFullEffect",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(O.prototype,"addPowerAnim3dPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(O.prototype,"skillDouIcon",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=O))||G)),u._RF.pop()}}}));

System.register("chunks:///UI/GameWin/GameWinPrefab.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../GameInstance.js","./GameResultGoldCell.js"],(function(e,t){var i,n,o,r,l,a,u,s,c,p,d,m,f,g,y,b,v,h,C,_,w,S,F,G,L,B,R,z,I,N,k,P,W,T,E,x,V,j,A,D,H,J,M,O,U,Z,q,K,Q,X,Y,$,ee,te,ie,ne,oe,re,le,ae,ue;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_dec14:void 0,_dec15:void 0,_dec16:void 0,_dec17:void 0,_dec18:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_descriptor13:void 0,_descriptor14:void 0,_descriptor15:void 0,_descriptor16:void 0,_descriptor17:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inherits,o=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,u=e.assertThisInitialized,s=e.createClass},function(e){c=e.cclegacy,p=e._decorator,d=e.Prefab,m=e.Node,f=e.SpriteFrame,g=e.SpriteComponent,y=e.LabelComponent,b=e.instantiate,v=e.Tween,h=e.v3,C=e.find,_=e.Component},function(e){w=e.GameInstance},function(e){S=e.GameResultGoldCell}],execute:function(){c._RF.push({},"fa8f9h1LBJLMZap+sTSLCS2","GameWinPrefab",void 0),ae=p.ccclass,ue=p.property,e("GameWinPrefab",(F=ae("GameWinPrefab"),G=ue({type:d}),L=ue({type:m}),B=ue({type:m}),R=ue({type:f}),z=ue({type:f}),I=ue({type:f}),N=ue({type:f}),k=ue({type:f}),P=ue({type:f}),W=ue({type:f}),T=ue({type:f}),E=ue({type:m}),x=ue({type:m}),V=ue({type:m}),j=ue({type:m}),A=ue({type:m}),D=ue({type:m}),F((M=i((J=function(e){function t(){var e,i;o(this,t);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return i=r(this,(e=l(t)).call.apply(e,[this].concat(s))),a(i,"winGoldCellPrefab",M,u(i)),a(i,"leftButton",O,u(i)),a(i,"rightButton",U,u(i)),a(i,"retryGameButtonSpriteFrame",Z,u(i)),a(i,"shareButtonSpriteFrame",q,u(i)),a(i,"nextLevelSpriteFrame",K,u(i)),a(i,"saveLifeButtonSpriteFrame",Q,u(i)),a(i,"gameWinIconSpriteFrame",X,u(i)),a(i,"gameLossIconSpriteFrame",Y,u(i)),a(i,"shareSaveLifeSpriteFrame",$,u(i)),a(i,"watchVideoSaveLifeSpriteFrame",ee,u(i)),a(i,"gameResultIconNode",te,u(i)),a(i,"gameResultNode",ie,u(i)),a(i,"sumNode",ne,u(i)),a(i,"totalEnemyCountLabel",oe,u(i)),a(i,"totalGoldCountLabel",re,u(i)),i.gameConfig=null,a(i,"scrollViewNode",le,u(i)),i.gameResultState=null,i.nodeList=[],i.currentWinPowerCount=0,i}return n(t,e),s(t,[{key:"start",value:function(){}},{key:"setGameResult",value:function(e,t,i,n){var o=this;this.gameResultState=e,this.gameConfig=i,console.log("游戏状态时",e);var r=t.length,l=0;console.log("当前关卡打死的敌人数目种类，获得的金币数目 "),e?(w.getInstance().getGameCtlNode().emit("play-audio","胜利音效"),this.gameResultIconNode.getComponent(g).spriteFrame=this.gameWinIconSpriteFrame,this.leftButton.getComponent(g).spriteFrame=this.shareButtonSpriteFrame,this.rightButton.getComponent(g).spriteFrame=this.nextLevelSpriteFrame):(this.gameResultIconNode.getComponent(g).spriteFrame=this.gameLossIconSpriteFrame,this.leftButton.getComponent(g).spriteFrame=this.retryGameButtonSpriteFrame,this.rightButton.getComponent(g).spriteFrame=this.watchVideoSaveLifeSpriteFrame);for(var a={},u=0;u<t.length;u++)a[t[u].enemyType]?(a[t[u].enemyType].enemyCount+=1,a[t[u].enemyType].winGoldCount+=t[u].dropGoldCount):a[t[u].enemyType]={enemyCount:1,winGoldCount:t[u].dropGoldCount},l+=t[u].dropGoldCount;this.currentWinPowerCount=l;var s=[];for(var c in a){var p=a[c];p.key=c,s.push(p)}console.log("list",s),s=s.sort((function(e,t){return t.winGoldCount-e.winGoldCount})),this.showCellEnterAnim(s,(function(){return console.log("展示结束"),o.showSumResult(r,l)}))}},{key:"showSumResult",value:function(e,t){var i=this;return new Promise((function(n,o){i.sumNode.active=!0,i.totalEnemyCountLabel.getComponent(y).string=e+"",i.totalGoldCountLabel.getComponent(y).string=t+""}))}},{key:"showCellEnterAnim",value:function(e,t){var i=this;if(0!==e.length){var n=e.pop(),o=b(this.winGoldCellPrefab);o.parent=this.gameResultNode;var r=new v(o);o.getComponent(S).init(this.gameConfig,n),o.position=h(0,-100*this.nodeList.length-50,0),this.gameResultNode.height=-1*o.position.y+60,this.nodeList.push(o),r.delay(.4),r.call((function(){i.showCellEnterAnim(e,t)})),r.start()}else t&&t()}},{key:"onButtonClick",value:function(e,t){var i=this;switch(C("GameController").emit("player-button-click-audio"),t){case"left-button":console.log("分享游戏结果"),this.gameResultState?w.getInstance().playerClickShareButton(this.currentWinPowerCount).then((function(){i.node.destroy()})):(w.getInstance().playerClickRetryButton(),this.node.destroy());break;case"right-button":this.gameResultState?(console.log("进入下一关"),this.node.destroy(),w.getInstance().getGameCtlNode().emit("player-click-next-level-button")):w.getInstance().playerClickSaveLifeButton().then((function(){i.node.destroy()}))}}}]),t}(_)).prototype,"winGoldCellPrefab",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=i(J.prototype,"leftButton",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=i(J.prototype,"rightButton",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=i(J.prototype,"retryGameButtonSpriteFrame",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=i(J.prototype,"shareButtonSpriteFrame",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=i(J.prototype,"nextLevelSpriteFrame",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=i(J.prototype,"saveLifeButtonSpriteFrame",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=i(J.prototype,"gameWinIconSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=i(J.prototype,"gameLossIconSpriteFrame",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=i(J.prototype,"shareSaveLifeSpriteFrame",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=i(J.prototype,"watchVideoSaveLifeSpriteFrame",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=i(J.prototype,"gameResultIconNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=i(J.prototype,"gameResultNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=i(J.prototype,"sumNode",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=i(J.prototype,"totalEnemyCountLabel",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=i(J.prototype,"totalGoldCountLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=i(J.prototype,"scrollViewNode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=J))||H)),c._RF.pop()}}}));

System.register("chunks:///UI/UIController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","./GoldCtl.js","./Menu/MenuUIBase.js","./Menu/BuildTowerMenuUI.js","./Menu/UpdateTowerUI.js","./SkillCtl.js","./GameWin/GameWinPrefab.js"],(function(e,t){var o,n,i,r,s,a,l,u,d,c,h,p,b,f,m,I,g,v,w,y,U,C,N,B,_,k,P,L,T,M,G,H,z,S,A,j,J,R,E,W,D,F,O,V,x,Z,q,K,Q,X,Y,$,ee,te,oe,ne,ie,re,se,ae,le;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,s=e.getPrototypeOf,a=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,c=e._decorator,h=e.Prefab,p=e.JsonAsset,b=e.Node,f=e.SpriteFrame,m=e.v3,I=e.view,g=e.isValid,v=e.instantiate,w=e.ProgressBarComponent,y=e.Tween,U=e.LabelComponent,C=e.CameraComponent,N=e.find,B=e.SpriteComponent,_=e.Component},function(e){k=e.GameInstance},function(e){P=e.GoldCtl},function(e){L=e.MenuUIBase},function(e){T=e.BuildTowerMenuUI},function(e){M=e.UpdateTowerUI},function(e){G=e.SkillCtl},function(e){H=e.GameWinPrefab}],execute:function(){d._RF.push({},"ac456IJb4BOS7ZW+hoJsDui","UIController",void 0),ae=c.ccclass,le=c.property,e("UIController",(z=ae("UIController"),S=le({type:h}),A=le({type:h}),j=le({type:p}),J=le({type:b}),R=le({type:b}),E=le({type:b}),W=le({type:f}),D=le({type:h}),F=le({type:b}),O=le({type:b}),V=le({type:b}),x=le({type:b}),z((K=o((q=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,u=new Array(n),d=0;d<n;d++)u[d]=arguments[d];return o=r(this,(e=s(t)).call.apply(e,[this].concat(u))),a(o,"buildTowerPrefab",K,l(o)),a(o,"updateMenuPrefab",Q,l(o)),a(o,"gameConfigJsonAsset",X,l(o)),a(o,"cameraNode",Y,l(o)),o.buildUINode=null,o.updateUINode=null,a(o,"enemyInfoButton",$,l(o)),a(o,"towerInfoButton",ee,l(o)),o.isHoldSkillIcon=!1,a(o,"bossIcon",te,l(o)),a(o,"gameResultPrefab",oe,l(o)),a(o,"currentLevelLabelIcon",ne,l(o)),a(o,"towerInfoLayer",ie,l(o)),a(o,"bossHealthBar",re,l(o)),a(o,"buildTowerMenuLayer",se,l(o)),o}return n(t,e),u(t,[{key:"onLoad",value:function(){var e=this;k.getInstance().setUICtlNode(this.node),this.node.on("show-boss-health-bar",this.showBossHealthBar.bind(this)),this.node.on("hide-boss-health-bar",(function(){e.bossHealthBar.position=m(0,-400,0)}))}},{key:"start",value:function(){var e=this,t=I.getVisibleSize().width;this.enemyInfoButton.position=m(-.5*t-150,0,0),this.towerInfoButton.position=m(.5*t+150,0,0),console.log("ui controller start"),k.getInstance().getGameCtlNode().on("touch-base-build-base",(function(t){e.node.emit("complete-current-guide"),e.isHoldSkillIcon||(g(e.updateUINode)&&e.updateUINode.getComponent(L).close(),g(e.buildUINode)||(e.buildUINode=v(e.buildTowerPrefab),e.buildUINode.parent=e.buildTowerMenuLayer,e.buildUINode.getComponent(T).init(e.gameConfigJsonAsset.json)),e.setUINodeTo3dPos(e.buildUINode,t),e.buildUINode.getComponent(L).open(t))})),k.getInstance().getGameCtlNode().on("touch-tower",(function(t){e.isHoldSkillIcon||(g(e.buildUINode)&&e.buildUINode.getComponent(L).close(),g(e.updateUINode)||(e.updateUINode=v(e.updateMenuPrefab),e.updateUINode.parent=e.buildTowerMenuLayer,e.updateUINode.getComponent(M).init(e.gameConfigJsonAsset.json)),e.setUINodeTo3dPos(e.updateUINode,t),e.updateUINode.getComponent(M).open(t))})),this.node.on("show-ui-enter-anim",this.showUIEnterAnim.bind(this),this),this.node.on("show-game-loss-ui",this.showGameLossUI.bind(this),this),this.node.on("show-game-win-ui",this.showGameWinUI.bind(this),this),this.node.on("show-current-level-icon-anim",this.showCurrentLevelIconAnim.bind(this),this),this.node.on("close-all-ui",this.closeSomeUI.bind(this),this),this.node.on("refer-current-tower-menu-ui",this.referTowerBuildMenuUI.bind(this),this),this.node.on("close-tower-menu-ui",this.coloseTowerBuildMenuUI.bind(this),this),this.node.on("update-boss-health-bar",this.updateBossHealthBar.bind(this),this)}},{key:"updateBossHealthBar",value:function(e){this.bossHealthBar.children[0].getComponent(w).progress=e}},{key:"showBossHealthBar",value:function(){var e=new y(this.bossHealthBar);return this.bossHealthBar.children[0].getComponent(w).progress=1,e.to(.2,{position:m(0,-280,0)}),e.start(),this.bossHealthBar}},{key:"coloseTowerBuildMenuUI",value:function(){g(this.buildUINode)&&this.buildUINode.getComponent(T).close(),g(this.updateUINode)&&this.updateUINode.getComponent(M).close()}},{key:"referTowerBuildMenuUI",value:function(){g(this.buildUINode)&&this.buildUINode.getComponent(T).referCurrentUI()}},{key:"closeSomeUI",value:function(){g(this.buildUINode)&&this.buildUINode.getComponent(T).close(),g(this.updateUINode)&&this.updateUINode.getComponent(M).close()}},{key:"showCurrentLevelIconAnim",value:function(e){var t=this,o=new y(this.currentLevelLabelIcon);this.currentLevelLabelIcon.active=!0,this.currentLevelLabelIcon.getComponent(U).string="第"+(k.getInstance().getPlayerData().currentLevelNum+1)+"关",o.set({scale:m(2,2,2)}),o.to(.5,{scale:m(1,1,1)},{easing:"backOut"}),o.delay(.8),o.call((function(){t.currentLevelLabelIcon.active=!1,e()})),o.start()}},{key:"showGameWinUI",value:function(e){var t=v(this.gameResultPrefab);t.parent=this.node;var o=this.gameConfigJsonAsset.json;t.getComponent(H).setGameResult(!0,e,o,!1)}},{key:"showGameLossUI",value:function(e,t){this.closeSomeUI();var o=v(this.gameResultPrefab);o.parent=this.node,o.getComponent(H).setGameResult(!1,e,this.gameConfigJsonAsset.json,t)}},{key:"showUIEnterAnim",value:function(e){var t=this;return this.node.emit("enter-game"),this.node.getComponent(G).showEnterAnim().then((function(){return t.node.getComponent(P).showEnterAnim()})).then((function(){return t.showButtonUIEnter()})).then((function(){e&&e()}))}},{key:"showButtonUIEnter",value:function(){var e=this;return new Promise((function(t,o){for(var n=[e.enemyInfoButton,e.towerInfoButton],i=I.getVisibleSize().width,r=[],s=function(e,t){return new Promise((function(o,n){var r=0===t?-1:1,s=new y(e);s.to(.4,{position:m(120*-r+.5*i*r,0,0)}),s.call((function(){console.log("进场结束"),o()})),s.start()}))},a=0;a<n.length;a++){var l=n[a];r.push(s(l,a))}Promise.all(r).then((function(){t()}))}))}},{key:"setUINodeTo3dPos",value:function(e,t){var o;o=this.cameraNode.getComponent(C).convertToUINode(t.position,this.node),e.setPosition(o)}},{key:"onButtonClick",value:function(e,t){switch(console.log("on button click",t),N("GameController").emit("player-button-click-audio"),t){case"start-game":console.log("event",e),e.target.destroy(),k.getInstance().getGameCtlNode().emit("player-click-game")}}},{key:"setHoldSkillIcon",value:function(e){this.isHoldSkillIcon=e}},{key:"showBossIconAnim",value:function(){var e=this;return new Promise((function(t,o){var n=new b;n.addComponent(B).spriteFrame=e.bossIcon,n.parent=e.node;var i=new y(n);i.set({scale:m(2,2,2),position:m(0,240,0)}),i.to(.2,{scale:m(1,1,1)},{easing:"backIn"}),i.delay(.8),i.hide(),i.call((function(){n.destroy(),t()})),i.start()}))}}]),t}(_)).prototype,"buildTowerPrefab",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=o(q.prototype,"updateMenuPrefab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=o(q.prototype,"gameConfigJsonAsset",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=o(q.prototype,"cameraNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=o(q.prototype,"enemyInfoButton",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=o(q.prototype,"towerInfoButton",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=o(q.prototype,"bossIcon",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=o(q.prototype,"gameResultPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=o(q.prototype,"currentLevelLabelIcon",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=o(q.prototype,"towerInfoLayer",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=o(q.prototype,"bossHealthBar",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=o(q.prototype,"buildTowerMenuLayer",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=q))||Z)),d._RF.pop()}}}));

System.register("chunks:///UI/WeaponUpdateCellPrefab.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","../BaseObject.js","../util/Tool.js"],(function(e,t){var o,n,i,r,a,l,c,u,s,p,d,v,g,h,f,m,b,y,C,I,w,L,_,k,F,A,B,N,G,D,S,U,P,T,W,z,R,j,x,K,O,H,E,M,q,J,Q;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass,s=e.get},function(e){p=e.cclegacy,d=e._decorator,v=e.Node,g=e.SpriteFrame,h=e.loader,f=e.SpriteComponent,m=e.LabelComponent,b=e.find},function(e){y=e.GameInstance},function(e){C=e.BaseObject},function(e){I=e.Tool}],execute:function(){p._RF.push({},"a6c70AbEx1NLpumxgHfrO6e","WeaponUpdateCellPrefab",void 0),J=d.ccclass,Q=d.property,e("WeaponUpdateCellPrefab",(w=J("WeaponUpdateCellPrefab"),L=Q({type:v}),_=Q({type:v}),k=Q({type:v}),F=Q({type:v}),A=Q({type:g}),B=Q({type:g}),N=Q({type:v}),G=Q({type:g}),D=Q({type:g}),S=Q({type:v}),U=Q({type:v}),w((W=o((T=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,u=new Array(n),s=0;s<n;s++)u[s]=arguments[s];return o=r(this,(e=a(t)).call.apply(e,[this].concat(u))),l(o,"currentDamageLabel",W,c(o)),l(o,"addDamageLabel",z,c(o)),l(o,"costGoldLabel",R,c(o)),l(o,"weaponIconNode",j,c(o)),l(o,"updateButtonSpriteFrameGray",x,c(o)),l(o,"updateButtonSpriteFrameGreen",K,c(o)),l(o,"updateButtonNode",O,c(o)),l(o,"activeButtonSpriteFrameGray",H,c(o)),l(o,"activeButtonSpriteFrameLight",E,c(o)),l(o,"duidiAttackIcon",M,c(o)),l(o,"duikonngAttackIcon",q,c(o)),o.currentChooseRate=0,o.weaponInfoCtl=null,o}return n(t,e),u(t,[{key:"start",value:function(){}},{key:"updateChooseRate",value:function(e){this.currentChooseRate=e,this.referUILabel()}},{key:"setData",value:function(e,o,n){var i=this;console.log("初始化数据",e),this.weaponInfoCtl=n,y.getInstance().getGameCtlNode().on("update-gold-label",(function(){i.referUILabel()}));var r=e.TowerType;this.objectType=r,s(a(t.prototype),"init",this).call(this,o),e.isActive&&this.showWeaponIcon(),this.referUILabel()}},{key:"showWeaponIcon",value:function(){var e=this,t=this.getIconSprteFrame();h.loadRes(t+"/spriteFrame",g,(function(t,o){t||(e.weaponIconNode.getComponent(f).spriteFrame=o),console.log("err",t)}))}},{key:"referUILabel",value:function(){for(var e=this.getWeaponIsActive(),t=y.getInstance().getPlayerData().getPowerCount(),o=this.getCanAttackMoveTypeList(),n=0;n<o.length;n++)"Walk"===o[n]&&(this.duidiAttackIcon.active=!0),"Fly"===o[n]&&(this.duikonngAttackIcon.active=!0);if(!e){var i=y.getInstance().getPlayerData().getFirstNeedToActiveTowerIndex(),r=this.getActiveCostGoldCount();return this.costGoldLabel.getComponent(m).string=I.convertNumToK(r),void(i===this.towerIndexType&&r<=t?this.updateButtonNode.getComponent(f).spriteFrame=this.activeButtonSpriteFrameLight:this.updateButtonNode.getComponent(f).spriteFrame=this.activeButtonSpriteFrameGray)}var a=this.getUpdateLocalLevelCost();this.currentDamageLabel.getComponent(m).string=I.convertNumToK(this.getCurrentAttackNum()),this.costGoldLabel.getComponent(m).string=I.convertNumToK(a),this.addDamageLabel.getComponent(m).string="+"+I.convertNumToK(this.getNextLocallevelAddDamage()),this.updateButtonNode.getComponent(f).spriteFrame=t<a?this.updateButtonSpriteFrameGray:this.updateButtonSpriteFrameGreen}},{key:"onButtonClick",value:function(e,t){switch(b("GameController").emit("player-button-click-audio"),t){case"update-button":console.log("升级按钮");var o=this.getWeaponIsActive(),n=y.getInstance().getPlayerData().getPowerCount();if(o){var i=this.getUpdateLocalLevelCost();i<=n&&(this.updateLocalLevel(this.currentChooseRate),y.getInstance().addPowerCount(-i),this.referUILabel())}else{var r=this.getActiveCostGoldCount();r<=n&&(this.activeWeapon(),y.getInstance().addPowerCount(-r),this.referUILabel(),this.showWeaponIcon(),this.weaponInfoCtl.node.emit("refer-current-tower-menu-ui"),this.weaponInfoCtl.weaponActived(this.node))}this.getWeaponIsActive()&&this.weaponInfoCtl.node.emit("refer-tower-info",this);break;case"WeaponBg":this.getWeaponIsActive()&&this.weaponInfoCtl.node.emit("show-tower-info",this)}}},{key:"getUpdateLocalLevelCost",value:function(){var e=s(a(t.prototype),"getUpdateLocalLevelCost",this).call(this);return e*=this.currentChooseRate}},{key:"getNextLocallevelAddDamage",value:function(){var e=s(a(t.prototype),"getNextLocallevelAddDamage",this).call(this);return e*=this.currentChooseRate}}]),t}(C)).prototype,"currentDamageLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(T.prototype,"addDamageLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(T.prototype,"costGoldLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(T.prototype,"weaponIconNode",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(T.prototype,"updateButtonSpriteFrameGray",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(T.prototype,"updateButtonSpriteFrameGreen",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(T.prototype,"updateButtonNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(T.prototype,"activeButtonSpriteFrameGray",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=o(T.prototype,"activeButtonSpriteFrameLight",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(T.prototype,"duidiAttackIcon",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(T.prototype,"duikonngAttackIcon",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=T))||P)),p._RF.pop()}}}));

System.register("chunks:///UI/WeaponInfoCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","./InfoLayerCtlBase.js","../util/Tool.js","./WeaponUpdateCellPrefab.js"],(function(e,t){var o,n,r,a,i,l,d,u,s,c,p,C,g,f,h,b,v,y,m,w,I,R,_,P,H,L,N,D,B,z,k,A,G,W,F,T,S,U,j,J,K,O,x,V,q,E,M,Q,X,Y,Z,$;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,d=e.assertThisInitialized,u=e.createClass,s=e.get},function(e){c=e.cclegacy,p=e._decorator,C=e.Prefab,g=e.Node,f=e.SpriteFrame,h=e.JsonAsset,b=e.LabelComponent,v=e.SpriteComponent,y=e.instantiate,m=e.v3,w=e.find,I=e.isValid},function(e){R=e.GameInstance},function(e){_=e.InfoLayerCtlBase},function(e){P=e.Tool},function(e){H=e.WeaponUpdateCellPrefab}],execute:function(){c._RF.push({},"4185fepR9NDl6TuAmrhxLTe","WeaponInfoCtl",void 0),Z=p.ccclass,$=p.property,e("WeaponInfoCtl",(L=Z("WeaponInfoCtl"),N=$({type:C}),D=$({type:g}),B=$({type:g}),z=$({type:g}),k=$({type:f}),A=$({type:f}),G=$({type:g}),W=$({type:g}),F=$({type:g}),T=$({type:g}),S=$({type:h}),L((J=o((j=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,u=new Array(n),s=0;s<n;s++)u[s]=arguments[s];return o=a(this,(e=i(t)).call.apply(e,[this].concat(u))),l(o,"updateWeaponInfoCellPrefab",J,d(o)),l(o,"weaponCellParentNode",K,d(o)),l(o,"currentInitRedHeartCountLabel",O,d(o)),l(o,"addRedHeartCostGoldCount",x,d(o)),l(o,"addRedHeartButtonSpriteFrameLight",V,d(o)),l(o,"addRedHeartButtonSpriteFrameGray",q,d(o)),l(o,"addRedHeartButton",E,d(o)),l(o,"chooseAddRedHeartCountLabel",M,d(o)),l(o,"scrollviewNode",Q,d(o)),o.weaponIndoCellNodeList=[],l(o,"currentPowerLabel",X,d(o)),l(o,"gameConfigJsonAsset",Y,d(o)),o.currentChooseRate=0,o}return n(t,e),u(t,[{key:"start",value:function(){var e=this;s(i(t.prototype),"start",this).call(this),this.node.on("refer-choose-rate-cost",(function(t){console.log("刷新当前选择的倍数",t),console.log("weapon indo cell node list",e.weaponIndoCellNodeList);for(var o=0;o<e.weaponIndoCellNodeList.length;o++){e.weaponIndoCellNodeList[o].getComponent(H).updateChooseRate(t)}e.currentChooseRate=t,e.referCurrentRedHeartCountUI()})),this.node.on("refer-current-power-label",(function(t){e.currentPowerLabel.getComponent(b).string=P.convertNumToK(t),e.referCurrentRedHeartCountUI();for(var o=0;o<e.weaponIndoCellNodeList.length;o++){e.weaponIndoCellNodeList[o].getComponent(H).referUILabel()}})),this.initWeaponData()}},{key:"referCurrentRedHeartCountUI",value:function(){var e=R.getInstance().getPlayerData().getAddOneRedHeartCostGoldCount()*this.currentChooseRate;this.addRedHeartCostGoldCount.getComponent(b).string=P.convertNumToK(e);var t=R.getInstance().getPlayerData().getPowerCount();console.log("cost",e),this.addRedHeartButton.getComponent(v).spriteFrame=t<e?this.addRedHeartButtonSpriteFrameGray:this.addRedHeartButtonSpriteFrameLight,this.currentInitRedHeartCountLabel.getComponent(b).string=R.getInstance().getPlayerData().getCurrentInitRedHeartCount()+"",this.chooseAddRedHeartCountLabel.getComponent(b).string="+"+P.convertNumToK(this.currentChooseRate),this.currentPowerLabel.getComponent(b).string=P.convertNumToK(R.getInstance().getPlayerData().getPowerCount())}},{key:"initWeaponData",value:function(){for(var e=this,t=R.getInstance().getPlayerData().getCurrentTowersLocalLevelData(),o=0;o<t.length;o++){var n=t[o],r=y(this.updateWeaponInfoCellPrefab);r.parent=this.weaponCellParentNode,r.getComponent(H).setData(n,this.gameConfigJsonAsset.json,this),r.position=m(0,-o*(r.height+10)-.5*(r.height+10)-5,0),this.weaponCellParentNode.height=-1*r.position.y+.5*r.height+10,this.weaponIndoCellNodeList.push(r)}R.getInstance().getGameCtlNode().on("update-gold-label",(function(){e.referCurrentRedHeartCountUI()}))}},{key:"onButtonClick",value:function(e,o){switch(s(i(t.prototype),"onButtonClick",this).call(this,e,o),w("GameController").emit("player-button-click-audio"),o){case"add-heart-button":var n=R.getInstance().getPlayerData().getPowerCount(),r=R.getInstance().getPlayerData().getAddOneRedHeartCostGoldCount()*this.currentChooseRate;n<r?this.node.emit("gold-not-enough"):(R.getInstance().addPowerCount(-r),R.getInstance().getPlayerData().addLocalInitRedHeartCount(this.currentChooseRate),this.node.emit("refer-red-heart-label")),this.referCurrentRedHeartCountUI();break;case"bg-node-click":this.node.emit("close-tower-info-layer")}}},{key:"weaponActived",value:function(e){var t=e.position.y;I(this.scrollviewNode)&&console.log("scrollview pos",t)}}]),t}(_)).prototype,"updateWeaponInfoCellPrefab",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(j.prototype,"weaponCellParentNode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(j.prototype,"currentInitRedHeartCountLabel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(j.prototype,"addRedHeartCostGoldCount",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(j.prototype,"addRedHeartButtonSpriteFrameLight",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(j.prototype,"addRedHeartButtonSpriteFrameGray",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=o(j.prototype,"addRedHeartButton",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(j.prototype,"chooseAddRedHeartCountLabel",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=o(j.prototype,"scrollviewNode",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=o(j.prototype,"currentPowerLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=o(j.prototype,"gameConfigJsonAsset",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=j))||U)),c._RF.pop()}}}));

System.register("chunks:///UI/道具/KuangBaoSkill.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(t,e){var n,c,s,i,o,u,l,r,a,p;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,c=t.classCallCheck,s=t.possibleConstructorReturn,i=t.getPrototypeOf},function(t){o=t.cclegacy,u=t._decorator},function(t){l=t.BaseObject}],execute:function(){o._RF.push({},"137d7fAtX1CO423/GncRui3","KuangBaoSkill",void 0),p=u.ccclass,u.property,t("KuangBaoSkill",(r=p("KuangBaoSkill"),r(a=function(t){function e(){return c(this,e),s(this,i(e).apply(this,arguments))}return n(e,t),e}(l))||a)),o._RF.pop()}}}));

System.register("chunks:///UI/道具/TreePrefab.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,r){var t,s,c,n,o,a,i,u,l,p,f;return e({_dec:void 0,_class:void 0}),{setters:[function(e){t=e.inherits,s=e.createClass,c=e.classCallCheck,n=e.possibleConstructorReturn,o=e.getPrototypeOf},function(e){a=e.cclegacy,i=e._decorator,u=e.Component}],execute:function(){a._RF.push({},"8a25dMpKeVPN5lsW6oWiwua","TreePrefab",void 0),f=i.ccclass,i.property,e("TreePrefab",(l=f("TreePrefab"),l(p=function(e){function r(){return c(this,r),n(this,o(r).apply(this,arguments))}return t(r,e),s(r,[{key:"start",value:function(){}}]),r}(u))||p)),a._RF.pop()}}}));

System.register("chunks:///util/Besize.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var i,s,r,l,a;return{setters:[function(t){i=t.createClass,s=t.classCallCheck},function(t){r=t.cclegacy,l=t._decorator,a=t.v3}],execute:function(){r._RF.push({},"b99e6kbi3NK3Y1RRPBDBTEz","Besize",void 0),l.ccclass,l.property,t("Besize",function(){function t(e,i,r){s(this,t),this.startPos=void 0,this.middlePos=void 0,this.endPos=void 0,this.startPos=e,this.middlePos=i,this.endPos=r}return i(t,[{key:"CalculateCubicBezierPoint",value:function(t,e,i,s){var r=1-t,l=t*t,o=r*r,c=a(e).multiplyScalar(o);return c=a(c).add(a(i).multiplyScalar(2*r*t)),c=a(c).add(s.multiplyScalar(l))}},{key:"getBesizePointList",value:function(t){for(var e=[],i=0;i<t;i++){var s=i/t,r=this.CalculateCubicBezierPoint(s,this.startPos,this.middlePos,this.endPos);e.push(r)}return e}}]),t}()),r._RF.pop()}}}));

System.register("chunks:///UI/GuideCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameInstance.js","../util/State.js"],(function(e,t){var n,i,o,r,s,a,u,c,l,d,g,p,f,h,v,y,C,m,w,_,I,b,G,k,S,A,P;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,i=e.inherits,o=e.classCallCheck,r=e.possibleConstructorReturn,s=e.getPrototypeOf,a=e.initializerDefineProperty,u=e.assertThisInitialized,c=e.createClass},function(e){l=e.cclegacy,d=e._decorator,g=e.Node,p=e.JsonAsset,f=e.UITransformComponent,h=e.Tween,v=e.v3,y=e.Component},function(e){C=e.GameInstance},function(e){m=e.State}],execute:function(){l._RF.push({},"d0053QZKoxNv4NvDDstfYlR","GuideCtl",void 0),A=d.ccclass,P=d.property,e("GuideCtl",(w=A("GuideCtl"),_=P({type:g}),I=P({type:p}),w((k=n((G=function(e){function t(){var e,n;o(this,t);for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return n=r(this,(e=s(t)).call.apply(e,[this].concat(c))),a(n,"guideLayer",k,u(n)),a(n,"guideConfigJsonAsset",S,u(n)),n.currentGuideIndex=1,n.guideCompleteCb=null,n.state=new m,n}return i(t,e),c(t,[{key:"start",value:function(){}},{key:"onLoad",value:function(){var e=this;this.node.on("show-guide",(function(t){var n="Step_"+e.currentGuideIndex;e.guideConfigJsonAsset.json[n]?C.getInstance().getPlayerData().getIsShowGuide(n)?t&&t():(e.guideCompleteCb=t,e.showMaskAnim(n)):t&&t();e.state.setState("show-guide")})),this.node.on("complete-current-guide",(function(){if("show-guide"===e.state.getState()){e.state.setState("over-guide");var t="Step_"+e.currentGuideIndex;C.getInstance().getPlayerData().setIsShowGuide(t),e.currentGuideIndex++,e.hideMaskAnim().then((function(){console.log("引导操作完成"),e.guideCompleteCb&&(console.log("存在回调"),e.guideCompleteCb())}))}}))}},{key:"hideMaskAnim",value:function(){var e=this;return new Promise((function(t,n){var i=e.guideLayer.getComponent(f),o=new h(i);o.to(.4,{width:2200,height:2200}),o.call((function(){t()})),o.start()}))}},{key:"showMaskAnim",value:function(e){var t=this;return new Promise((function(n,i){var o=t.guideConfigJsonAsset.json[e];console.log("guide data",o);var r=o.Size,s=o.MaskPos,a=o.Time;t.guideLayer.active=!0;var u=t.guideLayer.getComponent(f),c=new h(u);c.to(a,{width:r.width,height:r.height}),c.call((function(){n()})),c.start();var l=new h(t.guideLayer);l.to(a,{position:v(s.x,s.y,s.z)}),l.start()}))}}]),t}(y)).prototype,"guideLayer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=n(G.prototype,"guideConfigJsonAsset",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=G))||b)),l._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../AudioCtl.js","../Data/PlayerData.js","../util/AdsController.js","../GameInstance.js","../BaseObject.js","../BossController.js","../util/State.js","../util/BezierN.js","../util/My2Array.js","../GroundTiled/GroundTiled.js","../GroundMapCtl.js","../util/FindPathWithAStart.js","../Enemys/EnemyBase.js","../Enemys/EnemyBullet.js","../EnemyController.js","../BulletBase.js","../ChooseWeaponInfoRateCtl.js","../Effect/WinGoldAnimEffect.js","../Enemys/EnemyColonyCom.js","../Enemys/EnemyCube.js","../Enemys/WinGold.js","../TowerBuildBase/TowerBuildBase.js","../TowerBuildBaseCtl.js","../Towers/TowerBase.js","../Home/HomeIcon.js","../GameController.js","../SkillComponent/CrazyRotateSkill.js","../UI/AStartFindPath.js","../UI/DialogCtl.js","../UI/EnemyHealthBarCtl.js","../UI/MonsterInfoLayer.js","../UI/EnemyInfoCellPrefab.js","../UI/InfoLayerCtlBase.js","../UI/EnemyInfoLayerCtl.js","../UI/EnterGameAnimCtl.js","../UI/GameWin/GameResultGoldCell.js","../util/Tool.js","../UI/GoldCtl.js","../UI/Menu/MenuUIBase.js","../UI/Menu/BuildTowerUITowerIcon.js","../UI/Menu/BuildTowerMenuUI.js","../UI/Menu/BuildTowerUI.js","../UI/Menu/UpdateTowerUI.js","../UI/ShowGameEndInfoLayer.js","../UI/TouchScreenLayer.js","../UI/TowerInfoLayer.js","../UI/typescript.js","../UI/SkillCtl.js","../UI/GameWin/GameWinPrefab.js","../UI/UIController.js","../UI/WeaponUpdateCellPrefab.js","../UI/WeaponInfoCtl.js","../UI/道具/KuangBaoSkill.js","../UI/道具/TreePrefab.js","../util/Besize.js","../UI/GuideCtl.js"],(function(n,t){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/Scripts/AudioCtl.js', 'chunks:///AudioCtl.js');
  r('project:///assets/Scripts/Data/PlayerData.js', 'chunks:///Data/PlayerData.js');
  r('project:///assets/Scripts/util/AdsController.js', 'chunks:///util/AdsController.js');
  r('project:///assets/Scripts/GameInstance.js', 'chunks:///GameInstance.js');
  r('project:///assets/Scripts/BaseObject.js', 'chunks:///BaseObject.js');
  r('project:///assets/Scripts/BossController.js', 'chunks:///BossController.js');
  r('project:///assets/Scripts/util/State.js', 'chunks:///util/State.js');
  r('project:///assets/Scripts/util/BezierN.js', 'chunks:///util/BezierN.js');
  r('project:///assets/Scripts/util/My2Array.js', 'chunks:///util/My2Array.js');
  r('project:///assets/Scripts/GroundTiled/GroundTiled.js', 'chunks:///GroundTiled/GroundTiled.js');
  r('project:///assets/Scripts/GroundMapCtl.js', 'chunks:///GroundMapCtl.js');
  r('project:///assets/Scripts/util/FindPathWithAStart.js', 'chunks:///util/FindPathWithAStart.js');
  r('project:///assets/Scripts/Enemys/EnemyBase.js', 'chunks:///Enemys/EnemyBase.js');
  r('project:///assets/Scripts/Enemys/EnemyBullet.js', 'chunks:///Enemys/EnemyBullet.js');
  r('project:///assets/Scripts/EnemyController.js', 'chunks:///EnemyController.js');
  r('project:///assets/Scripts/BulletBase.js', 'chunks:///BulletBase.js');
  r('project:///assets/Scripts/ChooseWeaponInfoRateCtl.js', 'chunks:///ChooseWeaponInfoRateCtl.js');
  r('project:///assets/Scripts/Effect/WinGoldAnimEffect.js', 'chunks:///Effect/WinGoldAnimEffect.js');
  r('project:///assets/Scripts/Enemys/EnemyColonyCom.js', 'chunks:///Enemys/EnemyColonyCom.js');
  r('project:///assets/Scripts/Enemys/EnemyCube.js', 'chunks:///Enemys/EnemyCube.js');
  r('project:///assets/Scripts/Enemys/WinGold.js', 'chunks:///Enemys/WinGold.js');
  r('project:///assets/Scripts/TowerBuildBase/TowerBuildBase.js', 'chunks:///TowerBuildBase/TowerBuildBase.js');
  r('project:///assets/Scripts/TowerBuildBaseCtl.js', 'chunks:///TowerBuildBaseCtl.js');
  r('project:///assets/Scripts/Towers/TowerBase.js', 'chunks:///Towers/TowerBase.js');
  r('project:///assets/Scripts/Home/HomeIcon.js', 'chunks:///Home/HomeIcon.js');
  r('project:///assets/Scripts/GameController.js', 'chunks:///GameController.js');
  r('project:///assets/Scripts/SkillComponent/CrazyRotateSkill.js', 'chunks:///SkillComponent/CrazyRotateSkill.js');
  r('project:///assets/Scripts/UI/AStartFindPath.js', 'chunks:///UI/AStartFindPath.js');
  r('project:///assets/Scripts/UI/DialogCtl.js', 'chunks:///UI/DialogCtl.js');
  r('project:///assets/Scripts/UI/EnemyHealthBarCtl.js', 'chunks:///UI/EnemyHealthBarCtl.js');
  r('project:///assets/Scripts/UI/MonsterInfoLayer.js', 'chunks:///UI/MonsterInfoLayer.js');
  r('project:///assets/Scripts/UI/EnemyInfoCellPrefab.js', 'chunks:///UI/EnemyInfoCellPrefab.js');
  r('project:///assets/Scripts/UI/InfoLayerCtlBase.js', 'chunks:///UI/InfoLayerCtlBase.js');
  r('project:///assets/Scripts/UI/EnemyInfoLayerCtl.js', 'chunks:///UI/EnemyInfoLayerCtl.js');
  r('project:///assets/Scripts/UI/EnterGameAnimCtl.js', 'chunks:///UI/EnterGameAnimCtl.js');
  r('project:///assets/Scripts/UI/GameWin/GameResultGoldCell.js', 'chunks:///UI/GameWin/GameResultGoldCell.js');
  r('project:///assets/Scripts/util/Tool.js', 'chunks:///util/Tool.js');
  r('project:///assets/Scripts/UI/GoldCtl.js', 'chunks:///UI/GoldCtl.js');
  r('project:///assets/Scripts/UI/Menu/MenuUIBase.js', 'chunks:///UI/Menu/MenuUIBase.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerUITowerIcon.js', 'chunks:///UI/Menu/BuildTowerUITowerIcon.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerMenuUI.js', 'chunks:///UI/Menu/BuildTowerMenuUI.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerUI.js', 'chunks:///UI/Menu/BuildTowerUI.js');
  r('project:///assets/Scripts/UI/Menu/UpdateTowerUI.js', 'chunks:///UI/Menu/UpdateTowerUI.js');
  r('project:///assets/Scripts/UI/ShowGameEndInfoLayer.js', 'chunks:///UI/ShowGameEndInfoLayer.js');
  r('project:///assets/Scripts/UI/TouchScreenLayer.js', 'chunks:///UI/TouchScreenLayer.js');
  r('project:///assets/Scripts/UI/TowerInfoLayer.js', 'chunks:///UI/TowerInfoLayer.js');
  r('project:///assets/Scripts/UI/typescript.js', 'chunks:///UI/typescript.js');
  r('project:///assets/Scripts/UI/SkillCtl.js', 'chunks:///UI/SkillCtl.js');
  r('project:///assets/Scripts/UI/GameWin/GameWinPrefab.js', 'chunks:///UI/GameWin/GameWinPrefab.js');
  r('project:///assets/Scripts/UI/UIController.js', 'chunks:///UI/UIController.js');
  r('project:///assets/Scripts/UI/WeaponUpdateCellPrefab.js', 'chunks:///UI/WeaponUpdateCellPrefab.js');
  r('project:///assets/Scripts/UI/WeaponInfoCtl.js', 'chunks:///UI/WeaponInfoCtl.js');
  r('project:///assets/Scripts/UI/道具/KuangBaoSkill.js', 'chunks:///UI/道具/KuangBaoSkill.js');
  r('project:///assets/Scripts/UI/道具/TreePrefab.js', 'chunks:///UI/道具/TreePrefab.js');
  r('project:///assets/Scripts/util/Besize.js', 'chunks:///util/Besize.js');
  r('project:///assets/Scripts/UI/GuideCtl.js', 'chunks:///UI/GuideCtl.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});