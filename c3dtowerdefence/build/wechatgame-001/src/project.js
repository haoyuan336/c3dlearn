System.register("chunks:///AudioCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(o,i){var n,e,t,a,u,s,l,r,c,d,p,f,h,v,y,g,C,A,m,_,b,M;return o({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(o){n=o.applyDecoratedDescriptor,e=o.inherits,t=o.classCallCheck,a=o.possibleConstructorReturn,u=o.getPrototypeOf,s=o.initializerDefineProperty,l=o.assertThisInitialized,r=o.createClass},function(o){c=o.cclegacy,d=o._decorator,p=o.JsonAsset,f=o.AudioSourceComponent,h=o.loader,v=o.AudioClip,y=o.Component}],execute:function(){c._RF.push({},"7fa36dmnLhPGLldXsNYKbQR","AudioCtl",void 0),b=d.ccclass,M=d.property,o("AudioCtl",(g=b("AudioCtl"),C=M({type:p}),g((_=n((m=function(o){function i(){var o,n;t(this,i);for(var e=arguments.length,r=new Array(e),c=0;c<e;c++)r[c]=arguments[c];return(n=a(this,(o=u(i)).call.apply(o,[this].concat(r)))).audioSourcesCom=null,s(n,"gameConfigJsonAsset",_,l(n)),n.audioMap={},n}return e(i,o),r(i,[{key:"start",value:function(){var o=this;this.audioSourcesCom=this.node.getComponent(f);var i=this.gameConfigJsonAsset.json;for(var n in i){var e=i[n];for(var t in e){var a=e[t];t.indexOf("Audio")>-1&&a&&(this.audioMap[a]=a)}}var u=function(i){h.loadRes("音乐文件/"+i,v,(function(n,e){n?console.log("音频加载失败",n):o.audioMap[i]=e}))};for(var s in this.audioMap)u(this.audioMap[s])}},{key:"onLoad",value:function(){var o=this;this.node.on("play-audio",(function(i,n){console.log("player- audio",i),o.playAudio(i,n)})),this.node.on("player-button-click-audio",(function(){o.playAudio("按钮音效2",(function(){}))})),this.node.on("player-button-click-audio-2",(function(){o.playAudio("按钮音效2",(function(){}))})),this.node.on("play-bg-music",(function(){h.loadRes("音乐文件/背景音效",v,(function(o,i){}))}))}},{key:"playAudio",value:function(o,i){var n=this;console.log("播放音乐文件",o),o?this.audioMap[o]?(console.log("存在此音频，直接播放",o),this.audioMap[o].on("ended",(function(){console.log("音效播放完成"),i&&i()})),this.audioSourcesCom.playOneShot(this.audioMap[o])):h.loadRes("音乐文件/"+o,v,(function(e,t){e?console.log("load audio err",e):(n.audioMap[o]=t,t.on("ended",(function(){i&&i()})),n.audioSourcesCom.playOneShot(t))})):i&&i()}}]),i}(y)).prototype,"gameConfigJsonAsset",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=m))||A)),c._RF.pop()}}}));

System.register("chunks:///BaseObject.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var o,i,n,s,a,r,l,u,c,h,y,p,v,d,T,b,g,m,j,C,k,f,A,L,w,R,S,B;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,s=e.possibleConstructorReturn,a=e.getPrototypeOf,r=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,h=e._decorator,y=e.Node,p=e.CCFloat,v=e.isValid,d=e.v3,T=e.Quat,b=e.Vec3,g=e.Component}],execute:function(){c._RF.push({},"f047fSpjWxIyqfTRsf+Ksl/","BaseObject",void 0),S=h.ccclass,B=h.property,e("BaseObject",(m=S("BaseObject"),j=B({type:""}),C=B({type:y}),k=B({type:p}),m((L=o((A=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return o=s(this,(e=a(t)).call.apply(e,[this].concat(u))),r(o,"objectType",L,l(o)),r(o,"rootNode",w,l(o)),r(o,"animSpeedMulOffset",R,l(o)),o.currentLevel=1,o.baseGasNum=0,o.baseAttackNum=0,o.baseAttackRate=0,o.baseRotateAngle=0,o.rotateSpeed=0,o.baseGoldCount=0,o.buildCost=0,o.shootDuraction=0,o.baseAttackRange=0,o.towerUpdateMaxLevel=0,o.currentGasNum=0,o.moveSpeed=0,o.isCollisionGround=!1,o.leftTime=0,o.gameController=null,o.towerIndexType=0,o.iconSpriteFrame=null,o.activeCostGoldCount=0,o.enemyMoveType="walk",o.canAttackMoveTypeList=[],o.enemyBulletType=0,o.isCollisionDestroy=!1,o.enemyIndexType=0,o.isConlony=!1,o.bulletRecoverTime=0,o.needRecoverBullet=!1,o.attackType="normal",o.healthCount=0,o.objectName="无",o.desString="",o.shootAudio="",o.boomAudio="",o.showAudio="",o.walkAudio="",o.deadAudio="",o.readyAduio="",o}return i(t,e),u(t,[{key:"init",value:function(e,t,o,i,n){n&&(this.objectType=n),console.log("base object type",this.objectType),this.gameController=t,e[this.objectType].BaseGasNum&&(this.baseGasNum=e[this.objectType].BaseGasNum),this.currentGasNum=this.baseGasNum,e[this.objectType].MoveSpeed&&(this.moveSpeed=e[this.objectType].MoveSpeed),e[this.objectType].isCollisionGround&&(this.isCollisionGround=e[this.objectType].isCollisionGround),e[this.objectType].BaseAttackNum&&(this.baseAttackNum=e[this.objectType].BaseAttackNum),e[this.objectType].ShootRate&&(this.baseAttackRate=e[this.objectType].ShootRate,this.shootDuraction=1/this.getCurrentShootRate()),e[this.objectType].BaseRotateAngle&&(this.baseRotateAngle=e[this.objectType].BaseRotateAngle),e[this.objectType].LeftTime&&(this.leftTime=e[this.objectType].LeftTime),e[this.objectType].RotateSpeed&&(this.rotateSpeed=e[this.objectType].RotateSpeed),e[this.objectType].BaseGoldCount&&(this.baseGoldCount=e[this.objectType].BaseGoldCount),e[this.objectType].BuildCost&&(this.buildCost=e[this.objectType].BuildCost),e[this.objectType].AttackRange&&(this.baseAttackRange=e[this.objectType].AttackRange),e.TowerMaxLevel&&(this.towerUpdateMaxLevel=e.TowerMaxLevel),e[this.objectType].Index&&(this.towerIndexType=e[this.objectType].Index),e[this.objectType].IconSprteFrame&&(this.iconSpriteFrame=e[this.objectType].IconSprteFrame),e[this.objectType].ActiveCost&&(this.activeCostGoldCount=e[this.objectType].ActiveCost),e[this.objectType].MoveType&&(this.enemyMoveType=e[this.objectType].MoveType),e[this.objectType].CanAttackType&&(this.canAttackMoveTypeList=e[this.objectType].CanAttackType),e[this.objectType].EnemyBulletType&&(this.enemyBulletType=e[this.objectType].EnemyBulletType),e[this.objectType].isCollisionDestroy&&(this.isCollisionDestroy=e[this.objectType].isCollisionDestroy),e[this.objectType].EnemyIndex&&(this.enemyIndexType=e[this.objectType].EnemyIndex),e[this.objectType].Colony&&(this.isConlony=e[this.objectType].Colony),e[this.objectType].BulletRecoverTime&&(this.bulletRecoverTime=e[this.objectType].BulletRecoverTime),e[this.objectType].AttackType&&(this.attackType=e[this.objectType].AttackType),e[this.objectType].Name&&(this.objectName=e[this.objectType].Name),e[this.objectType].NeedRecoverBullet&&(this.needRecoverBullet=e[this.objectType].NeedRecoverBullet),e[this.objectType].HealthCount&&(this.healthCount=e[this.objectType].HealthCount),e[this.objectType].Des&&(this.desString=e[this.objectType].Des),e[this.objectType].ShootAudio&&(this.shootAudio=e[this.objectType].ShootAudio),e[this.objectType].BoomAudio&&(this.boomAudio=e[this.objectType].BoomAudio),e[this.objectType].ShowAudio&&(this.showAudio=e[this.objectType].ShowAudio),e[this.objectType].WalkAudio&&(this.walkAudio=e[this.objectType].WalkAudio),e[this.objectType].DeadAudio&&(this.deadAudio=e[this.objectType].DeadAudio),e[this.objectType].ReadyAduio&&(this.readyAduio=e[this.objectType].ReadyAduio)}},{key:"getBaseAttackDamage",value:function(){return this.baseAttackNum}},{key:"getCurrentAttackNum",value:function(){var e=this.baseAttackNum;console.log("base damage num",e);var t=1*(this.currentLevel+1)*this.currentLevel*.5;return console.log("current level damage",t),e+t+this.getLocalDamageNum()}},{key:"getLocalDamageNum",value:function(){var e=this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType);console.log("local level",e);var t=(1+e)*e*.5;return console.log(this.objectType+":local damage",t),t}},{key:"getCurrentSkillRotateAngle",value:function(){return this.baseRotateAngle}},{key:"getCurrentShootRate",value:function(){var e=this.baseAttackRate;return console.log("current shoot rate",e),e*=1+this.currentLevel*this.currentLevel*.1,console.log("current shoor rate",e),e>10&&(e=10),e}},{key:"getCurrentGoldCount",value:function(){return this.baseGoldCount}},{key:"getCurrentLevel",value:function(){return this.currentLevel}},{key:"getUpdateCost",value:function(){var e=this.currentLevel+1;return this.buildCost+(1+e)*e*.5}},{key:"getUpdateLocalLevelCost",value:function(){var e=this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType);return console.log("local level",e),Math.round(.5*Math.pow(e+1,2))}},{key:"getNextLocallevelAddDamage",value:function(){return this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType)+1}},{key:"getDestroyCount",value:function(){var e=this.buildCost,t=this.currentLevel;return Math.round(.8*(e+(1+t)*t*.5))}},{key:"updateLevel",value:function(){this.currentLevel++;var e=this.getCurrentShootRate();this.shootDuraction=1/e,console.log("升级之后 的 攻击事件间隔",this.shootDuraction),this.bulletRecoverTime*=1-this.currentLevel*this.currentLevel*.1,this.bulletRecoverTime<.2&&(this.bulletRecoverTime=.2)}},{key:"getCurrentAttackRange",value:function(){var e=this.currentLevel;return this.baseAttackRange*(1+e*(e-.5)*.01)}},{key:"getTowerIsMax",value:function(){return console.log("current level",this.currentLevel),console.log("tower update max level",this.towerUpdateMaxLevel),this.currentLevel>=this.towerUpdateMaxLevel}},{key:"getIconSprteFrame",value:function(){return this.iconSpriteFrame}},{key:"getWeaponIsActive",value:function(){return this.gameController.playerData.getWeaponIsActive(this.towerIndexType)}},{key:"updateLocalLevel",value:function(e){var t=this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType);t+=e,console.log("升级的jishu",e),this.gameController.playerData.updateTowerLocalLevel(this.towerIndexType,t)}},{key:"getActiveCostGoldCount",value:function(){return this.activeCostGoldCount}},{key:"activeWeapon",value:function(){this.gameController.playerData.activeTower(this.towerIndexType)}},{key:"getMoveType",value:function(){return this.enemyMoveType}},{key:"getCanAttackEnemy",value:function(e){if(!v(e))return!1;var o=e.getComponent(t);if(o)for(var i=o.getMoveType(),n=this.canAttackMoveTypeList,s=0;s<n.length;s++){if(n[s]===i)return!0}return!1}},{key:"getCanAttackMoveTypeList",value:function(){return this.canAttackMoveTypeList}},{key:"getIsBoss",value:function(){return this.objectType.indexOf("Boss")>-1}},{key:"getEnemyBulletType",value:function(){return this.enemyBulletType}},{key:"getIsCollisionDestroy",value:function(){return this.isCollisionDestroy}},{key:"getLookAtAngle",value:function(e,t){var o=d(e).subtract(t).normalize(),i=new T;return T.fromViewUp(i,o,b.UP),i}},{key:"getEnemyIsActive",value:function(){return this.gameController.playerData.getEnemyIsActive(this.objectType)}},{key:"getIsShowed",value:function(){return this.gameController.playerData.getIsShowed(this.objectType)}},{key:"setShowed",value:function(){this.gameController.playerData.setShowed(this.objectType)}},{key:"getIsColony",value:function(){return this.isConlony}},{key:"getBulletRecoverTime",value:function(){return this.bulletRecoverTime}},{key:"getMoveSpeed",value:function(){return this.moveSpeed}},{key:"getAttackType",value:function(){return this.attackType}},{key:"getObjectName",value:function(){return this.objectName}},{key:"getAttackSpeedLevel",value:function(){return this.currentLevel}},{key:"getIsNeedRecoverBullet",value:function(){return this.needRecoverBullet}},{key:"getHealthCount",value:function(){return this.healthCount}},{key:"getDesString",value:function(){return this.desString}},{key:"getBoomAudioStr",value:function(){return this.boomAudio}},{key:"getShowAudio",value:function(){return this.showAudio}}]),t}(g)).prototype,"objectType",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"default"}}),w=o(A.prototype,"rootNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(A.prototype,"animSpeedMulOffset",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),f=A))||f)),c._RF.pop()}}}));

System.register("chunks:///BossController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,o){var e,s,r,n,c,l,i,u,a,p,C;return t({_dec:void 0,_class:void 0}),{setters:[function(t){e=t.inherits,s=t.createClass,r=t.classCallCheck,n=t.possibleConstructorReturn,c=t.getPrototypeOf},function(t){l=t.cclegacy,i=t._decorator,u=t.Component}],execute:function(){l._RF.push({},"dcc66ytht5FMYgvOIQcQVvo","BossController",void 0),C=i.ccclass,i.property,t("BossController",(a=C("BossController"),a(p=function(t){function o(){return r(this,o),n(this,c(o).apply(this,arguments))}return e(o,t),s(o,[{key:"start",value:function(){}}]),o}(u))||p)),l._RF.pop()}}}));

System.register("chunks:///util/State.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var a,s,n;return{setters:[function(t){a=t.createClass,s=t.classCallCheck},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"309b9GENMFDhItBZDPdMuEd","State",void 0),t("State",function(){function t(){s(this,t),this.state="",this.handleMap={}}return a(t,[{key:"setState",value:function(t){if(this.state=t,this.handleMap[this.state]){for(var e=this.handleMap[this.state],a=[],s=1;s<arguments.length;s++)a.push(arguments[s]);for(var n=0;n<e.length;n++){var i=e[n];i.apply(this,a)}}}},{key:"getState",value:function(){return this.state}},{key:"addState",value:function(t,e){this.handleMap[t]?this.handleMap[t].push(e):this.handleMap[t]=[e]}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///TowerBuildBase/TowerBuildBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,o){var t,r,i,n,l,a,s,u,d,c,h,f,m,p,g,y,w,v,C,B,b,T,k;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inherits,i=e.classCallCheck,n=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,c=e._decorator,h=e.Node,f=e.find,m=e.CameraComponent,p=e.SkeletalAnimationComponent,g=e.isValid,y=e.Component}],execute:function(){d._RF.push({},"bf2b5yrz6pN7ZEPmB5V4xlb","TowerBuildBase",void 0),T=c.ccclass,k=c.property,e("TowerBuildBase",(w=T("TowerBuildBase"),v=k({type:h}),w((b=t((B=function(e){function o(){var e,t;i(this,o);for(var r=arguments.length,u=new Array(r),d=0;d<r;d++)u[d]=arguments[d];return(t=n(this,(e=l(o)).call.apply(e,[this].concat(u)))).cameraNodeCom=null,t.gameController=null,t.targetTower=null,a(t,"arrowGuide",b,s(t)),t}return r(o,e),u(o,[{key:"onLoad",value:function(){}},{key:"start",value:function(){this.gameController=f("GameController"),this.cameraNodeCom=f("Camera").getComponent(m),this.gameController.on("touch-screen-to-3d",this.touchScreenTo3d.bind(this),this),this.gameController.on("destroy-all-tower-build-base",this.destroyTowerBuildBase.bind(this),this),this.gameController.on("frozen-tower-build-base",this.forzenTowerBuildBase.bind(this),this)}},{key:"forzenTowerBuildBase",value:function(){var e=this.arrowGuide.getComponent(p),o=e.defaultClip;e.getState(o.name).pause()}},{key:"touchScreenTo3d",value:function(e){if(!g(this.targetTower))for(var o=0;o<e.length;o++){var t=e[o];t.collider.node&&t.collider.node.uuid===this.node.uuid&&(console.log("点中了此塔的基座"),this.gameController.emit("touch-base-build-base",this.node),this.gameController.emit("player-button-click-audio-2"))}}},{key:"onDestroy",value:function(){this.gameController.off("destroy-all-tower-build-base",this.destroyTowerBuildBase,this),this.gameController.off("touch-screen-to-3d",this.touchScreenTo3d,this),this.gameController.off("frozen-tower-build-base",this.forzenTowerBuildBase,this)}},{key:"destroyTowerBuildBase",value:function(){this.node.destroy()}},{key:"unSetTargetTower",value:function(e){this.targetTower=void 0,this.node.active=!0}},{key:"setTargetTower",value:function(e){this.targetTower=e,this.node.active=!1}}]),o}(y)).prototype,"arrowGuide",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=B))||C)),d._RF.pop()}}}));

System.register("chunks:///util/BezierN.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,r){var e,n,o,i,l;return{setters:[function(t){e=t.createClass,n=t.classCallCheck},function(t){o=t.cclegacy,i=t._decorator,l=t.v3}],execute:function(){o._RF.push({},"e43e2vpRCtNoZCKx8bvmJ4Z","BezierN",void 0),i.ccclass,i.property,t("BezierN",function(){function t(r){n(this,t),this.controllerPointList=[],this.controllerPointList=r}return e(t,[{key:"getPointList",value:function(t){for(var r=this.controllerPointList.length,e=[1,1],n=3;n<r+1;n++){for(var o=[],i=0;i<e.length;i++)o.push(e[i]);e[0]=1,e[n-1]=1;for(var c=0;c<o.length-1;c++)e[c+1]=o[c]+o[c+1]}for(var s=[],a=0;a<t;a++){for(var u=a/t,h=l(0,0,0),f=0;f<r;f++){var v=r-1-f,p=f,g=e[f]*Math.pow(1-u,v)*Math.pow(u,p);h.add(l(this.controllerPointList[f]).multiplyScalar(g))}s.push(h)}return s}}],[{key:"getPathLength",value:function(t){for(var r=0,e=0;e<t.length;e++){if(0!==e)r+=l(t[e]).subtract(t[e-1]).length()}return r}}]),t}()),o._RF.pop()}}}));

System.register("chunks:///util/My2Array.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,u,i,s;return{setters:[function(t){n=t.createClass,u=t.classCallCheck},function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"5a822YVyJlDnb5+nCIOK0H/","My2Array",void 0),s=function(){function t(){u(this,t),this.numberList=[],this.heightNum=0}return n(t,[{key:"pushValue",value:function(t){this.numberList[this.numberList.length-1].push(t)}},{key:"pushList",value:function(t){this.numberList.push(t)}},{key:"getValue",value:function(t,e){if(!(e<0||t<0))return e>=this.numberList.length?null:t>=this.numberList[e].length?null:this.numberList[e][t]}},{key:"setValue",value:function(t,e,n){this.numberList[t][e]=n}},{key:"getHeightLength",value:function(){return this.numberList.length}},{key:"getWidthLength",value:function(){return this.numberList.length>0?this.numberList[0].length:0}},{key:"getValueWithLieIndex",value:function(t){return this.numberList[t]}},{key:"convertOneSpaceList",value:function(){for(var t=[],e=0;e<this.getHeightLength();e++)for(var n=0;n<this.getWidthLength();n++)t.push(this.numberList[e][n]);return t}}]),t}(),i._RF.pop(),t("default",s)}}}));

System.register("chunks:///GroundTiled/GroundTiled.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js"],(function(t,e){var r,n,s,i,c,a,u,o,l,p,h,d;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){r=t.inherits,n=t.classCallCheck,s=t.possibleConstructorReturn,i=t.getPrototypeOf,c=t.createClass},function(t){a=t.cclegacy,u=t._decorator,o=t.v2},function(t){l=t.BaseObject}],execute:function(){a._RF.push({},"75b72ybo0hO5rMJsDKDP6W5","GroundTiled",void 0),d=u.ccclass,u.property,t("GroundTiled",(p=d("GroundTiled"),p(h=function(t){function e(){var t,r;n(this,e);for(var c=arguments.length,a=new Array(c),u=0;u<c;u++)a[u]=arguments[u];return(r=s(this,(t=i(e)).call.apply(t,[this].concat(a)))).mapX=0,r.mapY=0,r.targetObjectList=[],r}return r(e,t),c(e,[{key:"getIsVoid",value:function(){return 0===this.targetObjectList.length}},{key:"setMapXY",value:function(t,e){this.mapX=t,this.mapY=e}},{key:"getMapXY",value:function(){return o(this.mapX,this.mapY)}},{key:"getTargetObjectList",value:function(){return this.targetObjectList}},{key:"setTargetObject",value:function(t){this.targetObjectList.push(t)}}]),e}(l))||h)),a._RF.pop()}}}));

System.register("chunks:///GroundMapCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/My2Array.js","./GroundTiled/GroundTiled.js"],(function(e,t){var i,r,o,n,a,s,u,d,l,p,h,c,f,v,m,g,y,b,w,M,T,_,C,z,L,P,x,k,H,E,G,N,W,A,I,S;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,r=e.inherits,o=e.classCallCheck,n=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,u=e.assertThisInitialized,d=e.createClass},function(e){l=e.cclegacy,p=e._decorator,h=e.Prefab,c=e.CCInteger,f=e.CCFloat,v=e.instantiate,m=e.v3,g=e.v2,y=e.Tween,b=e.find,w=e.Component},function(e){M=e.default},function(e){T=e.GroundTiled}],execute:function(){l._RF.push({},"44e5akPt5hEHpdS1j2qoO/6","GroundMapCtl",void 0),I=p.ccclass,S=p.property,e("GroundMapCtl",(_=I("GroundMapCtl"),C=S({type:h}),z=S({type:c}),L=S({type:c}),P=S({type:f}),x=S({type:h}),_((E=i((H=function(e){function t(){var e,i;o(this,t);for(var r=arguments.length,d=new Array(r),l=0;l<r;l++)d[l]=arguments[l];return i=n(this,(e=a(t)).call.apply(e,[this].concat(d))),s(i,"groundMapTiledPrefab",E,u(i)),s(i,"mapWidth",G,u(i)),s(i,"mapHeight",N,u(i)),s(i,"tiledSize",W,u(i)),i.mapNodeList=new M,i.obsNodeList=[],s(i,"treePrefab",A,u(i)),i.groundTiledEdageIndexList=[],i}return r(t,e),d(t,[{key:"start",value:function(){for(var e=0;e<this.mapHeight;e++){for(var t=[],i=0;i<this.mapWidth;i++){var r=v(this.groundMapTiledPrefab);r.parent=this.node;var o=m(-.5*(this.mapWidth-1)*this.tiledSize+i*this.tiledSize,-6,-.5*(this.mapHeight-1)*this.tiledSize+e*this.tiledSize);r.setPosition(o),r.active=!1,t.push(r)}this.mapNodeList.pushList(t)}for(var n=[],a=0;a<this.mapWidth;a++)n.push(g(a,0));for(var s=1;s<this.mapHeight;s++)n.push(g(this.mapWidth-1,s));for(var u=this.mapWidth-2;u>=0;u--)n.push(g(u,this.mapHeight-1));for(var d=this.mapHeight-2;d>0;d--)n.push(g(0,d));this.groundTiledEdageIndexList=n}},{key:"getInEdageIndexList",value:function(){return this.groundTiledEdageIndexList}},{key:"showTreeEnterAnim",value:function(e){return console.log("show tree enter anima"),new Promise((function(t,i){e.active=!0,e.scale=m(1,0,1);var r=new y(e);r.to(.2,{scale:m(1,1,1)},{easing:"elasticOut"}),r.call((function(){t()})),r.start()}))}},{key:"showGroundEnterAnim",value:function(){var e=this;return this.showGroundTiledEnterAnim().then((function(){for(var t=0;t<2;){var i=[0,e.mapHeight-1][Math.round(1*Math.random())],r=Math.round(Math.random()*(e.mapWidth-1)),o=e.mapNodeList.getValue(r,i);if(o){e.obsNodeList.push(g(r,i));var n=o;if(n&&n.getComponent(T)){var a=n.getComponent(T);if(a.getIsVoid()){var s=v(e.treePrefab);s.parent=e.node,a.setTargetObject(s),s.active=!1,s.position=m(n.position.x,0,n.position.z),e.showTreeEnterAnim(s),t++}}}}}))}},{key:"setTowerBuildBaseOnTiled",value:function(e,t,i){var r=this.mapNodeList.getValue(t,i);if(r){this.obsNodeList.push(g(t,i));var o=r;o&&o.getComponent(T)&&o.getComponent(T).setTargetObject(e)}}},{key:"showGroundTiledEnterAnim",value:function(){for(var e=g(Math.floor(this.mapWidth/2),Math.floor(this.mapHeight/2)+1),t=0,i=g(0,-1),r=1,o=0,n=0,a=[];e.x<=this.mapWidth+1&&e.y<=this.mapHeight+1&&e.x>=0&&e.y>=0;){for(var s=0;s<r;){s++;var u=this.mapNodeList.getValue(e.x,e.y);if(u){var d=u;d&&(a.push(this.showEnterAnim(d,n)),n++)}e.add(i)}var l=2*Math.PI/4*t;(i=g(0,1).rotate(l).normalize()).x=i.x<0&&Math.abs(i.x)<1?0:Math.floor(i.x),i.y=i.y<0&&Math.abs(i.y)<1?0:Math.floor(i.y),2==o&&(o=0,r++),o++,t++}return Promise.all(a)}},{key:"showEnterAnim",value:function(e,t){return new Promise((function(i,r){var o=new y(e),n=e.position;o.delay(.03*t),o.call((function(){e.active=!0,t%3==0&&b("GameController").emit("play-audio","drop")})),o.to(.4,{position:m(n.x,0,n.z)},{easing:"elasticOut"}),o.call((function(){i()})),o.start()}))}},{key:"getMapNodeList",value:function(){return this.mapNodeList}},{key:"getObsPosList",value:function(){return this.obsNodeList}},{key:"getMapSize",value:function(){return g(this.mapWidth,this.mapHeight)}}]),t}(w)).prototype,"groundMapTiledPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=i(H.prototype,"mapWidth",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),N=i(H.prototype,"mapHeight",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),W=i(H.prototype,"tiledSize",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),A=i(H.prototype,"treePrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=H))||k)),l._RF.pop()}}}));

System.register("chunks:///util/FindPathWithAStart.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./My2Array.js"],(function(t,e){var s,i,n,a,h;return{setters:[function(t){s=t.createClass,i=t.classCallCheck},function(t){n=t.cclegacy},function(t){a=t.default}],execute:function(){n._RF.push({},"9bae92/Z1FGnZ8sEkxwZFcp","FindPathWithAStart",void 0),h=function(){function t(e,s){i(this,t),this.x=0,this.y=0,this.isHaveObs=!1,this.gValue=0,this.hValue=0,this.parent=null,this.x=e,this.y=s}return s(t,[{key:"setParent",value:function(t){this.parent=t}},{key:"getFValue",value:function(){return this.gValue+this.hValue}},{key:"setObs",value:function(t){this.isHaveObs=t}}]),t}(),t("FindPathWithAStart",function(){function t(e,s,n){i(this,t),this.openList=[],this.closeList=[],this.mapNodeList=new a,this.statrNode=null,this.endNode=null;for(var r=e.getHeightLength(),u=e.getWidthLength(),o=0;o<r;o++){for(var l=new Array,c=0;c<u;c++)l.push(new h(c,o));this.mapNodeList.pushList(l)}this.statrNode=this.mapNodeList.getValue(s[0],s[1]),this.endNode=this.mapNodeList.getValue(n[0],n[1])}return s(t,[{key:"findPathList",value:function(){var t=[];for(this.openList.push(this.statrNode);this.openList.length>0;){var e=this.findMinFvalueNode(this.openList),s=this.openList.splice(e,1)[0];if(s.x===this.endNode.x&&s.y===this.endNode.y){var i=s.parent;for(t.push(s);i.x!==this.statrNode.x||i.y!==this.statrNode.y;)t.push(i),i=i.parent;break}this.closeList.push(s);for(var n=this.findNearbyNodeList(s,this.mapNodeList),a=0;a<n.length;a++){var h=n[a];this.checkIsInList(h,this.closeList)||(this.checkIsInList(h,this.openList)?h.parent.gValue<s.gValue&&(h.setParent(s),h.gValue=s.gValue+this.getDistance(h.parent,h),h.hValue=this.getDistance(h,this.endNode)):(h.setParent(s),h.gValue=s.gValue+this.getDistance(h.parent,h),h.hValue=this.getDistance(h,this.endNode),this.openList.push(h)))}}t=t.reverse();for(var r=[],u=0;u<t.length;u++)r.push([t[u].x,t[u].y]);return r}},{key:"getDistance",value:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"findNearbyNodeList",value:function(t,e){for(var s=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],i=[],n=0;n<s.length;n++){var a=s[n],h=t.x+a[0],r=t.y+a[1],u=e.getValue(h,r);u&&!u.isHaveObs&&i.push(u)}return i}},{key:"findMinFvalueNode",value:function(t){for(var e=Number.MAX_VALUE,s=null,i=0;i<t.length;i++){var n=t[i].getFValue();n<e&&(e=n,s=i)}return s}},{key:"checkIsInList",value:function(t,e){for(var s=0;s<e.length;s++){var i=e[s];if(i.x===t.x&&i.y===t.y)return!0}return!1}},{key:"updateObsData",value:function(t){for(var e=0;e<t.length;e++){var s=t[e];this.mapNodeList.getValue(s[0],s[1]).setObs(!0)}}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///UI/SkillCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js","../Towers/TowerBase.js","./UIController.js","../GameController.js"],(function(e,o){var t,i,n,r,l,s,a,c,u,d,p,v,f,h,k,m,g,y,C,w,b,_,N,T,S,P,R,B,z,I,L,E,U,F,x,A,D,j,H,O,G,V,J,M,W,Y,Z,q,K,Q,X,$;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,d=e._decorator,p=e.Prefab,v=e.SpriteFrame,f=e.Node,h=e.CCInteger,k=e.view,m=e.v3,g=e.find,y=e.CameraComponent,C=e.UITransformComponent,w=e.Tween,b=e.isValid,_=e.instantiate,N=e.Component},function(e){T=e.State},function(e){S=e.TowerBase},function(e){P=e.UIController},function(e){R=e.GameController}],execute:function(){u._RF.push({},"40520LpyUZJx6EmYjb+U/Iw","SkillCtl",void 0),X=d.ccclass,$=d.property,e("SkillCtl",(B=X("SkillCtl"),z=$({type:p}),I=$({type:v}),L=$({type:v}),E=$({type:f}),U=$({type:h}),F=$({type:f}),x=$({type:f}),A=$({type:f}),D=$({type:p}),j=$({type:f}),B((G=t((O=function(e){function o(){var e,t;n(this,o);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return t=r(this,(e=l(o)).call.apply(e,[this].concat(c))),s(t,"狂暴道具Prefab",G,a(t)),s(t,"狂暴道具SpriteFrameRed",V,a(t)),s(t,"狂暴道具SpriteFrameGray",J,a(t)),s(t,"skillsNode",M,a(t)),s(t,"currentSkillCount",W,a(t)),s(t,"skillRedBgList",Y,a(t)),s(t,"skillButtonNode",Z,a(t)),t.skillNodeList=[],t.currentTouchNode=null,t.cameraNodeCom=null,t.gameController=null,t.timeoutResolve=void 0,t.rayCheckResolve=void 0,t.targetTower=void 0,t.currentSkillPower=0,s(t,"skillPowerFullEffect",q,a(t)),t.state=new T,s(t,"addPowerAnim3dPrefab",K,a(t)),s(t,"skillDouIcon",Q,a(t)),t}return i(o,e),c(o,[{key:"onLoad",value:function(){}},{key:"start",value:function(){var e=this,o=k.getVisibleSize().width;this.skillButtonNode.position=m(.5*o+100,this.skillButtonNode.position.y,this.skillButtonNode.position.z),this.gameController=g("GameController").getComponent(R),this.gameController.node.on("touch-screen-to-3d",(function(o){for(var t=0;t<o.length;t++){var i=o[t];if(i.collider&&i.collider.node&&i.collider.node.getComponent(S)&&e.rayCheckResolve){e.targetTower=i.collider.node,e.rayCheckResolve("check-succ"),e.rayCheckResolve=void 0;break}}})),this.cameraNodeCom=g("Camera").getComponent(y),this.node.on(f.EventType.TOUCH_START,(function(o){console.log("touch start",o);var t=e.skillDouIcon.getComponent(C).getBoundingBoxToWorld(),i=o.getUILocation();t.contains(i)&&(console.log("点中了 技能点"),e.currentTouchNode=e.skillDouIcon,e.startCheckSkillNode(),e.node.getComponent(P).setHoldSkillIcon(!0))})),this.node.on(f.EventType.TOUCH_MOVE,(function(o){if(e.currentTouchNode){var t=o.getUILocation(),i=e.node.getComponent(C).convertToNodeSpaceAR(m(t.x,t.y,0));e.currentTouchNode.position=m(i.x,i.y,0)}})),this.node.on(f.EventType.TOUCH_END,(function(o){e.currentTouchNode&&(console.log("释放"),e.scheduleOnce((function(){e.node.getComponent(P).setHoldSkillIcon(!1),e.timeoutResolve&&(e.timeoutResolve("timeout"),e.timeoutResolve=void 0)}),.1))}))}},{key:"startCheckSkillNode",value:function(){var e=this,o=[new Promise((function(o,t){e.rayCheckResolve=o})),new Promise((function(o,t){e.timeoutResolve=o}))];Promise.race(o).then((function(o){if("timeout"===o){console.log("超市了");var t=new w(e.currentTouchNode);t.to(.2,{position:e.skillButtonNode.position}),t.call((function(){e.currentTouchNode=void 0})),t.start()}else if(console.log("释放技能成功"),b(e.targetTower)){console.log("给目标塔发送消息，释放技能"),e.targetTower.getComponent(S).releaseSkill(),e.currentTouchNode.active=!1,e.currentTouchNode.position=e.skillButtonNode.position,e.skillPowerFullEffect.active=!1,e.currentSkillPower=0;for(var i=0;i<e.skillRedBgList.length;i++){var n=e.skillRedBgList[i];n.position=m(n.position.x,-80,n.position.z)}e.currentTouchNode=void 0}}))}},{key:"showEnterAnim",value:function(){var e=this;return new Promise((function(o,t){var i=k.getVisibleSize(),n=i.height;console.log("height",n);var r=new w(e.skillButtonNode);r.to(.2,{position:m(.5*i.width-110,e.skillButtonNode.position.y,e.skillButtonNode.position.z)}),r.call((function(){o(),e.state.setState("run")})),r.start()}))}},{key:"addSkillPower",value:function(e){this.gameController.playerData.addPowerCount(e)}},{key:"showAddPowerAnimEffect",value:function(e,o){var t=this,i=_(this.addPowerAnim3dPrefab);i.parent=this.gameController.node,i.position=o;var n=new w(i);n.by(.4,{position:m(0,5,0)}),n.delay(.6),n.to(.6,{position:m(45,30,0)}),n.call((function(){i.destroy(),t.addSkillPower(e)})),n.start()}},{key:"update",value:function(e){if("run"===this.state.getState())for(var o=0;o<this.skillRedBgList.length;o++){var t=this.skillRedBgList[o];if(t.position=m(t.position.x+20*e,t.position.y,t.position.z),t.position.x>153){var i=0===o?1:0,n=this.skillRedBgList[i];t.position=m(n.position.x-152,n.position.y,n.position.z)}}}}]),o}(N)).prototype,"狂暴道具Prefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(O.prototype,"狂暴道具SpriteFrameRed",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(O.prototype,"狂暴道具SpriteFrameGray",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(O.prototype,"skillsNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(O.prototype,"currentSkillCount",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Y=t(O.prototype,"skillRedBgList",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Z=t(O.prototype,"skillButtonNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(O.prototype,"skillPowerFullEffect",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(O.prototype,"addPowerAnim3dPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(O.prototype,"skillDouIcon",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=O))||H)),u._RF.pop()}}}));

System.register("chunks:///Towers/TowerBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../util/State.js","../TowerBuildBase/TowerBuildBase.js","../UI/SkillCtl.js","../Enemys/EnemyBase.js","../EnemyController.js","../GameController.js","../BulletBase.js"],(function(t,e){var o,n,i,r,a,s,l,u,c,d,h,g,m,f,p,y,v,k,C,A,T,w,S,B,b,E,N,R,P,D,O,z,_,x,L,I,j,G,M,F,U,V,H,Q,W,q;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inherits,i=t.classCallCheck,r=t.possibleConstructorReturn,a=t.getPrototypeOf,s=t.initializerDefineProperty,l=t.assertThisInitialized,u=t.createClass,c=t.get},function(t){d=t.cclegacy,h=t._decorator,g=t.Prefab,m=t.Node,f=t.CCFloat,p=t.v3,y=t.find,v=t.SkeletalAnimationComponent,k=t.isValid,C=t.Tween,A=t.instantiate,T=t.Vec3,w=t.v2,S=t.Quat},function(t){B=t.BaseObject},function(t){b=t.State},function(t){E=t.TowerBuildBase},function(t){N=t.SkillCtl},function(t){R=t.EnemyBase},function(t){P=t.EnemyController},function(t){D=t.GameController},function(t){O=t.BulletBase}],execute:function(){d._RF.push({},"93965WLO/1GpoRxL0uoTS9a","TowerBase",void 0),W=h.ccclass,q=h.property,t("TowerBase",(z=W("TowerBase"),_=q({type:g}),x=q({type:m}),L=q({type:m}),I=q({type:f}),j=q({type:m}),z((F=o((M=function(t){function e(){var t,o;i(this,e);for(var n=arguments.length,u=new Array(n),c=0;c<n;c++)u[c]=arguments[c];return(o=r(this,(t=a(e)).call.apply(t,[this].concat(u)))).state=new b,o.currentTargetEnemy=null,o.currentShootTime=0,s(o,"bulletPrefab",F,l(o)),s(o,"bulletStartPosList",U,l(o)),s(o,"weaponBaseNode",V,l(o)),o.currentShootDiraction=p(0,0,0),o.gameConfig=null,s(o,"attackAnimEventTimeOffset",H,l(o)),o.towerBuildBase=null,s(o,"attackRangeNode",Q,l(o)),o.skillCtl=null,o.currentShootBulletIndex=0,o.isShooting=!1,o}return n(e,t),u(e,[{key:"init",value:function(t,o){c(a(e.prototype),"init",this).call(this,t,o),this.skillCtl=y("Canvas").getComponent(N),this.gameConfig=t,console.log("tower base init"),this.node.emit("init",t,o)}},{key:"start",value:function(){var t=this;console.log("tower base start"),this.state.setState("run"),this.gameController=y("GameController").getComponent(D),this.gameController.node.on("touch-screen-to-3d",this.touchScreenTo3d.bind(this),this),this.gameController.node.on("destroy-all-tower",this.destroyAllTower.bind(this),this),this.state.addState("releas-skill",(function(){t.currentTargetEnemy&&(t.currentTargetEnemy=null),t.node.emit("release-skill",(function(){t.state.setState("run")}))})),this.state.addState("destroy",(function(){var e=t.rootNode.getComponent(v),o=p(2*Math.random(),0,2*Math.random());if(e){var n=e.getState("骨架|todestroy");n?(n.repeatCount=1,e.play("骨架|todestroy"),t.scheduleOnce((function(){t.towerBuildBase&&t.towerBuildBase.getComponent(E).unSetTargetTower(t.node),t.gameController.getComponent(D).showAddGoldAnimEffect(t.getDestroyCount(),p(t.node.position.x,0,t.node.position.z).add(o)),t.node.destroy()}),n.length)):(t.node.destroy(),t.towerBuildBase&&(t.towerBuildBase.getComponent(E).unSetTargetTower(t.node),t.gameController.getComponent(D).showAddGoldAnimEffect(t.getDestroyCount(),p(t.node.position.x,0,t.node.position.z).add(o))))}else t.node.destroy(),t.towerBuildBase&&(t.towerBuildBase.getComponent(E).unSetTargetTower(t.node),t.gameController.getComponent(D).showAddGoldAnimEffect(t.getDestroyCount(),p(t.node.position.x,0,t.node.position.z).add(o)))}))}},{key:"destroyAllTower",value:function(){this.node.destroy()}},{key:"touchScreenTo3d",value:function(t){if(console.log("射线检测到了 tower"),"run"===this.state.getState())for(var e=0;e<t.length;e++){if(t[e].collider.node.uuid===this.node.uuid){this.gameController.node.emit("touch-tower",this.node);break}}}},{key:"onDestroy",value:function(){console.log("销毁"),this.gameController.node.off("touch-screen-to-3d",this.touchScreenTo3d,this),this.gameController.node.on("destroy-all-tower",this.destroyAllTower,this)}},{key:"toDestroy",value:function(){this.state.setState("destroy")}},{key:"update",value:function(t){var e=this;if("run"===this.state.getState()){var o=this.getAttackType();if("normal"===o){var n=this.findSingleEnemy(t);if(k(n)){if(this.isShooting)return;this.isShooting=!0,this.shootOneBullet(this.getCurrentAttackRate(),this.currentShootDiraction,this.getCurrentAttackNum()).then((function(){e.scheduleOnce((function(){e.isShooting=!1}),e.shootDuraction)}))}}else if("Range"===o){var i=this.findRangeEnemy(t);if(k(i)){if(this.isShooting)return;this.isShooting=!0,this.playOneTimeAttackAnim().then((function(){return e.createOneGuideMissile()})).then((function(){e.scheduleOnce((function(){e.isShooting=!1}),e.shootDuraction)}))}}else if("Auto"===o){var r=this.findSingleEnemy(t);if(k(r)){if(k(this.rootNode)&&(this.rootNode.lookAt(this.currentTargetEnemy.position),this.rootNode.eulerAngles.x<0&&(this.rootNode.eulerAngles=p(0,this.rootNode.eulerAngles.y,this.rootNode.eulerAngles.z))),this.weaponBaseNode&&(this.weaponBaseNode.lookAt(this.currentTargetEnemy.position),this.weaponBaseNode.eulerAngles=p(0,this.weaponBaseNode.eulerAngles.y,this.rootNode.eulerAngles.z)),this.isShooting)return;this.isShooting=!0;var a=this.rootNode.getComponent(v),s=a.getState("骨架|AttackAnim"),l=new C(this.node);l.delay(.1),l.call((function(){a.play("骨架|AttackAnim")})),this.gameController.node.emit("play-audio",this.shootAudio);for(var u=function(t){t.call((function(){var t=p(e.currentShootDiraction);k(e.currentTargetEnemy)&&!e.currentTargetEnemy.getComponent(R).getIsDead()&&e.createOneTimeBullet(t).then((function(){}))})),t.delay(.1)},c=0;c<10;c++)u(l);l.call((function(){s.stop()})),l.delay(this.shootDuraction),l.call((function(){e.isShooting=!1})),l.start()}}}}},{key:"playOneTimeAttackAnim",value:function(){var t=this;return new Promise((function(e,o){var n=t.rootNode.getComponent(v),i=n.getState("骨架|AttackAnim");i.repeatCount=1,n.play("骨架|AttackAnim");var r=i.length;console.log("length",r),i.speed=1,t.readyAduio&&t.gameController.node.emit("play-audio",t.readyAduio);var a=new C(t.node);a.delay(r*t.attackAnimEventTimeOffset),a.call((function(){e()})),a.delay(r*(1-t.attackAnimEventTimeOffset)),a.call((function(){})),a.start()}))}},{key:"findRangeEnemy",value:function(t){if(null!==this.currentTargetEnemy)return k(this.currentTargetEnemy)&&!this.currentTargetEnemy.getComponent(R).getIsDead()?this.currentTargetEnemy:(this.currentTargetEnemy=null,null);for(var e=this.gameController.getComponent(P).getCurrentEnemyNodeList(),o=0;o<e.length;o++){var n=e[o];if(k(n)&&this.getCanAttackEnemy(n)&&n.getComponent(R).getIsCanLock()&&!n.getComponent(R).getIsDead())if(p(this.node.position).subtract(n.position).length()<this.getCurrentAttackRange())return this.currentTargetEnemy=n,n}}},{key:"createOneGuideMissile",value:function(){var t=this;return new Promise((function(e,o){console.log("创建一枚导弹");var n=t.bulletStartPosList[0],i=new C(n),r=p(n.position);i.by(.4,{position:p(0,4,0)}),i.call((function(){n.active=!1;var e=A(t.bulletPrefab);e.parent=t.node.parent,e.position=n.worldPosition,e.getComponent(O).init(t.gameConfig,t.gameController,{baseAttackNum:t.getCurrentAttackNum()}),t.gameController.node.emit("play-audio",t.shootAudio)})),i.delay(.8),i.call((function(){n.position=r,n.active=!0,e()})),i.start()}))}},{key:"findSingleEnemy",value:function(t){if(null===this.currentTargetEnemy){for(var e=this.gameController.getComponent(P).getCurrentEnemyNodeList(),o=1e4,n=void 0,i=0;i<e.length;i++){var r=e[i];if(k(r)&&r.getComponent(R).getIsCanLock()&&!r.getComponent(R).getIsDead()&&this.getCanAttackEnemy(r)){var a=new T(r.position).subtract(this.node.position).length();a<o&&(o=a,n=r)}}if(n)w(n.position.x,n.position.z).subtract(w(this.node.position.x,this.node.position.z)).length()<this.getCurrentAttackRange()&&(this.currentTargetEnemy=n)}if(k(this.currentTargetEnemy))if("normal"===this.getAttackType()&&this.rootNode&&(this.rootNode.lookAt(this.currentTargetEnemy.position),this.rootNode.eulerAngles.x<0&&(this.rootNode.eulerAngles=p(0,this.rootNode.eulerAngles.y,this.rootNode.eulerAngles.z))),this.currentTargetEnemy.getComponent(R)&&this.currentTargetEnemy.getComponent(R).getIsDead())this.currentTargetEnemy=null;else if(this.currentShootDiraction=p(this.currentTargetEnemy.position).subtract(p(this.node.position)),"normal"===this.getAttackType()){var s=new S,l=p(this.currentShootDiraction.x,0,this.currentShootDiraction.z).normalize();S.fromViewUp(s,l,T.UP);var u=new S;S.lerp(u,this.node.rotation,s,.2),this.node.rotation=s}if(k(this.currentTargetEnemy)){if(w(this.currentTargetEnemy.position.x,this.currentTargetEnemy.position.z).subtract(w(this.node.position.x,this.node.position.z)).length()>this.getCurrentAttackRange())return this.currentTargetEnemy=null,null}else this.currentTargetEnemy=null;return this.currentTargetEnemy}},{key:"getCurrentAttackRate",value:function(){return this.baseAttackRate}},{key:"shootOneBullet",value:function(t,e,o){var n=this;return new Promise((function(t,o){var i=[];n.rootNode&&i.push(n.rootNode),n.weaponBaseNode&&i.push(n.weaponBaseNode);var r=!1;if(n.getBulletRecoverTime()>0)for(var a=0;a<n.bulletStartPosList.length;a++){if(n.bulletStartPosList[a].active){r=!0;break}}else r=!0;if(r){for(var s=0,l=0;l<i.length;l++){var u=i[l].getComponent(v);if(u){var c=u.getState("骨架|AttackAnim");u.play("骨架|AttackAnim"),c.repeatCount=1;var d=(n.getAttackSpeedLevel()+10)/10;c.speed=d,s=c.length*(1/d)}}console.log("shoot one bullet length",s),n.scheduleOnce((function(){n.gameController.node.emit("play-audio",n.shootAudio),n.createOneTimeBullet(e).then((function(){t()}))}),s*n.attackAnimEventTimeOffset)}else t()}))}},{key:"createOneTimeBullet",value:function(t){var e=this;return console.log("创建一枚导弹"),new Promise((function(o,n){o();for(var i=function(o){var n=e.bulletStartPosList[o];if(n.active){var i=A(e.bulletPrefab);if(i.parent=e.node.parent,i.active=!1,i.setPosition(n.worldPosition),i.active=!0,i.getComponent(O).init(e.gameConfig,e.gameController,{direction:t,targetEnemy:e.currentTargetEnemy,baseAttackNum:e.getCurrentAttackNum(),targetTower:e}),e.getIsNeedRecoverBullet()){n.active=!1,e.currentShootBulletIndex++,e.currentShootBulletIndex===e.bulletStartPosList.length&&(e.currentShootBulletIndex=0);var r=p(n.position),a=new C(n),s=p(n.position).subtract(p(0,.3,-.3));return"Range"===e.getAttackType()&&(s=p(n.position).subtract(p(0,-1,0))),a.set({position:s}),a.delay(e.getBulletRecoverTime()),a.call((function(){n.active=!0})),a.to(.2,{position:r}),a.start(),"break"}}},r=e.currentShootBulletIndex;r<e.bulletStartPosList.length;r++){if("break"===i(r))break}}))}},{key:"enemyDeadByThis",value:function(t,e){t&&k(this.skillCtl)&&this.skillCtl.showAddPowerAnimEffect(e,this.node.position)}},{key:"releaseSkill",value:function(){console.log("release skill",this.objectType),this.state.setState("releas-skill")}},{key:"setTowerBuildBase",value:function(t){this.towerBuildBase=t}},{key:"updateLevel",value:function(){c(a(e.prototype),"updateLevel",this).call(this)}},{key:"showAttackRange",value:function(){var t=this.getCurrentAttackRange();console.log("attack range",t),this.attackRangeNode.active=!0;var e=new C(this.attackRangeNode);e.to(.1,{scale:p(2*t,2*t,2*t)}),e.start()}},{key:"closeAttackRange",value:function(){var t=this,e=new C(this.attackRangeNode);e.to(.1,{scale:p(1,1,1)}),e.call((function(){t.attackRangeNode.active=!1})),e.start()}}]),e}(B)).prototype,"bulletPrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=o(M.prototype,"bulletStartPosList",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=o(M.prototype,"weaponBaseNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(M.prototype,"attackAnimEventTimeOffset",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Q=o(M.prototype,"attackRangeNode",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=M))||G)),d._RF.pop()}}}));

System.register("chunks:///UI/Menu/MenuUIBase.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../util/State.js","../../Towers/TowerBase.js"],(function(t,e){var o,n,s,a,i,c,u,l,r,h,d,g,p,f,v,k;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){o=t.inherits,n=t.classCallCheck,s=t.possibleConstructorReturn,a=t.getPrototypeOf,i=t.createClass},function(t){c=t.cclegacy,u=t._decorator,l=t.isValid,r=t.Tween,h=t.v3,d=t.Component},function(t){g=t.State},function(t){p=t.TowerBase}],execute:function(){c._RF.push({},"22840YoTAVEEoGWokYeLlSX","MenuUIBase",void 0),k=u.ccclass,u.property,t("MenuUIBase",(f=k("MenuUIBase"),f(v=function(t){function e(){var t,o;n(this,e);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return(o=s(this,(t=a(e)).call.apply(t,[this].concat(c)))).state=new g,o.targetNode=null,o}return o(e,t),i(e,[{key:"init",value:function(t,e){this.state.addState("open-ui",this.openUI.bind(this)),this.state.addState("close-ui",this.closeUI.bind(this))}},{key:"open",value:function(t){console.log("打开"),l(this.targetNode)&&this.targetNode.getComponent(p)&&this.targetNode.uuid!==t.uuid&&this.targetNode.getComponent(p).closeAttackRange(),t.getComponent(p)&&t.getComponent(p).showAttackRange(),this.targetNode=t,this.state.setState("open-ui")}},{key:"close",value:function(){this.state.setState("close-ui")}},{key:"closeUI",value:function(){l(this.targetNode)&&this.targetNode.getComponent(p)&&this.targetNode.getComponent(p).closeAttackRange();var t=new r(this.node);t.to(.2,{scale:h(0,0,0)}),t.call((function(){})),t.start()}},{key:"openUI",value:function(){console.log("open ui"),this.node.active=!0;var t=new r(this.node);t.to(.2,{scale:h(1,1,1)}),t.call((function(){})),t.start()}}]),e}(d))||v)),c._RF.pop()}}}));

System.register("chunks:///util/Tool.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,o){var n,t,l;return{setters:[function(e){n=e.createClass,t=e.classCallCheck},function(e){l=e.cclegacy}],execute:function(){l._RF.push({},"a5b9421aLlB+qBZsaa/3PZA","Tool",void 0),e("Tool",function(){function e(){t(this,e)}return n(e,null,[{key:"convertNumToK",value:function(e){for(var o=(e=Math.abs(e))+"",n=e,t=0;n>0;)n=Math.floor(n/1e3),t++;return o=e/Math.pow(1e3,t-1)+"",console.log("end Str",o),o.length>4&&(o=o.substring(0,4)),t>=1&&(o+=["","K","M","B"][t-1]),console.log("end Str",o),o}}]),e}()),l._RF.pop()}}}));

System.register("chunks:///UI/GoldCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/Tool.js","../GameController.js"],(function(e,t){var r,o,n,i,l,a,d,u,c,s,p,f,b,v,g,y,C,h,m,L,_,G,w,N,z,H,E,P,k,T,B,D,I,R,j,S,A,F,K,x;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,o=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,d=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,s=e._decorator,p=e.Node,f=e.find,b=e.Tween,v=e.v3,g=e.LabelComponent,y=e.ProgressBarComponent,C=e.instantiate,h=e.view,m=e.Component},function(e){L=e.Tool},function(e){_=e.GameController}],execute:function(){c._RF.push({},"76e03n/eNtMAopLI1ZIiGNs","GoldCtl",void 0),K=s.ccclass,x=s.property,e("GoldCtl",(G=K("GoldCtl"),w=x({type:p}),N=x({type:p}),z=x({type:p}),H=x({type:p}),E=x({type:p}),P=x({type:p}),k=x({type:p}),G((D=r((B=function(e){function t(){var e,r;n(this,t);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return r=i(this,(e=l(t)).call.apply(e,[this].concat(u))),a(r,"goldsNode",D,d(r)),a(r,"currentLevelLabel",I,d(r)),a(r,"currentScoreLabel",R,d(r)),a(r,"currentGoldLabel",j,d(r)),a(r,"addGoldEffectLabel",S,d(r)),a(r,"redHeartProgressBar",A,d(r)),a(r,"redHeartCountLabel",F,d(r)),r.addGoldEffectNodeCount=0,r}return o(t,e),u(t,[{key:"start",value:function(){var e=this,t=f("GameController");t.on("refer-current-wave-level",(function(t,r){e.updateLevelLabel(t,r)})),t.on("update-gold-label",(function(t,r){e.updateGoldCountLabel(t,r)})),this.node.on("gold-not-enough",(function(){var t=new b(e.currentGoldLabel);t.to(.1,{scale:v(1.5,1.5,1.5)}),t.to(.1,{scale:v(1,1,1)}),t.start()})),this.node.on("refer-red-heart-label",(function(){var r=t.getComponent(_),o=r.playerData.getCurrentRedHeartCount(),n=r.playerData.getCurrentInitRedHeartCount();e.redHeartCountLabel.getComponent(g).string=n+"/"+o;var i=o/n;e.redHeartProgressBar.getComponent(y).progress=i}))}},{key:"updateLevelLabel",value:function(e,t){this.currentLevelLabel.getComponent(g).string=e+1+"-"+(t+1)}},{key:"updateGoldCountLabel",value:function(e,t){var r=this,o=L.convertNumToK(e);if(this.currentGoldLabel.getComponent(g).string=o,t){if(this.addGoldEffectNodeCount>20)return;this.addGoldEffectNodeCount++;var n=C(this.addGoldEffectLabel);n.parent=this.goldsNode;var i="-";t>0&&(i="+");var l=L.convertNumToK(t);n.getComponent(g).string=i+l+"";var a=new b(n);a.by(.2,{position:v(0,20,0)}),a.delay(.5),a.by(.2,{position:v(0,20,0),opacity:-.5}),a.call((function(){n.destroy(),r.addGoldEffectNodeCount--})),a.start()}}},{key:"showEnterAnim",value:function(){var e=this,t=h.getVisibleSize().height;return console.log("播放金币ui的进场动画"),this.node.emit("refer-red-heart-label"),new Promise((function(r,o){var n=new b(e.goldsNode);n.to(.2,{position:v(0,.5*t-65,0)}),n.call((function(){r()})),n.start()}))}}]),t}(m)).prototype,"goldsNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=r(B.prototype,"currentLevelLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=r(B.prototype,"currentScoreLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=r(B.prototype,"currentGoldLabel",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=r(B.prototype,"addGoldEffectLabel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=r(B.prototype,"redHeartProgressBar",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=r(B.prototype,"redHeartCountLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=B))||T)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/UpdateTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js","../../Towers/TowerBase.js","./MenuUIBase.js","../../util/Tool.js","../../GameController.js"],(function(e,t){var o,n,r,a,i,s,l,u,p,c,d,C,g,m,h,y,v,f,b,_,w,B,T,U,k,I,N,L,S,F,M,j,x,z,D,G;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass,p=e.get},function(e){c=e.cclegacy,d=e._decorator,C=e.Node,g=e.SpriteFrame,m=e.find,h=e.SpriteComponent,y=e.LabelComponent},function(e){v=e.BaseObject},function(e){f=e.TowerBase},function(e){b=e.MenuUIBase},function(e){_=e.Tool},function(e){w=e.GameController}],execute:function(){c._RF.push({},"18715njxPNA9Ie4NOUMTb2f","UpdateTowerUI",void 0),D=d.ccclass,G=d.property,e("UpdateTowerUI",(B=D("UpdateTowerUI"),T=G({type:C}),U=G({type:C}),k=G({type:g}),I=G({type:g}),N=G({type:C}),B((F=o((S=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,u=new Array(n),p=0;p<n;p++)u[p]=arguments[p];return o=a(this,(e=i(t)).call.apply(e,[this].concat(u))),s(o,"updateCostLabel",F,l(o)),s(o,"destroyWinLabel",M,l(o)),o.gameController=null,o.updateCostCount=null,o.destroyWinCount=null,s(o,"updateMaxLevelSpriteFrame",j,l(o)),s(o,"updateButtonSpriteFrame",x,l(o)),s(o,"updateButtonNode",z,l(o)),o}return n(t,e),u(t,[{key:"onLoad",value:function(){this.gameController=m("GameController").getComponent(w)}},{key:"start",value:function(){}},{key:"onButtonClick",value:function(e,t){m("GameController").emit("player-button-click-audio"),console.log("custom data",t);var o=this.gameController.playerData.getCurrentGoldCount();switch(t){case"bg":console.log("点中了背景"),this.state.setState("close-ui");break;case"update":if(this.targetNode.getComponent(v).getTowerIsMax())return;o>=this.updateCostCount?(this.gameController.playerData.addGoldCount(-1*this.updateCostCount),this.state.setState("close-ui"),this.targetNode.getComponent(f).updateLevel()):m("Canvas").emit("gold-not-enough");break;case"destroy":this.state.setState("close-ui"),this.targetNode.getComponent(f).toDestroy()}}},{key:"checkIsUpdateMax",value:function(){var e=this.targetNode.getComponent(v).getTowerIsMax();console.log("is max",e),e?(console.log("更新按钮 贴图"),this.updateButtonNode.getComponent(h).spriteFrame=this.updateMaxLevelSpriteFrame):this.updateButtonNode.getComponent(h).spriteFrame=this.updateButtonSpriteFrame}},{key:"open",value:function(e){p(i(t.prototype),"open",this).call(this,e),this.checkIsUpdateMax();var o=e.getComponent(f),n=o.getUpdateCost(),r=o.getDestroyCount();this.updateCostLabel.getComponent(y).string=_.convertNumToK(n)+"",this.destroyWinLabel.getComponent(y).string=_.convertNumToK(r)+"",this.updateCostCount=n,this.destroyWinCount=r}}]),t}(b)).prototype,"updateCostLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(S.prototype,"destroyWinLabel",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(S.prototype,"updateMaxLevelSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(S.prototype,"updateButtonSpriteFrame",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(S.prototype,"updateButtonNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=S))||L)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerUITowerIcon.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(e,t){var i,o,r,n,s,l,c,a,u,d,p,h,y,f,w,b,g,v,m,T,C,_,A,I,L,B,j,k,N;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,s=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,a=e.createClass,u=e.get},function(e){d=e.cclegacy,p=e._decorator,h=e.Node,y=e.Prefab,f=e.isValid,w=e.instantiate,b=e.v3,g=e.LabelComponent},function(e){v=e.BaseObject}],execute:function(){d._RF.push({},"960c8xSpalMJZbfb3XktNJx","BuildTowerUITowerIcon",void 0),k=p.ccclass,N=p.property,e("BuildTowerUITowerIcon",(m=k("BuildTowerUITowerIcon"),T=N({type:h}),C=N({type:y}),_=N({type:h}),m((L=i((I=function(e){function t(){var e,i;r(this,t);for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return i=n(this,(e=s(t)).call.apply(e,[this].concat(a))),l(i,"costGoldLabel",L,c(i)),l(i,"towerShowAnimList",B,c(i)),l(i,"showTowerAnimLayer",j,c(i)),i.gameConfig=void 0,i.currentBuildCost=null,i.towerType=null,i.currentAnimNode=null,i}return o(t,e),a(t,[{key:"onLoad",value:function(){}},{key:"start",value:function(){}},{key:"init",value:function(e,i,o){this.gameConfig=o,this.towerType=e,f(this.currentAnimNode)&&this.currentAnimNode.destroy();var r=w(this.towerShowAnimList[e]);for(var n in this.currentAnimNode=r,r.scale=b(1,1,1),r.parent=this.showTowerAnimLayer,console.log("type",e),this.gameConfig)n.indexOf("Tower")>-1&&this.gameConfig[n].Index===e&&(this.objectType=n);console.log("object type",this.objectType),u(s(t.prototype),"init",this).call(this,this.gameConfig,i),this.costGoldLabel.getComponent(g).string=this.buildCost+""}},{key:"getCurrentBuildCost",value:function(){return this.buildCost}},{key:"getTowerType",value:function(){return this.towerType}}]),t}(v)).prototype,"costGoldLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(I.prototype,"towerShowAnimList",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=i(I.prototype,"showTowerAnimLayer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=I))||A)),d._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerMenuUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./MenuUIBase.js","./BuildTowerUITowerIcon.js"],(function(e,t){var o,i,r,n,l,s,a,u,c,d,h,g,p,f,C,w,v,I,m,y,T,B,b,U,_,k,N;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,u=e.createClass,c=e.get},function(e){d=e.cclegacy,h=e._decorator,g=e.Prefab,p=e.instantiate,f=e.ButtonComponent,C=e.v3,w=e.v2,v=e.find,I=e.isValid},function(e){m=e.MenuUIBase},function(e){y=e.BuildTowerUITowerIcon}],execute:function(){d._RF.push({},"e6405P/+GFGaa0/qmo/iQAc","BuildTowerMenuUI",void 0),k=h.ccclass,N=h.property,e("BuildTowerMenuUI",(T=k("BuildTowerMenuUI"),B=N({type:g}),T((_=o((U=function(e){function t(){var e,o;r(this,t);for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return o=n(this,(e=l(t)).call.apply(e,[this].concat(u))),s(o,"buildTowerUITowerIcon",_,a(o)),o.gameConfig=null,o.towerIconNodeList=[],o}return i(t,e),u(t,[{key:"init",value:function(e,o){c(l(t.prototype),"init",this).call(this),this.gameController=o,this.gameConfig=e,this.referCurrentUI()}},{key:"referCurrentUI",value:function(){var e=this.gameController.playerData.getCurrentActiveTowerList(),t=e.length,o=t-this.towerIconNodeList.length;if(console.log("dis",o),o>0)for(var i=0;i<o;i++){var r=p(this.buildTowerUITowerIcon);r.addComponent(f),r.on("click",this.onButtonClick.bind(this)),r.parent=this.node,this.towerIconNodeList.push(r)}else if(o<0)for(var n=0;n<Math.abs(o);n++)this.towerIconNodeList.pop().destroy();for(var l=0;l<this.towerIconNodeList.length;l++){var s=this.towerIconNodeList[l];s.name="tower_"+e[l],s.getComponent(y).init(e[l],this.gameController,this.gameConfig);var a=60/s.width;s.scale=C(a,a,1);var u=w(0,1),c=(u=u.rotate(2*Math.PI/t*l).normalize()).multiplyScalar(75);s.setPosition(C(c.x,c.y,0))}console.log("build tower ui"),this.node.getChildByName("BuildTowerBgNode").on("click",this.onButtonClick.bind(this))}},{key:"onButtonClick",value:function(e,t){if(v("GameController").emit("player-button-click-audio"),"close"!==t)if("BuildTowerBgNode"===e.node.name)this.state.setState("close-ui");else{var o=e.node.getComponent(y);if(o){var i=o.getTowerType(),r=o.getCurrentBuildCost(),n=this.gameController.playerData.getCurrentGoldCount();console.log("current gold count",n),r<=n&&I(this.targetNode)?(this.gameController.playerData.addGoldCount(-1*r),this.state.setState("close-ui"),v("GameController").emit("build-one-tower",i,this.targetNode)):v("Canvas").emit("gold-not-enough")}}else this.state.setState("close-ui")}}]),t}(m)).prototype,"buildTowerUITowerIcon",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=U))||b)),d._RF.pop()}}}));

System.register("chunks:///UI/GameWin/GameResultGoldCell.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(e,t){var n,o,i,r,l,a,s,c,u,p,d,m,y,C,b,f,g,v,h,G,_,F,I,w,L,R,j,N,k;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass,u=e.get},function(e){p=e.cclegacy,d=e._decorator,m=e.Node,y=e.LabelComponent,C=e.loader,b=e.SpriteFrame,f=e.isValid,g=e.SpriteComponent},function(e){v=e.BaseObject}],execute:function(){p._RF.push({},"00a24DEoTFIC42oXzjaFqsy","GameResultGoldCell",void 0),N=d.ccclass,k=d.property,e("GameResultGoldCell",(h=N("GameResultGoldCell"),G=k({type:m}),_=k({type:m}),F=k({type:m}),h((L=n((w=function(e){function t(){var e,n;i(this,t);for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];return n=r(this,(e=l(t)).call.apply(e,[this].concat(c))),a(n,"enemyIconNode",L,s(n)),a(n,"enemyCountLabel",R,s(n)),a(n,"winGoldCountLabel",j,s(n)),n}return o(t,e),c(t,[{key:"start",value:function(){}},{key:"init",value:function(e,n){var o=this,i=e.getGameConfig().json,r=n.key;u(l(t.prototype),"init",this).call(this,i,e,null,null,r);var a=this.getIconSprteFrame();this.enemyCountLabel.getComponent(y).string=n.enemyCount+"",this.winGoldCountLabel.getComponent(y).string=n.winGoldCount+"",C.loadRes(a+"/spriteFrame",b,(function(e,t){!e&&f(o.enemyIconNode)&&(o.enemyIconNode.getComponent(g).spriteFrame=t)}))}},{key:"setData",value:function(e,t,n){var o=this;this.enemyCountLabel.getComponent(y).string=e+"",this.winGoldCountLabel.getComponent(y).string=t+"",C.loadRes(n+"/spriteFrame",b,(function(e,t){!e&&f(o.enemyIconNode)&&(o.enemyIconNode.getComponent(g).spriteFrame=t)}))}}]),t}(v)).prototype,"enemyIconNode",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(w.prototype,"enemyCountLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=n(w.prototype,"winGoldCountLabel",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=w))||I)),p._RF.pop()}}}));

System.register("chunks:///UI/GameWin/GameWinPrefab.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./GameResultGoldCell.js"],(function(e,t){var o,i,n,r,l,a,u,s,p,c,d,m,g,f,y,h,b,v,C,_,w,S,F,G,L,B,R,z,N,k,I,P,W,T,x,E,A,j,D,V,H,J,M,O,U,Z,q,K,Q,X,Y,$,ee,te,oe,ie;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_dec14:void 0,_dec15:void 0,_dec16:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_descriptor13:void 0,_descriptor14:void 0,_descriptor15:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,u=e.assertThisInitialized,s=e.createClass},function(e){p=e.cclegacy,c=e._decorator,d=e.Prefab,m=e.Node,g=e.SpriteFrame,f=e.SpriteComponent,y=e.LabelComponent,h=e.instantiate,b=e.Tween,v=e.v3,C=e.find,_=e.Component},function(e){w=e.GameResultGoldCell}],execute:function(){p._RF.push({},"fa8f9h1LBJLMZap+sTSLCS2","GameWinPrefab",void 0),oe=c.ccclass,ie=c.property,e("GameWinPrefab",(S=oe("GameWinPrefab"),F=ie({type:d}),G=ie({type:m}),L=ie({type:m}),B=ie({type:g}),R=ie({type:g}),z=ie({type:g}),N=ie({type:g}),k=ie({type:g}),I=ie({type:g}),P=ie({type:m}),W=ie({type:m}),T=ie({type:m}),x=ie({type:m}),E=ie({type:m}),A=ie({type:m}),S((V=o((D=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,s=new Array(i),p=0;p<i;p++)s[p]=arguments[p];return o=r(this,(e=l(t)).call.apply(e,[this].concat(s))),a(o,"winGoldCellPrefab",V,u(o)),a(o,"leftButton",H,u(o)),a(o,"rightButton",J,u(o)),a(o,"retryGameButtonSpriteFrame",M,u(o)),a(o,"shareButtonSpriteFrame",O,u(o)),a(o,"nextLevelSpriteFrame",U,u(o)),a(o,"saveLifeButtonSpriteFrame",Z,u(o)),a(o,"gameWinIconSpriteFrame",q,u(o)),a(o,"gameLossIconSpriteFrame",K,u(o)),a(o,"gameResultIconNode",Q,u(o)),a(o,"gameResultNode",X,u(o)),a(o,"sumNode",Y,u(o)),a(o,"totalEnemyCountLabel",$,u(o)),a(o,"totalGoldCountLabel",ee,u(o)),o.gameConfig=null,a(o,"scrollViewNode",te,u(o)),o.gameResultState=null,o.uiController=null,o.gameController=null,o.nodeList=[],o}return i(t,e),s(t,[{key:"start",value:function(){}},{key:"setGameResult",value:function(e,t,o,i,n){var r=this;this.uiController=i,this.gameController=n,this.gameResultState=e,this.gameConfig=o,console.log("游戏状态时",e);var l=t.length,a=0;console.log("当前关卡打死的敌人数目种类，获得的金币数目 "),e?(this.gameController.node.emit("play-audio","胜利音效"),this.gameResultIconNode.getComponent(f).spriteFrame=this.gameWinIconSpriteFrame,this.leftButton.getComponent(f).spriteFrame=this.shareButtonSpriteFrame,this.rightButton.getComponent(f).spriteFrame=this.nextLevelSpriteFrame):(this.gameResultIconNode.getComponent(f).spriteFrame=this.gameLossIconSpriteFrame,this.leftButton.getComponent(f).spriteFrame=this.retryGameButtonSpriteFrame,this.rightButton.getComponent(f).spriteFrame=this.saveLifeButtonSpriteFrame);for(var u={},s=0;s<t.length;s++)u[t[s].enemyType]?(u[t[s].enemyType].enemyCount+=1,u[t[s].enemyType].winGoldCount+=t[s].dropGoldCount):u[t[s].enemyType]={enemyCount:1,winGoldCount:t[s].dropGoldCount},a+=t[s].dropGoldCount;var p=[];for(var c in u){var d=u[c];d.key=c,p.push(d)}console.log("list",p),p=p.sort((function(e,t){return t.winGoldCount-e.winGoldCount})),this.showCellEnterAnim(p,(function(){return console.log("展示结束"),r.showSumResult(l,a)}))}},{key:"showSumResult",value:function(e,t){var o=this;return new Promise((function(i,n){o.sumNode.active=!0,o.totalEnemyCountLabel.getComponent(y).string=e+"",o.totalGoldCountLabel.getComponent(y).string=t+""}))}},{key:"showCellEnterAnim",value:function(e,t){var o=this;if(0!==e.length){var i=e.pop(),n=h(this.winGoldCellPrefab);n.parent=this.gameResultNode;var r=new b(n);n.getComponent(w).init(this.gameController,i),n.position=v(0,-100*this.nodeList.length-50,0),this.gameResultNode.height=-1*n.position.y+60,this.nodeList.push(n),r.delay(.4),r.call((function(){o.showCellEnterAnim(e,t)})),r.start()}else t&&t()}},{key:"onButtonClick",value:function(e,t){var o=this;switch(C("GameController").emit("player-button-click-audio"),t){case"left-button":console.log("分享游戏结果"),this.gameResultState?this.gameController.playerClickShareButton().then((function(){o.gameController.enterNextLevel(),o.node.destroy()})):(this.gameController.playerClickRetryButton(),this.node.destroy());break;case"right-button":this.gameResultState?(console.log("进入下一关"),this.node.destroy(),this.uiController.playerClickNextLevelButton()):this.gameController.playerClickSaveLifeButton().then((function(){o.node.destroy()}))}}}]),t}(_)).prototype,"winGoldCellPrefab",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(D.prototype,"leftButton",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=o(D.prototype,"rightButton",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(D.prototype,"retryGameButtonSpriteFrame",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(D.prototype,"shareButtonSpriteFrame",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=o(D.prototype,"nextLevelSpriteFrame",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=o(D.prototype,"saveLifeButtonSpriteFrame",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(D.prototype,"gameWinIconSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(D.prototype,"gameLossIconSpriteFrame",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=o(D.prototype,"gameResultIconNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=o(D.prototype,"gameResultNode",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=o(D.prototype,"sumNode",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=o(D.prototype,"totalEnemyCountLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=o(D.prototype,"totalGoldCountLabel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=o(D.prototype,"scrollViewNode",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=D))||j)),p._RF.pop()}}}));

System.register("chunks:///UI/UIController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./SkillCtl.js","./Menu/MenuUIBase.js","./GoldCtl.js","./Menu/UpdateTowerUI.js","./Menu/BuildTowerMenuUI.js","./GameWin/GameWinPrefab.js","../GameController.js"],(function(e,o){var t,n,i,r,l,s,a,u,c,d,p,h,m,f,b,I,g,v,C,w,U,y,N,k,B,_,P,L,G,T,S,z,M,j,H,R,A,E,W,D,F,x,O,V,J,Z,q,K,Q,X,Y,$,ee,oe,te,ne;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,d=e._decorator,p=e.Prefab,h=e.Node,m=e.SpriteFrame,f=e.find,b=e.view,I=e.v3,g=e.isValid,v=e.instantiate,C=e.Tween,w=e.ProgressBarComponent,U=e.LabelComponent,y=e.CameraComponent,N=e.SpriteComponent,k=e.Component},function(e){B=e.SkillCtl},function(e){_=e.MenuUIBase},function(e){P=e.GoldCtl},function(e){L=e.UpdateTowerUI},function(e){G=e.BuildTowerMenuUI},function(e){T=e.GameWinPrefab},function(e){S=e.GameController}],execute:function(){c._RF.push({},"ac456IJb4BOS7ZW+hoJsDui","UIController",void 0),te=d.ccclass,ne=d.property,e("UIController",(z=te("UIController"),M=ne({type:p}),j=ne({type:p}),H=ne({type:h}),R=ne({type:h}),A=ne({type:h}),E=ne({type:m}),W=ne({type:p}),D=ne({type:h}),F=ne({type:h}),x=ne({type:h}),z((J=t((V=function(e){function o(){var e,t;i(this,o);for(var n=arguments.length,u=new Array(n),c=0;c<n;c++)u[c]=arguments[c];return t=r(this,(e=l(o)).call.apply(e,[this].concat(u))),s(t,"buildTowerPrefab",J,a(t)),s(t,"updateMenuPrefab",Z,a(t)),t.gameController=null,s(t,"cameraNode",q,a(t)),t.buildUINode=null,t.updateUINode=null,s(t,"enemyInfoButton",K,a(t)),s(t,"towerInfoButton",Q,a(t)),t.isHoldSkillIcon=!1,s(t,"bossIcon",X,a(t)),s(t,"gameResultPrefab",Y,a(t)),s(t,"currentLevelLabelIcon",$,a(t)),s(t,"towerInfoLayer",ee,a(t)),s(t,"bossHealthBar",oe,a(t)),t}return n(o,e),u(o,[{key:"start",value:function(){var e=this;this.gameController=f("GameController").getComponent(S);var o=b.getVisibleSize().width;this.enemyInfoButton.position=I(-.5*o-100,0,0),this.towerInfoButton.position=I(.5*o+100,0,0),console.log("ui controller start"),this.gameController.node.on("touch-base-build-base",(function(o){e.node.emit("complete-current-guide"),e.isHoldSkillIcon||(g(e.updateUINode)&&e.updateUINode.getComponent(_).close(),g(e.buildUINode)||(e.buildUINode=v(e.buildTowerPrefab),e.buildUINode.parent=e.node,e.buildUINode.getComponent(G).init(e.gameController.getGameConfig().json,e.gameController)),e.setUINodeTo3dPos(e.buildUINode,o),e.buildUINode.getComponent(_).open(o))})),this.gameController.node.on("touch-tower",(function(o){e.isHoldSkillIcon||(g(e.buildUINode)&&e.buildUINode.getComponent(_).close(),g(e.updateUINode)||(e.updateUINode=v(e.updateMenuPrefab),e.updateUINode.parent=e.node,e.updateUINode.getComponent(L).init(e.gameController.getGameConfig().json,e.gameController)),e.setUINodeTo3dPos(e.updateUINode,o),e.updateUINode.getComponent(L).open(o))})),this.node.on("show-ui-enter-anim",this.showUIEnterAnim.bind(this),this),this.node.on("show-game-loss-ui",this.showGameLossUI.bind(this),this),this.node.on("show-game-win-ui",this.showGameWinUI.bind(this),this),this.node.on("show-current-level-icon-anim",this.showCurrentLevelIconAnim.bind(this),this),this.node.on("close-all-ui",this.closeSomeUI.bind(this),this),this.node.on("refer-current-tower-menu-ui",this.referTowerBuildMenuUI.bind(this),this),this.node.on("close-tower-menu-ui",this.coloseTowerBuildMenuUI.bind(this),this)}},{key:"showBossHealthBar",value:function(){var e=new C(this.bossHealthBar);return this.bossHealthBar.children[0].getComponent(w).progress=1,e.to(.2,{position:I(0,-280,0)}),e.start(),this.bossHealthBar}},{key:"coloseTowerBuildMenuUI",value:function(){g(this.buildUINode)&&this.buildUINode.getComponent(G).close(),g(this.updateUINode)&&this.updateUINode.getComponent(L).close()}},{key:"referTowerBuildMenuUI",value:function(){g(this.buildUINode)&&this.buildUINode.getComponent(G).referCurrentUI()}},{key:"closeSomeUI",value:function(){g(this.buildUINode)&&this.buildUINode.getComponent(G).close(),g(this.updateUINode)&&this.updateUINode.getComponent(L).close()}},{key:"showCurrentLevelIconAnim",value:function(e){var o=this,t=new C(this.currentLevelLabelIcon);this.currentLevelLabelIcon.active=!0,this.currentLevelLabelIcon.getComponent(U).string="第"+(this.gameController.getCurrentLevelNum()+1)+"关",t.set({scale:I(2,2,2)}),t.to(.5,{scale:I(1,1,1)},{easing:"backOut"}),t.delay(.8),t.call((function(){o.currentLevelLabelIcon.active=!1,e()})),t.start()}},{key:"showGameWinUI",value:function(e){var o=v(this.gameResultPrefab);o.parent=this.node;var t=this.gameController.getGameConfig().json;o.getComponent(T).setGameResult(!0,e,t,this,this.gameController)}},{key:"showGameLossUI",value:function(e){this.closeSomeUI();var o=v(this.gameResultPrefab);o.parent=this.node;var t=this.gameController.getGameConfig().json;o.getComponent(T).setGameResult(!1,e,t,this,this.gameController)}},{key:"showUIEnterAnim",value:function(e){var o=this;return this.node.emit("enter-game"),this.node.getComponent(B).showEnterAnim().then((function(){return o.node.getComponent(P).showEnterAnim()})).then((function(){return o.showButtonUIEnter()})).then((function(){e&&e()}))}},{key:"showButtonUIEnter",value:function(){var e=this;return new Promise((function(o,t){for(var n=[e.enemyInfoButton,e.towerInfoButton],i=b.getVisibleSize().width,r=[],l=function(e,o){return new Promise((function(t,n){var r=0===o?-1:1,l=new C(e);l.to(.4,{position:I(100*-r+.5*i*r,0,0)}),l.call((function(){console.log("进场结束"),t()})),l.start()}))},s=0;s<n.length;s++){var a=n[s];r.push(l(a,s))}Promise.all(r).then((function(){o()}))}))}},{key:"setUINodeTo3dPos",value:function(e,o){var t;t=this.cameraNode.getComponent(y).convertToUINode(o.position,this.node),e.setPosition(t)}},{key:"onButtonClick",value:function(e,o){switch(console.log("on button click",o),f("GameController").emit("player-button-click-audio"),o){case"start-game":console.log("event",e),e.target.destroy(),this.gameController.node.emit("player-click-game")}}},{key:"setHoldSkillIcon",value:function(e){this.isHoldSkillIcon=e}},{key:"showBossIconAnim",value:function(){var e=this;return new Promise((function(o,t){var n=new h;n.addComponent(N).spriteFrame=e.bossIcon,n.parent=e.node;var i=new C(n);i.set({scale:I(2,2,2),position:I(0,240,0)}),i.to(.2,{scale:I(1,1,1)},{easing:"backIn"}),i.delay(.8),i.hide(),i.call((function(){n.destroy(),o()})),i.start()}))}},{key:"playerClickNextLevelButton",value:function(){this.gameController.enterNextLevel()}}]),o}(k)).prototype,"buildTowerPrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(V.prototype,"updateMenuPrefab",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(V.prototype,"cameraNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(V.prototype,"enemyInfoButton",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(V.prototype,"towerInfoButton",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(V.prototype,"bossIcon",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(V.prototype,"gameResultPrefab",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(V.prototype,"currentLevelLabelIcon",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(V.prototype,"towerInfoLayer",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=t(V.prototype,"bossHealthBar",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=V))||O)),c._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../util/State.js","../util/BezierN.js","../GroundMapCtl.js","../util/FindPathWithAStart.js","../UI/UIController.js","../EnemyController.js","../GameController.js"],(function(e,t){var n,o,a,i,r,s,l,u,c,h,d,m,p,f,g,v,y,C,k,A,M,b,B,w,S,L,N,z,P,T,x,E,O,j,H,D;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,a=e.classCallCheck,i=e.possibleConstructorReturn,r=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass,c=e.get},function(e){h=e.cclegacy,d=e._decorator,m=e.Node,p=e.v3,f=e.find,g=e.SkeletalAnimationComponent,v=e.Tween,y=e.v2,C=e.Quat,k=e.Vec3,A=e.ProgressBarComponent,M=e.isValid},function(e){b=e.BaseObject},function(e){B=e.State},function(e){w=e.BezierN},function(e){S=e.GroundMapCtl},function(e){L=e.FindPathWithAStart},function(e){N=e.UIController},function(e){z=e.DeadEnemyObj},function(e){P=e.GameController}],execute:function(){h._RF.push({},"c8d3fW25B9NIZ69bxowfjcm","EnemyBase",void 0),H=d.ccclass,D=d.property,e("EnemyBase",(T=H("EnemyBase"),x=D({type:m}),T((j=n((O=function(e){function t(){var e,n;a(this,t);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return(n=i(this,(e=r(t)).call.apply(e,[this].concat(u)))).pathList=[],n.state=new B,n.currentPathIndex=0,n.beLockedMaxNum=P.enemyBeLockMaxNum,n.currentbeLockedCount=0,n.cameraNode=null,n.healthBar=null,n.gameConfigJson=null,n.currentHealthCount=0,n.enemyCtl=null,n.currentMoveTw=null,n.groundMapCtl=null,n.beAttackedCb=null,n.bezierPathList=[],n.currentBoneAnimName="",n.enemyColonyCtl=null,s(n,"caidaiEffect",j,l(n)),n.bossHealthBar=null,n}return o(t,e),u(t,[{key:"init",value:function(e,n,o,a){c(r(t.prototype),"init",this).call(this,e,n),this.getMoveType().indexOf("Fly")>-1&&(this.node.position=p(this.node.position.x,10,this.node.position.z)),this.groundMapCtl=f("GameController").getComponent(S),this.gameConfigJson=e,this.beLockedMaxNum=this.gameConfigJson[this.objectType].BeLockedCount,this.currentHealthCount=this.healthCount;var i=this.getLookAtAngle(this.node.position,a);this.node.worldRotation=i}},{key:"enterShowBossEnter",value:function(){this.currentMoveTw&&this.currentMoveTw.stop()}},{key:"contiuePlayMoveAnim",value:function(){var e=this;this.currentMoveTw&&(this.rootNode.getComponent(g).getState(this.currentBoneAnimName).speed=3,this.scheduleOnce((function(){e.rootNode.getComponent(g).getState(e.currentBoneAnimName).speed=1}),3))}},{key:"showEnemyEnterAnim",value:function(e,t,n,o){var a=this,i=this.node;return this.enemyCtl=t,this.enemyCtl.node.on("frozen-all-enemy",this.forzenSelf.bind(this),this),new Promise((function(t,r){var s=new v(i);i.position;s.delay(.1*e),s.show(),s.call((function(){i.active=!0})),s.to(.1,{scale:p(1,1,1)}),s.call((function(){a.startRun(n,o),t()})),s.start()}))}},{key:"startRun",value:function(e,t){this.state.setState("run");var n=this.getMoveType();"Walk"===n?this.proceeWalkLogic(e,t):"Fly"===n&&(this.getIsColony()||this.processFlyLogic(e,t))}},{key:"processFlyLogic",value:function(e,t){var n=this;if(this.gameController.node.emit("play-audio",this.getShowAudio()),"run"===this.state.getState()){for(var o=this.groundMapCtl.getMapSize(),a=[y(e.x,e.y)],i=0;i<8;i++)a.push(y(Math.round(Math.random()*(o.x-1)),Math.round(Math.random()*(o.y-1))));a.push(t);for(var r=[],s=0;s<a.length;s++){var l=a[s],u=this.groundMapCtl.getMapNodeList().getValue(l.x,l.y);if(u){var c=u.position;r.push(p(c.x,10,c.z))}}var h=new w(r).getPointList(200);this.currentMoveTw=this.processMoveAction(h),this.currentMoveTw.call((function(){n.currentBoneAnimName="骨架|AttackAnim";n.rootNode.getComponent(g).getState("骨架|AttackAnim").length;n.shootOneBossBullet().then((function(){var e=[y(0,0),y(0,10),y(10,0),y(10,10)],o=Math.round(Math.random()*(e.length-1));n.processFlyLogic(e[o],t)}))})),this.currentMoveTw.start()}}},{key:"getOneRandomMapPos",value:function(){var e=this.groundMapCtl.getMapSize();return y(Math.round(Math.random()*(e.x-1)),Math.round(Math.random()*(e.y-1)))}},{key:"processMoveAction",value:function(e){for(var t=this,n=new v(this.node),o=function(n,o){var a=0;new C;if(0===o){a=p(t.node.position).subtract(e[o]).length()/t.moveSpeed,t.getLookAtAngle(t.node.position,e[o])}else{var i=p(e[o-1]).subtract(e[o]).length();t.getLookAtAngle(e[o-1],e[o]),a=i/t.moveSpeed}n.call((function(){t.node.lookAt(e[o])})),n.to(a,{position:e[o]}),n.call((function(){}))},a=0;a<e.length;a++)o(n,a);return n}},{key:"proceeWalkLogic",value:function(e,t){var n=this;if(this.gameController.node.emit("play-audio",this.getShowAudio()),"run"===this.state.getState()){for(var o=this.groundMapCtl.getMapNodeList(),a=this.groundMapCtl.getObsPosList(),i=new L(o,[e.x,e.y],[t.x,t.y]),r=[],s=0;s<a.length;s++){var l=a[s];r.push([l.x,l.y])}i.updateObsData(r);for(var u=i.findPathList(),c=[],h=0;h<u.length;h++){var d=u[h];c.push(this.groundMapCtl.getMapNodeList().getValue(d[0],d[1]).position)}var m=new w(c);this.bezierPathList=m.getPointList(50),this.bezierPathList=this.bezierPathList.slice(0,this.bezierPathList.length-5),this.node.position.equals(this.bezierPathList[this.bezierPathList.length-1])?(console.log("不用再走一遍逻辑了"),this.toBeAttack().then((function(){n.proceeWalkLogic(e,t)}))):(this.currentMoveTw=this.processMoveAction(this.bezierPathList),this.currentMoveTw.call((function(){n.toBeAttack().then((function(){n.proceeWalkLogic(e,t)}))})),this.currentMoveTw.start())}}},{key:"toBeAttack",value:function(){var e=this;return new Promise((function(t,n){e.currentBoneAnimName="骨架|AttackAnim";var o=e.rootNode.getComponent(g);o.play(e.currentBoneAnimName);var a=o.getState(e.currentBoneAnimName),i=a.length;a.repeatCount=1,e.gameController.node.emit("play-audio",e.shootAudio);var r=new v(e.node);r.delay(e.animSpeedMulOffset*i),r.call((function(){console.log("普通敌人发动攻击",e.getBaseAttackDamage()),e.gameController.enemyAttacked(e.getBaseAttackDamage())})),r.delay((1-e.animSpeedMulOffset)*i),r.call((function(){t()})),r.start()}))}},{key:"getLookAtAngle",value:function(e,t){var n=p(e).subtract(t).normalize(),o=new C;return C.fromViewUp(o,n,k.UP),o}},{key:"forzenSelf",value:function(){if(this.currentMoveTw){this.currentMoveTw.stop(),this.state.setState("forzen");var e=this.rootNode.getComponent(g).getState(this.currentBoneAnimName);e&&e.pause()}}},{key:"shootOneBossBullet",value:function(){var e=this;return new Promise((function(t,n){e.currentBoneAnimName="骨架|AttackAnim";var o=e.rootNode.getComponent(g);o.play(e.currentBoneAnimName);var a=o.getState(e.currentBoneAnimName).length,i=new v(e.node);i.delay(e.animSpeedMulOffset*a),i.call((function(){e.enemyCtl.bossShootOneEgg(e.node),e.gameController.node.emit("play-audio",e.shootAudio)})),i.delay((1-e.animSpeedMulOffset)*a),i.call((function(){e.currentBoneAnimName="骨架|MoveAnim",o.play(e.currentBoneAnimName),t&&t()})),i.start()}))}},{key:"onLoad",value:function(){var e=this;this.state.addState("over",(function(){e.enemyCtl.removeEnemyInList(e.node),e.node.destroy()})),this.state.addState("to-dead",(function(){e.enemyCtl.pushOneEnemyDeadData(new z(e.objectType,e.getCurrentGoldCount())),e.currentMoveTw&&e.currentMoveTw.stop();var t=new v(e.rootNode);e.unscheduleAllCallbacks(),t.by(.1,{scale:p(1,1,1)}),t.call((function(){e.deadAudio&&e.gameController.node.emit("play-audio",e.deadAudio),e.node.position=p(e.node.position.x,0,e.node.position.z),e.rootNode.active=!1,e.caidaiEffect.eulerAngles=p(0,360*Math.random(),0),p(e.node.position).subtract(p(0,0,0)).length()<18&&(e.caidaiEffect.active=!0),e.gameController.showAddGoldAnimEffect(e.getCurrentGoldCount(),p(e.node.position.x,0,e.node.position.z))})),t.delay(1),t.call((function(){e.state.setState("over")})),t.start()})),this.state.addState("run",(function(){var t=e.rootNode.getComponent(g);t&&(e.currentBoneAnimName="骨架|MoveAnim",t.play(e.currentBoneAnimName)),e.playWalkAudio()})),this.node.on("be-attacked",(function(t){if("run"===e.state.getState()){if(e.beAttackedCb=t.cb,e.currentHealthCount-=t.baseAttackNum,e.bossHealthBar)e.bossHealthBar.children[0].getComponent(A).progress=e.currentHealthCount/e.healthCount;var n=t.baseGasNum;e.currentGasNum+=n;var o=new v(e.node);o.to(.05,{scale:p(1.05,.98,1.05)}),o.to(.05,{scale:p(1,1,1)}),o.start(),e.currentHealthCount<=0&&(e.currentHealthCount=0,e.beAttackedCb&&e.beAttackedCb(!0,e.getHealthCount()),e.state.setState("to-dead")),M(e.healthBar)&&(e.healthBar.getComponent(A).progress=e.currentHealthCount/e.healthCount)}}))}},{key:"start",value:function(){}},{key:"playWalkAudio",value:function(){var e=this;this.walkAudio&&this.gameController.node.emit("play-audio",this.walkAudio,(function(){console.log("音效播放完成",e.state.getState()),"run"===e.state.getState()&&e.playWalkAudio()}))}},{key:"getIsDead",value:function(){return"over"===this.state.getState()||"to-dead"===this.state.getState()}},{key:"getIsCanLock",value:function(){return this.currentbeLockedCount<this.beLockedMaxNum}},{key:"setBeLocked",value:function(e){this.currentbeLockedCount++}},{key:"unSetBeLocked",value:function(e){this.currentbeLockedCount--}},{key:"update",value:function(e){this.enemyColonyCtl&&this.enemyColonyCtl.update(e)}},{key:"playBossEnterAnim",value:function(){var e=this;return this.bossHealthBar=f("Canvas").getComponent(N).showBossHealthBar(),new Promise((function(t,n){for(var o=e.rootNode.getComponent(g),a=o.clips,i=void 0,r=0;r<a.length;r++){var s=a[r];"boss-show"===s.name&&(i=s)}i?(o.play("boss-show"),e.scheduleOnce((function(){t()}),i.length)):(o.play("骨架|MoveAnim"),e.scheduleOnce((function(){t()}),1))}))}},{key:"onDestroy",value:function(){this.enemyCtl&&M(this.enemyCtl.node)&&this.enemyCtl.node.off("frozen-all-enemy",this.forzenSelf,this),this.bossHealthBar&&(this.bossHealthBar.position=p(0,-400,0))}},{key:"getColonyComCtl",value:function(){return this.enemyColonyCtl}}]),t}(b)).prototype,"caidaiEffect",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=O))||E)),h._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyBullet.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../util/State.js","../GameController.js"],(function(t,e){var i,n,a,o,c,s,r,l,d,u,f,h,p,y,v,m,g,E,_,S,k,B,P,b;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inherits,a=t.classCallCheck,o=t.possibleConstructorReturn,c=t.getPrototypeOf,s=t.initializerDefineProperty,r=t.assertThisInitialized,l=t.createClass,d=t.get},function(t){u=t.cclegacy,f=t._decorator,h=t.Node,p=t.Tween,y=t.v3},function(t){v=t.BaseObject},function(t){m=t.State},function(t){g=t.GameController}],execute:function(){u._RF.push({},"17cf4gdnXZPP6GfTwWTkX9d","EnemyBullet",void 0),P=f.ccclass,b=f.property,t("EnemyBullet",(E=P("EnemyBullet"),_=b({type:h}),E((B=i((k=function(t){function e(){var t,i;a(this,e);for(var n=arguments.length,l=new Array(n),d=0;d<n;d++)l[d]=arguments[d];return(i=o(this,(t=c(e)).call.apply(t,[this].concat(l)))).state=new m,i.accY=g.accY,i.currentSpeed=0,i.endPos=null,s(i,"caidaiEffect",B,r(i)),i}return n(e,t),l(e,[{key:"start",value:function(){var t=this;this.state.addState("move-end",(function(){var e=new p(t.rootNode);e.to(.1,{scale:y(2,2,2)}),e.hide(),e.call((function(){t.gameController.enemyAttacked(t.getBaseAttackDamage()),t.caidaiEffect.active=!0})),e.delay(.8+.5*Math.random()),e.call((function(){t.caidaiEffect.active=!1,t.node.destroy()})),e.start()}))}},{key:"init",value:function(t,i,n){d(c(e.prototype),"init",this).call(this,t,i),this.endPos=n,this.caidaiEffect.eulerAngles=y(0,360*Math.random(),0);var a=.2*Math.random()+.8;this.caidaiEffect.scale=y(a,a,a),this.state.setState("run")}},{key:"update",value:function(t){"run"===this.state.getState()&&(this.currentSpeed+=this.accY,this.node.position=y(this.node.position).add(y(0,this.currentSpeed*t,0)),this.node.position.y-this.endPos.y<1&&(console.log("停止"),this.state.setState("move-end")))}}]),e}(v)).prototype,"caidaiEffect",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=k))||S)),u._RF.pop()}}}));

System.register("chunks:///EnemyController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./GroundTiled/GroundTiled.js","./GroundMapCtl.js","./Enemys/EnemyBase.js","./Enemys/EnemyBullet.js","./GameController.js"],(function(e,t){var n,o,i,r,a,l,s,u,d,m,c,g,y,v,h,f,p,C,L,b,E,N,w,D,P,_,k,x,I,W,B,A,G,z,O,j,T,S,M,R,V,F,H,J,q,K;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_temp:void 0}),{setters:[function(e){n=e.classCallCheck,o=e.applyDecoratedDescriptor,i=e.inherits,r=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,m=e._decorator,c=e.JsonAsset,g=e.Prefab,y=e.Node,v=e.find,h=e.v3,f=e.Tween,p=e.CameraComponent,C=e.instantiate,L=e.Vec2,b=e.Component,E=e.isValid},function(e){N=e.State},function(e){w=e.GroundTiled},function(e){D=e.GroundMapCtl},function(e){P=e.EnemyBase},function(e){_=e.EnemyBullet},function(e){k=e.GameController}],execute:function(){d._RF.push({},"9eb73bkCLlAgoJJ0ubFFvcV","EnemyController",void 0),q=m.ccclass,K=m.property,e("DeadEnemyObj",(function e(t,o){n(this,e),this.enemyType="",this.dropGoldCount=0,this.enemyType=t,this.dropGoldCount=o})),e("EnemyController",(x=q("EnemyController"),I=K({type:c}),W=K({type:g}),B=K({type:y}),A=K({type:y}),G=K({type:y}),z=K({type:g}),O=K({type:g}),x((S=o((T=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,u=new Array(i),d=0;d<i;d++)u[d]=arguments[d];return o=r(this,(e=a(t)).call.apply(e,[this].concat(u))),l(o,"gameConfigRes",S,s(o)),l(o,"enemysPrefabList",M,s(o)),o.gameConfig=null,o.currentWaveIndex=0,o.waveData=null,o.state=new N,o.addEnemyDuraction=1,o.enemyNodeList=[],o.currentRandomEnemyTypeList=[],l(o,"startPosNodeList",R,s(o)),o.endPos=null,l(o,"enemyHealthBarCtlNode",V,s(o)),l(o,"cameraNode",F,s(o)),l(o,"bosssPrefabList",H,s(o)),l(o,"enemyBulletPrefabList",J,s(o)),o.gameController=null,o.allWaveAddOverCb=null,o.allEnemyDeadCb=null,o.boosIsLive=!1,o.currentLevelDeadEnemyDataList=[],o.uiControllerNode=null,o}return i(t,e),u(t,[{key:"onLoad",value:function(){var e=this;this.node.on("destroy-all-enemy",(function(t){for(var n=0,o=0;o<e.enemyNodeList.length;o++){var i=e.enemyNodeList[o];n+=i.getComponent(P).getCurrentGoldCount(),i.destroy()}e.enemyNodeList=[],t&&t(n)})),this.node.on("init-level-label",(function(){e.node.emit("refer-current-wave-level",e.gameController.getCurrentLevelNum(),0)}))}},{key:"start",value:function(){var e=this;this.uiControllerNode=v("Canvas"),this.gameConfig=this.gameConfigRes.json,this.gameController=this.node.getComponent(k),this.endPos=h(0,0,0),this.schedule((function(){if("start-add-enemy"===e.state.getState()){var t=e.waveData.EnemyType;if(e.node.emit("refer-current-wave-level",e.gameController.getCurrentLevelNum(),e.currentWaveIndex),e.currentWaveIndex<=t.length-2){var n=t[e.currentWaveIndex];e.addOneWaveEnemy(n),e.currentWaveIndex++}else if(e.currentWaveIndex===t.length-1){var o=t[e.currentWaveIndex];e.addOneBossEnemy(o),e.currentWaveIndex++}else console.log("敌人增加完毕"),e.state.setState("add-enemy-end"),Promise.all([new Promise((function(t,n){e.allEnemyDeadCb=t}))]).then((function(){console.log("游戏胜利"),e.uiControllerNode.emit("show-end-dialog",e.gameController.getCurrentLevelNum(),(function(){e.gameController.gameWin(e.currentLevelDeadEnemyDataList)}))}))}}),4)}},{key:"playBossEnterAnim",value:function(e){var t=this;return new Promise((function(n,o){var i=e.getComponent(P);i?i.playBossEnterAnim().then((function(){n()})):t.scheduleOnce((function(){n()}),1)}))}},{key:"startGame",value:function(){var e=this;this.currentLevelDeadEnemyDataList=[],this.currentWaveIndex=0,this.waveData=this.gameConfig["Level_"+this.gameController.getCurrentLevelNum()],this.uiControllerNode.emit("show-start-dialog",this.gameController.getCurrentLevelNum(),(function(){e.uiControllerNode.emit("show-guide",(function(){e.uiControllerNode.emit("show-guide",(function(){e.scheduleOnce((function(){e.state.setState("start-add-enemy")}),2.5)}))}))})),Promise.all([new Promise((function(t,n){e.allWaveAddOverCb=t})),new Promise((function(e,t){}))]).then((function(){console.log("游戏胜利"),e.uiControllerNode.emit("show-end-dialog",e.gameController.getCurrentLevelNum(),(function(){e.gameController.gameWin(e.currentLevelDeadEnemyDataList)}))}))}},{key:"continueGame",value:function(){var e=this;this.currentWaveIndex--,this.waveData=this.gameConfig["Level_"+this.gameController.getCurrentLevelNum()],this.state.setState("start-add-enemy"),Promise.all([new Promise((function(t,n){e.allWaveAddOverCb=t})),new Promise((function(t,n){e.allEnemyDeadCb=t}))]).then((function(){console.log("游戏胜利"),e.gameController.gameWin(e.currentLevelDeadEnemyDataList)}))}},{key:"pushOneEnemyDeadData",value:function(e){console.log("push one enemy dead data",e),this.currentLevelDeadEnemyDataList.push(e),this.gameController.playerData.activeEnemy(e.enemyType)}},{key:"pauseGame",value:function(){}},{key:"showCameraBackAnim",value:function(){var e=this;return new Promise((function(t,n){var o=new f(e.cameraNode);o.to(.5,{position:h(30,42,30),eulerAngles:h(-45,45,0)}),o.call((function(){t()})),o.start(),new f(e.cameraNode.getComponent(p)).to(.5,{orthoHeight:22}).start()}))}},{key:"addOneBossEnemy",value:function(e){var t=this;console.log("增加一个boss");var n=this.node.getComponent(D).getInEdageIndexList(),o=n[Math.round(Math.random()*(n.length-1))],i=this.node.getComponent(D).getMapNodeList().getValue(o.x,o.y),r=e[0].type,a=C(this.bosssPrefabList[r]);return a.parent=this.node,a.position=h(i.position.x,0,i.position.z),a.active=!1,a.getComponent(P).init(this.gameConfig,this.gameController,i.position,this.endPos),this.enemyNodeList.push(a),new Promise((function(e,n){return t.playBossEnterAnim(a).then((function(){t.node.emit("enter-continue-play-move-anim"),a.getComponent(P).showEnemyEnterAnim(1,t,o,new L(5,5)),e()}))}))}},{key:"addOneWaveEnemy",value:function(e){for(var t=this,n=[],o=this.node.getComponent(D).getInEdageIndexList(),i=this.node.getComponent(D).getMapNodeList(),r=0;r<e.length;r++)e[r].count;for(var a=[],l=0;l<e.length;l++)for(var s=e[l],u=0;u<s.count;u++)a.push(s.type);console.log("type list",a);var d=Math.round(Math.random()*o.length);0===this.currentWaveIndex&&0===this.gameController.getCurrentLevelNum()&&(d=0),console.log("current wave",this.currentWaveIndex),console.log("current level",this.gameController.getCurrentLevelNum());for(var m=function(e,r){var a=d+e;a>=o.length&&(a-=o.length),console.log("index list length",o.length);var l=o[a];console.log("start index",a);var s=i.getValue(l.x,l.y);if(E(s)&&s.getComponent(w)&&s.getComponent(w).getIsVoid()){var u=C(t.enemysPrefabList[r]);u.parent=t.node,u.position=h(s.position.x,0,s.position.z),u.active=!1,u.getComponent(P).init(t.gameConfig,t.gameController,s.position,t.endPos),t.enemyNodeList.push(u),n.push(u.getComponent(P).showEnemyEnterAnim(e,t,l,new L(5,5)))}},c=0;c<a.length;c++)m(c,a[c]);return Promise.all(n)}},{key:"removeEnemyInList",value:function(e){for(var t=0;t<this.enemyNodeList.length;t++){this.enemyNodeList[t].uuid===e.uuid&&this.enemyNodeList.splice(t,1)}0===this.enemyNodeList.length&&this.allEnemyDeadCb&&(this.allEnemyDeadCb(),this.allEnemyDeadCb=null)}},{key:"getCurrentEnemyNodeList",value:function(){return this.enemyNodeList}},{key:"enemyAttacked",value:function(e){this.gameController.getComponent(k).enemyAttacked(e)}},{key:"frozenAllEnemy",value:function(){this.state.setState("game-over"),this.node.emit("frozen-all-enemy")}},{key:"bossShootOneEgg",value:function(e){var t=e.getComponent(P);if(t){var n=t.getEnemyBulletType(),o=C(this.enemyBulletPrefabList[n]);o.parent=this.node,o.position=e.position,o.getComponent(_).init(this.gameController.getGameConfig().json,this.gameController,this.endPos)}}},{key:"getDeadEnemyData",value:function(){return this.currentLevelDeadEnemyDataList}}]),t}(b)).prototype,"gameConfigRes",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(T.prototype,"enemysPrefabList",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=o(T.prototype,"startPosNodeList",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=o(T.prototype,"enemyHealthBarCtlNode",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=o(T.prototype,"cameraNode",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(T.prototype,"bosssPrefabList",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),J=o(T.prototype,"enemyBulletPrefabList",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=T))||j)),d._RF.pop()}}}));

System.register("chunks:///TowerBuildBaseCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./GroundMapCtl.js","./GameController.js"],(function(e,t){var o,i,n,r,l,s,a,u,d,c,p,f,h,g,v,C,m,B,w,y,T,b,_,P,z;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,c=e._decorator,p=e.Prefab,f=e.v2,h=e.instantiate,g=e.v3,v=e.Tween,C=e.Component},function(e){m=e.GroundMapCtl},function(e){B=e.GameController}],execute:function(){d._RF.push({},"09d8fCuijNMwIzg+sejpSkn","TowerBuildBaseCtl",void 0),P=c.ccclass,z=c.property,e("TowerBuildBaseCtl",(w=P("TowerBuildBaseCtl"),y=z({type:p}),w((_=o((b=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,u=new Array(i),d=0;d<i;d++)u[d]=arguments[d];return o=r(this,(e=l(t)).call.apply(e,[this].concat(u))),s(o,"towerBuildBasePrefab",_,a(o)),o.groundTiledNodeList=null,o.gameController=null,o}return i(t,e),u(t,[{key:"showTowerBuildBaseEnterAnim",value:function(){this.gameController=this.node.getComponent(B);var e=this.gameController.getGameConfig().json["Level_"+this.gameController.getCurrentLevelNum()].TowerBuildPos;this.groundTiledNodeList=this.node.getComponent(m).getMapNodeList();for(var t=[],o=0;o<e.length;o++){var i=e[o],n=f(i[0],i[1]),r=this.groundTiledNodeList.getValue(n.x,n.y),l=h(this.towerBuildBasePrefab);l.parent=this.node,l.position=g(r.position.x,20,r.position.z),this.node.getComponent(m).setTowerBuildBaseOnTiled(l,n.x,n.y),t.push(this.showEnterAnim(l,o))}return Promise.all(t)}},{key:"showEnterAnim",value:function(e,t){var o=this;return e.active=!1,new Promise((function(i,n){var r=new v(e),l=e.position;r.delay(.2*t),r.call((function(){e.active=!0})),r.to(.5,{position:g(l.x,0,l.z)},{easing:"bounceOut"}),r.call((function(){o.gameController.node.emit("play-audio","drop"),i()})),r.start()}))}},{key:"frozenAllTowerBuildBase",value:function(){this.node.emit("frozen-tower-build-base")}}]),t}(C)).prototype,"towerBuildBasePrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=b))||T)),d._RF.pop()}}}));

System.register("chunks:///Data/PlayerData.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var r,n,a;return{setters:[function(e){r=e.createClass,n=e.classCallCheck},function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"3f2cezzOStAIpBjPLZ7+fqQ","PlayerData",void 0),e("PlayData",function(){function e(t){n(this,e),this.currentSkillCount=2,this.currentActiveSkillCount=3,this.currentGoldCount=0,this.gameController=null,this.currentLevelNum=0,this.currentTowerLevelData=[],this.currentInitRedHeartCounnt=3,this.currentRedHeardCount=0,this.currentActiveEnemyMap={},this.currentPowerCount=0,this.gameController=t;var r=this.getLocalData("game-time");console.log("game time",r),r?(this.currentSkillCount=Number(this.getLocalData("current-skill-count")),this.currentActiveSkillCount=Number(this.getLocalData("current-active-skill-count")),this.currentLevelNum=Number(this.getLocalData("current-level-num")),this.currentPowerCount=Number(this.getLocalData("curent-power-count")),this.currentTowerLevelData=JSON.parse(this.getLocalData("tower-level-data")),this.currentInitRedHeartCounnt=Number(this.getLocalData("current-init-red-heart-count")),this.currentActiveEnemyMap=JSON.parse(this.getLocalData("active-enemy-list")),console.log("current active enemy map",this.currentActiveEnemyMap)):(this.setLocalData("game-time","1"),this.setLocalData("current-active-skill-count",this.currentActiveSkillCount+""),this.setLocalData("current-skill-count",this.currentSkillCount+""),this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt+""),this.setLocalData("active-enemy-list",JSON.stringify(this.currentActiveEnemyMap)),this.initTowerLevelLocalData(this.gameController.getGameConfig().json)),this.currentRedHeardCount=this.currentInitRedHeartCounnt}return r(e,[{key:"initTowerLevelLocalData",value:function(e){var t=[];for(var r in e)"Tower"===e[r].Type&&t.push(e[r]);t=t.sort((function(e,t){return e.index-t.index}));for(var n=[],a=0;a<t.length;a++){var o=t[a],u={IconSprteFrame:o.IconSprteFrame,isActive:!1,currentLevel:0,TowerType:o.TowerType};a<2?(u.isActive=!0,u.currentLevel=1):(u.isActive=!1,u.currentLevel=0),n.push(u)}console.log("json",n),this.currentTowerLevelData=n,this.setLocalData("tower-level-data",JSON.stringify(n))}},{key:"clearLocalData",value:function(){localStorage.clear()}},{key:"getLocalData",value:function(e){return console.log("获取游戏数据",e),localStorage.getItem(e)}},{key:"setLocalData",value:function(e,t){localStorage.setItem(e,t)}},{key:"updateGoldCount",value:function(e){}},{key:"getCurrentGoldCount",value:function(){return this.currentGoldCount}},{key:"initGoldCount",value:function(){this.currentGoldCount=0}},{key:"addGoldCount",value:function(e){this.currentGoldCount+=e,this.gameController.node.emit("update-gold-label",this.currentGoldCount,e)}},{key:"newGame",value:function(){this.currentRedHeardCount=this.currentInitRedHeartCounnt,this.currentGoldCount=this.gameController.getGameConfig().json["Level_"+this.currentLevelNum].InitGoldCount}},{key:"enterNextLevel",value:function(){this.currentLevelNum++;var e=this.gameController.getGameConfig().json["Level_"+this.currentLevelNum].InitGoldCount;this.currentGoldCount=e,this.setLocalData("current-level-num",this.currentLevelNum+"")}},{key:"activeTower",value:function(e){console.log("active tower index",e),console.log("current tower level data",this.currentTowerLevelData),this.currentTowerLevelData[e].isActive=!0,this.currentTowerLevelData[e].currentLevel=1,this.setLocalData("tower-level-data",JSON.stringify(this.currentTowerLevelData))}},{key:"getWeaponIsActive",value:function(e){return this.currentTowerLevelData[e].isActive}},{key:"getCurrentTowerLocalLevel",value:function(e){return this.currentTowerLevelData[e].currentLevel}},{key:"getCurrentTowersLocalLevelData",value:function(){return this.currentTowerLevelData}},{key:"updateTowerLocalLevel",value:function(e,t){this.currentTowerLevelData[e].currentLevel=t,this.setLocalData("tower-level-data",JSON.stringify(this.currentTowerLevelData))}},{key:"getFirstNeedToActiveTowerIndex",value:function(){for(var e=0,t=0;t<this.currentTowerLevelData.length;t++){if(!this.currentTowerLevelData[t].isActive){e=t;break}}return e}},{key:"getCurrentInitRedHeartCount",value:function(){return this.currentInitRedHeartCounnt}},{key:"getAddOneRedHeartCostGoldCount",value:function(){var e=this.getCurrentInitRedHeartCount();return(1+e)*e*e*100}},{key:"addLocalInitRedHeartCount",value:function(e){this.currentInitRedHeartCounnt+=e,this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt.toString())}},{key:"getCurrentRedHeartCount",value:function(){return this.currentRedHeardCount}},{key:"addRedHeartCount",value:function(e){this.currentRedHeardCount+=e,this.gameController.referRedHeardUI()}},{key:"getCurrentActiveTowerList",value:function(){for(var e=[],t=0;t<this.currentTowerLevelData.length;t++){this.currentTowerLevelData[t].isActive&&e.push(t)}return console.log("current active tower list",e),e}},{key:"getCurrentActiveEnemyMap",value:function(){return this.currentActiveEnemyMap}},{key:"getEnemyIsActive",value:function(e){return!!this.currentActiveEnemyMap[e]}},{key:"activeEnemy",value:function(e){this.currentActiveEnemyMap[e]||(this.currentActiveEnemyMap[e]=!0,console.log("激活一个敌人",e),console.log("current active enemy map",this.currentActiveEnemyMap),this.setLocalData("active-enemy-list",JSON.stringify(this.currentActiveEnemyMap)),console.log("data = ",this.getLocalData("active-enemy-list")),this.gameController.activeEnemySuccess(e))}},{key:"getIsShowed",value:function(e){return!!Boolean(this.getLocalData("set-object-showed"+e))}},{key:"setShowed",value:function(e){this.setLocalData("set-object-showed"+e,"true")}},{key:"getIsShowGuide",value:function(e){return Boolean(this.getLocalData("guide-step-"+e))}},{key:"setIsShowGuide",value:function(e){this.setLocalData("guide-step-"+e,"true")}},{key:"getQueryString",value:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),r=window.location.search.substr(1).match(t);return null!=r?unescape(r[2]):null}},{key:"addPowerCount",value:function(e){this.currentPowerCount+=e,this.setLocalData("curent-power-count",this.currentPowerCount.toString()),this.gameController.referPowerCountLabel()}},{key:"getPowerCount",value:function(){return this.currentPowerCount}},{key:"recoverRedHeartCount",value:function(){this.currentRedHeardCount=this.currentInitRedHeartCounnt}}]),e}()),a._RF.pop()}}}));

System.register("chunks:///Effect/WinGoldAnimEffect.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,o,i,l,a,r,s,c,u,d,f,p,h,m,v;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){n=t.inherits,o=t.classCallCheck,i=t.possibleConstructorReturn,l=t.getPrototypeOf,a=t.createClass},function(t){r=t.cclegacy,s=t._decorator,c=t.SkeletalAnimationComponent,u=t.v3,d=t.find,f=t.Tween,p=t.Component}],execute:function(){r._RF.push({},"2ee3e+XrHFJlYuGFP9mqdRS","WinGoldAnimEffect",void 0),v=s.ccclass,s.property,t("WinGoldAnimEffect",(h=v("WinGoldAnimEffect"),h(m=function(t){function e(){var t,n;o(this,e);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=i(this,(t=l(e)).call.apply(t,[this].concat(r)))).goldCount=0,n.skelete=null,n}return n(e,t),a(e,[{key:"start",value:function(){var t=this.node.getComponent(c);if(this.skelete=t,t){var e=t.defaultClip;t.getState(e.name).repeatCount=1,t.play(e.name)}}},{key:"setGoldCount",value:function(t,e){var n=this,o=u(this.node.position).subtract(u(-25,10,0)).length()/50;this.goldCount=t,d("GameController").emit("play-audio","金币掉落1");var i=new f(this.node);i.delay(3),i.to(o,{position:u(-25,10,0)}),i.call((function(){e.playerData.addGoldCount(t),n.node.destroy()})),i.start()}}]),e}(p))||m)),r._RF.pop()}}}));

System.register("chunks:///Home/HomeIcon.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js"],(function(e,t){var o,r,n,i,s,a,c,u,l,d,p,f,v,h,y,H,m,_,g,I,S;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,s=e.getPrototypeOf,a=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){l=e.cclegacy,d=e._decorator,p=e.Node,f=e.v3,v=e.Component},function(e){h=e.State}],execute:function(){l._RF.push({},"8213do7DSVI0IEO26O7s126","HomeIcon",void 0),I=d.ccclass,S=d.property,e("HomeIcon",(y=I("HomeIcon"),H=S({type:p}),y((g=o((_=function(e){function t(){var e,o;n(this,t);for(var r=arguments.length,u=new Array(r),l=0;l<r;l++)u[l]=arguments[l];return o=i(this,(e=s(t)).call.apply(e,[this].concat(u))),a(o,"redHeartNode",g,c(o)),o.state=new h,o}return r(t,e),u(t,[{key:"start",value:function(){this.state.setState("run")}},{key:"frozenHomeIcon",value:function(){this.state.setState("frozen")}},{key:"freeHomeIconn",value:function(){this.state.setState("run")}},{key:"update",value:function(e){"run"===this.state.getState()&&(this.redHeartNode.eulerAngles=this.redHeartNode.eulerAngles.add(f(0,1,0)))}}]),t}(v)).prototype,"redHeartNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=_))||m)),l._RF.pop()}}}));

System.register("chunks:///GameController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./TowerBuildBase/TowerBuildBase.js","./GroundMapCtl.js","./Towers/TowerBase.js","./EnemyController.js","./TowerBuildBaseCtl.js","./Data/PlayerData.js","./Effect/WinGoldAnimEffect.js","./Home/HomeIcon.js"],(function(e,t){var n,o,r,i,a,l,u,s,c,m,d,f,p,h,y,v,g,C,w,b,B,S,G,k,I,P,_,A,N,D,z,E,T,H,L,j,R,x,J,O,F,M,U,W,V,Y,q,X,K,Q,Z,$,ee,te;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_class3:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,u=e.assertThisInitialized,s=e.createClass},function(e){c=e.cclegacy,m=e._decorator,d=e.Node,f=e.JsonAsset,p=e.Prefab,h=e.Tween,y=e.v3,v=e.isValid,g=e.PhysicsSystem,C=e.instantiate,w=e.SkeletalAnimationComponent,b=e.Component},function(e){B=e.State},function(e){S=e.TowerBuildBase},function(e){G=e.GroundMapCtl},function(e){k=e.TowerBase},function(e){I=e.EnemyController},function(e){P=e.TowerBuildBaseCtl},function(e){_=e.PlayData},function(e){A=e.WinGoldAnimEffect},function(e){N=e.HomeIcon}],execute:function(){c._RF.push({},"5b4c0ApYS1B3bhehBCF/cvX","GameController",void 0),ee=m.ccclass,te=m.property,e("GameController",(D=ee("GameController"),z=te({type:d}),E=te({type:f}),T=te({type:p}),H=te({type:d}),L=te({type:d}),j=te({type:d}),R=te({type:d}),x=te({type:p}),J=te({type:p}),D(($=Z=function(e){function t(){var e,n;r(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return n=i(this,(e=a(t)).call.apply(e,[this].concat(s))),l(n,"enemyHealthBarCtlNode",M,u(n)),l(n,"gameConfigJson",U,u(n)),l(n,"towersPrefabList",W,u(n)),l(n,"startGameButton",V,u(n)),n.state=new B,l(n,"uiController",Y,u(n)),l(n,"plate",q,u(n)),l(n,"gameStartButtonBase",X,u(n)),l(n,"homeIconPrefab",K,u(n)),n.homeIconNode=null,n.playerData=null,l(n,"goldAnim3dPrefab",Q,u(n)),n.homeIconTw=null,n}return o(t,e),s(t,[{key:"onLoad",value:function(){this.playerData=new _(this);var e=new h(this.plate);e.repeatForever(new h(this.plate).to(20,{eulerAngles:y(0,360,0)}).set({eulerAngles:y(0,0,0)})),e.start()}},{key:"playerClickSaveLifeButton",value:function(){var e=this;return new Promise((function(t,n){t(),v(e.homeIconNode)&&(e.homeIconNode.active=!1),e.node.emit("destroy-all-enemy",(function(t){e.showHomeIconEnterAnim().then((function(){e.playerData.recoverRedHeartCount(),e.uiController.emit("refer-red-heart-label"),e.state.setState("run"),e.node.getComponent(I).continueGame()}))}))}))}},{key:"playerClickShareButton",value:function(){return new Promise((function(e,t){e()}))}},{key:"playerClickRetryButton",value:function(){var e=this;this.playerData.newGame(),this.enterGame().then((function(){e.uiController.emit("refer-red-heart-label"),e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(I).startGame()}))}},{key:"start",value:function(){var e=this;g.instance.enable=!0,this.state.addState("ready",(function(){console.log("enter state ",e.state.getState())})),this.state.setState("ready"),this.node.on("build-one-tower",(function(t,n){if(e.uiController.emit("complete-current-guide"),t<e.towersPrefabList.length){var o=C(e.towersPrefabList[t]);o.parent=e.node,o.getComponent(k).init(e.gameConfigJson.json,e);var r=y(n.position.x,0,n.position.z);o.setPosition(r),n.getComponent(S).setTargetTower(o),o.getComponent(k).setTowerBuildBase(n)}})),this.state.addState("play-start-button-anim",(function(){e.uiController.emit("complete-current-guide"),e.node.emit("play-audio","按钮音效"),e.node.emit("play-bg-music"),e.playStatrButtonPressAnim().then((function(){return new Promise((function(t,n){new h(e.startGameButton).by(1,{position:y(0,-10,0)}).call((function(){console.log("play over"),e.startGameButton.destroy(),t()})).start()}))})).then((function(){var t=new h(e.gameStartButtonBase);return t.to(.2,{scale:y(0,0,0)}),t.call((function(){e.gameStartButtonBase.destroy()})),t.start(),e.node.getComponent(G).showGroundEnterAnim()})).then((function(){return e.enterGame()})).then((function(){return e.showUIEnterAnim()})).then((function(){e.state.setState("run"),e.node.getComponent(I).startGame(),e.playerData.newGame(),e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount())}))})),this.state.addState("game-loss",(function(){console.log("进入游戏失败的状态"),e.uiController.emit("close-weapon-info-layer"),e.node.getComponent(I).frozenAllEnemy(),e.node.getComponent(P).frozenAllTowerBuildBase(),e.homeIconNode.getComponent(N).frozenHomeIcon();var t=e.node.getComponent(I).getDeadEnemyData();e.scheduleOnce((function(){e.uiController.emit("show-game-loss-ui",t)}),.6)}))}},{key:"showUIEnterAnim",value:function(){var e=this;return new Promise((function(t,n){e.uiController.emit("show-ui-enter-anim",(function(){t()}))}))}},{key:"showHomeIconEnterAnim",value:function(){var e=this;return new Promise((function(t,n){v(e.homeIconNode)||(e.homeIconNode=C(e.homeIconPrefab),e.homeIconNode.parent=e.node);var o=e.node.getComponent(G);if(o){var r=o.getMapNodeList().getValue(5,5);e.homeIconNode.position=y(r.position.x,20,r.position.z),e.homeIconNode.getComponent(N).freeHomeIconn(),r.active=!1;var i=new h(e.homeIconNode);e.homeIconNode.active=!0,i.call((function(){r.active=!0})),i.to(2,{position:y(r.position.x,0,r.position.z)},{easing:"quadOut"}),i.call((function(){t()})),i.start()}}))}},{key:"playStatrButtonPressAnim",value:function(){var e=this;return new Promise((function(t,n){var o=e.startGameButton.getChildByName("StartGameButton").getComponent(w);if(o){var r=o.defaultClip,i=o.getState(r.name);i.repeatCount=1;var a=i.length;o.play(r.name),e.scheduleOnce((function(){console.log("播放完成"),t()}),a)}else t()}))}},{key:"playerTouch3dObject",value:function(e){if("ready"===this.state.getState())for(var t=0;t<e.length;t++){e[t].collider.node.uuid===this.startGameButton.uuid&&this.state.setState("play-start-button-anim")}else"run"===this.state.getState()&&this.node.emit("touch-screen-to-3d",g.instance.raycastResults)}},{key:"update",value:function(e){}},{key:"getGameConfig",value:function(){return this.gameConfigJson}},{key:"getCurrentLevelNum",value:function(){return this.playerData.currentLevelNum}},{key:"showAddGoldAnimEffect",value:function(e,t){var n=C(this.goldAnim3dPrefab);n.parent=this.node,n.getComponent(A).setGoldCount(e,this),n.position=t}},{key:"showBossEnterState",value:function(){this.node.emit("show-boss-enter-state")}},{key:"gameWin",value:function(e){this.uiController.emit("close-all-ui"),this.uiController.emit("close-weapon-info-layer"),"run"===this.state.getState()&&(this.state.setState("show-game-result"),this.uiController.emit("show-game-win-ui",e))}},{key:"enterNextLevel",value:function(){var e=this;this.playerData.enterNextLevel(),console.log("进入下一关"),this.enterGame().then((function(){e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(I).startGame()}))}},{key:"enterGame",value:function(){var e=this;return new Promise((function(t,n){v(e.homeIconNode)&&(e.homeIconNode.active=!1),e.node.emit("destroy-all-tower"),e.node.emit("destroy-all-tower-build-base"),e.node.emit("destroy-all-enemy"),e.node.emit("init-level-label"),e.node.getComponent(P).showTowerBuildBaseEnterAnim().then((function(){return e.showHomeIconEnterAnim()})).then((function(){return e.showCurrentLevelIconAnim()})).then((function(){t()}))}))}},{key:"showCurrentLevelIconAnim",value:function(){var e=this;return new Promise((function(t,n){e.uiController.emit("show-current-level-icon-anim",(function(){t&&t()}))}))}},{key:"enemyAttacked",value:function(e){(console.log("敌人发动了攻击",e),"run"===this.state.getState())&&(this.playerData.getCurrentRedHeartCount()>0&&(this.playerData.addRedHeartCount(-1),0===this.playerData.getCurrentRedHeartCount()&&(console.log("游戏结束"),this.state.setState("game-loss"))))}},{key:"referRedHeardUI",value:function(){this.uiController.emit("refer-red-heart-label")}},{key:"activeEnemySuccess",value:function(e){console.log("active enemy succcess",e),this.uiController.emit("refer-enemy-info-cell",e)}},{key:"referPowerCountLabel",value:function(){this.uiController.emit("refer-current-power-label",this.playerData.currentPowerCount)}}]),t}(b),Z.accY=-1,Z.enemyBeLockMaxNum=1,M=n((F=$).prototype,"enemyHealthBarCtlNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=n(F.prototype,"gameConfigJson",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=n(F.prototype,"towersPrefabList",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=n(F.prototype,"startGameButton",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=n(F.prototype,"uiController",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=n(F.prototype,"plate",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=n(F.prototype,"gameStartButtonBase",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=n(F.prototype,"homeIconPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=n(F.prototype,"goldAnim3dPrefab",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=F))||O)),c._RF.pop()}}}));

System.register("chunks:///BulletBase.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./BaseObject.js","./util/State.js","./util/BezierN.js","./Enemys/EnemyBase.js","./EnemyController.js","./GameController.js"],(function(e,t){var o,i,n,s,r,a,l,d,c,h,u,p,f,m,g,y,v,b,S,C,w,k,E,B,P,N,z,T,A,D,Y,_,M,j,x,I;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,s=e.possibleConstructorReturn,r=e.getPrototypeOf,a=e.initializerDefineProperty,l=e.assertThisInitialized,d=e.createClass,c=e.get},function(e){h=e.cclegacy,u=e._decorator,p=e.Prefab,f=e.v3,m=e.Quat,g=e.Vec3,y=e.ColliderComponent,v=e.isValid,b=e.Tween,S=e.instantiate},function(e){C=e.BaseObject},function(e){w=e.State},function(e){k=e.BezierN},function(e){E=e.EnemyBase},function(e){B=e.EnemyController},function(e){P=e.GameController}],execute:function(){h._RF.push({},"90e683Z9ntM7pLuSDO8IdqW","BulletBase",void 0),x=u.ccclass,I=u.property,e("BulletBase",(N=x("BulletBase"),z=I({type:p}),T=I({type:p}),A=I({type:p}),N((_=o((Y=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,d=new Array(i),c=0;c<i;c++)d[c]=arguments[c];return(o=s(this,(e=r(t)).call.apply(e,[this].concat(d)))).state=new w,o.speedY=0,o.accY=P.accY,o.currentDirection=f(0,0),o.currentInitSpeedY=6,o.currentCostAcc=-3,o.maxLeftTime=1+Math.random(),o.colliderComponent=null,o.gameConfigJson={},o.targetTowerBase=null,o.targetEnemyNode=null,o.movePathList=[],o.currentSpeedY=10,a(o,"exporeEffectPrefab",_,l(o)),a(o,"daodanweijiPrefab",M,l(o)),a(o,"baozhaEffectPrefab",j,l(o)),o.moveState=new w,o}return i(t,e),d(t,[{key:"onLoad",value:function(){this.state.addState("sleep",(function(){}))}},{key:"init",value:function(e,o,i){var n=this;if(c(r(t.prototype),"init",this).call(this,e,o),this.baseAttackNum+=i.baseAttackNum,this.targetTowerBase=i.targetTower,i&&i.direction){var s=i.direction;this.currentDirection=f(s);var a=f(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);this.currentDirection.add(a);var l=new m;m.fromViewUp(l,f(s).multiplyScalar(-1).normalize(),g.UP),this.node.worldRotation=l,this.state.setState("run")}var d=i.targetEnemy;if(d&&(this.targetEnemyNode=d),this.gameConfigJson=e,this.colliderComponent=this.node.getComponent(y),this.colliderComponent.on("onTriggerEnter",this.onTriggerEnter.bind(this)),this.scheduleOnce((function(){n.node.destroy()}),this.leftTime),"Bezier"===this.getMoveType())if(v(this.targetEnemyNode)){var h=this.targetEnemyNode.position,u=f(this.node.position).add(h).multiplyScalar(.5).add(f(0,15,0)),p=[this.node.position,u,h];this.movePathList=new k(p).getPointList(50);var b=this.processMove(this.movePathList);b.call((function(){n.state.setState("run"),n.moveState.setState("bezier-end")})),b.start()}else this.node.destroy();else this.state.setState("run")}},{key:"processMove",value:function(e){for(var t=new b(this.node),o=1;o<e.length;o++)this.processPosAndQuat(t,e[o],e[o-1]);return t}},{key:"processPosAndQuat",value:function(e,t,o){var i=this,n=f(o).subtract(t).length()/this.getMoveSpeed();e.call((function(){i.node.lookAt(t)})),e.to(n,{position:t})}},{key:"onTriggerEnter",value:function(e){var t=this;if("SkyDown"!==this.getMoveType()){var o=e.otherCollider;if(v(o)&&v(o.node)&&o.node.name.indexOf("Wall")>1&&(console.log(" other collier node",o.node.name),this.node.destroy()),o&&o.getComponent(E)&&!o.getComponent(E).getIsDead()){if(console.log("base attack num",this.baseAttackNum),this.getIsCollisionDestroy())if(this.gameController.node.emit("play-audio",this.getBoomAudioStr()),this.state.setState("enter-to-destroy"),v(this.exporeEffectPrefab)){this.rootNode.active=!1;var i=S(this.exporeEffectPrefab);i.parent=this.node;var n=new b(i);n.by(.1,{scale:f(1,1,1)}),n.call((function(){t.node.destroy()})),n.start()}else this.node.destroy();o.node.emit("be-attacked",{baseAttackNum:this.baseAttackNum,baseGasNum:this.baseGasNum,cb:function(e,o){console.log("是否死了",e),t.targetTowerBase&&t.targetTowerBase.enemyDeadByThis(e,o)}})}}}},{key:"start",value:function(){}},{key:"update",value:function(e){var t=this;if("run"===this.state.getState())if("Bezier"===this.getMoveType())if(v(this.targetEnemyNode)){var o=f(this.targetEnemyNode.position).add(f(0,2,0)).subtract(this.node.position);this.node.position=f(this.node.position).add(o.multiplyScalar(.2*e*this.getMoveSpeed())),"bezier-end"===this.moveState.getState()&&this.node.lookAt(this.targetEnemyNode.position)}else this.node.destroy();else if("SkyDown"===this.getMoveType()){if(this.currentSpeedY+=2,this.currentSpeedY%10==0){var i=S(this.daodanweijiPrefab);i.parent=this.node.parent,i.position=this.node.position;var n=new b(i);n.by(.2,{scale:f(1,1,1)}),n.call((function(){i.destroy()})),n.start()}if(this.node.position=f(this.node.position).add(f(0,e*this.currentSpeedY,0)),this.node.position.y>30){this.state.setState("move-over"),this.node.position=f(this.node.position.x,30,this.node.position.z);var s=this.checkDownPos();if(v(s)){console.log("end pos",s),this.node.position=f(s.x,30,s.z),this.rootNode.scale=f(1,-1,1);var r=new b(this.node);r.to(.6,{position:s}),r.call((function(){t.showBaozhaEffect()})),r.start()}else this.node.destroy()}}else{this.speedY+=this.accY*e;var a=this.node.position,l=(a.y,this.speedY,this.currentDirection.normalize().multiplyScalar(this.moveSpeed*e));l.y<0&&(l.y=0),this.node.setPosition(f(a.x+l.x,a.y+l.y,a.z+l.z)),this.node.getPosition().y<=0&&this.isCollisionGround&&(this.speedY=this.currentInitSpeedY,this.currentInitSpeedY+=this.currentCostAcc,this.currentInitSpeedY<0&&this.state.setState("sleep"))}}},{key:"checkDownPos",value:function(){var e=this.gameController.node.getComponent(B).getCurrentEnemyNodeList();if(0!==e.length){for(var t=[],o=0;o<e.length;o++){var i=e[o];if(v(i)&&!i.getComponent(E).getIsDead()){for(var n=[],s=0;s<e.length;s++){var r=e[s];if(i.uuid!==r.uuid&&!r.getComponent(E).getIsDead()){var a=f(i.position).subtract(r.position).length();n.push(a)}}n=(n=n.sort((function(e,t){return e-t}))).slice(0,Math.min(3,n.length));for(var l=0,d=0;d<n.length;d++)l+=n[d];t.push({node:i,dis:l})}}return t=t.sort((function(e,t){return e.dis-t.dis})),v(t[0].node)?t[0].node.position:null}this.node.destroy()}},{key:"showBaozhaEffect",value:function(){var e=this,t=S(this.exporeEffectPrefab);t.position=this.node.position,t.parent=this.node.parent,this.gameController.node.emit("play-audio",this.boomAudio);var o=new b(t);o.by(.3,{scale:f(5,5,5)}),o.call((function(){e.rangeAttackEnemy(t),t.destroy()})),o.start()}},{key:"rangeAttackEnemy",value:function(e){for(var t=this,o=this.gameController.node.getComponent(B).getCurrentEnemyNodeList(),i=0;i<o.length;i++){var n=o[i],s=f(n.position).subtract(e.position).length();s<10&&(console.log("dis",s),console.log("攻击敌人"),n.emit("be-attacked",{baseAttackNum:this.getCurrentAttackNum(),baseGasNum:0,cb:function(e,o){t.targetTowerBase&&t.targetTowerBase.enemyDeadByThis(e,o)}}))}this.node.destroy()}}]),t}(C)).prototype,"exporeEffectPrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(Y.prototype,"daodanweijiPrefab",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(Y.prototype,"baozhaEffectPrefab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=Y))||D)),h._RF.pop()}}}));

System.register("chunks:///ChooseWeaponInfoRateCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js"],(function(t,e){var r,o,i,n,a,s,u,c,l,p,d,h,f,v,y,m,C,g,_,b,S,B,I,R,w,P,x,L,k,z,F;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(t){r=t.applyDecoratedDescriptor,o=t.inherits,i=t.classCallCheck,n=t.possibleConstructorReturn,a=t.getPrototypeOf,s=t.initializerDefineProperty,u=t.assertThisInitialized,c=t.createClass},function(t){l=t.cclegacy,p=t._decorator,d=t.Node,h=t.SpriteFrame,f=t.v2,v=t.v3,y=t.find,m=t.Tween,C=t.Component},function(t){g=t.State}],execute:function(){l._RF.push({},"6601aZ3NHFPo42l2cZ4+0Lq","ChooseWeaponInfoRateCtl",void 0),z=p.ccclass,F=p.property,t("ChooseWeaponInfoRateCtl",(_=z("ChooseWeaponInfoRateCtl"),b=F({type:d}),S=F({type:h}),B=F({type:h}),I=F({type:d}),_((P=r((w=function(t){function e(){var t,r;i(this,e);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return r=n(this,(t=a(e)).call.apply(t,[this].concat(c))),s(r,"rateButtonList",P,u(r)),s(r,"rateButtonSpriteFrameLight",x,u(r)),s(r,"rateButtonSpriteFrameGray",L,u(r)),s(r,"rateButtonParentNode",k,u(r)),r.currentRateIndex=0,r.state=new g,r}return o(e,t),c(e,[{key:"start",value:function(){for(var t=this,e=0;e<this.rateButtonList.length;e++){var r=this.rateButtonList[e],o=f(0,1).rotate(2*Math.PI*1/3*e-2*Math.PI*270/360).normalize().multiplyScalar(80);r.position=v(o.x,o.y,0)}this.state.addState("wait",(function(){console.log("current rate index",t.currentRateIndex),t.node.emit("refer-choose-rate-cost",t.getCurrentChooseRate())})),this.state.setState("wait")}},{key:"onButtonClick",value:function(t,e){var r=this;if(y("GameController").emit("player-button-click-audio"),e.indexOf("rate")>-1){if(console.log("旋转按钮"),"wait"!==this.state.getState())return;this.currentRateIndex++;var o=this.currentRateIndex%3*120;this.state.setState("move");for(var i=[],n=0;n<this.rateButtonList.length;n++){var a=this.rateButtonList[n],s=f(0,1).rotate(2*Math.PI*1/3*n-2*Math.PI*(270+o)/360).normalize().multiplyScalar(80);i.push(this.moveToAction(a,s))}Promise.all(i).then((function(){r.state.setState("wait")}))}}},{key:"moveToAction",value:function(t,e){return new Promise((function(r,o){var i=new m(t);i.to(.2,{position:v(e.x,e.y,0)}),i.call((function(){r()})),i.start()}))}},{key:"getCurrentChooseRate",value:function(){return[1,10,100][this.currentRateIndex%3]}}]),e}(C)).prototype,"rateButtonList",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=r(w.prototype,"rateButtonSpriteFrameLight",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=r(w.prototype,"rateButtonSpriteFrameGray",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=r(w.prototype,"rateButtonParentNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=w))||R)),l._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyColonyCom.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/BezierN.js","./EnemyBase.js"],(function(t,e){var i,r,o,s,n,a,h,u,c,l;return{setters:[function(t){i=t.createClass,r=t.classCallCheck},function(t){o=t.cclegacy,s=t._decorator,n=t.Vec3,a=t.v3,h=t.Quat,u=t.Tween},function(t){c=t.BezierN},function(t){l=t.EnemyBase}],execute:function(){o._RF.push({},"dd328sjHD1OM4+6gaUYeHWb","EnemyColonyCom",void 0),s.ccclass,s.property,t("EnemyColonyCom",function(){function t(e,i,o){r(this,t),this.currentCheckDuraction=0,this.currentMoveDir=new n(Math.random()-.5,Math.random()-.5,Math.random()-.5),this.targetNode=null,this.currentNodeList=[],this.isFirstTargetNode=!1,this.movePathList=null,this.currentMoveTw=null,this.fenliForceWeight=10,this.juheliForceWeight=1,this.duilieliWeight=1,this.floowerfirstNodeWeight=5,this.fenliDistance=4,this.juheDistance=6,this.duilieDistance=60,this.currentPathListIndex=0,this.movePathList=new c(o).getPointList(200),this.targetNode=i,this.currentNodeList=e}return i(t,[{key:"update",value:function(t){if(!this.isFirstTargetNode){var e=this.processCheckDir().normalize();this.currentMoveDir=a(this.currentMoveDir).add(e.multiplyScalar(t)),this.targetNode.position=a(this.targetNode.position).add(a(this.currentMoveDir).multiplyScalar(t));var i=new h;h.fromViewUp(i,a(this.currentMoveDir).normalize().multiplyScalar(-1),n.UP);var r=new h;h.lerp(r,new h(this.targetNode.rotation),i,t),this.targetNode.rotation=r}}},{key:"processLisanForce",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.uuid!==this.targetNode.uuid&&i.getComponent(l).getColonyComCtl())a(i.position).subtract(this.targetNode.position).length()<this.fenliDistance&&t.push(i)}if(t.length>0){for(var r=a(0,0,0),o=0;o<t.length;o++){var s=t[o].position,n=a(this.targetNode.position).subtract(s);r.add(n)}return r.multiplyScalar(this.fenliForceWeight),r}return a(0,0,0)}},{key:"processJuHeForce",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.getComponent(l).getColonyComCtl())a(i.position).subtract(this.targetNode.position).length()>this.juheDistance&&t.push(i)}for(var r=a(0,0,0),o=0;o<t.length;o++){var s=t[o].position;r.add(s)}return t.length>0?(r=r.multiplyScalar(1/t.length),a(r).subtract(this.targetNode.position).multiplyScalar(this.juheliForceWeight)):a(0,0,0)}},{key:"processDuiLieForce",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.getComponent(l).getColonyComCtl())a(i.position).subtract(this.targetNode.position).length()<=this.duilieDistance&&t.push(i)}var r=a(0,0,0);if(t.length>0){for(var o=0;o<t.length;o++){var s=t[o].getComponent(l);r.add(s.getColonyComCtl().getCurrentMoveDir())}return r.multiplyScalar(this.duilieliWeight*(1/t.length))}return a(0,0,0)}},{key:"processCheckDir",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.getComponent(l).getColonyComCtl()&&(t.push(i),1===t.length)){if(t[0].uuid===this.targetNode.uuid)return this.isFirstTargetNode=!0,this.processMoveTween(),a(0,0,0);break}}var r=this.processByFirstNodeForce(t[0]),o=this.processLisanForce(),s=this.processDuiLieForce(),n=this.processJuHeForce();return o.add(s).add(n).add(r)}},{key:"processByFirstNodeForce",value:function(t){return a(t.position).subtract(this.targetNode.position).multiplyScalar(this.floowerfirstNodeWeight)}},{key:"processMoveTween",value:function(){var t=new u(this.targetNode);this.currentMoveTw=t,t.set({position:this.movePathList[0]});for(var e=function(t,e,i){var r=a(i).subtract(e).length(),o=a(e).subtract(i).normalize(),s=new h;h.fromViewUp(s,o,n.UP),t.to(r/5,{position:e,rotation:s})},i=1;i<this.movePathList.length-1;i++){e(t,this.movePathList[i],this.movePathList[i+1])}new u(this.targetNode).repeatForever(t).start()}},{key:"processPathListDir",value:function(){}},{key:"getCurrentMoveDir",value:function(){return this.currentMoveDir}}]),t}()),o._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyCube.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./EnemyBase.js"],(function(e,n){var t,s,c,r,u,i,o,a,l,p;return e({_dec:void 0,_class:void 0}),{setters:[function(e){t=e.inherits,s=e.classCallCheck,c=e.possibleConstructorReturn,r=e.getPrototypeOf},function(e){u=e.cclegacy,i=e._decorator},function(e){o=e.EnemyBase}],execute:function(){u._RF.push({},"ac439Ca0GFJGrdHaYw+IQip","EnemyCube",void 0),p=i.ccclass,i.property,e("EnemyCube",(a=p("EnemCube"),a(l=function(e){function n(){return s(this,n),c(this,r(n).apply(this,arguments))}return t(n,e),n}(o))||l)),u._RF.pop()}}}));

System.register("chunks:///Enemys/WinGold.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,o,s,c,r,i,l,u,a,p,d;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,o=t.createClass,s=t.classCallCheck,c=t.possibleConstructorReturn,r=t.getPrototypeOf},function(t){i=t.cclegacy,l=t._decorator,u=t.Component}],execute:function(){i._RF.push({},"cf9deP2StlNm75zKMIn6aZo","WinGold",void 0),d=l.ccclass,l.property,t("WinGold",(a=d("WinGold"),a(p=function(t){function e(){return s(this,e),c(this,r(e).apply(this,arguments))}return n(e,t),o(e,[{key:"start",value:function(){}}]),e}(u))||p)),i._RF.pop()}}}));

System.register("chunks:///SkillComponent/CrazyRotateSkill.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../Towers/TowerBase.js"],(function(e,t){var o,n,r,a,i,l,s,c,u,d,p,h,v,f,g,y,C,k,b,w,R,S;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,d=e._decorator,p=e.Node,h=e.Tween,v=e.v3},function(e){f=e.BaseObject},function(e){g=e.TowerBase}],execute:function(){u._RF.push({},"621d4adyJFG1KkUA3lbByt0","CrazyRotateSkill",void 0),R=d.ccclass,S=d.property,e("CrazyRotateSkill",(y=R("CrazyRotateSkill"),C=S({type:p}),y((w=o((b=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,c=new Array(n),u=0;u<n;u++)c[u]=arguments[u];return o=a(this,(e=i(t)).call.apply(e,[this].concat(c))),l(o,"weaponGunNode",w,s(o)),o}return n(t,e),c(t,[{key:"onLoad",value:function(){var e=this;this.node.on("init",(function(t,o){e.init(t,o)}))}},{key:"start",value:function(){var e=this,t=function(){for(var t=e.node.getComponent(g).bulletStartPosList,o=0;o<t.length;o++){var n=t[o],r=v(n.worldPosition).subtract(e.node.position),a=e.getCurrentAttackNum();e.node.getComponent(g).shootOneBullet(e.baseAttackRate+e.node.getComponent(f).baseAttackRate,r,a)}};this.node.on("release-skill",(function(o){var n=e.getCurrentShootRate()+e.node.getComponent(g).getCurrentShootRate();console.log("shoot rate",n);var r=1/n;e.schedule(t,r);var a=e.getCurrentSkillRotateAngle(),i=a/e.rotateSpeed,l=new h(e.node),s=Math.random()-.5;e.weaponGunNode&&(e.weaponGunNode.eulerAngles=v(0,0,0)),l.by(i,{eulerAngles:v(0,a*(s/Math.abs(s)),0)}),l.call((function(){e.unschedule(t),o&&o()})),l.start()}))}}]),t}(f)).prototype,"weaponGunNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=b))||k)),u._RF.pop()}}}));

System.register("chunks:///UI/AStartFindPath.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/My2Array.js"],(function(t,e){var o,n,r,i,s,a,h,u,l,c,d,p,v,y,f,g,m,L,C,P,N,M,x,V,b,k,A,T;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inherits,r=t.classCallCheck,i=t.possibleConstructorReturn,s=t.getPrototypeOf,a=t.initializerDefineProperty,h=t.assertThisInitialized,u=t.createClass},function(t){l=t.cclegacy,c=t._decorator,d=t.Node,p=t.Color,v=t.instantiate,y=t.v3,f=t.SpriteComponent,g=t.isValid,m=t.UITransformComponent,L=t.v2,C=t.Component},function(t){P=t.default}],execute:function(){l._RF.push({},"aee76uGSzxFLKJAvvNlf0aC","AStartFindPath",void 0),k=c.ccclass,A=c.property,T=function(){function t(e,o,n){r(this,t),this.x=0,this.y=0,this.node=null,this.parentNode=null,this.fValue=0,this.gValue=0,this.hValue=0,this.x=e,this.y=o,this.node=n}return u(t,[{key:"setParentNode",value:function(t){this.parentNode=t}}]),t}(),t("AStartFindPath",(N=k("AStartFindPath"),M=A({type:d}),N((b=o((V=function(t){function e(){var t,o;r(this,e);for(var n=arguments.length,u=new Array(n),l=0;l<n;l++)u[l]=arguments[l];return o=i(this,(t=s(e)).call.apply(t,[this].concat(u))),a(o,"pointNode",b,h(o)),o.my2dArray=null,o.obsColor=p.RED,o.startColor=p.BLUE,o.endColor=p.GREEN,o.currentTouchNode=null,o.openList=[],o.closeList=[],o.startObj=null,o.size=30,o.currentPathList=[],o.checkPointList=[],o}return n(e,t),u(e,[{key:"start",value:function(){var t=this,e=this.size,o=new P;this.my2dArray=o;for(var n=0;n<e;n++){for(var r=[],i=0;i<e;i++){var s=v(this.pointNode);s.active=!0,s.parent=this.node,s.position=y(-.5*(e-1)*22+22*i,-.5*(e-1)*22+22*n,0),r.push(new T(i,n,s))}o.pushList(r)}for(var a=0;a<30;a++)this.randomObs(e);var h=this.getRandomPoint(e);h.node.getComponent(f).color=this.startColor,this.startObj=h,this.node.on(d.EventType.TOUCH_START,(function(o){g(t.currentTouchNode)&&(t.currentTouchNode.node.getComponent(f).color=p.WHITE);var n=o.getUILocation();console.log("touch pos",n);for(var r=0;r<e;r++)for(var i=0;i<e;i++){var s=t.my2dArray.getValue(i,r).node;s.getComponent(m).getBoundingBoxToWorld().contains(n)&&(s.getComponent(f).color=t.endColor,t.currentTouchNode=t.my2dArray.getValue(i,r))}t.currentTouchNode&&(t.openList=[],t.closeList=[],t.processFindPath())}))}},{key:"processFValue",value:function(t,e){var o,n=null;return n=e||t.parentNode,o=t.parentNode.gValue+this.getDistance(t,n),t.gValue=o,t.hValue=this.getDistance(t,this.currentTouchNode),t.gValue+t.hValue}},{key:"getDistance",value:function(t,e){var o=Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2);return Math.sqrt(o)}},{key:"getNearPointObj",value:function(t){for(var e=t.x,o=t.y,n=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],r=[],i=0;i<n.length;i++){var s=e+n[i][0],a=o+n[i][1],h=this.my2dArray.getValue(s,a);h&&!h.node.getComponent(f).color.equals(this.obsColor)&&r.push(h)}return r}},{key:"processFindPath",value:function(){for(this.openList.push(this.startObj);this.openList.length>0;){var t=this.getFvalueMinNode();if(console.log("current obj",t),t.x===this.currentTouchNode.x&&t.y===this.currentTouchNode.y){if(console.log("找到了终点"),this.checkPointList.length>0)for(var e=0;e<this.checkPointList.length;e++){this.checkPointList[e].node.getComponent(f).color=p.WHITE}if(this.currentPathList.length>0)for(var o=0;o<this.currentPathList.length;o++){this.currentPathList[o].node.getComponent(f).color=p.WHITE}for(var n=[];t.x!==this.startObj.x||t.y!==this.startObj.y;)n.push(t.parentNode),(t=t.parentNode).node.getComponent(f).color=p.BLACK;return n.splice(n.length-1,1),void(this.currentPathList=n)}this.closeList.push(t);for(var r=this.getNearPointObj(t),i=0;i<r.length;i++){var s=r[i];if(!this.checkIsInCloseList(s))if(this.checkisInOpenList(s))this.processFValue(s,t)<s.fValue&&(s.setParentNode(t),s.fValue=this.processFValue(s));else s.setParentNode(t),s.fValue=this.processFValue(s),s.node.getComponent(f).color=p.GRAY,this.checkPointList.push(s),this.openList.push(s)}}}},{key:"checkisInOpenList",value:function(t){for(var e=0;e<this.openList.length;e++){var o=this.openList[e];if(o.x===t.x&&o.y===t.y)return!0}return!1}},{key:"checkIsInCloseList",value:function(t){for(var e=0;e<this.closeList.length;e++){var o=this.closeList[e];if(o.x===t.x&&o.y===t.y)return!0}return!1}},{key:"getFvalueMinNode",value:function(){for(var t=Number.MAX_VALUE,e=0,o=0;o<this.openList.length;o++){var n=this.openList[o];n.fValue<t&&(t=n.fValue,e=o)}return this.openList.splice(e,1)[0]}},{key:"getRandomPoint",value:function(t){var e=L(Math.round(Math.random()*(t-1)),Math.round(Math.random()*(t-1)));return this.my2dArray.getValue(e.x,e.y)}},{key:"randomObs",value:function(t){var e={x:Math.round(Math.random()*t-10)+5,y:Math.round(Math.random()*t-10)+5},o=L(0,1),n=[2*Math.PI*45/360,.5*Math.PI,Math.PI];o.rotate(n[Math.round(Math.random()*(n.length-1))]).normalize(),console.log("dir",o),o.x=Math.round(Math.abs(o.x))*Math.abs(o.x)/o.x,o.y=Math.round(Math.abs(o.y))*Math.abs(o.y)/o.y,console.log("dir",o);for(var r=0;r<4;r++){var i=L(o).multiplyScalar(r),s=L(e.x,e.y).add(i),a=this.my2dArray.getValue(s.x,s.y);a&&(a.node.getComponent(f).color=p.RED)}}}]),e}(C)).prototype,"pointNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=V))||x)),l._RF.pop()}}}));

System.register("chunks:///UI/DialogCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,o){var i,t,n,a,l,r,c,s,d,u,g,v,p,f,h,y,D,b,L,m,C,w,_,P,N,O,k,x,A,z,I,T,B,F,J;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inherits,n=e.classCallCheck,a=e.possibleConstructorReturn,l=e.getPrototypeOf,r=e.initializerDefineProperty,c=e.assertThisInitialized,s=e.createClass},function(e){d=e.cclegacy,u=e._decorator,g=e.JsonAsset,v=e.Node,p=e.LabelComponent,f=e.loader,h=e.SpriteFrame,y=e.SpriteComponent,D=e.find,b=e.v3,L=e.Tween,m=e.Component}],execute:function(){d._RF.push({},"6cd17627e9OW6ntczLEzTI0","DialogCtl",void 0),F=u.ccclass,J=u.property,e("DialogCtl",(C=F("DialogCtl"),w=J({type:g}),_=J({type:v}),P=J({type:v}),N=J({type:v}),O=J({type:v}),C((A=i((x=function(e){function o(){var e,i;n(this,o);for(var t=arguments.length,s=new Array(t),d=0;d<t;d++)s[d]=arguments[d];return i=a(this,(e=l(o)).call.apply(e,[this].concat(s))),r(i,"dialogConfigJsonAsset",A,c(i)),r(i,"dialogBgNode",z,c(i)),r(i,"dialogLayer",I,c(i)),r(i,"dialogLabel",T,c(i)),r(i,"dialogPicNode",B,c(i)),i.currentLevelDialogData=[],i.currentDialogIndex=0,i.dialogOverCb=null,i}return t(o,e),s(o,[{key:"start",value:function(){var e=this;this.node.on("show-start-dialog",(function(o,i){console.log("展示开始对话的内容",o),e.dialogBgNode.active=!0,e.dialogLayer.active=!0,e.currentLevelDialogData=e.dialogConfigJsonAsset.json["Level_"+o].StartDialogList,e.currentDialogIndex=0,e.showOneDialog(),e.dialogOverCb=function(){e.closeDialogLayer().then((function(){i()}))}})),this.node.on("show-end-dialog",(function(o,i){console.log("展示开始对话的内容",o),e.dialogBgNode.active=!0,e.dialogLayer.active=!0,e.currentLevelDialogData=e.dialogConfigJsonAsset.json["Level_"+o].EndDialogList,e.currentDialogIndex=0,e.showOneDialog(),e.dialogOverCb=function(){e.closeDialogLayer().then((function(){i()}))}}))}},{key:"closeDialogLayer",value:function(){var e=this;return new Promise((function(o,i){e.showTLPOutAnim().then((function(){e.dialogBgNode.active=!1,e.dialogLayer.active=!1,e.dialogLabel.getComponent(p).string="",o()}))}))}},{key:"showOneDialog",value:function(){var e=this;if(this.currentDialogIndex>=this.currentLevelDialogData.length)this.dialogOverCb&&this.dialogOverCb();else{var o=this.currentLevelDialogData[this.currentDialogIndex],i="特朗普懂帝"+Math.round(4*Math.random());f.loadRes(i+"/spriteFrame",h,(function(i,t){i||e.showTLPEnterAnim().then((function(){e.dialogPicNode.getComponent(y).spriteFrame=t;var i=o.Text;e.dialogLabel.getComponent(p).string=i}))})),this.currentDialogIndex++}}},{key:"onButtonClick",value:function(e,o){switch(D("GameController").emit("player-button-click-audio"),o){case"next-button":console.log("下一步"),this.showOneDialog()}}},{key:"showTLPEnterAnim",value:function(){var e=this;return new Promise((function(o,i){if(e.dialogPicNode.position.x>-500)o();else{e.dialogPicNode.position=b(-1e3,-161.675,0);var t=new L(e.dialogPicNode);t.to(.2,{position:b(-407.421,-161,0)}),t.call((function(){o()})),t.start()}}))}},{key:"showTLPOutAnim",value:function(){var e=this;return new Promise((function(o,i){var t=new L(e.dialogPicNode);t.to(.2,{position:b(-1e3,-161,0)}),t.call((function(){o()})),t.start()}))}}]),o}(m)).prototype,"dialogConfigJsonAsset",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(x.prototype,"dialogBgNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=i(x.prototype,"dialogLayer",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=i(x.prototype,"dialogLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(x.prototype,"dialogPicNode",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=x))||k)),d._RF.pop()}}}));

System.register("chunks:///UI/EnemyHealthBarCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var n,r,a,o,i,l,c,u,s,p,d,y,f,m,v,h,_,C,b,B,g,H;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inherits,a=e.classCallCheck,o=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){s=e.cclegacy,p=e._decorator,d=e.Prefab,y=e.CameraComponent,f=e.Component}],execute:function(){s._RF.push({},"6dc3cXIfPpCN6tR8iLaqvBX","EnemyHealthBarCtl",void 0),g=p.ccclass,H=p.property,e("EnemyHealthBarCtl",(m=g("EnemyHealthBarCtl"),v=H({type:d}),h=H({type:y}),m((b=n((C=function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,u=new Array(r),s=0;s<r;s++)u[s]=arguments[s];return n=o(this,(e=i(t)).call.apply(e,[this].concat(u))),l(n,"enemyHealthBarPrefab",b,c(n)),l(n,"cameraNode",B,c(n)),n}return r(t,e),u(t,[{key:"onLoad",value:function(){this.node.on("add-one-enemy",(function(e){})),this.node.on("remove-one-enemy",(function(){}))}},{key:"start",value:function(){}},{key:"update",value:function(e){}}]),t}(f)).prototype,"enemyHealthBarPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(C.prototype,"cameraNode",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=C))||_)),s._RF.pop()}}}));

System.register("chunks:///UI/MonsterInfoLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var n,o,r,i,a,l,s,c,p,u,d,f,y,b,m,g,v,h,L,_,C,I,w,z,S,M,N,F,R,j,k,D,P;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass},function(e){p=e.cclegacy,u=e._decorator,d=e.Node,f=e.LabelComponent,y=e.loader,b=e.SpriteFrame,m=e.SpriteComponent,g=e.Component}],execute:function(){p._RF.push({},"19cfe434XNK0JMjRNGL9hyg","MonsterInfoLayer",void 0),D=u.ccclass,P=u.property,e("MonsterInfoLayer",(v=D("MonsterInfoLayer"),h=P({type:d}),L=P({type:d}),_=P({type:d}),C=P({type:d}),I=P({type:d}),w=P({type:d}),v((M=n((S=function(e){function t(){var e,n;r(this,t);for(var o=arguments.length,c=new Array(o),p=0;p<o;p++)c[p]=arguments[p];return n=i(this,(e=a(t)).call.apply(e,[this].concat(c))),l(n,"nameLabel",M,s(n)),l(n,"speedLabel",N,s(n)),l(n,"healthCountLabel",F,s(n)),l(n,"storyLabel",R,s(n)),l(n,"monsterInfoLayer",j,s(n)),l(n,"spriteIconNode",k,s(n)),n}return o(t,e),c(t,[{key:"start",value:function(){var e=this;this.node.on("close-monster-info-layer",(function(){e.monsterInfoLayer.active=!1})),this.node.on("close-weapon-info-layer",(function(){e.monsterInfoLayer.active=!1}))}},{key:"showMonsterInfoLayer",value:function(e){var t=this;this.monsterInfoLayer.active=!0,this.nameLabel.getComponent(f).string=e.getObjectName(),this.healthCountLabel.getComponent(f).string=e.getHealthCount().toString(),this.speedLabel.getComponent(f).string=e.getMoveSpeed().toString(),this.storyLabel.getComponent(f).string=e.getDesString(),y.loadRes(e.getIconSprteFrame()+"/spriteFrame",b,(function(e,n){t.spriteIconNode.getComponent(m).spriteFrame=n}))}}]),t}(g)).prototype,"nameLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=n(S.prototype,"speedLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=n(S.prototype,"healthCountLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(S.prototype,"storyLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=n(S.prototype,"monsterInfoLayer",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=n(S.prototype,"spriteIconNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=S))||z)),p._RF.pop()}}}));

System.register("chunks:///UI/EnemyInfoCellPrefab.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","./MonsterInfoLayer.js"],(function(e,o){var t,n,i,r,l,s,c,a,u,f,p,d,h,y,m,v,C,I,g,b,w,N,_,k,j,P,E;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,c=e.assertThisInitialized,a=e.createClass,u=e.get},function(e){f=e.cclegacy,p=e._decorator,d=e.Node,h=e.find,y=e.loader,m=e.SpriteFrame,v=e.SpriteComponent},function(e){C=e.BaseObject},function(e){I=e.MonsterInfoLayer}],execute:function(){f._RF.push({},"ede41pxC3ZOx6d6u8MOr8l/","EnemyInfoCellPrefab",void 0),P=p.ccclass,E=p.property,e("EnemyInfoCellPrefab",(g=P("EnemyInfoCellPrefab"),b=E({type:d}),w=E({type:d}),g((k=t((_=function(e){function o(){var e,t;i(this,o);for(var n=arguments.length,a=new Array(n),u=0;u<n;u++)a[u]=arguments[u];return t=r(this,(e=l(o)).call.apply(e,[this].concat(a))),s(t,"enemyIconNode",k,c(t)),s(t,"newInfoTipsNode",j,c(t)),t.uiControllerNode=null,t}return n(o,e),a(o,[{key:"init",value:function(e,t){var n=this,i=t.enemyType;console.log("enemy type",i),this.uiControllerNode=h("Canvas");var r=e.getGameConfig().json;u(l(o.prototype),"init",this).call(this,r,e,null,null,i),this.gameController.node.on("refer-enemy-info-cell",(function(){n.referUI()})),this.node.on("click",this.onButtonClick.bind(this),this),this.referUI()}},{key:"referUI",value:function(){var e=this,o=this.getEnemyIsActive();if(console.log("is active",o),o){var t=this.getIconSprteFrame();console.log("sprite frame icon str",t),y.loadRes(t+"/spriteFrame",m,(function(o,t){o||(e.enemyIconNode.getComponent(v).spriteFrame=t)})),this.getIsShowed()||(this.newInfoTipsNode.active=!0,this.uiControllerNode.emit("show-new-enemy-info-tips"))}}},{key:"onButtonClick",value:function(){h("GameController").emit("player-button-click-audio"),console.log("click"),this.getEnemyIsActive()&&(this.uiControllerNode.getComponent(I).showMonsterInfoLayer(this),this.newInfoTipsNode.active=!1,this.setShowed(),this.uiControllerNode.emit("show-new-enemy-info-tips"))}}]),o}(C)).prototype,"enemyIconNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(_.prototype,"newInfoTipsNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=_))||N)),f._RF.pop()}}}));

System.register("chunks:///UI/InfoLayerCtlBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js"],(function(e,t){var o,n,i,r,a,c,s,l,u,d,h,f,p,y,v,w,g,b,B,k,m,S,N,_,C,L,I,D,P,z;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,c=e.initializerDefineProperty,s=e.assertThisInitialized,l=e.createClass},function(e){u=e.cclegacy,d=e._decorator,h=e.Node,f=e.v3,p=e.view,y=e.Tween,v=e.SpriteComponent,w=e.Component},function(e){g=e.State}],execute:function(){u._RF.push({},"48a3c0EK8xEhbYTC0+7u64U","InfoLayerCtlBase",void 0),P=d.ccclass,z=d.property,e("InfoLayerCtlBase",(b=P("InfoLayerCtlBase"),B=z({type:h}),k=z({type:h}),m=z({type:h}),S=z({type:""}),b((C=o((_=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return o=r(this,(e=a(t)).call.apply(e,[this].concat(l))),c(o,"bectledLayerNode",C,s(o)),c(o,"blockBgNode",L,s(o)),c(o,"ctlShowButton",I,s(o)),c(o,"hideDir",D,s(o)),o.state=new g,o}return n(t,e),l(t,[{key:"start",value:function(){var e=this;this.bectledLayerNode.position=f(.5*this.bectledLayerNode.width*("Right"===this.hideDir?1:-1),0,0),this.state.setState("close"),this.state.addState("play-open-anim",(function(){console.log("播放武器信息ui打开的动画"),e.hideButton().then((function(){return e.showInfoLayerNode()})).then((function(){e.showBlockBgNode()})).then((function(){e.state.setState("open")}))})),this.state.addState("play-close-anim",(function(){e.hideBlockBgNode().then((function(){return e.hideInfoLayerNode()})).then((function(){return e.showCtlInfoButtonn()})).then((function(){e.state.setState("close")}))})),this.node.on("close-weapon-info-layer",(function(){"open"===e.state.getState()&&e.state.setState("play-close-anim")}))}},{key:"closeUICb",value:function(){}},{key:"showCtlInfoButtonn",value:function(){var e=this;return new Promise((function(t,o){var n=p.getVisibleSize().width,i=new y(e.ctlShowButton),r="Right"===e.hideDir?1:-1;i.to(.1,{position:f(.5*n*r-100*r,0,0)}),i.call((function(){t()})),i.start()}))}},{key:"hideInfoLayerNode",value:function(){var e=this;return new Promise((function(t,o){var n=new y(e.bectledLayerNode),i="Right"===e.hideDir?1:-1;n.to(.2,{position:f(.5*e.bectledLayerNode.width*i,0,0)}),n.call((function(){t()})),n.start()}))}},{key:"hideBlockBgNode",value:function(){var e=this;return new Promise((function(t,o){t(),e.blockBgNode.active=!1}))}},{key:"showInfoLayerNode",value:function(){var e=this;return new Promise((function(t,o){var n=new y(e.bectledLayerNode);n.to(.2,{position:f(0,0,0)}),n.call((function(){t()})),n.start()}))}},{key:"showBlockBgNode",value:function(){var e=this;return new Promise((function(t,o){e.blockBgNode.active=!0;var n=new y(e.blockBgNode.getComponent(v));n.call((function(){t()})),n.start()}))}},{key:"hideButton",value:function(){var e=this,t=p.getVisibleSize().width;return new Promise((function(o,n){var i=new y(e.ctlShowButton),r="Right"===e.hideDir?1:-1;i.to(.1,{position:f(.5*t*r+100*r,0,0)}),i.call((function(){o()})),i.start()}))}},{key:"onButtonClick",value:function(e,t){switch(t){case"show-info-layer":console.log("武器信息按钮"),"close"===this.state.getState()&&(this.state.setState("play-open-anim"),this.node.emit("close-tower-menu-ui"));break;case"bg-node-click":console.log("背景节点点击 ",this.state.getState()),"open"===this.state.getState()&&this.state.setState("play-close-anim")}}}]),t}(w)).prototype,"bectledLayerNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=o(_.prototype,"blockBgNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=o(_.prototype,"ctlShowButton",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=o(_.prototype,"hideDir",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Right"}}),N=_))||N)),u._RF.pop()}}}));

System.register("chunks:///UI/EnemyInfoLayerCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../GameController.js","./EnemyInfoCellPrefab.js","./InfoLayerCtlBase.js"],(function(e,n){var o,t,i,l,r,a,s,c,f,y,p,u,m,d,g,v,C,I,h,b,_,E,N,P,w,k,j,B,M,L,T,x;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inherits,i=e.classCallCheck,l=e.possibleConstructorReturn,r=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass,f=e.get},function(e){y=e.cclegacy,p=e._decorator,u=e.Node,m=e.Prefab,d=e.instantiate,g=e.v3},function(e){v=e.BaseObject},function(e){C=e.GameController},function(e){I=e.EnemyInfoCellPrefab},function(e){h=e.InfoLayerCtlBase}],execute:function(){y._RF.push({},"dd7e3sy4eVGxLt1hsBdjeJ6","EnemyInfoLayerCtl",void 0),T=p.ccclass,x=p.property,e("EnemyInfoLayerCtl",(b=T("EnemyInfoLayerCtl"),_=x({type:C}),E=x({type:u}),N=x({type:m}),P=x({type:u}),b((j=o((k=function(e){function n(){var e,o;i(this,n);for(var t=arguments.length,c=new Array(t),f=0;f<t;f++)c[f]=arguments[f];return o=l(this,(e=r(n)).call.apply(e,[this].concat(c))),a(o,"gameController",j,s(o)),a(o,"enemyInfoNodeParentNode",B,s(o)),a(o,"enemyInfoCellPrefab",M,s(o)),o.enemyInfoCellMap={},a(o,"newInfoTipsNode",L,s(o)),o}return t(n,e),c(n,[{key:"start",value:function(){var e=this;f(r(n.prototype),"start",this).call(this),this.initEnemyData(),this.node.on("refer-enemy-info-cell",(function(n){(console.log("`激活了某个敌人`",n),console.log("enemy info cell map",e.enemyInfoCellMap),e.enemyInfoCellMap[n])&&(console.log("刷新这个敌人的UI"),e.enemyInfoCellMap[n].getComponent(I).referUI())})),this.node.on("show-new-enemy-info-tips",(function(){var n=!1;for(var o in e.newInfoTipsNode.active=!1,e.enemyInfoCellMap){var t=e.enemyInfoCellMap[o];if(!t.getComponent(v).getIsShowed()&&t.getComponent(v).getEnemyIsActive()){n=!0;break}}console.log("is have",n),n&&(e.newInfoTipsNode.active=!0)}))}},{key:"closeUICb",value:function(){}},{key:"initEnemyData",value:function(){var e=this.gameController.getGameConfig().json,n=[];for(var o in e){var t=e[o];o.indexOf("Boss")>-1&&(console.log("iu",o),console.log("data",t),n.push(t))}console.log("enemy list",n),n=n.sort((function(e,n){return e.EnemyIndex-n.EnemyIndex})),console.log("enemy list",n);for(var i=0;i<n.length;i++){console.log("data = ",n[i]);var l=d(this.enemyInfoCellPrefab);l.parent=this.enemyInfoNodeParentNode;var r=n[i].EnemyType;console.log("enemy type",r),l.getComponent(I).init(this.gameController,{enemyType:r}),l.getComponent(I).referUI();var a=i%3,s=Math.floor(i/3);console.log("x",a),console.log("y = ",s),l.position=g(100*a-100,-100*s-70,0),this.enemyInfoNodeParentNode.height=-1*l.position.y+70,this.enemyInfoCellMap[r]=l}}},{key:"referEnemyData",value:function(){}},{key:"onButtonClick",value:function(e,o){f(r(n.prototype),"onButtonClick",this).call(this,e,o),"bg-node-click"===o&&this.node.emit("close-monster-info-layer")}}]),n}(h)).prototype,"gameController",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=o(k.prototype,"enemyInfoNodeParentNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(k.prototype,"enemyInfoCellPrefab",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=o(k.prototype,"newInfoTipsNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=k))||w)),y._RF.pop()}}}));

System.register("chunks:///UI/EnterGameAnimCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var o,n,i,r,a,l,c,u,s,p,d,h,m,f,y,v,g,b,_,w,C,A,G,N,k,z,T,L;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){s=e.cclegacy,p=e._decorator,d=e.Node,h=e.find,m=e.UIOpacityComponent,f=e.Tween,y=e.Component}],execute:function(){s._RF.push({},"965ecmCN75I15VOe1C9JGA5","EnterGameAnimCtl",void 0),T=p.ccclass,L=p.property,e("EnterGameAnimCtl",(v=T("EnterGameAnimCtl"),g=L({type:d}),b=L({type:d}),_=L({type:d}),w=L({type:d}),v((G=o((A=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,u=new Array(n),s=0;s<n;s++)u[s]=arguments[s];return o=r(this,(e=a(t)).call.apply(e,[this].concat(u))),l(o,"logoLayer",G,c(o)),l(o,"logoNode",N,c(o)),l(o,"bgNode",k,c(o)),l(o,"healthGameTips",z,c(o)),o}return n(t,e),u(t,[{key:"start",value:function(){var e=this;this.logoLayer.active=!0,this.showAnim(this.healthGameTips,!1,1).then((function(){return e.showAnim(e.healthGameTips,!0,.01)})).then((function(){return e.showAnim(e.logoNode,!1,1)})).then((function(){return e.showAnim(e.logoNode,!0,.01)})).then((function(){return e.showAnim(e.bgNode,!0,.01)})).then((function(){e.logoLayer.on("click",(function(){h("GameController").emit("player-button-click-audio"),e.logoLayer.active=!1})),e.node.emit("show-guide")}))}},{key:"showAnim",value:function(e,t,o){var n=e.getComponent(m);return n.opacity=t?255:0,new Promise((function(e,i){var r=new f(n);r.to(1,{opacity:t?0:255}),r.delay(o),r.call((function(){e()})),r.start()}))}}]),t}(y)).prototype,"logoLayer",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=o(A.prototype,"logoNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=o(A.prototype,"bgNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(A.prototype,"healthGameTips",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=A))||C)),s._RF.pop()}}}));

System.register("chunks:///UI/GuideCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameController.js"],(function(e,t){var n,o,i,r,a,s,u,l,c,d,g,p,f,h,C,v,m,y,w,_,G,b,k,A,I,x,D;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,u=e.assertThisInitialized,l=e.createClass},function(e){c=e.cclegacy,d=e._decorator,g=e.Node,p=e.JsonAsset,f=e.find,h=e.UITransformComponent,C=e.Tween,v=e.v3,m=e.Component},function(e){y=e.GameController}],execute:function(){c._RF.push({},"d0053QZKoxNv4NvDDstfYlR","GuideCtl",void 0),x=d.ccclass,D=d.property,e("GuideCtl",(w=x("GuideCtl"),_=D({type:g}),G=D({type:p}),w((A=n((k=function(e){function t(){var e,n;i(this,t);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return n=r(this,(e=a(t)).call.apply(e,[this].concat(l))),s(n,"guideLayer",A,u(n)),s(n,"guideConfigJsonAsset",I,u(n)),n.currentGuideIndex=1,n.gameController=null,n.guideCompleteCb=null,n}return o(t,e),l(t,[{key:"start",value:function(){this.gameController=f("GameController").getComponent(y)}},{key:"onLoad",value:function(){var e=this;this.node.on("show-guide",(function(t){var n="Step_"+e.currentGuideIndex;e.guideConfigJsonAsset.json[n]?e.gameController.playerData.getIsShowGuide(n)?t&&t():(e.guideCompleteCb=t,e.showMaskAnim(n)):t&&t()})),this.node.on("complete-current-guide",(function(){var t="Step_"+e.currentGuideIndex;e.gameController.playerData.setIsShowGuide(t),e.currentGuideIndex++,e.hideMaskAnim().then((function(){console.log("引导操作完成"),e.guideCompleteCb&&(console.log("存在回调"),e.guideCompleteCb())}))}))}},{key:"hideMaskAnim",value:function(){var e=this;return new Promise((function(t,n){var o=e.guideLayer.getComponent(h),i=new C(o);i.to(.6,{width:1700,height:1700}),i.call((function(){t()})),i.start()}))}},{key:"showMaskAnim",value:function(e){var t=this;return new Promise((function(n,o){var i=t.guideConfigJsonAsset.json[e];console.log("guide data",i);var r=i.Size,a=i.MaskPos,s=i.Time;t.guideLayer.active=!0;var u=t.guideLayer.getComponent(h),l=new C(u);l.to(s,{width:r.width,height:r.height}),l.call((function(){n()})),l.start();var c=new C(t.guideLayer);c.to(s,{position:v(a.x,a.y,a.z)}),c.start()}))}}]),t}(m)).prototype,"guideLayer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(k.prototype,"guideConfigJsonAsset",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=k))||b)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./MenuUIBase.js","./BuildTowerUITowerIcon.js"],(function(e,t){var o,i,r,n,l,s,a,c,u,d,h,g,p,f,w,C,v,I,m,y,T,B,U,b,_,k,N;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,c=e.createClass,u=e.get},function(e){d=e.cclegacy,h=e._decorator,g=e.Prefab,p=e.instantiate,f=e.ButtonComponent,w=e.v3,C=e.v2,v=e.find,I=e.isValid},function(e){m=e.MenuUIBase},function(e){y=e.BuildTowerUITowerIcon}],execute:function(){d._RF.push({},"e33afUUW/FG4pMfGRr03v2w","BuildTowerUI",void 0),k=h.ccclass,N=h.property,e("BuildTowerUI",(T=k("BuildTowerUI"),B=N({type:g}),T((_=o((b=function(e){function t(){var e,o;r(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return o=n(this,(e=l(t)).call.apply(e,[this].concat(c))),s(o,"buildTowerUITowerIcon",_,a(o)),o.gameConfig=null,o.towerIconNodeList=[],o}return i(t,e),c(t,[{key:"init",value:function(e,o){u(l(t.prototype),"init",this).call(this),this.gameController=o,this.gameConfig=e,this.referCurrentUI()}},{key:"referCurrentUI",value:function(){var e=this.gameController.playerData.getCurrentActiveTowerList(),t=e.length,o=t-this.towerIconNodeList.length;if(console.log("dis",o),o>0)for(var i=0;i<o;i++){var r=p(this.buildTowerUITowerIcon);r.addComponent(f),r.on("click",this.onButtonClick.bind(this)),r.parent=this.node,this.towerIconNodeList.push(r)}else if(o<0)for(var n=0;n<Math.abs(o);n++)this.towerIconNodeList.pop().destroy();for(var l=0;l<this.towerIconNodeList.length;l++){var s=this.towerIconNodeList[l];s.name="tower_"+e[l],s.getComponent(y).init(e[l],this.gameController,this.gameConfig);var a=60/s.width;s.scale=w(a,a,1);var c=C(0,1),u=(c=c.rotate(2*Math.PI/t*l).normalize()).multiplyScalar(75);s.setPosition(w(u.x,u.y,0))}console.log("build tower ui"),this.node.getChildByName("BuildTowerBgNode").on("click",this.onButtonClick.bind(this))}},{key:"onButtonClick",value:function(e,t){if(v("GameController").emit("player-button-click-audio"),"close"!==t)if("BuildTowerBgNode"===e.node.name)this.state.setState("close-ui");else{var o=e.node.getComponent(y);if(o){var i=o.getTowerType(),r=o.getCurrentBuildCost(),n=this.gameController.playerData.getCurrentGoldCount();console.log("current gold count",n),r<=n&&I(this.targetNode)?(this.gameController.playerData.addGoldCount(-1*r),this.state.setState("close-ui"),v("GameController").emit("build-one-tower",i,this.targetNode)):v("Canvas").emit("gold-not-enough")}}else this.state.setState("close-ui")}}]),t}(m)).prototype,"buildTowerUITowerIcon",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=b))||U)),d._RF.pop()}}}));

System.register("chunks:///UI/TouchScreenLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameController.js"],(function(e,t){var n,o,r,a,c,s,l,i,u,p,y,m,h,C,d,v;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){n=e.inherits,o=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,c=e.createClass},function(e){s=e.cclegacy,l=e._decorator,i=e.find,u=e.CameraComponent,p=e.Node,y=e.PhysicsSystem,m=e.Component},function(e){h=e.GameController}],execute:function(){s._RF.push({},"5c5e3+MsMZDYpvgjM8gmHSO","TouchScreenLayer",void 0),v=l.ccclass,l.property,e("TouchScreenLayer",(C=v("TouchScreenLayer"),C(d=function(e){function t(){var e,n;o(this,t);for(var c=arguments.length,s=new Array(c),l=0;l<c;l++)s[l]=arguments[l];return(n=r(this,(e=a(t)).call.apply(e,[this].concat(s)))).cameraNode=null,n.gameCtl=null,n}return n(t,e),c(t,[{key:"start",value:function(){var e=this;this.cameraNode=i("Camera").getComponent(u),this.gameCtl=i("GameController"),this.node.on(p.EventType.TOUCH_END,(function(t){var n=t.getLocation(),o=e.cameraNode.getComponent(u).screenPointToRay(n.x,n.y);y.instance.raycast(o,1,1e4,!0),y.instance.raycastResults&&i("GameController").getComponent(h).playerTouch3dObject(y.instance.raycastResults)}))}},{key:"update",value:function(e){}}]),t}(m))||d)),s._RF.pop()}}}));

System.register("chunks:///UI/TowerInfoLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var r,o,i,n,a,c,l,u,s,d,p,f,b,w,y,h,v,m,g,L,_,A,I,k,C,N,T,S,z,P,D,R,j,x,F,O,V,B,H,M;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,o=e.inherits,i=e.classCallCheck,n=e.possibleConstructorReturn,a=e.getPrototypeOf,c=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass},function(e){s=e.cclegacy,d=e._decorator,p=e.Node,f=e.Prefab,b=e.LabelComponent,w=e.isValid,y=e.instantiate,h=e.v3,v=e.Component}],execute:function(){s._RF.push({},"34c6bA7xiVOdLmFLwAjWo2Q","TowerInfoLayer",void 0),H=d.ccclass,M=d.property,e("TowerInfoLayer",(m=H("TowerInfoLayer"),g=M({type:p}),L=M({type:p}),_=M({type:p}),A=M({type:p}),I=M({type:p}),k=M({type:p}),C=M({type:p}),N=M({type:p}),T=M({type:f}),m((P=r((z=function(e){function t(){var e,r;i(this,t);for(var o=arguments.length,u=new Array(o),s=0;s<o;s++)u[s]=arguments[s];return r=n(this,(e=a(t)).call.apply(e,[this].concat(u))),c(r,"currentAttackDamageLabel",P,l(r)),c(r,"currentAttckRangeLabel",D,l(r)),c(r,"currentAttackSpeedLabel",R,l(r)),c(r,"towerNameLabel",j,l(r)),c(r,"attackTypeIconList",x,l(r)),c(r,"towerInfoLabel",F,l(r)),c(r,"towerInfoLayer",O,l(r)),c(r,"tower2dAnimNodePos",V,l(r)),c(r,"tower2dAnimPrefabList",B,l(r)),r.currentShowAnimNode=null,r}return o(t,e),u(t,[{key:"start",value:function(){var e=this;this.node.on("show-tower-info",this.setTowerData.bind(this),this),this.node.on("close-tower-info-layer",(function(){e.towerInfoLayer.active=!1})),this.node.on("refer-tower-info",this.referTowerInfo.bind(this),this),this.node.on("close-weapon-info-layer",(function(){e.towerInfoLayer.active=!1}))}},{key:"referTowerInfo",value:function(e){this.currentAttackDamageLabel.getComponent(b).string=e.getCurrentAttackNum().toString(),this.currentAttackSpeedLabel.getComponent(b).string=e.getCurrentShootRate().toFixed(1)+"/S",this.currentAttckRangeLabel.getComponent(b).string=Math.floor(e.getCurrentAttackRange()).toString(),this.towerNameLabel.getComponent(b).string=e.getObjectName();var t=e.towerIndexType;w(this.currentShowAnimNode)&&this.currentShowAnimNode.destroy();var r=y(this.tower2dAnimPrefabList[t]);r.parent=this.towerInfoLayer,r.position=h(this.tower2dAnimNodePos.position),this.currentShowAnimNode=r}},{key:"setTowerData",value:function(e){this.towerInfoLayer.active=!0,this.referTowerInfo(e)}}]),t}(v)).prototype,"currentAttackDamageLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=r(z.prototype,"currentAttckRangeLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=r(z.prototype,"currentAttackSpeedLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=r(z.prototype,"towerNameLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=r(z.prototype,"attackTypeIconList",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=r(z.prototype,"towerInfoLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=r(z.prototype,"towerInfoLayer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=r(z.prototype,"tower2dAnimNodePos",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=r(z.prototype,"tower2dAnimPrefabList",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=z))||S)),s._RF.pop()}}}));

System.register("chunks:///UI/typescript.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var s,c,r,n,i,o,p,u,l,a,y;return t({_dec:void 0,_class:void 0}),{setters:[function(t){s=t.inherits,c=t.createClass,r=t.classCallCheck,n=t.possibleConstructorReturn,i=t.getPrototypeOf},function(t){o=t.cclegacy,p=t._decorator,u=t.Component}],execute:function(){o._RF.push({},"22ae7b9IOpLNY3XMC2PMmpx","typescript",void 0),y=p.ccclass,p.property,t("Typescript",(l=y("Typescript"),l(a=function(t){function e(){return r(this,e),n(this,i(e).apply(this,arguments))}return s(e,t),c(e,[{key:"start",value:function(){}}]),e}(u))||a)),o._RF.pop()}}}));

System.register("chunks:///UI/WeaponUpdateCellPrefab.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../util/Tool.js"],(function(e,t){var o,r,i,a,n,l,c,u,p,s,d,h,v,g,f,m,b,y,C,w,L,I,_,k,F,A,B,N,D,G,S,U,T,W,z,P,R,x,j,K,O,H,E,M,q,J;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,i=e.classCallCheck,a=e.possibleConstructorReturn,n=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass,p=e.get},function(e){s=e.cclegacy,d=e._decorator,h=e.Node,v=e.SpriteFrame,g=e.loader,f=e.SpriteComponent,m=e.LabelComponent,b=e.find},function(e){y=e.BaseObject},function(e){C=e.Tool}],execute:function(){s._RF.push({},"a6c70AbEx1NLpumxgHfrO6e","WeaponUpdateCellPrefab",void 0),q=d.ccclass,J=d.property,e("WeaponUpdateCellPrefab",(w=q("WeaponUpdateCellPrefab"),L=J({type:h}),I=J({type:h}),_=J({type:h}),k=J({type:h}),F=J({type:v}),A=J({type:v}),B=J({type:h}),N=J({type:v}),D=J({type:v}),G=J({type:h}),S=J({type:h}),w((W=o((T=function(e){function t(){var e,o;i(this,t);for(var r=arguments.length,u=new Array(r),p=0;p<r;p++)u[p]=arguments[p];return o=a(this,(e=n(t)).call.apply(e,[this].concat(u))),l(o,"currentDamageLabel",W,c(o)),l(o,"addDamageLabel",z,c(o)),l(o,"costGoldLabel",P,c(o)),l(o,"weaponIconNode",R,c(o)),l(o,"updateButtonSpriteFrameGray",x,c(o)),l(o,"updateButtonSpriteFrameGreen",j,c(o)),l(o,"updateButtonNode",K,c(o)),l(o,"activeButtonSpriteFrameGray",O,c(o)),l(o,"activeButtonSpriteFrameLight",H,c(o)),l(o,"duidiAttackIcon",E,c(o)),l(o,"duikonngAttackIcon",M,c(o)),o.currentChooseRate=0,o.weaponInfoCtl=null,o}return r(t,e),u(t,[{key:"start",value:function(){}},{key:"updateChooseRate",value:function(e){this.currentChooseRate=e,this.referUILabel()}},{key:"setData",value:function(e,o,r,i){var a=this;console.log("初始化数据",e),this.weaponInfoCtl=i,o.node.on("update-gold-label",(function(){a.referUILabel()}));var l=e.TowerType;this.objectType=l,p(n(t.prototype),"init",this).call(this,r,o),e.isActive&&this.showWeaponIcon(),this.referUILabel()}},{key:"showWeaponIcon",value:function(){var e=this,t=this.getIconSprteFrame();g.loadRes(t+"/spriteFrame",v,(function(t,o){t||(e.weaponIconNode.getComponent(f).spriteFrame=o),console.log("err",t)}))}},{key:"referUILabel",value:function(){for(var e=this.getWeaponIsActive(),t=this.gameController.playerData.getPowerCount(),o=this.getCanAttackMoveTypeList(),r=0;r<o.length;r++)"Walk"===o[r]&&(this.duidiAttackIcon.active=!0),"Fly"===o[r]&&(this.duikonngAttackIcon.active=!0);if(!e){var i=this.gameController.playerData.getFirstNeedToActiveTowerIndex();console.log("first need active tower",i);var a=this.getActiveCostGoldCount();return this.costGoldLabel.getComponent(m).string=C.convertNumToK(a),void(i===this.towerIndexType&&a<=t?this.updateButtonNode.getComponent(f).spriteFrame=this.activeButtonSpriteFrameLight:this.updateButtonNode.getComponent(f).spriteFrame=this.activeButtonSpriteFrameGray)}var n=this.getUpdateLocalLevelCost();this.currentDamageLabel.getComponent(m).string=C.convertNumToK(this.getCurrentAttackNum()),this.costGoldLabel.getComponent(m).string=C.convertNumToK(n),this.addDamageLabel.getComponent(m).string="+"+C.convertNumToK(this.getNextLocallevelAddDamage()),this.updateButtonNode.getComponent(f).spriteFrame=t<n?this.updateButtonSpriteFrameGray:this.updateButtonSpriteFrameGreen}},{key:"onButtonClick",value:function(e,t){switch(b("GameController").emit("player-button-click-audio"),t){case"update-button":console.log("升级按钮");var o=this.getWeaponIsActive(),r=this.gameController.playerData.getPowerCount();if(o){var i=this.getUpdateLocalLevelCost();i<=r&&(this.updateLocalLevel(this.currentChooseRate),this.gameController.playerData.addPowerCount(-i),this.referUILabel())}else{var a=this.getActiveCostGoldCount();a<=r&&(this.activeWeapon(),this.gameController.playerData.addPowerCount(-a),this.referUILabel(),this.showWeaponIcon(),this.weaponInfoCtl.node.emit("refer-current-tower-menu-ui"),this.weaponInfoCtl.weaponActived(this.node))}this.getWeaponIsActive()&&this.weaponInfoCtl.node.emit("refer-tower-info",this);break;case"WeaponBg":this.getWeaponIsActive()&&this.weaponInfoCtl.node.emit("show-tower-info",this)}}},{key:"getUpdateLocalLevelCost",value:function(){var e=p(n(t.prototype),"getUpdateLocalLevelCost",this).call(this);return e*=this.currentChooseRate}},{key:"getNextLocallevelAddDamage",value:function(){var e=p(n(t.prototype),"getNextLocallevelAddDamage",this).call(this);return e*=this.currentChooseRate}}]),t}(y)).prototype,"currentDamageLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(T.prototype,"addDamageLabel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=o(T.prototype,"costGoldLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(T.prototype,"weaponIconNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(T.prototype,"updateButtonSpriteFrameGray",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(T.prototype,"updateButtonSpriteFrameGreen",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(T.prototype,"updateButtonNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(T.prototype,"activeButtonSpriteFrameGray",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(T.prototype,"activeButtonSpriteFrameLight",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=o(T.prototype,"duidiAttackIcon",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(T.prototype,"duikonngAttackIcon",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=T))||U)),s._RF.pop()}}}));

System.register("chunks:///UI/WeaponInfoCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/Tool.js","../GameController.js","./InfoLayerCtlBase.js","./WeaponUpdateCellPrefab.js"],(function(e,t){var o,r,n,a,i,l,d,u,s,p,c,C,h,f,g,b,m,v,y,w,R,_,I,H,L,P,N,D,B,z,k,G,W,F,T,S,U,A,j,K,O,x,V,q,E,J,M,Q,X,Y,Z;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,d=e.assertThisInitialized,u=e.createClass,s=e.get},function(e){p=e.cclegacy,c=e._decorator,C=e.Prefab,h=e.Node,f=e.SpriteFrame,g=e.LabelComponent,b=e.SpriteComponent,m=e.instantiate,v=e.v3,y=e.find,w=e.isValid},function(e){R=e.Tool},function(e){_=e.GameController},function(e){I=e.InfoLayerCtlBase},function(e){H=e.WeaponUpdateCellPrefab}],execute:function(){p._RF.push({},"4185fepR9NDl6TuAmrhxLTe","WeaponInfoCtl",void 0),Y=c.ccclass,Z=c.property,e("WeaponInfoCtl",(L=Y("WeaponInfoCtl"),P=Z({type:_}),N=Z({type:C}),D=Z({type:h}),B=Z({type:h}),z=Z({type:h}),k=Z({type:f}),G=Z({type:f}),W=Z({type:h}),F=Z({type:h}),T=Z({type:h}),S=Z({type:h}),L((j=o((A=function(e){function t(){var e,o;n(this,t);for(var r=arguments.length,u=new Array(r),s=0;s<r;s++)u[s]=arguments[s];return o=a(this,(e=i(t)).call.apply(e,[this].concat(u))),l(o,"gameController",j,d(o)),l(o,"updateWeaponInfoCellPrefab",K,d(o)),l(o,"weaponCellParentNode",O,d(o)),l(o,"currentInitRedHeartCountLabel",x,d(o)),l(o,"addRedHeartCostGoldCount",V,d(o)),l(o,"addRedHeartButtonSpriteFrameLight",q,d(o)),l(o,"addRedHeartButtonSpriteFrameGray",E,d(o)),l(o,"addRedHeartButton",J,d(o)),l(o,"chooseAddRedHeartCountLabel",M,d(o)),l(o,"scrollviewNode",Q,d(o)),o.weaponIndoCellNodeList=[],l(o,"currentPowerLabel",X,d(o)),o.currentChooseRate=0,o}return r(t,e),u(t,[{key:"start",value:function(){var e=this;s(i(t.prototype),"start",this).call(this),this.node.on("refer-choose-rate-cost",(function(t){console.log("刷新当前选择的倍数",t),console.log("weapon indo cell node list",e.weaponIndoCellNodeList);for(var o=0;o<e.weaponIndoCellNodeList.length;o++){e.weaponIndoCellNodeList[o].getComponent(H).updateChooseRate(t)}e.currentChooseRate=t,e.referCurrentRedHeartCountUI()})),this.node.on("refer-current-power-label",(function(t){e.currentPowerLabel.getComponent(g).string=R.convertNumToK(t),e.referCurrentRedHeartCountUI();for(var o=0;o<e.weaponIndoCellNodeList.length;o++){e.weaponIndoCellNodeList[o].getComponent(H).referUILabel()}})),this.initWeaponData()}},{key:"referCurrentRedHeartCountUI",value:function(){var e=this.gameController.getComponent(_),t=e.playerData.getAddOneRedHeartCostGoldCount()*this.currentChooseRate;this.addRedHeartCostGoldCount.getComponent(g).string=R.convertNumToK(t);var o=e.playerData.getPowerCount();console.log("current gold count",o),console.log("cost",t),this.addRedHeartButton.getComponent(b).spriteFrame=o<t?this.addRedHeartButtonSpriteFrameGray:this.addRedHeartButtonSpriteFrameLight,this.currentInitRedHeartCountLabel.getComponent(g).string=e.playerData.getCurrentInitRedHeartCount()+"",this.chooseAddRedHeartCountLabel.getComponent(g).string="+"+R.convertNumToK(this.currentChooseRate),this.currentPowerLabel.getComponent(g).string=R.convertNumToK(e.playerData.getPowerCount())}},{key:"initWeaponData",value:function(){for(var e=this,t=this.gameController.getComponent(_),o=this.gameController.getComponent(_).getGameConfig().json,r=this.gameController.playerData.getCurrentTowersLocalLevelData(),n=0;n<r.length;n++){var a=r[n],i=m(this.updateWeaponInfoCellPrefab);i.parent=this.weaponCellParentNode,i.getComponent(H).setData(a,t,o,this),i.position=v(0,-n*(i.height+10)-.5*(i.height+10)-5,0),this.weaponCellParentNode.height=-1*i.position.y+.5*i.height+10,this.weaponIndoCellNodeList.push(i)}this.gameController.node.on("update-gold-label",(function(){e.referCurrentRedHeartCountUI()}))}},{key:"onButtonClick",value:function(e,o){switch(s(i(t.prototype),"onButtonClick",this).call(this,e,o),y("GameController").emit("player-button-click-audio"),o){case"add-heart-button":var r=this.gameController.getComponent(_),n=r.playerData.getPowerCount(),a=r.playerData.getAddOneRedHeartCostGoldCount()*this.currentChooseRate;n<a?this.node.emit("gold-not-enough"):(r.playerData.addPowerCount(-a),r.playerData.addLocalInitRedHeartCount(this.currentChooseRate),this.node.emit("refer-red-heart-label")),this.referCurrentRedHeartCountUI();break;case"bg-node-click":this.node.emit("close-tower-info-layer")}}},{key:"weaponActived",value:function(e){var t=e.position.y;w(this.scrollviewNode)&&console.log("scrollview pos",t)}}]),t}(I)).prototype,"gameController",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(A.prototype,"updateWeaponInfoCellPrefab",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(A.prototype,"weaponCellParentNode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(A.prototype,"currentInitRedHeartCountLabel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(A.prototype,"addRedHeartCostGoldCount",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(A.prototype,"addRedHeartButtonSpriteFrameLight",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=o(A.prototype,"addRedHeartButtonSpriteFrameGray",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=o(A.prototype,"addRedHeartButton",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(A.prototype,"chooseAddRedHeartCountLabel",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=o(A.prototype,"scrollviewNode",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=o(A.prototype,"currentPowerLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=A))||U)),p._RF.pop()}}}));

System.register("chunks:///UI/道具/KuangBaoSkill.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(t,e){var n,c,s,i,o,u,l,r,a,p;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,c=t.classCallCheck,s=t.possibleConstructorReturn,i=t.getPrototypeOf},function(t){o=t.cclegacy,u=t._decorator},function(t){l=t.BaseObject}],execute:function(){o._RF.push({},"137d7fAtX1CO423/GncRui3","KuangBaoSkill",void 0),p=u.ccclass,u.property,t("KuangBaoSkill",(r=p("KuangBaoSkill"),r(a=function(t){function e(){return c(this,e),s(this,i(e).apply(this,arguments))}return n(e,t),e}(l))||a)),o._RF.pop()}}}));

System.register("chunks:///UI/道具/TreePrefab.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,r){var t,s,c,n,o,a,i,u,l,p,f;return e({_dec:void 0,_class:void 0}),{setters:[function(e){t=e.inherits,s=e.createClass,c=e.classCallCheck,n=e.possibleConstructorReturn,o=e.getPrototypeOf},function(e){a=e.cclegacy,i=e._decorator,u=e.Component}],execute:function(){a._RF.push({},"8a25dMpKeVPN5lsW6oWiwua","TreePrefab",void 0),f=i.ccclass,i.property,e("TreePrefab",(l=f("TreePrefab"),l(p=function(e){function r(){return c(this,r),n(this,o(r).apply(this,arguments))}return t(r,e),s(r,[{key:"start",value:function(){}}]),r}(u))||p)),a._RF.pop()}}}));

System.register("chunks:///util/AdsController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var l,n,c;return{setters:[function(e){l=e.createClass,n=e.classCallCheck},function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"00d1d2cCXdJEoYd5l9/lwHa","AdsController",void 0),e("AdsController",function(){function e(){n(this,e)}return l(e,[{key:"watchVideoAds",value:function(){}}]),e}()),c._RF.pop()}}}));

System.register("chunks:///util/Besize.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var i,s,r,l,a;return{setters:[function(t){i=t.createClass,s=t.classCallCheck},function(t){r=t.cclegacy,l=t._decorator,a=t.v3}],execute:function(){r._RF.push({},"b99e6kbi3NK3Y1RRPBDBTEz","Besize",void 0),l.ccclass,l.property,t("Besize",function(){function t(e,i,r){s(this,t),this.startPos=void 0,this.middlePos=void 0,this.endPos=void 0,this.startPos=e,this.middlePos=i,this.endPos=r}return i(t,[{key:"CalculateCubicBezierPoint",value:function(t,e,i,s){var r=1-t,l=t*t,o=r*r,c=a(e).multiplyScalar(o);return c=a(c).add(a(i).multiplyScalar(2*r*t)),c=a(c).add(s.multiplyScalar(l))}},{key:"getBesizePointList",value:function(t){for(var e=[],i=0;i<t;i++){var s=i/t,r=this.CalculateCubicBezierPoint(s,this.startPos,this.middlePos,this.endPos);e.push(r)}return e}}]),t}()),r._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../AudioCtl.js","../BaseObject.js","../BossController.js","../util/State.js","../TowerBuildBase/TowerBuildBase.js","../util/BezierN.js","../util/My2Array.js","../GroundTiled/GroundTiled.js","../GroundMapCtl.js","../util/FindPathWithAStart.js","../UI/SkillCtl.js","../Towers/TowerBase.js","../UI/Menu/MenuUIBase.js","../util/Tool.js","../UI/GoldCtl.js","../UI/Menu/UpdateTowerUI.js","../UI/Menu/BuildTowerUITowerIcon.js","../UI/Menu/BuildTowerMenuUI.js","../UI/GameWin/GameResultGoldCell.js","../UI/GameWin/GameWinPrefab.js","../UI/UIController.js","../Enemys/EnemyBase.js","../Enemys/EnemyBullet.js","../EnemyController.js","../TowerBuildBaseCtl.js","../Data/PlayerData.js","../Effect/WinGoldAnimEffect.js","../Home/HomeIcon.js","../GameController.js","../BulletBase.js","../ChooseWeaponInfoRateCtl.js","../Enemys/EnemyColonyCom.js","../Enemys/EnemyCube.js","../Enemys/WinGold.js","../SkillComponent/CrazyRotateSkill.js","../UI/AStartFindPath.js","../UI/DialogCtl.js","../UI/EnemyHealthBarCtl.js","../UI/MonsterInfoLayer.js","../UI/EnemyInfoCellPrefab.js","../UI/InfoLayerCtlBase.js","../UI/EnemyInfoLayerCtl.js","../UI/EnterGameAnimCtl.js","../UI/GuideCtl.js","../UI/Menu/BuildTowerUI.js","../UI/TouchScreenLayer.js","../UI/TowerInfoLayer.js","../UI/typescript.js","../UI/WeaponUpdateCellPrefab.js","../UI/WeaponInfoCtl.js","../UI/道具/KuangBaoSkill.js","../UI/道具/TreePrefab.js","../util/AdsController.js","../util/Besize.js"],(function(n,t){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/Scripts/AudioCtl.js', 'chunks:///AudioCtl.js');
  r('project:///assets/Scripts/BaseObject.js', 'chunks:///BaseObject.js');
  r('project:///assets/Scripts/BossController.js', 'chunks:///BossController.js');
  r('project:///assets/Scripts/util/State.js', 'chunks:///util/State.js');
  r('project:///assets/Scripts/TowerBuildBase/TowerBuildBase.js', 'chunks:///TowerBuildBase/TowerBuildBase.js');
  r('project:///assets/Scripts/util/BezierN.js', 'chunks:///util/BezierN.js');
  r('project:///assets/Scripts/util/My2Array.js', 'chunks:///util/My2Array.js');
  r('project:///assets/Scripts/GroundTiled/GroundTiled.js', 'chunks:///GroundTiled/GroundTiled.js');
  r('project:///assets/Scripts/GroundMapCtl.js', 'chunks:///GroundMapCtl.js');
  r('project:///assets/Scripts/util/FindPathWithAStart.js', 'chunks:///util/FindPathWithAStart.js');
  r('project:///assets/Scripts/UI/SkillCtl.js', 'chunks:///UI/SkillCtl.js');
  r('project:///assets/Scripts/Towers/TowerBase.js', 'chunks:///Towers/TowerBase.js');
  r('project:///assets/Scripts/UI/Menu/MenuUIBase.js', 'chunks:///UI/Menu/MenuUIBase.js');
  r('project:///assets/Scripts/util/Tool.js', 'chunks:///util/Tool.js');
  r('project:///assets/Scripts/UI/GoldCtl.js', 'chunks:///UI/GoldCtl.js');
  r('project:///assets/Scripts/UI/Menu/UpdateTowerUI.js', 'chunks:///UI/Menu/UpdateTowerUI.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerUITowerIcon.js', 'chunks:///UI/Menu/BuildTowerUITowerIcon.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerMenuUI.js', 'chunks:///UI/Menu/BuildTowerMenuUI.js');
  r('project:///assets/Scripts/UI/GameWin/GameResultGoldCell.js', 'chunks:///UI/GameWin/GameResultGoldCell.js');
  r('project:///assets/Scripts/UI/GameWin/GameWinPrefab.js', 'chunks:///UI/GameWin/GameWinPrefab.js');
  r('project:///assets/Scripts/UI/UIController.js', 'chunks:///UI/UIController.js');
  r('project:///assets/Scripts/Enemys/EnemyBase.js', 'chunks:///Enemys/EnemyBase.js');
  r('project:///assets/Scripts/Enemys/EnemyBullet.js', 'chunks:///Enemys/EnemyBullet.js');
  r('project:///assets/Scripts/EnemyController.js', 'chunks:///EnemyController.js');
  r('project:///assets/Scripts/TowerBuildBaseCtl.js', 'chunks:///TowerBuildBaseCtl.js');
  r('project:///assets/Scripts/Data/PlayerData.js', 'chunks:///Data/PlayerData.js');
  r('project:///assets/Scripts/Effect/WinGoldAnimEffect.js', 'chunks:///Effect/WinGoldAnimEffect.js');
  r('project:///assets/Scripts/Home/HomeIcon.js', 'chunks:///Home/HomeIcon.js');
  r('project:///assets/Scripts/GameController.js', 'chunks:///GameController.js');
  r('project:///assets/Scripts/BulletBase.js', 'chunks:///BulletBase.js');
  r('project:///assets/Scripts/ChooseWeaponInfoRateCtl.js', 'chunks:///ChooseWeaponInfoRateCtl.js');
  r('project:///assets/Scripts/Enemys/EnemyColonyCom.js', 'chunks:///Enemys/EnemyColonyCom.js');
  r('project:///assets/Scripts/Enemys/EnemyCube.js', 'chunks:///Enemys/EnemyCube.js');
  r('project:///assets/Scripts/Enemys/WinGold.js', 'chunks:///Enemys/WinGold.js');
  r('project:///assets/Scripts/SkillComponent/CrazyRotateSkill.js', 'chunks:///SkillComponent/CrazyRotateSkill.js');
  r('project:///assets/Scripts/UI/AStartFindPath.js', 'chunks:///UI/AStartFindPath.js');
  r('project:///assets/Scripts/UI/DialogCtl.js', 'chunks:///UI/DialogCtl.js');
  r('project:///assets/Scripts/UI/EnemyHealthBarCtl.js', 'chunks:///UI/EnemyHealthBarCtl.js');
  r('project:///assets/Scripts/UI/MonsterInfoLayer.js', 'chunks:///UI/MonsterInfoLayer.js');
  r('project:///assets/Scripts/UI/EnemyInfoCellPrefab.js', 'chunks:///UI/EnemyInfoCellPrefab.js');
  r('project:///assets/Scripts/UI/InfoLayerCtlBase.js', 'chunks:///UI/InfoLayerCtlBase.js');
  r('project:///assets/Scripts/UI/EnemyInfoLayerCtl.js', 'chunks:///UI/EnemyInfoLayerCtl.js');
  r('project:///assets/Scripts/UI/EnterGameAnimCtl.js', 'chunks:///UI/EnterGameAnimCtl.js');
  r('project:///assets/Scripts/UI/GuideCtl.js', 'chunks:///UI/GuideCtl.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerUI.js', 'chunks:///UI/Menu/BuildTowerUI.js');
  r('project:///assets/Scripts/UI/TouchScreenLayer.js', 'chunks:///UI/TouchScreenLayer.js');
  r('project:///assets/Scripts/UI/TowerInfoLayer.js', 'chunks:///UI/TowerInfoLayer.js');
  r('project:///assets/Scripts/UI/typescript.js', 'chunks:///UI/typescript.js');
  r('project:///assets/Scripts/UI/WeaponUpdateCellPrefab.js', 'chunks:///UI/WeaponUpdateCellPrefab.js');
  r('project:///assets/Scripts/UI/WeaponInfoCtl.js', 'chunks:///UI/WeaponInfoCtl.js');
  r('project:///assets/Scripts/UI/道具/KuangBaoSkill.js', 'chunks:///UI/道具/KuangBaoSkill.js');
  r('project:///assets/Scripts/UI/道具/TreePrefab.js', 'chunks:///UI/道具/TreePrefab.js');
  r('project:///assets/Scripts/util/AdsController.js', 'chunks:///util/AdsController.js');
  r('project:///assets/Scripts/util/Besize.js', 'chunks:///util/Besize.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});