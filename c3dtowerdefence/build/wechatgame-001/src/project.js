System.register("chunks:///BaseObject.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var o,n,i,r,a,s,l,c,u,y,p,h,v,T,b,d,g,m,C,f,k,j,L,A,R,w,I;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,y=e._decorator,p=e.Node,h=e.CCFloat,v=e.v3,T=e.Quat,b=e.Vec3,d=e.Component}],execute:function(){u._RF.push({},"f047fSpjWxIyqfTRsf+Ksl/","BaseObject",void 0),w=y.ccclass,I=y.property,e("BaseObject",(g=w("BaseObject"),m=I({type:""}),C=I({type:p}),f=I({type:h}),g((L=o((j=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,c=new Array(n),u=0;u<n;u++)c[u]=arguments[u];return o=r(this,(e=a(t)).call.apply(e,[this].concat(c))),s(o,"objectType",L,l(o)),s(o,"rootNode",A,l(o)),s(o,"animSpeedMulOffset",R,l(o)),o.currentLevel=1,o.baseGasNum=0,o.baseAttackNum=0,o.baseAttackRate=0,o.baseRotateAngle=0,o.rotateSpeed=0,o.baseGoldCount=0,o.buildCost=0,o.shootDuraction=0,o.baseAttackRange=0,o.towerUpdateMaxLevel=0,o.currentGasNum=0,o.moveSpeed=0,o.isCollisionGround=!1,o.leftTime=0,o.gameController=null,o.towerIndexType=0,o.iconSpriteFrame=null,o.activeCostGoldCount=0,o.enemyMoveType="walk",o.canAttackMoveTypeList=[],o.enemyBulletType=0,o.isCollisionDestroy=!1,o.enemyIndexType=0,o.isConlony=!1,o.bulletRecoverTime=0,o}return n(t,e),c(t,[{key:"init",value:function(e,t,o,n,i){i&&(this.objectType=i),console.log("base object type",this.objectType),this.gameController=t,e[this.objectType].BaseGasNum&&(this.baseGasNum=e[this.objectType].BaseGasNum),this.currentGasNum=this.baseGasNum,e[this.objectType].MoveSpeed&&(this.moveSpeed=e[this.objectType].MoveSpeed),e[this.objectType].isCollisionGround&&(this.isCollisionGround=e[this.objectType].isCollisionGround),e[this.objectType].BaseAttackNum&&(this.baseAttackNum=e[this.objectType].BaseAttackNum),e[this.objectType].ShootRate&&(this.baseAttackRate=e[this.objectType].ShootRate,this.shootDuraction=1/this.getCurrentShootRate()),e[this.objectType].BaseRotateAngle&&(this.baseRotateAngle=e[this.objectType].BaseRotateAngle),e[this.objectType].LeftTime&&(this.leftTime=e[this.objectType].LeftTime),e[this.objectType].RotateSpeed&&(this.rotateSpeed=e[this.objectType].RotateSpeed),e[this.objectType].BaseGoldCount&&(this.baseGoldCount=e[this.objectType].BaseGoldCount),e[this.objectType].BuildCost&&(this.buildCost=e[this.objectType].BuildCost),e[this.objectType].AttackRange&&(this.baseAttackRange=e[this.objectType].AttackRange),e.TowerMaxLevel&&(this.towerUpdateMaxLevel=e.TowerMaxLevel),e[this.objectType].Index&&(this.towerIndexType=e[this.objectType].Index),e[this.objectType].IconSprteFrame&&(this.iconSpriteFrame=e[this.objectType].IconSprteFrame),e[this.objectType].ActiveCost&&(this.activeCostGoldCount=e[this.objectType].ActiveCost),e[this.objectType].MoveType&&(this.enemyMoveType=e[this.objectType].MoveType),e[this.objectType].CanAttackType&&(this.canAttackMoveTypeList=e[this.objectType].CanAttackType),e[this.objectType].EnemyBulletType&&(this.enemyBulletType=e[this.objectType].EnemyBulletType),e[this.objectType].isCollisionDestroy&&(this.isCollisionDestroy=e[this.objectType].isCollisionDestroy),e[this.objectType].EnemyIndex&&(this.enemyIndexType=e[this.objectType].EnemyIndex),e[this.objectType].Colony&&(this.isConlony=e[this.objectType].Colony),e[this.objectType].BulletRecoverTime&&(this.bulletRecoverTime=e[this.objectType].BulletRecoverTime)}},{key:"getBaseAttackDamage",value:function(){return this.baseAttackNum}},{key:"getCurrentAttackNum",value:function(){var e=this.baseAttackNum;console.log("base damage num",e);var t=1*(this.currentLevel+1)*this.currentLevel*.5;return console.log("current level damage",t),e+t+this.getLocalDamageNum()}},{key:"getLocalDamageNum",value:function(){var e=this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType);console.log("local level",e);var t=(1+e)*e*.5;return console.log(this.objectType+":local damage",t),t}},{key:"getCurrentSkillRotateAngle",value:function(){return this.baseRotateAngle}},{key:"getCurrentShootRate",value:function(){var e=this.baseAttackRate;return console.log("current shoot rate",e),e*=1+this.currentLevel*this.currentLevel*.01,console.log("current shoor rate",e),e>10&&(e=10),e}},{key:"getCurrentGoldCount",value:function(){return this.baseGoldCount}},{key:"getCurrentLevel",value:function(){return this.currentLevel}},{key:"getUpdateCost",value:function(){var e=this.currentLevel+1;return this.buildCost+(1+e)*e*.5}},{key:"getUpdateLocalLevelCost",value:function(){var e=this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType);return console.log("local level",e),Math.round(.5*Math.pow(e+1,2))}},{key:"getNextLocallevelAddDamage",value:function(){return this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType)+1}},{key:"getDestroyCount",value:function(){var e=this.buildCost,t=this.currentLevel;return Math.round(.8*(e+(1+t)*t*.5))}},{key:"updateLevel",value:function(){this.currentLevel++;var e=this.getCurrentShootRate();this.shootDuraction=1/e,console.log("升级之后 的 攻击事件间隔",this.shootDuraction)}},{key:"getCurrentAttackRange",value:function(){var e=this.currentLevel;return this.baseAttackRange*(1+e*(e-.5)*.01)}},{key:"getTowerIsMax",value:function(){return console.log("current level",this.currentLevel),console.log("tower update max level",this.towerUpdateMaxLevel),this.currentLevel>=this.towerUpdateMaxLevel}},{key:"getIconSprteFrame",value:function(){return this.iconSpriteFrame}},{key:"getWeaponIsActive",value:function(){return this.gameController.playerData.getWeaponIsActive(this.towerIndexType)}},{key:"updateLocalLevel",value:function(e){var t=this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType);t+=e,console.log("升级的jishu",e),this.gameController.playerData.updateTowerLocalLevel(this.towerIndexType,t)}},{key:"getActiveCostGoldCount",value:function(){return this.activeCostGoldCount}},{key:"activeWeapon",value:function(){this.gameController.playerData.activeTower(this.towerIndexType)}},{key:"getMoveType",value:function(){return this.enemyMoveType}},{key:"getCanAttackEnemy",value:function(e){var o=e.getComponent(t);if(o)for(var n=o.getMoveType(),i=this.canAttackMoveTypeList,r=0;r<i.length;r++){if(i[r]===n)return!0}return!1}},{key:"getCanAttackMoveTypeList",value:function(){return this.canAttackMoveTypeList}},{key:"getIsBoss",value:function(){return this.objectType.indexOf("Boss")>-1}},{key:"getEnemyBulletType",value:function(){return this.enemyBulletType}},{key:"getIsCollisionDestroy",value:function(){return this.isCollisionDestroy}},{key:"getLookAtAngle",value:function(e,t){var o=v(e).subtract(t).normalize(),n=new T;return T.fromViewUp(n,o,b.UP),n}},{key:"getEnemyIsActive",value:function(){return this.gameController.playerData.getEnemyIsActive(this.objectType)}},{key:"getIsColony",value:function(){return this.isConlony}},{key:"getBulletRecoverTime",value:function(){return this.bulletRecoverTime}},{key:"getMoveSpeed",value:function(){return this.moveSpeed}}]),t}(d)).prototype,"objectType",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"default"}}),A=o(j.prototype,"rootNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(j.prototype,"animSpeedMulOffset",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),k=j))||k)),u._RF.pop()}}}));

System.register("chunks:///BossController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,o){var e,s,r,n,c,l,i,u,a,p,C;return t({_dec:void 0,_class:void 0}),{setters:[function(t){e=t.inherits,s=t.createClass,r=t.classCallCheck,n=t.possibleConstructorReturn,c=t.getPrototypeOf},function(t){l=t.cclegacy,i=t._decorator,u=t.Component}],execute:function(){l._RF.push({},"dcc66ytht5FMYgvOIQcQVvo","BossController",void 0),C=i.ccclass,i.property,t("BossController",(a=C("BossController"),a(p=function(t){function o(){return r(this,o),n(this,c(o).apply(this,arguments))}return e(o,t),s(o,[{key:"start",value:function(){}}]),o}(u))||p)),l._RF.pop()}}}));

System.register("chunks:///util/State.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var a,s,n;return{setters:[function(t){a=t.createClass,s=t.classCallCheck},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"309b9GENMFDhItBZDPdMuEd","State",void 0),t("State",function(){function t(){s(this,t),this.state="",this.handleMap={}}return a(t,[{key:"setState",value:function(t){if(this.state=t,this.handleMap[this.state]){for(var e=this.handleMap[this.state],a=[],s=1;s<arguments.length;s++)a.push(arguments[s]);for(var n=0;n<e.length;n++){var i=e[n];i.apply(this,a)}}}},{key:"getState",value:function(){return this.state}},{key:"addState",value:function(t,e){this.handleMap[t]?this.handleMap[t].push(e):this.handleMap[t]=[e]}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///ChooseWeaponInfoRateCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js"],(function(t,e){var r,o,i,n,a,s,u,c,l,p,h,d,f,v,y,m,g,C,_,S,b,B,I,R,w,P,x,L,z,F;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(t){r=t.applyDecoratedDescriptor,o=t.inherits,i=t.classCallCheck,n=t.possibleConstructorReturn,a=t.getPrototypeOf,s=t.initializerDefineProperty,u=t.assertThisInitialized,c=t.createClass},function(t){l=t.cclegacy,p=t._decorator,h=t.Node,d=t.SpriteFrame,f=t.v2,v=t.v3,y=t.Tween,m=t.Component},function(t){g=t.State}],execute:function(){l._RF.push({},"6601aZ3NHFPo42l2cZ4+0Lq","ChooseWeaponInfoRateCtl",void 0),z=p.ccclass,F=p.property,t("ChooseWeaponInfoRateCtl",(C=z("ChooseWeaponInfoRateCtl"),_=F({type:h}),S=F({type:d}),b=F({type:d}),B=F({type:h}),C((w=r((R=function(t){function e(){var t,r;i(this,e);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return r=n(this,(t=a(e)).call.apply(t,[this].concat(c))),s(r,"rateButtonList",w,u(r)),s(r,"rateButtonSpriteFrameLight",P,u(r)),s(r,"rateButtonSpriteFrameGray",x,u(r)),s(r,"rateButtonParentNode",L,u(r)),r.currentRateIndex=0,r.state=new g,r}return o(e,t),c(e,[{key:"start",value:function(){for(var t=this,e=0;e<this.rateButtonList.length;e++){var r=this.rateButtonList[e],o=f(0,1).rotate(2*Math.PI*1/3*e-2*Math.PI*270/360).normalize().multiplyScalar(80);r.position=v(o.x,o.y,0)}this.state.addState("wait",(function(){console.log("current rate index",t.currentRateIndex),t.node.emit("refer-choose-rate-cost",t.getCurrentChooseRate())})),this.state.setState("wait")}},{key:"onButtonClick",value:function(t,e){var r=this;if(e.indexOf("rate")>-1){if(console.log("旋转按钮"),"wait"!==this.state.getState())return;this.currentRateIndex++;var o=this.currentRateIndex%3*120;this.state.setState("move");for(var i=[],n=0;n<this.rateButtonList.length;n++){var a=this.rateButtonList[n],s=f(0,1).rotate(2*Math.PI*1/3*n-2*Math.PI*(270+o)/360).normalize().multiplyScalar(80);i.push(this.moveToAction(a,s))}Promise.all(i).then((function(){r.state.setState("wait")}))}}},{key:"moveToAction",value:function(t,e){return new Promise((function(r,o){var i=new y(t);i.to(.2,{position:v(e.x,e.y,0)}),i.call((function(){r()})),i.start()}))}},{key:"getCurrentChooseRate",value:function(){return[1,10,100][this.currentRateIndex%3]}}]),e}(m)).prototype,"rateButtonList",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=r(R.prototype,"rateButtonSpriteFrameLight",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=r(R.prototype,"rateButtonSpriteFrameGray",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=r(R.prototype,"rateButtonParentNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=R))||I)),l._RF.pop()}}}));

System.register("chunks:///Data/PlayerData.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var r,n,a;return{setters:[function(t){r=t.createClass,n=t.classCallCheck},function(t){a=t.cclegacy}],execute:function(){a._RF.push({},"3f2cezzOStAIpBjPLZ7+fqQ","PlayerData",void 0),t("PlayData",function(){function t(e){n(this,t),this.currentSkillCount=2,this.currentActiveSkillCount=3,this.currentGoldCount=30,this.gameController=null,this.currentLevelNum=0,this.currentTowerLevelData=[],this.currentInitRedHeartCounnt=3,this.currentRedHeardCount=0,this.currentActiveEnemyMap=[],this.gameController=e;var r=this.getLocalData("game-time");console.log("game time",r),this.setLocalData("gold-count","99999"),this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt+""),this.setLocalData("active-enemy-list",JSON.stringify(this.currentActiveEnemyMap)),this.initTowerLevelLocalData(this.gameController.getGameConfig().json),r?(this.currentSkillCount=Number(this.getLocalData("current-skill-count")),this.currentActiveSkillCount=Number(this.getLocalData("current-active-skill-count")),this.currentGoldCount=Number(this.getLocalData("gold-count")),this.currentLevelNum=Number(this.getLocalData("current-level-num")),this.currentTowerLevelData=JSON.parse(this.getLocalData("tower-level-data")),this.currentInitRedHeartCounnt=Number(this.getLocalData("current-init-red-heart-count")),this.currentActiveEnemyMap=JSON.parse(this.getLocalData("active-enemy-list"))):(this.setLocalData("game-time","1"),this.setLocalData("current-active-skill-count",this.currentActiveSkillCount+""),this.setLocalData("current-skill-count",this.currentSkillCount+""),this.setLocalData("gold-count",this.currentGoldCount+""),this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt+""),this.setLocalData("active-enemy-list",JSON.stringify(this.currentActiveEnemyMap)),this.initTowerLevelLocalData(this.gameController.getGameConfig().json)),this.currentRedHeardCount=this.currentInitRedHeartCounnt}return r(t,[{key:"initTowerLevelLocalData",value:function(t){var e=[];for(var r in t)"Tower"===t[r].Type&&e.push(t[r]);e=e.sort((function(t,e){return t.index-e.index}));for(var n=[],a=0;a<e.length;a++){var o=e[a],i={IconSprteFrame:o.IconSprteFrame,isActive:!1,currentLevel:0,TowerType:o.TowerType};a<2?(i.isActive=!0,i.currentLevel=1):(i.isActive=!1,i.currentLevel=0),n.push(i)}console.log("json",n),this.currentTowerLevelData=n,this.setLocalData("tower-level-data",JSON.stringify(n))}},{key:"clearLocalData",value:function(){localStorage.clear()}},{key:"getLocalData",value:function(t){return console.log("获取游戏数据",t),localStorage.getItem(t)}},{key:"setLocalData",value:function(t,e){localStorage.setItem(t,e)}},{key:"updateGoldCount",value:function(t){this.setLocalData("gold-count",t.toString())}},{key:"getCurrentGoldCount",value:function(){return this.currentGoldCount}},{key:"initGoldCount",value:function(){this.currentGoldCount=0,this.setLocalData("gold-count",this.currentGoldCount+"")}},{key:"addGoldCount",value:function(t){this.currentGoldCount+=t,this.setLocalData("gold-count",this.currentGoldCount+""),this.gameController.node.emit("update-gold-label",this.currentGoldCount,t)}},{key:"newGame",value:function(){this.currentLevelNum=0,this.currentRedHeardCount=this.currentInitRedHeartCounnt,this.setLocalData("current-level-num",this.currentLevelNum+""),this.currentGoldCount=this.gameController.getGameConfig().json["Level_"+this.currentLevelNum].InitGoldCount,this.setLocalData("gold-count",this.currentGoldCount+"")}},{key:"enterNextLevel",value:function(){this.currentLevelNum++;var t=this.gameController.getGameConfig().json["Level_"+this.currentLevelNum].InitGoldCount;this.addGoldCount(t),this.setLocalData("current-level-num",this.currentLevelNum+"")}},{key:"activeTower",value:function(t){console.log("active tower index",t),console.log("current tower level data",this.currentTowerLevelData),this.currentTowerLevelData[t].isActive=!0,this.currentTowerLevelData[t].currentLevel=1,this.setLocalData("tower-level-data",JSON.stringify(this.currentTowerLevelData))}},{key:"getWeaponIsActive",value:function(t){return this.currentTowerLevelData[t].isActive}},{key:"getCurrentTowerLocalLevel",value:function(t){return this.currentTowerLevelData[t].currentLevel}},{key:"getCurrentTowersLocalLevelData",value:function(){return this.currentTowerLevelData}},{key:"updateTowerLocalLevel",value:function(t,e){this.currentTowerLevelData[t].currentLevel=e,this.setLocalData("tower-level-data",JSON.stringify(this.currentTowerLevelData))}},{key:"getFirstNeedToActiveTowerIndex",value:function(){for(var t=0,e=0;e<this.currentTowerLevelData.length;e++){if(!this.currentTowerLevelData[e].isActive){t=e;break}}return t}},{key:"getCurrentInitRedHeartCount",value:function(){return this.currentInitRedHeartCounnt}},{key:"getAddOneRedHeartCostGoldCount",value:function(){var t=this.getCurrentInitRedHeartCount();return(1+t)*t*.5*100}},{key:"addLocalInitRedHeartCount",value:function(t){this.currentInitRedHeartCounnt+=t,this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt.toString())}},{key:"getCurrentRedHeartCount",value:function(){return this.currentRedHeardCount}},{key:"addRedHeartCount",value:function(t){this.currentRedHeardCount+=t,this.gameController.referRedHeardUI()}},{key:"getCurrentActiveTowerList",value:function(){for(var t=[],e=0;e<this.currentTowerLevelData.length;e++){this.currentTowerLevelData[e].isActive&&t.push(e)}return console.log("current active tower list",t),t}},{key:"getCurrentActiveEnemyMap",value:function(){return this.currentActiveEnemyMap}},{key:"getEnemyIsActive",value:function(t){return!!this.currentActiveEnemyMap[t]}},{key:"activeEnemy",value:function(t){this.currentActiveEnemyMap[t]||(this.currentActiveEnemyMap[t]=!0,console.log("激活一个敌人",t),this.setLocalData("active-enemy-list",JSON.stringify(this.currentActiveEnemyMap)),this.gameController.activeEnemySuccess(t))}}]),t}()),a._RF.pop()}}}));

System.register("chunks:///Effect/WinGoldAnimEffect.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,o,l,i,a,r,s,c,u,d,f,p,v,h;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){n=t.inherits,o=t.classCallCheck,l=t.possibleConstructorReturn,i=t.getPrototypeOf,a=t.createClass},function(t){r=t.cclegacy,s=t._decorator,c=t.SkeletalAnimationComponent,u=t.Tween,d=t.v3,f=t.Component}],execute:function(){r._RF.push({},"2ee3e+XrHFJlYuGFP9mqdRS","WinGoldAnimEffect",void 0),h=s.ccclass,s.property,t("WinGoldAnimEffect",(p=h("WinGoldAnimEffect"),p(v=function(t){function e(){var t,n;o(this,e);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=l(this,(t=i(e)).call.apply(t,[this].concat(r)))).goldCount=0,n.skelete=null,n}return n(e,t),a(e,[{key:"start",value:function(){var t=this.node.getComponent(c);if(this.skelete=t,t){var e=t.defaultClip;t.getState(e.name).repeatCount=1,t.play(e.name)}}},{key:"setGoldCount",value:function(t,e){var n=this;this.goldCount=t;var o=new u(this.node);o.delay(3),o.to(.4,{position:d(-25,10,0)}),o.call((function(){e.playerData.addGoldCount(t),n.node.destroy()})),o.start()}}]),e}(f))||v)),r._RF.pop()}}}));

System.register("chunks:///TowerBuildBase/TowerBuildBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,o){var t,r,i,n,a,l,s,u,d,c,h,f,m,p,g,w,y,v,B,C,T,b,k;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inherits,i=e.classCallCheck,n=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,c=e._decorator,h=e.Node,f=e.find,m=e.CameraComponent,p=e.SkeletalAnimationComponent,g=e.isValid,w=e.Component}],execute:function(){d._RF.push({},"bf2b5yrz6pN7ZEPmB5V4xlb","TowerBuildBase",void 0),b=c.ccclass,k=c.property,e("TowerBuildBase",(y=b("TowerBuildBase"),v=k({type:h}),y((T=t((C=function(e){function o(){var e,t;i(this,o);for(var r=arguments.length,u=new Array(r),d=0;d<r;d++)u[d]=arguments[d];return(t=n(this,(e=a(o)).call.apply(e,[this].concat(u)))).cameraNodeCom=null,t.gameController=null,t.targetTower=null,l(t,"arrowGuide",T,s(t)),t}return r(o,e),u(o,[{key:"onLoad",value:function(){}},{key:"start",value:function(){this.gameController=f("GameController"),this.cameraNodeCom=f("Camera").getComponent(m),this.gameController.on("touch-screen-to-3d",this.touchScreenTo3d.bind(this),this),this.gameController.on("destroy-all-tower-build-base",this.destroyTowerBuildBase.bind(this),this),this.gameController.on("frozen-tower-build-base",this.forzenTowerBuildBase.bind(this),this)}},{key:"forzenTowerBuildBase",value:function(){var e=this.arrowGuide.getComponent(p),o=e.defaultClip;e.getState(o.name).pause()}},{key:"touchScreenTo3d",value:function(e){if(!g(this.targetTower))for(var o=0;o<e.length;o++){var t=e[o];t.collider.node&&t.collider.node.uuid===this.node.uuid&&(console.log("点中了此塔的基座"),this.gameController.emit("touch-base-build-base",this.node))}}},{key:"onDestroy",value:function(){this.gameController.off("destroy-all-tower-build-base",this.destroyTowerBuildBase,this),this.gameController.off("touch-screen-to-3d",this.touchScreenTo3d,this),this.gameController.off("frozen-tower-build-base",this.forzenTowerBuildBase,this)}},{key:"destroyTowerBuildBase",value:function(){this.node.destroy()}},{key:"unSetTargetTower",value:function(e){this.targetTower=void 0,this.node.active=!0}},{key:"setTargetTower",value:function(e){this.targetTower=e,this.node.active=!1}}]),o}(w)).prototype,"arrowGuide",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=C))||B)),d._RF.pop()}}}));

System.register("chunks:///util/My2Array.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,u,i,s;return{setters:[function(t){n=t.createClass,u=t.classCallCheck},function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"5a822YVyJlDnb5+nCIOK0H/","My2Array",void 0),s=function(){function t(){u(this,t),this.numberList=[],this.heightNum=0}return n(t,[{key:"pushValue",value:function(t){this.numberList[this.numberList.length-1].push(t)}},{key:"pushList",value:function(t){this.numberList.push(t)}},{key:"getValue",value:function(t,e){if(!(e<0||t<0))return e>=this.numberList.length?null:t>=this.numberList[e].length?null:this.numberList[e][t]}},{key:"setValue",value:function(t,e,n){this.numberList[t][e]=n}},{key:"getHeightLength",value:function(){return this.numberList.length}},{key:"getWidthLength",value:function(){return this.numberList.length>0?this.numberList[0].length:0}},{key:"getValueWithLieIndex",value:function(t){return this.numberList[t]}},{key:"convertOneSpaceList",value:function(){for(var t=[],e=0;e<this.getHeightLength();e++)for(var n=0;n<this.getWidthLength();n++)t.push(this.numberList[e][n]);return t}}]),t}(),i._RF.pop(),t("default",s)}}}));

System.register("chunks:///GroundTiled/GroundTiled.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js"],(function(t,e){var r,n,s,i,c,a,u,o,l,p,h,d;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){r=t.inherits,n=t.classCallCheck,s=t.possibleConstructorReturn,i=t.getPrototypeOf,c=t.createClass},function(t){a=t.cclegacy,u=t._decorator,o=t.v2},function(t){l=t.BaseObject}],execute:function(){a._RF.push({},"75b72ybo0hO5rMJsDKDP6W5","GroundTiled",void 0),d=u.ccclass,u.property,t("GroundTiled",(p=d("GroundTiled"),p(h=function(t){function e(){var t,r;n(this,e);for(var c=arguments.length,a=new Array(c),u=0;u<c;u++)a[u]=arguments[u];return(r=s(this,(t=i(e)).call.apply(t,[this].concat(a)))).mapX=0,r.mapY=0,r.targetObjectList=[],r}return r(e,t),c(e,[{key:"getIsVoid",value:function(){return 0===this.targetObjectList.length}},{key:"setMapXY",value:function(t,e){this.mapX=t,this.mapY=e}},{key:"getMapXY",value:function(){return o(this.mapX,this.mapY)}},{key:"getTargetObjectList",value:function(){return this.targetObjectList}},{key:"setTargetObject",value:function(t){this.targetObjectList.push(t)}}]),e}(l))||h)),a._RF.pop()}}}));

System.register("chunks:///GroundMapCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/My2Array.js","./GroundTiled/GroundTiled.js"],(function(e,t){var i,r,n,o,a,s,u,d,l,p,h,c,f,v,m,g,y,b,w,M,T,_,z,C,L,P,x,k,H,E,N,W,G,A,I;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,o=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,u=e.assertThisInitialized,d=e.createClass},function(e){l=e.cclegacy,p=e._decorator,h=e.Prefab,c=e.CCInteger,f=e.CCFloat,v=e.instantiate,m=e.v3,g=e.v2,y=e.Tween,b=e.Component},function(e){w=e.default},function(e){M=e.GroundTiled}],execute:function(){l._RF.push({},"44e5akPt5hEHpdS1j2qoO/6","GroundMapCtl",void 0),A=p.ccclass,I=p.property,e("GroundMapCtl",(T=A("GroundMapCtl"),_=I({type:h}),z=I({type:c}),C=I({type:c}),L=I({type:f}),P=I({type:h}),T((H=i((k=function(e){function t(){var e,i;n(this,t);for(var r=arguments.length,d=new Array(r),l=0;l<r;l++)d[l]=arguments[l];return i=o(this,(e=a(t)).call.apply(e,[this].concat(d))),s(i,"groundMapTiledPrefab",H,u(i)),s(i,"mapWidth",E,u(i)),s(i,"mapHeight",N,u(i)),s(i,"tiledSize",W,u(i)),i.mapNodeList=new w,i.obsNodeList=[],s(i,"treePrefab",G,u(i)),i.groundTiledEdageIndexList=[],i}return r(t,e),d(t,[{key:"start",value:function(){for(var e=0;e<this.mapHeight;e++){for(var t=[],i=0;i<this.mapWidth;i++){var r=v(this.groundMapTiledPrefab);r.parent=this.node;var n=m(-.5*(this.mapWidth-1)*this.tiledSize+i*this.tiledSize,-6,-.5*(this.mapHeight-1)*this.tiledSize+e*this.tiledSize);r.setPosition(n),r.active=!1,t.push(r)}this.mapNodeList.pushList(t)}for(var o=[],a=0;a<this.mapWidth;a++)o.push(g(a,0));for(var s=1;s<this.mapHeight;s++)o.push(g(this.mapWidth-1,s));for(var u=this.mapWidth-2;u>=0;u--)o.push(g(u,this.mapHeight-1));for(var d=this.mapHeight-2;d>0;d--)o.push(g(0,d));this.groundTiledEdageIndexList=o}},{key:"getInEdageIndexList",value:function(){return this.groundTiledEdageIndexList}},{key:"showTreeEnterAnim",value:function(e){return console.log("show tree enter anima"),new Promise((function(t,i){e.active=!0,e.scale=m(1,0,1);var r=new y(e);r.to(.2,{scale:m(1,1,1)},{easing:"elasticOut"}),r.call((function(){t()})),r.start()}))}},{key:"showGroundEnterAnim",value:function(){var e=this;return this.showGroundTiledEnterAnim().then((function(){for(var t=0;t<2;){var i=[0,e.mapHeight-1][Math.round(1*Math.random())],r=Math.round(Math.random()*(e.mapWidth-1)),n=e.mapNodeList.getValue(r,i);if(n){e.obsNodeList.push(g(r,i));var o=n;if(o&&o.getComponent(M)){var a=o.getComponent(M);if(a.getIsVoid()){var s=v(e.treePrefab);s.parent=e.node,a.setTargetObject(s),s.active=!1,s.position=m(o.position.x,0,o.position.z),e.showTreeEnterAnim(s),t++}}}}}))}},{key:"setTowerBuildBaseOnTiled",value:function(e,t,i){var r=this.mapNodeList.getValue(t,i);if(r){this.obsNodeList.push(g(t,i));var n=r;n&&n.getComponent(M)&&n.getComponent(M).setTargetObject(e)}}},{key:"showGroundTiledEnterAnim",value:function(){for(var e=g(Math.floor(this.mapWidth/2),Math.floor(this.mapHeight/2)+1),t=0,i=g(0,-1),r=1,n=0,o=0,a=[];e.x<=this.mapWidth+1&&e.y<=this.mapHeight+1&&e.x>=0&&e.y>=0;){for(var s=0;s<r;){s++;var u=this.mapNodeList.getValue(e.x,e.y);if(u){var d=u;d&&(a.push(this.showEnterAnim(d,o)),o++)}e.add(i)}var l=2*Math.PI/4*t;(i=g(0,1).rotate(l).normalize()).x=i.x<0&&Math.abs(i.x)<1?0:Math.floor(i.x),i.y=i.y<0&&Math.abs(i.y)<1?0:Math.floor(i.y),2==n&&(n=0,r++),n++,t++}return Promise.all(a)}},{key:"showEnterAnim",value:function(e,t){return new Promise((function(i,r){var n=new y(e),o=e.position;n.delay(.03*t),n.call((function(){e.active=!0})),n.to(.4,{position:m(o.x,0,o.z)},{easing:"elasticOut"}),n.call((function(){i()})),n.start()}))}},{key:"getMapNodeList",value:function(){return this.mapNodeList}},{key:"getObsPosList",value:function(){return this.obsNodeList}},{key:"getMapSize",value:function(){return g(this.mapWidth,this.mapHeight)}}]),t}(b)).prototype,"groundMapTiledPrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=i(k.prototype,"mapWidth",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),N=i(k.prototype,"mapHeight",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),W=i(k.prototype,"tiledSize",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),G=i(k.prototype,"treePrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=k))||x)),l._RF.pop()}}}));

System.register("chunks:///TowerBuildBaseCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./GroundMapCtl.js","./GameController.js"],(function(e,t){var o,n,i,r,l,s,a,u,c,d,p,f,h,g,v,C,B,m,w,y,T,b,_,P,z;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,d=e._decorator,p=e.Prefab,f=e.v2,h=e.instantiate,g=e.v3,v=e.Tween,C=e.Component},function(e){B=e.GroundMapCtl},function(e){m=e.GameController}],execute:function(){c._RF.push({},"09d8fCuijNMwIzg+sejpSkn","TowerBuildBaseCtl",void 0),P=d.ccclass,z=d.property,e("TowerBuildBaseCtl",(w=P("TowerBuildBaseCtl"),y=z({type:p}),w((_=o((b=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,u=new Array(n),c=0;c<n;c++)u[c]=arguments[c];return o=r(this,(e=l(t)).call.apply(e,[this].concat(u))),s(o,"towerBuildBasePrefab",_,a(o)),o.groundTiledNodeList=null,o.gameController=null,o}return n(t,e),u(t,[{key:"showTowerBuildBaseEnterAnim",value:function(){this.gameController=this.node.getComponent(m);var e=this.gameController.getGameConfig().json["Level_"+this.gameController.getCurrentLevelNum()].TowerBuildPos;this.groundTiledNodeList=this.node.getComponent(B).getMapNodeList();for(var t=[],o=0;o<e.length;o++){var n=e[o],i=f(n[0],n[1]),r=this.groundTiledNodeList.getValue(i.x,i.y),l=h(this.towerBuildBasePrefab);l.parent=this.node,l.position=g(r.position.x,20,r.position.z),this.node.getComponent(B).setTowerBuildBaseOnTiled(l,i.x,i.y),t.push(this.showEnterAnim(l,o))}return Promise.all(t)}},{key:"showEnterAnim",value:function(e,t){return e.active=!1,new Promise((function(o,n){var i=new v(e),r=e.position;i.delay(.2*t),i.call((function(){e.active=!0})),i.to(.5,{position:g(r.x,0,r.z)},{easing:"bounceOut"}),i.call((function(){o()})),i.start()}))}},{key:"frozenAllTowerBuildBase",value:function(){this.node.emit("frozen-tower-build-base")}}]),t}(C)).prototype,"towerBuildBasePrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=b))||T)),c._RF.pop()}}}));

System.register("chunks:///util/BezierN.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,r){var e,n,o,i,l;return{setters:[function(t){e=t.createClass,n=t.classCallCheck},function(t){o=t.cclegacy,i=t._decorator,l=t.v3}],execute:function(){o._RF.push({},"e43e2vpRCtNoZCKx8bvmJ4Z","BezierN",void 0),i.ccclass,i.property,t("BezierN",function(){function t(r){n(this,t),this.controllerPointList=[],this.controllerPointList=r}return e(t,[{key:"getPointList",value:function(t){for(var r=this.controllerPointList.length,e=[1,1],n=3;n<r+1;n++){for(var o=[],i=0;i<e.length;i++)o.push(e[i]);e[0]=1,e[n-1]=1;for(var c=0;c<o.length-1;c++)e[c+1]=o[c]+o[c+1]}for(var s=[],a=0;a<t;a++){for(var u=a/t,h=l(0,0,0),f=0;f<r;f++){var v=r-1-f,p=f,g=e[f]*Math.pow(1-u,v)*Math.pow(u,p);h.add(l(this.controllerPointList[f]).multiplyScalar(g))}s.push(h)}return s}}],[{key:"getPathLength",value:function(t){for(var r=0,e=0;e<t.length;e++){if(0!==e)r+=l(t[e]).subtract(t[e-1]).length()}return r}}]),t}()),o._RF.pop()}}}));

System.register("chunks:///BulletBase.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./BaseObject.js","./util/State.js","./util/BezierN.js","./GameController.js","./Enemys/EnemyBase.js"],(function(e,t){var i,o,n,s,r,a,l,c,d,h,u,p,f,m,y,g,v,b,B,C,S,k,E,N,P,w,T,A,z,D,M;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,o=e.inherits,n=e.classCallCheck,s=e.possibleConstructorReturn,r=e.getPrototypeOf,a=e.initializerDefineProperty,l=e.assertThisInitialized,c=e.createClass,d=e.get},function(e){h=e.cclegacy,u=e._decorator,p=e.Prefab,f=e.v3,m=e.Quat,y=e.Vec3,g=e.ColliderComponent,v=e.isValid,b=e.Tween,B=e.instantiate},function(e){C=e.BaseObject},function(e){S=e.State},function(e){k=e.BezierN},function(e){E=e.GameController},function(e){N=e.EnemyBase}],execute:function(){h._RF.push({},"90e683Z9ntM7pLuSDO8IdqW","BulletBase",void 0),D=u.ccclass,M=u.property,e("BulletBase",(P=D("BulletBase"),w=M({type:p}),P((z=i((A=function(e){function t(){var e,i;n(this,t);for(var o=arguments.length,c=new Array(o),d=0;d<o;d++)c[d]=arguments[d];return(i=s(this,(e=r(t)).call.apply(e,[this].concat(c)))).state=new S,i.speedY=0,i.accY=E.accY,i.currentDirection=f(0,0),i.currentInitSpeedY=6,i.currentCostAcc=-3,i.maxLeftTime=1+Math.random(),i.colliderComponent=null,i.gameConfigJson={},i.targetTowerBase=null,i.targetEnemyNode=null,i.movePathList=[],a(i,"exporeEffectPrefab",z,l(i)),i}return o(t,e),c(t,[{key:"onLoad",value:function(){this.state.addState("sleep",(function(){}))}},{key:"init",value:function(e,i,o){var n=this;d(r(t.prototype),"init",this).call(this,e,i),this.baseAttackNum+=o.baseAttackNum,this.targetTowerBase=o.targetTower;var s=o.direction;this.currentDirection=s;var a=o.targetEnemy;a&&(this.targetEnemyNode=a);var l=f(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);this.currentDirection.add(l);var c=new m;if(m.fromViewUp(c,f(s).multiplyScalar(-1).normalize(),y.UP),this.node.worldRotation=c,this.gameConfigJson=e,this.colliderComponent=this.node.getComponent(g),this.colliderComponent.on("onTriggerEnter",this.onTriggerEnter.bind(this)),this.scheduleOnce((function(){n.node.destroy()}),this.leftTime),"Bezier"===this.getMoveType())if(v(this.targetEnemyNode)){var h=this.targetEnemyNode.position,u=f(this.node.position).add(h).multiplyScalar(.5).add(f(0,15,0)),p=[this.node.position,u,h];this.movePathList=new k(p).getPointList(50);var b=this.processMove(this.movePathList);b.call((function(){n.state.setState("run")})),b.start()}else this.node.destroy();else this.state.setState("run")}},{key:"processMove",value:function(e){for(var t=new b(this.node),i=1;i<e.length;i++)this.processPosAndQuat(t,e[i],e[i-1]);return t}},{key:"processPosAndQuat",value:function(e,t,i){var o=this,n=f(i).subtract(t).length()/this.getMoveSpeed();e.call((function(){o.node.lookAt(t)})),e.to(n,{position:t})}},{key:"onTriggerEnter",value:function(e){var t=this,i=e.otherCollider;if(v(i)&&v(i.node)&&i.node.name.indexOf("Wall")>1&&(console.log(" other collier node",i.node.name),this.node.destroy()),i&&i.getComponent(N)&&!i.getComponent(N).getIsDead()){if(console.log("base attack num",this.baseAttackNum),this.getIsCollisionDestroy())if(this.state.setState("enter-to-destroy"),v(this.exporeEffectPrefab)){this.rootNode.active=!1;var o=B(this.exporeEffectPrefab);o.parent=this.node;var n=new b(o);n.by(.1,{scale:f(1,1,1)}),n.call((function(){t.node.destroy()})),n.start()}else this.node.destroy();i.node.emit("be-attacked",{baseAttackNum:this.baseAttackNum,baseGasNum:this.baseGasNum,cb:function(e){console.log("是否死了",e),t.targetTowerBase&&t.targetTowerBase.enemyDeadByThis(e)}})}}},{key:"start",value:function(){}},{key:"update",value:function(e){if("run"===this.state.getState())if("Bezier"===this.getMoveType())if(v(this.targetEnemyNode)){var t=f(this.targetEnemyNode.position).add(f(0,2,0)).subtract(this.node.position);this.node.position=f(this.node.position).add(t.multiplyScalar(.5*e*this.getMoveSpeed())),this.node.lookAt(this.targetEnemyNode.position)}else this.node.destroy();else{this.speedY+=this.accY*e;var i=this.node.position,o=(i.y,this.speedY,this.currentDirection.normalize().multiplyScalar(this.moveSpeed*e));o.y<0&&(o.y=0),this.node.setPosition(f(i.x+o.x,i.y+o.y,i.z+o.z)),this.node.getPosition().y<=0&&this.isCollisionGround&&(this.speedY=this.currentInitSpeedY,this.currentInitSpeedY+=this.currentCostAcc,this.currentInitSpeedY<0&&this.state.setState("sleep"))}}}]),t}(C)).prototype,"exporeEffectPrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=A))||T)),h._RF.pop()}}}));

System.register("chunks:///UI/Menu/MenuUIBase.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js","../../util/State.js","../../Towers/TowerBase.js"],(function(t,e){var o,n,s,a,i,c,u,l,r,h,d,g,p,f,v,y,k;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){o=t.inherits,n=t.classCallCheck,s=t.possibleConstructorReturn,a=t.getPrototypeOf,i=t.createClass,c=t.get},function(t){u=t.cclegacy,l=t._decorator,r=t.isValid,h=t.Tween,d=t.v3},function(t){g=t.BaseObject},function(t){p=t.State},function(t){f=t.TowerBase}],execute:function(){u._RF.push({},"22840YoTAVEEoGWokYeLlSX","MenuUIBase",void 0),k=l.ccclass,l.property,t("MenuUIBase",(v=k("MenuUIBase"),v(y=function(t){function e(){var t,o;n(this,e);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return(o=s(this,(t=a(e)).call.apply(t,[this].concat(c)))).state=new p,o.targetNode=null,o}return o(e,t),i(e,[{key:"init",value:function(t,o){c(a(e.prototype),"init",this).call(this,t,o),this.state.addState("open-ui",this.openUI.bind(this)),this.state.addState("close-ui",this.closeUI.bind(this))}},{key:"open",value:function(t){console.log("打开"),r(this.targetNode)&&this.targetNode.getComponent(f)&&this.targetNode.uuid!==t.uuid&&this.targetNode.getComponent(f).closeAttackRange(),t.getComponent(f)&&t.getComponent(f).showAttackRange(),this.targetNode=t,this.state.setState("open-ui")}},{key:"close",value:function(){this.state.setState("close-ui")}},{key:"closeUI",value:function(){r(this.targetNode)&&this.targetNode.getComponent(f)&&this.targetNode.getComponent(f).closeAttackRange();var t=new h(this.node);t.to(.2,{scale:d(0,0,0)}),t.call((function(){})),t.start()}},{key:"openUI",value:function(){console.log("open ui"),this.node.active=!0;var t=new h(this.node);t.to(.2,{scale:d(1,1,1)}),t.call((function(){})),t.start()}}]),e}(g))||y)),u._RF.pop()}}}));

System.register("chunks:///util/Tool.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,o){var n,t,l;return{setters:[function(e){n=e.createClass,t=e.classCallCheck},function(e){l=e.cclegacy}],execute:function(){l._RF.push({},"a5b9421aLlB+qBZsaa/3PZA","Tool",void 0),e("Tool",function(){function e(){t(this,e)}return n(e,null,[{key:"convertNumToK",value:function(e){for(var o=(e=Math.abs(e))+"",n=e,t=0;n>0;)n=Math.floor(n/1e3),t++;return o=e/Math.pow(1e3,t-1)+"",console.log("end Str",o),o.length>4&&(o=o.substring(0,4)),t>=1&&(o+=["","K","M","B"][t-1]),console.log("end Str",o),o}}]),e}()),l._RF.pop()}}}));

System.register("chunks:///UI/GoldCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/Tool.js","../GameController.js"],(function(e,t){var r,o,n,i,l,a,d,u,c,s,p,f,b,v,g,y,C,h,m,L,_,G,w,N,z,H,E,P,k,T,B,D,I,R,j,S,A,F,K,x;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,o=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,d=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,s=e._decorator,p=e.Node,f=e.find,b=e.Tween,v=e.v3,g=e.LabelComponent,y=e.ProgressBarComponent,C=e.instantiate,h=e.view,m=e.Component},function(e){L=e.Tool},function(e){_=e.GameController}],execute:function(){c._RF.push({},"76e03n/eNtMAopLI1ZIiGNs","GoldCtl",void 0),K=s.ccclass,x=s.property,e("GoldCtl",(G=K("GoldCtl"),w=x({type:p}),N=x({type:p}),z=x({type:p}),H=x({type:p}),E=x({type:p}),P=x({type:p}),k=x({type:p}),G((D=r((B=function(e){function t(){var e,r;n(this,t);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return r=i(this,(e=l(t)).call.apply(e,[this].concat(u))),a(r,"goldsNode",D,d(r)),a(r,"currentLevelLabel",I,d(r)),a(r,"currentScoreLabel",R,d(r)),a(r,"currentGoldLabel",j,d(r)),a(r,"addGoldEffectLabel",S,d(r)),a(r,"redHeartProgressBar",A,d(r)),a(r,"redHeartCountLabel",F,d(r)),r.addGoldEffectNodeCount=0,r}return o(t,e),u(t,[{key:"start",value:function(){var e=this,t=f("GameController");t.on("refer-current-wave-level",(function(t,r){e.updateLevelLabel(t,r)})),t.on("update-gold-label",(function(t,r){e.updateGoldCountLabel(t,r)})),this.node.on("gold-not-enough",(function(){var t=new b(e.currentGoldLabel);t.to(.1,{scale:v(1.5,1.5,1.5)}),t.to(.1,{scale:v(1,1,1)}),t.start()})),this.node.on("refer-red-heart-label",(function(){var r=t.getComponent(_),o=r.playerData.getCurrentRedHeartCount(),n=r.playerData.getCurrentInitRedHeartCount();e.redHeartCountLabel.getComponent(g).string=n+"/"+o;var i=o/n;e.redHeartProgressBar.getComponent(y).progress=i}))}},{key:"updateLevelLabel",value:function(e,t){this.currentLevelLabel.getComponent(g).string=e+1+"-"+(t+1)}},{key:"updateGoldCountLabel",value:function(e,t){var r=this,o=L.convertNumToK(e);if(this.currentGoldLabel.getComponent(g).string=o,t){if(this.addGoldEffectNodeCount>20)return;this.addGoldEffectNodeCount++;var n=C(this.addGoldEffectLabel);n.parent=this.goldsNode;var i="-";t>0&&(i="+");var l=L.convertNumToK(t);n.getComponent(g).string=i+l+"";var a=new b(n);a.by(.2,{position:v(0,20,0)}),a.delay(.5),a.by(.2,{position:v(0,20,0),opacity:-.5}),a.call((function(){n.destroy(),r.addGoldEffectNodeCount--})),a.start()}}},{key:"showEnterAnim",value:function(){var e=this,t=h.getVisibleSize().height;return console.log("播放金币ui的进场动画"),this.node.emit("refer-red-heart-label"),new Promise((function(r,o){var n=new b(e.goldsNode);n.to(.2,{position:v(0,.5*t-65,0)}),n.call((function(){r()})),n.start()}))}}]),t}(m)).prototype,"goldsNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=r(B.prototype,"currentLevelLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=r(B.prototype,"currentScoreLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=r(B.prototype,"currentGoldLabel",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=r(B.prototype,"addGoldEffectLabel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=r(B.prototype,"redHeartProgressBar",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=r(B.prototype,"redHeartCountLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=B))||T)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/UpdateTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js","./MenuUIBase.js","../../util/Tool.js","../../Towers/TowerBase.js","../../GameController.js"],(function(e,t){var o,n,r,i,a,s,l,u,p,c,d,g,C,m,h,y,v,f,b,_,w,B,T,U,k,I,N,L,S,F,M,j,x,z,D,G;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass,p=e.get},function(e){c=e.cclegacy,d=e._decorator,g=e.Node,C=e.SpriteFrame,m=e.find,h=e.SpriteComponent,y=e.LabelComponent},function(e){v=e.BaseObject},function(e){f=e.MenuUIBase},function(e){b=e.Tool},function(e){_=e.TowerBase},function(e){w=e.GameController}],execute:function(){c._RF.push({},"18715njxPNA9Ie4NOUMTb2f","UpdateTowerUI",void 0),D=d.ccclass,G=d.property,e("UpdateTowerUI",(B=D("UpdateTowerUI"),T=G({type:g}),U=G({type:g}),k=G({type:C}),I=G({type:C}),N=G({type:g}),B((F=o((S=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,u=new Array(n),p=0;p<n;p++)u[p]=arguments[p];return o=i(this,(e=a(t)).call.apply(e,[this].concat(u))),s(o,"updateCostLabel",F,l(o)),s(o,"destroyWinLabel",M,l(o)),o.gameController=null,o.updateCostCount=null,o.destroyWinCount=null,s(o,"updateMaxLevelSpriteFrame",j,l(o)),s(o,"updateButtonSpriteFrame",x,l(o)),s(o,"updateButtonNode",z,l(o)),o}return n(t,e),u(t,[{key:"onLoad",value:function(){this.gameController=m("GameController").getComponent(w)}},{key:"start",value:function(){}},{key:"init",value:function(e,o){p(a(t.prototype),"init",this).call(this,e,o)}},{key:"onButtonClick",value:function(e,t){console.log("custom data",t);var o=this.gameController.playerData.getCurrentGoldCount();switch(t){case"bg":console.log("点中了背景"),this.state.setState("close-ui");break;case"update":if(this.targetNode.getComponent(v).getTowerIsMax())return;o>=this.updateCostCount?(this.gameController.playerData.addGoldCount(-1*this.updateCostCount),this.state.setState("close-ui"),this.targetNode.getComponent(_).updateLevel()):m("Canvas").emit("gold-not-enough");break;case"destroy":this.state.setState("close-ui"),this.targetNode.getComponent(_).toDestroy()}}},{key:"checkIsUpdateMax",value:function(){var e=this.targetNode.getComponent(v).getTowerIsMax();console.log("is max",e),e?(console.log("更新按钮 贴图"),this.updateButtonNode.getComponent(h).spriteFrame=this.updateMaxLevelSpriteFrame):this.updateButtonNode.getComponent(h).spriteFrame=this.updateButtonSpriteFrame}},{key:"open",value:function(e){p(a(t.prototype),"open",this).call(this,e),this.checkIsUpdateMax();var o=e.getComponent(_),n=o.getUpdateCost(),r=o.getDestroyCount();this.updateCostLabel.getComponent(y).string=b.convertNumToK(n)+"",this.destroyWinLabel.getComponent(y).string=b.convertNumToK(r)+"",this.updateCostCount=n,this.destroyWinCount=r}}]),t}(f)).prototype,"updateCostLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(S.prototype,"destroyWinLabel",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(S.prototype,"updateMaxLevelSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(S.prototype,"updateButtonSpriteFrame",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(S.prototype,"updateButtonNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=S))||L)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerUITowerIcon.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(e,t){var i,o,r,n,s,l,c,a,u,d,p,h,y,f,w,b,g,v,m,T,C,_,A,I,L,B,j,k,N;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,s=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,a=e.createClass,u=e.get},function(e){d=e.cclegacy,p=e._decorator,h=e.Node,y=e.Prefab,f=e.isValid,w=e.instantiate,b=e.v3,g=e.LabelComponent},function(e){v=e.BaseObject}],execute:function(){d._RF.push({},"960c8xSpalMJZbfb3XktNJx","BuildTowerUITowerIcon",void 0),k=p.ccclass,N=p.property,e("BuildTowerUITowerIcon",(m=k("BuildTowerUITowerIcon"),T=N({type:h}),C=N({type:y}),_=N({type:h}),m((L=i((I=function(e){function t(){var e,i;r(this,t);for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return i=n(this,(e=s(t)).call.apply(e,[this].concat(a))),l(i,"costGoldLabel",L,c(i)),l(i,"towerShowAnimList",B,c(i)),l(i,"showTowerAnimLayer",j,c(i)),i.gameConfig=void 0,i.currentBuildCost=null,i.towerType=null,i.currentAnimNode=null,i}return o(t,e),a(t,[{key:"onLoad",value:function(){}},{key:"start",value:function(){}},{key:"init",value:function(e,i,o){this.gameConfig=o,this.towerType=e,f(this.currentAnimNode)&&this.currentAnimNode.destroy();var r=w(this.towerShowAnimList[e]);for(var n in this.currentAnimNode=r,r.scale=b(.5,.5,.5),r.parent=this.showTowerAnimLayer,console.log("type",e),this.gameConfig)n.indexOf("Tower")>-1&&this.gameConfig[n].Index===e&&(this.objectType=n);console.log("object type",this.objectType),u(s(t.prototype),"init",this).call(this,this.gameConfig,i),this.costGoldLabel.getComponent(g).string=this.buildCost+""}},{key:"getCurrentBuildCost",value:function(){return this.buildCost}},{key:"getTowerType",value:function(){return this.towerType}}]),t}(v)).prototype,"costGoldLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(I.prototype,"towerShowAnimList",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=i(I.prototype,"showTowerAnimLayer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=I))||A)),d._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./MenuUIBase.js","./BuildTowerUITowerIcon.js"],(function(e,t){var o,i,n,r,l,s,a,c,u,d,h,g,p,f,v,w,C,I,m,y,T,B,b,U,k,_,N;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,c=e.createClass,u=e.get},function(e){d=e.cclegacy,h=e._decorator,g=e.Prefab,p=e.instantiate,f=e.ButtonComponent,v=e.v3,w=e.v2,C=e.isValid,I=e.find},function(e){m=e.MenuUIBase},function(e){y=e.BuildTowerUITowerIcon}],execute:function(){d._RF.push({},"e6405P/+GFGaa0/qmo/iQAc","BuildTowerUI",void 0),_=h.ccclass,N=h.property,e("BuildTowerUI",(T=_("BuildTowerUI"),B=N({type:g}),T((k=o((U=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return o=r(this,(e=l(t)).call.apply(e,[this].concat(c))),s(o,"buildTowerUITowerIcon",k,a(o)),o.gameConfig=null,o.towerIconNodeList=[],o}return i(t,e),c(t,[{key:"init",value:function(e,o){this.gameController=o,this.gameConfig=e,u(l(t.prototype),"init",this).call(this,e,o),this.referCurrentUI()}},{key:"start",value:function(){}},{key:"onEnable",value:function(){}},{key:"referCurrentUI",value:function(){var e=this.gameController.playerData.getCurrentActiveTowerList(),t=e.length,o=t-this.towerIconNodeList.length;if(console.log("dis",o),o>0)for(var i=0;i<o;i++){var n=p(this.buildTowerUITowerIcon);n.addComponent(f),n.on("click",this.onButtonClick.bind(this)),n.parent=this.node,this.towerIconNodeList.push(n)}else if(o<0)for(var r=0;r<Math.abs(o);r++)this.towerIconNodeList.pop().destroy();for(var l=0;l<this.towerIconNodeList.length;l++){var s=this.towerIconNodeList[l];s.name="tower_"+e[l],s.getComponent(y).init(e[l],this.gameController,this.gameConfig);var a=76/s.width;s.scale=v(a,a,1);var c=w(0,1),u=(c=c.rotate(2*Math.PI/t*l).normalize()).multiplyScalar(60);s.setPosition(v(u.x,u.y,0))}console.log("build tower ui"),this.node.getChildByName("BuildTowerBgNode").on("click",this.onButtonClick.bind(this))}},{key:"onButtonClick",value:function(e,t){if("close"!==t)if("BuildTowerBgNode"===e.node.name)this.state.setState("close-ui");else{var o=e.node.getComponent(y);if(o){var i=o.getTowerType(),n=o.getCurrentBuildCost(),r=this.gameController.playerData.getCurrentGoldCount();console.log("current gold count",r),n<=r&&C(this.targetNode)?(this.gameController.playerData.addGoldCount(-1*n),this.state.setState("close-ui"),I("GameController").emit("build-one-tower",i,this.targetNode)):I("Canvas").emit("gold-not-enough")}}else this.state.setState("close-ui")}}]),t}(m)).prototype,"buildTowerUITowerIcon",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=U))||b)),d._RF.pop()}}}));

System.register("chunks:///UI/GameWin/GameResultGoldCell.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(e,t){var o,n,i,l,r,a,s,c,u,p,d,m,y,g,C,b,f,v,h,G,_,F,w,L,R,I,j,k;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,l=e.possibleConstructorReturn,r=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass,u=e.get},function(e){p=e.cclegacy,d=e._decorator,m=e.Node,y=e.LabelComponent,g=e.loader,C=e.SpriteFrame,b=e.SpriteComponent},function(e){f=e.BaseObject}],execute:function(){p._RF.push({},"00a24DEoTFIC42oXzjaFqsy","GameResultGoldCell",void 0),j=d.ccclass,k=d.property,e("GameResultGoldCell",(v=j("GameResultGoldCell"),h=k({type:m}),G=k({type:m}),_=k({type:m}),v((L=o((w=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,c=new Array(n),u=0;u<n;u++)c[u]=arguments[u];return o=l(this,(e=r(t)).call.apply(e,[this].concat(c))),a(o,"enemyIconNode",L,s(o)),a(o,"enemyCountLabel",R,s(o)),a(o,"winGoldCountLabel",I,s(o)),o}return n(t,e),c(t,[{key:"start",value:function(){}},{key:"init",value:function(e,o){var n=this,i=e.getGameConfig().json,l=o.key;u(r(t.prototype),"init",this).call(this,i,e,null,null,l);var a=this.getIconSprteFrame();this.enemyCountLabel.getComponent(y).string=o.enemyCount+"",this.winGoldCountLabel.getComponent(y).string=o.winGoldCount+"",console.log("icon str",a),g.loadRes(a+"/spriteFrame",C,(function(e,t){console.log("err",e),console.log("result",t),e||(n.enemyIconNode.getComponent(b).spriteFrame=t)}))}},{key:"setData",value:function(e,t,o){var n=this;this.enemyCountLabel.getComponent(y).string=e+"",this.winGoldCountLabel.getComponent(y).string=t+"",console.log("icon str",o),g.loadRes(o+"/spriteFrame",C,(function(e,t){console.log("err",e),console.log("result",t),e||(n.enemyIconNode.getComponent(b).spriteFrame=t)}))}}]),t}(f)).prototype,"enemyIconNode",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(w.prototype,"enemyCountLabel",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=o(w.prototype,"winGoldCountLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=w))||F)),p._RF.pop()}}}));

System.register("chunks:///UI/GameWin/GameWinPrefab.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./GameResultGoldCell.js"],(function(e,t){var o,n,i,r,l,a,u,s,p,c,d,m,g,f,y,h,v,b,C,_,w,S,F,G,L,B,R,z,N,k,I,P,W,T,x,E,A,j,D,V,H,J,M,O,U,Z,q,K,Q,X,Y,$,ee,te,oe;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_dec14:void 0,_dec15:void 0,_dec16:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_descriptor13:void 0,_descriptor14:void 0,_descriptor15:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,u=e.assertThisInitialized,s=e.createClass},function(e){p=e.cclegacy,c=e._decorator,d=e.Prefab,m=e.Node,g=e.SpriteFrame,f=e.SpriteComponent,y=e.LabelComponent,h=e.instantiate,v=e.Tween,b=e.v3,C=e.Component},function(e){_=e.GameResultGoldCell}],execute:function(){p._RF.push({},"fa8f9h1LBJLMZap+sTSLCS2","GameWinPrefab",void 0),te=c.ccclass,oe=c.property,e("GameWinPrefab",(w=te("GameWinPrefab"),S=oe({type:d}),F=oe({type:m}),G=oe({type:m}),L=oe({type:g}),B=oe({type:g}),R=oe({type:g}),z=oe({type:g}),N=oe({type:g}),k=oe({type:g}),I=oe({type:m}),P=oe({type:m}),W=oe({type:m}),T=oe({type:m}),x=oe({type:m}),E=oe({type:m}),w((D=o((j=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,s=new Array(n),p=0;p<n;p++)s[p]=arguments[p];return o=r(this,(e=l(t)).call.apply(e,[this].concat(s))),a(o,"winGoldCellPrefab",D,u(o)),a(o,"leftButton",V,u(o)),a(o,"rightButton",H,u(o)),a(o,"retryGameButtonSpriteFrame",J,u(o)),a(o,"shareButtonSpriteFrame",M,u(o)),a(o,"nextLevelSpriteFrame",O,u(o)),a(o,"saveLifeButtonSpriteFrame",U,u(o)),a(o,"gameWinIconSpriteFrame",Z,u(o)),a(o,"gameLossIconSpriteFrame",q,u(o)),a(o,"gameResultIconNode",K,u(o)),a(o,"gameResultNode",Q,u(o)),a(o,"sumNode",X,u(o)),a(o,"totalEnemyCountLabel",Y,u(o)),a(o,"totalGoldCountLabel",$,u(o)),o.gameConfig=null,a(o,"scrollViewNode",ee,u(o)),o.gameResultState=null,o.uiController=null,o.gameController=null,o.nodeList=[],o}return n(t,e),s(t,[{key:"start",value:function(){}},{key:"setGameResult",value:function(e,t,o,n,i){var r=this;this.uiController=n,this.gameController=i,this.gameResultState=e,this.gameConfig=o,console.log("游戏状态时",e);var l=t.length,a=0;console.log("游戏结果数据是",t),console.log("当前关卡打死的敌人数目种类，获得的金币数目 "),e?(this.gameResultIconNode.getComponent(f).spriteFrame=this.gameWinIconSpriteFrame,this.leftButton.getComponent(f).spriteFrame=this.shareButtonSpriteFrame,this.rightButton.getComponent(f).spriteFrame=this.nextLevelSpriteFrame):(this.gameResultIconNode.getComponent(f).spriteFrame=this.gameLossIconSpriteFrame,this.leftButton.getComponent(f).spriteFrame=this.retryGameButtonSpriteFrame,this.rightButton.getComponent(f).spriteFrame=this.saveLifeButtonSpriteFrame);for(var u={},s=0;s<t.length;s++)u[t[s].enemyType]?(u[t[s].enemyType].enemyCount+=1,u[t[s].enemyType].winGoldCount+=t[s].dropGoldCount):u[t[s].enemyType]={enemyCount:1,winGoldCount:t[s].dropGoldCount},a+=t[s].dropGoldCount;var p=[];for(var c in u){var d=u[c];d.key=c,p.push(d)}console.log("list",p),p=p.sort((function(e,t){return t.winGoldCount-e.winGoldCount})),this.showCellEnterAnim(p,(function(){return console.log("展示结束"),r.showSumResult(l,a)}))}},{key:"showSumResult",value:function(e,t){var o=this;return new Promise((function(n,i){o.sumNode.active=!0,o.totalEnemyCountLabel.getComponent(y).string=e+"",o.totalGoldCountLabel.getComponent(y).string=t+""}))}},{key:"showCellEnterAnim",value:function(e,t){var o=this;if(0!==e.length){var n=e.pop(),i=h(this.winGoldCellPrefab);i.parent=this.gameResultNode;var r=new v(i);i.getComponent(_).init(this.gameController,n),i.position=b(0,-100*this.nodeList.length-50,0),this.gameResultNode.height=-1*i.position.y+60,this.nodeList.push(i),r.delay(.4),r.call((function(){o.showCellEnterAnim(e,t)})),r.start()}else t&&t()}},{key:"onButtonClick",value:function(e,t){var o=this;switch(t){case"left-button":console.log("分享游戏结果"),this.gameResultState?this.gameController.playerClickShareButton().then((function(){o.gameController.enterNextLevel(),o.node.destroy()})):(this.gameController.playerClickRetryButton(),this.node.destroy());break;case"right-button":this.gameResultState?(console.log("进入下一关"),this.node.destroy(),this.uiController.playerClickNextLevelButton()):this.gameController.playerClickSaveLifeButton().then((function(){o.node.destroy()}))}}}]),t}(C)).prototype,"winGoldCellPrefab",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(j.prototype,"leftButton",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(j.prototype,"rightButton",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=o(j.prototype,"retryGameButtonSpriteFrame",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(j.prototype,"shareButtonSpriteFrame",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(j.prototype,"nextLevelSpriteFrame",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=o(j.prototype,"saveLifeButtonSpriteFrame",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=o(j.prototype,"gameWinIconSpriteFrame",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(j.prototype,"gameLossIconSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(j.prototype,"gameResultIconNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=o(j.prototype,"gameResultNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=o(j.prototype,"sumNode",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=o(j.prototype,"totalEnemyCountLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=o(j.prototype,"totalGoldCountLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=o(j.prototype,"scrollViewNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=j))||A)),p._RF.pop()}}}));

System.register("chunks:///UI/UIController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./Menu/MenuUIBase.js","./GoldCtl.js","./Menu/UpdateTowerUI.js","./Menu/BuildTowerUI.js","./GameWin/GameWinPrefab.js","./SkillCtl.js","../GameController.js"],(function(e,t){var o,n,i,r,l,s,a,u,c,d,p,h,m,f,I,b,g,v,C,U,w,y,N,k,_,P,B,L,G,S,T,j,z,M,R,A,E,H,W,D,F,x,O,V,J,Z,q,K,Q,X,Y;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,d=e._decorator,p=e.Prefab,h=e.Node,m=e.SpriteFrame,f=e.find,I=e.view,b=e.v3,g=e.isValid,v=e.instantiate,C=e.Tween,U=e.LabelComponent,w=e.CameraComponent,y=e.SpriteComponent,N=e.Component},function(e){k=e.MenuUIBase},function(e){_=e.GoldCtl},function(e){P=e.UpdateTowerUI},function(e){B=e.BuildTowerUI},function(e){L=e.GameWinPrefab},function(e){G=e.SkillCtl},function(e){S=e.GameController}],execute:function(){c._RF.push({},"ac456IJb4BOS7ZW+hoJsDui","UIController",void 0),X=d.ccclass,Y=d.property,e("UIController",(T=X("UIController"),j=Y({type:p}),z=Y({type:p}),M=Y({type:h}),R=Y({type:h}),A=Y({type:h}),E=Y({type:m}),H=Y({type:p}),W=Y({type:h}),T((x=o((F=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,u=new Array(n),c=0;c<n;c++)u[c]=arguments[c];return o=r(this,(e=l(t)).call.apply(e,[this].concat(u))),s(o,"buildTowerPrefab",x,a(o)),s(o,"updateMenuPrefab",O,a(o)),o.gameController=null,s(o,"cameraNode",V,a(o)),o.buildUINode=null,o.updateUINode=null,s(o,"enemyInfoButton",J,a(o)),s(o,"towerInfoButton",Z,a(o)),o.isHoldSkillIcon=!1,s(o,"bossIcon",q,a(o)),s(o,"gameResultPrefab",K,a(o)),s(o,"currentLevelLabelIcon",Q,a(o)),o}return n(t,e),u(t,[{key:"start",value:function(){var e=this;this.gameController=f("GameController").getComponent(S);var t=I.getVisibleSize().width;this.enemyInfoButton.position=b(-.5*t-100,0,0),this.towerInfoButton.position=b(.5*t+100,0,0),console.log("ui controller start"),this.gameController.node.on("touch-base-build-base",(function(t){e.isHoldSkillIcon||(g(e.updateUINode)&&e.updateUINode.getComponent(k).close(),g(e.buildUINode)||(e.buildUINode=v(e.buildTowerPrefab),e.buildUINode.parent=e.node,e.buildUINode.getComponent(B).init(e.gameController.getGameConfig().json,e.gameController)),e.setUINodeTo3dPos(e.buildUINode,t),e.buildUINode.getComponent(k).open(t))})),this.gameController.node.on("touch-tower",(function(t){e.isHoldSkillIcon||(g(e.buildUINode)&&e.buildUINode.getComponent(k).close(),g(e.updateUINode)||(e.updateUINode=v(e.updateMenuPrefab),e.updateUINode.parent=e.node,e.updateUINode.getComponent(P).init(e.gameController.getGameConfig().json,e.gameController)),e.setUINodeTo3dPos(e.updateUINode,t),e.updateUINode.getComponent(P).open(t))})),this.node.on("show-ui-enter-anim",this.showUIEnterAnim.bind(this),this),this.node.on("show-game-loss-ui",this.showGameLossUI.bind(this),this),this.node.on("show-game-win-ui",this.showGameWinUI.bind(this),this),this.node.on("show-current-level-icon-anim",this.showCurrentLevelIconAnim.bind(this),this),this.node.on("close-all-ui",this.closeSomeUI.bind(this),this),this.node.on("refer-current-tower-menu-ui",this.referTowerBuildMenuUI.bind(this),this)}},{key:"referTowerBuildMenuUI",value:function(){g(this.buildUINode)&&this.buildUINode.getComponent(B).referCurrentUI()}},{key:"closeSomeUI",value:function(){g(this.buildUINode)&&this.buildUINode.getComponent(B).close(),g(this.updateUINode)&&this.updateUINode.getComponent(P).close()}},{key:"showCurrentLevelIconAnim",value:function(e){var t=this,o=new C(this.currentLevelLabelIcon);this.currentLevelLabelIcon.active=!0,this.currentLevelLabelIcon.getComponent(U).string="第"+(this.gameController.getCurrentLevelNum()+1)+"关",o.set({scale:b(2,2,2)}),o.to(.5,{scale:b(1,1,1)},{easing:"backOut"}),o.delay(.8),o.call((function(){t.currentLevelLabelIcon.active=!1,e()})),o.start()}},{key:"showGameWinUI",value:function(e){var t=v(this.gameResultPrefab);t.parent=this.node;var o=this.gameController.getGameConfig().json;t.getComponent(L).setGameResult(!0,e,o,this,this.gameController)}},{key:"showGameLossUI",value:function(e){this.closeSomeUI();var t=v(this.gameResultPrefab);t.parent=this.node;var o=this.gameController.getGameConfig().json;t.getComponent(L).setGameResult(!1,e,o,this,this.gameController)}},{key:"showUIEnterAnim",value:function(e){var t=this;return this.node.emit("enter-game"),this.node.getComponent(G).showEnterAnim().then((function(){return t.node.getComponent(_).showEnterAnim()})).then((function(){return t.showButtonUIEnter()})).then((function(){e&&e()}))}},{key:"showButtonUIEnter",value:function(){var e=this;return new Promise((function(t,o){for(var n=[e.enemyInfoButton,e.towerInfoButton],i=I.getVisibleSize().width,r=[],l=function(e,t){return new Promise((function(o,n){var r=0===t?-1:1,l=new C(e);l.to(.4,{position:b(100*-r+.5*i*r,0,0)}),l.call((function(){console.log("进场结束"),o()})),l.start()}))},s=0;s<n.length;s++){var a=n[s];r.push(l(a,s))}Promise.all(r).then((function(){t()}))}))}},{key:"setUINodeTo3dPos",value:function(e,t){var o;o=this.cameraNode.getComponent(w).convertToUINode(t.position,this.node),e.setPosition(o)}},{key:"onButtonClick",value:function(e,t){switch(console.log("on button click",t),t){case"start-game":console.log("event",e),e.target.destroy(),this.gameController.node.emit("player-click-game")}}},{key:"setHoldSkillIcon",value:function(e){this.isHoldSkillIcon=e}},{key:"showBossIconAnim",value:function(){var e=this;return new Promise((function(t,o){var n=new h;n.addComponent(y).spriteFrame=e.bossIcon,n.parent=e.node;var i=new C(n);i.set({scale:b(2,2,2),position:b(0,240,0)}),i.to(.2,{scale:b(1,1,1)},{easing:"backIn"}),i.delay(.8),i.hide(),i.call((function(){n.destroy(),t()})),i.start()}))}},{key:"playerClickNextLevelButton",value:function(){this.gameController.enterNextLevel()}}]),t}(N)).prototype,"buildTowerPrefab",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(F.prototype,"updateMenuPrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(F.prototype,"cameraNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=o(F.prototype,"enemyInfoButton",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=o(F.prototype,"towerInfoButton",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(F.prototype,"bossIcon",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(F.prototype,"gameResultPrefab",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=o(F.prototype,"currentLevelLabelIcon",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=F))||D)),c._RF.pop()}}}));

System.register("chunks:///UI/SkillCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js","./UIController.js","../Towers/TowerBase.js","../GameController.js"],(function(e,o){var t,i,n,r,l,s,c,a,u,d,p,v,f,h,k,g,m,y,w,C,b,S,_,N,T,P,R,B,z,I,L,E,F,U,x,D,A,j,H,O,G,V,J,M,W,Y,Z,q,K,Q,X,$;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,c=e.assertThisInitialized,a=e.createClass},function(e){u=e.cclegacy,d=e._decorator,p=e.Prefab,v=e.SpriteFrame,f=e.Node,h=e.CCInteger,k=e.view,g=e.v3,m=e.find,y=e.CameraComponent,w=e.UITransformComponent,C=e.Tween,b=e.isValid,S=e.instantiate,_=e.Component},function(e){N=e.State},function(e){T=e.UIController},function(e){P=e.TowerBase},function(e){R=e.GameController}],execute:function(){u._RF.push({},"40520LpyUZJx6EmYjb+U/Iw","SkillCtl",void 0),X=d.ccclass,$=d.property,e("SkillCtl",(B=X("SkillCtl"),z=$({type:p}),I=$({type:v}),L=$({type:v}),E=$({type:f}),F=$({type:h}),U=$({type:f}),x=$({type:f}),D=$({type:f}),A=$({type:p}),j=$({type:f}),B((G=t((O=function(e){function o(){var e,t;n(this,o);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=r(this,(e=l(o)).call.apply(e,[this].concat(a))),s(t,"狂暴道具Prefab",G,c(t)),s(t,"狂暴道具SpriteFrameRed",V,c(t)),s(t,"狂暴道具SpriteFrameGray",J,c(t)),s(t,"skillsNode",M,c(t)),s(t,"currentSkillCount",W,c(t)),s(t,"skillRedBgList",Y,c(t)),s(t,"skillButtonNode",Z,c(t)),t.skillNodeList=[],t.currentTouchNode=null,t.cameraNodeCom=null,t.gameController=null,t.timeoutResolve=void 0,t.rayCheckResolve=void 0,t.targetTower=void 0,t.currentSkillPower=0,s(t,"skillPowerFullEffect",q,c(t)),t.state=new N,s(t,"addPowerAnim3dPrefab",K,c(t)),s(t,"skillDouIcon",Q,c(t)),t}return i(o,e),a(o,[{key:"onLoad",value:function(){}},{key:"start",value:function(){var e=this,o=k.getVisibleSize().width;this.skillButtonNode.position=g(.5*o+100,this.skillButtonNode.position.y,this.skillButtonNode.position.z),this.gameController=m("GameController").getComponent(R),this.gameController.node.on("touch-screen-to-3d",(function(o){for(var t=0;t<o.length;t++){var i=o[t];if(i.collider&&i.collider.node&&i.collider.node.getComponent(P)&&e.rayCheckResolve){e.targetTower=i.collider.node,e.rayCheckResolve("check-succ"),e.rayCheckResolve=void 0;break}}})),this.cameraNodeCom=m("Camera").getComponent(y),this.node.on(f.EventType.TOUCH_START,(function(o){console.log("touch start",o);var t=e.skillDouIcon.getComponent(w).getBoundingBoxToWorld(),i=o.getUILocation();t.contains(i)&&(console.log("点中了 技能点"),e.currentTouchNode=e.skillDouIcon,e.startCheckSkillNode(),e.node.getComponent(T).setHoldSkillIcon(!0))})),this.node.on(f.EventType.TOUCH_MOVE,(function(o){if(e.currentTouchNode){var t=o.getUILocation(),i=e.node.getComponent(w).convertToNodeSpaceAR(g(t.x,t.y,0));e.currentTouchNode.position=g(i.x,i.y,0)}})),this.node.on(f.EventType.TOUCH_END,(function(o){e.currentTouchNode&&(console.log("释放"),e.scheduleOnce((function(){e.node.getComponent(T).setHoldSkillIcon(!1),e.timeoutResolve&&(e.timeoutResolve("timeout"),e.timeoutResolve=void 0)}),.1))}))}},{key:"startCheckSkillNode",value:function(){var e=this,o=[new Promise((function(o,t){e.rayCheckResolve=o})),new Promise((function(o,t){e.timeoutResolve=o}))];Promise.race(o).then((function(o){if("timeout"===o){console.log("超市了");var t=new C(e.currentTouchNode);t.to(.2,{position:e.skillButtonNode.position}),t.call((function(){e.currentTouchNode=void 0})),t.start()}else if(console.log("释放技能成功"),b(e.targetTower)){console.log("给目标塔发送消息，释放技能"),e.targetTower.getComponent(P).releaseSkill(),e.currentTouchNode.active=!1,e.currentTouchNode.position=e.skillButtonNode.position,e.skillPowerFullEffect.active=!1,e.currentSkillPower=0;for(var i=0;i<e.skillRedBgList.length;i++){var n=e.skillRedBgList[i];n.position=g(n.position.x,-80,n.position.z)}e.currentTouchNode=void 0}}))}},{key:"showEnterAnim",value:function(){var e=this;return new Promise((function(o,t){var i=k.getVisibleSize(),n=i.height;console.log("height",n);var r=new C(e.skillButtonNode);r.to(.2,{position:g(.5*i.width-110,e.skillButtonNode.position.y,e.skillButtonNode.position.z)}),r.call((function(){o(),e.state.setState("run")})),r.start()}))}},{key:"addSkillPower",value:function(e){if(!(this.currentSkillPower>=80)){this.currentSkillPower+=e;var o=this.currentSkillPower/80;1===o&&(this.skillPowerFullEffect.active=!0,this.skillDouIcon.active=!0,this.skillDouIcon.position=this.skillButtonNode.position);for(var t=0;t<this.skillRedBgList.length;t++){var i=this.skillRedBgList[t];i.position=g(i.position.x,80*o-80,i.position.z)}}}},{key:"showAddPowerAnimEffect",value:function(e,o){var t=this,i=S(this.addPowerAnim3dPrefab);i.parent=this.gameController.node,i.position=o;var n=new C(i);n.by(.4,{position:g(0,5,0)}),n.delay(.6),n.to(.6,{position:g(45,10,0)}),n.call((function(){i.destroy(),t.addSkillPower(e)})),n.start()}},{key:"update",value:function(e){if("run"===this.state.getState())for(var o=0;o<this.skillRedBgList.length;o++){var t=this.skillRedBgList[o];if(t.position=g(t.position.x+20*e,t.position.y,t.position.z),t.position.x>153){var i=0===o?1:0,n=this.skillRedBgList[i];t.position=g(n.position.x-152,n.position.y,n.position.z)}}}}]),o}(_)).prototype,"狂暴道具Prefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(O.prototype,"狂暴道具SpriteFrameRed",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(O.prototype,"狂暴道具SpriteFrameGray",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(O.prototype,"skillsNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(O.prototype,"currentSkillCount",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Y=t(O.prototype,"skillRedBgList",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Z=t(O.prototype,"skillButtonNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(O.prototype,"skillPowerFullEffect",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(O.prototype,"addPowerAnim3dPrefab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(O.prototype,"skillDouIcon",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=O))||H)),u._RF.pop()}}}));

System.register("chunks:///Towers/TowerBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../util/State.js","../TowerBuildBase/TowerBuildBase.js","../BulletBase.js","../UI/SkillCtl.js","../GameController.js","../Enemys/EnemyBase.js","../EnemyController.js"],(function(t,e){var o,n,i,r,a,s,l,u,c,h,d,g,f,m,p,y,v,k,C,T,b,w,B,S,A,E,N,R,_,P,z,D,x,O,j,L,I,G,F,U,V,M,H,Q,W,q;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inherits,i=t.classCallCheck,r=t.possibleConstructorReturn,a=t.getPrototypeOf,s=t.initializerDefineProperty,l=t.assertThisInitialized,u=t.createClass,c=t.get},function(t){h=t.cclegacy,d=t._decorator,g=t.Prefab,f=t.Node,m=t.CCFloat,p=t.v3,y=t.find,v=t.SkeletalAnimationComponent,k=t.isValid,C=t.Vec3,T=t.v2,b=t.Quat,w=t.Tween,B=t.instantiate},function(t){S=t.BaseObject},function(t){A=t.State},function(t){E=t.TowerBuildBase},function(t){N=t.BulletBase},function(t){R=t.SkillCtl},function(t){_=t.GameController},function(t){P=t.EnemyBase},function(t){z=t.EnemyController}],execute:function(){h._RF.push({},"93965WLO/1GpoRxL0uoTS9a","TowerBase",void 0),W=d.ccclass,q=d.property,t("TowerBase",(D=W("TowerBase"),x=q({type:g}),O=q({type:f}),j=q({type:f}),L=q({type:m}),I=q({type:f}),D((U=o((F=function(t){function e(){var t,o;i(this,e);for(var n=arguments.length,u=new Array(n),c=0;c<n;c++)u[c]=arguments[c];return(o=r(this,(t=a(e)).call.apply(t,[this].concat(u)))).state=new A,o.currentTargetEnemy=null,o.currentShootTime=0,s(o,"bulletPrefab",U,l(o)),s(o,"bulletStartPosList",V,l(o)),s(o,"weaponBaseNode",M,l(o)),o.currentShootDiraction=p(0,0,0),o.gameConfig=null,s(o,"attackAnimEventTimeOffset",H,l(o)),o.towerBuildBase=null,s(o,"attackRangeNode",Q,l(o)),o.skillCtl=null,o.currentShootBulletIndex=0,o}return n(e,t),u(e,[{key:"init",value:function(t,o){c(a(e.prototype),"init",this).call(this,t,o),this.skillCtl=y("Canvas").getComponent(R),this.gameConfig=t,console.log("tower base init"),this.node.emit("init",t,o)}},{key:"start",value:function(){var t=this;console.log("tower base start"),this.state.setState("run"),this.gameController=y("GameController").getComponent(_),this.gameController.node.on("touch-screen-to-3d",this.touchScreenTo3d.bind(this),this),this.gameController.node.on("destroy-all-tower",this.destroyAllTower.bind(this),this),this.state.addState("releas-skill",(function(){t.currentTargetEnemy&&(t.currentTargetEnemy=null),t.node.emit("release-skill",(function(){t.state.setState("run")}))})),this.state.addState("destroy",(function(){var e=t.rootNode.getComponent(v),o=e.getState("骨架|todestroy");o?(o.repeatCount=1,e.play("骨架|todestroy"),t.scheduleOnce((function(){t.towerBuildBase&&t.towerBuildBase.getComponent(E).unSetTargetTower(t.node);var e=p(2*Math.random(),0,2*Math.random());t.gameController.getComponent(_).showAddGoldAnimEffect(t.getDestroyCount(),p(t.node.position.x,0,t.node.position.z).add(e)),t.node.destroy()}),o.length)):(t.node.destroy(),t.towerBuildBase&&t.towerBuildBase.getComponent(E).unSetTargetTower(t.node))}))}},{key:"destroyAllTower",value:function(){this.node.destroy()}},{key:"touchScreenTo3d",value:function(t){if(console.log("射线检测到了 tower"),"run"===this.state.getState())for(var e=0;e<t.length;e++){if(t[e].collider.node.uuid===this.node.uuid){this.gameController.node.emit("touch-tower",this.node);break}}}},{key:"onDestroy",value:function(){console.log("销毁"),this.gameController.node.off("touch-screen-to-3d",this.touchScreenTo3d,this),this.gameController.node.on("destroy-all-tower",this.destroyAllTower,this)}},{key:"toDestroy",value:function(){this.state.setState("destroy")}},{key:"update",value:function(t){if("run"===this.state.getState()){if(null===this.currentTargetEnemy){for(var e=this.gameController.getComponent(z).getCurrentEnemyNodeList(),o=1e4,n=void 0,i=0;i<e.length;i++){var r=e[i];if(k(r)&&r.getComponent(P).getIsCanLock()&&!r.getComponent(P).getIsDead()&&this.getCanAttackEnemy(r)){var a=new C(r.position).subtract(this.node.position).length();a<o&&(o=a,n=r)}}if(n)T(n.position.x,n.position.z).subtract(T(this.node.position.x,this.node.position.z)).length()<this.getCurrentAttackRange()&&(this.currentTargetEnemy=n)}if(k(this.currentTargetEnemy))if(this.rootNode&&(this.rootNode.lookAt(this.currentTargetEnemy.position),this.rootNode.eulerAngles.x<0&&(this.rootNode.eulerAngles=p(0,this.rootNode.eulerAngles.y,this.rootNode.eulerAngles.z))),this.currentTargetEnemy.getComponent(P)&&this.currentTargetEnemy.getComponent(P).getIsDead())this.currentTargetEnemy=null;else{this.currentShootDiraction=p(this.currentTargetEnemy.position).subtract(p(this.node.position));var s=new b,l=p(this.currentShootDiraction.x,0,this.currentShootDiraction.z).normalize();b.fromViewUp(s,l,C.UP);var u=new b;b.lerp(u,this.node.rotation,s,.2),this.node.rotation=s}if(k(this.currentTargetEnemy))if(this.currentShootTime>this.shootDuraction){if(T(this.currentTargetEnemy.position.x,this.currentTargetEnemy.position.z).subtract(T(this.node.position.x,this.node.position.z)).length()>this.getCurrentAttackRange())return void(this.currentTargetEnemy=void 0);this.currentShootTime=0,this.shootOneBullet(this.getCurrentAttackRate(),this.currentShootDiraction,this.getCurrentAttackNum())}else this.currentShootTime+=t;else this.currentTargetEnemy=null}}},{key:"getCurrentAttackRate",value:function(){return this.baseAttackRate}},{key:"shootOneBullet",value:function(t,e,o){var n=this,i=[this.rootNode];this.weaponBaseNode&&i.push(this.weaponBaseNode);var r=!1;if(this.getBulletRecoverTime()>0)for(var a=0;a<this.bulletStartPosList.length;a++){if(this.bulletStartPosList[a].active){r=!0;break}}else r=!0;if(r){for(var s=0,l=0;l<i.length;l++){var u=i[l].getComponent(v);if(u){var c=u.getState("骨架|AttackAnim"),h=1*c.length/t;u.play("骨架|AttackAnim"),c.repeatCount=1,s=h}}this.scheduleOnce((function(){n.createOneTimeBullet(e,n.getCurrentAttackNum())}),s*this.attackAnimEventTimeOffset)}}},{key:"createOneTimeBullet",value:function(t,e){for(var o=this,n=function(n){var i=o.bulletStartPosList[n];if(i.active){var r=B(o.bulletPrefab);if(r.parent=o.node.parent,r.active=!1,r.setPosition(i.worldPosition),r.active=!0,console.log("createOneBullet base attack num",e),r.getComponent(N).init(o.gameConfig,o.gameController,{direction:t,targetEnemy:o.currentTargetEnemy,baseAttackNum:e,targetTower:o}),o.getBulletRecoverTime()>0){i.active=!1,o.currentShootBulletIndex++,o.currentShootBulletIndex===o.bulletStartPosList.length&&(o.currentShootBulletIndex=0);var a=p(i.position),s=new w(i);return s.set({position:p(i.position).subtract(p(0,.3,-.3))}),s.delay(o.getBulletRecoverTime()),s.call((function(){i.active=!0})),s.to(.2,{position:a}),s.start(),"break"}}},i=this.currentShootBulletIndex;i<this.bulletStartPosList.length;i++){if("break"===n(i))break}}},{key:"enemyDeadByThis",value:function(t){t&&k(this.skillCtl)&&this.skillCtl.showAddPowerAnimEffect(2,this.node.position)}},{key:"releaseSkill",value:function(){console.log("release skill",this.objectType),this.state.setState("releas-skill")}},{key:"setTowerBuildBase",value:function(t){this.towerBuildBase=t}},{key:"updateLevel",value:function(){c(a(e.prototype),"updateLevel",this).call(this)}},{key:"showAttackRange",value:function(){var t=this.getCurrentAttackRange();console.log("attack range",t),this.attackRangeNode.active=!0;var e=new w(this.attackRangeNode);e.to(.1,{scale:p(2*t,2*t,2*t)}),e.start()}},{key:"closeAttackRange",value:function(){var t=this,e=new w(this.attackRangeNode);e.to(.1,{scale:p(1,1,1)}),e.call((function(){t.attackRangeNode.active=!1})),e.start()}}]),e}(S)).prototype,"bulletPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(F.prototype,"bulletStartPosList",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=o(F.prototype,"weaponBaseNode",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(F.prototype,"attackAnimEventTimeOffset",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Q=o(F.prototype,"attackRangeNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=F))||G)),h._RF.pop()}}}));

System.register("chunks:///Home/HomeIcon.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js"],(function(e,t){var o,r,n,i,s,a,c,u,l,d,p,f,v,h,y,H,m,_,g,I,S;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,s=e.getPrototypeOf,a=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){l=e.cclegacy,d=e._decorator,p=e.Node,f=e.v3,v=e.Component},function(e){h=e.State}],execute:function(){l._RF.push({},"8213do7DSVI0IEO26O7s126","HomeIcon",void 0),I=d.ccclass,S=d.property,e("HomeIcon",(y=I("HomeIcon"),H=S({type:p}),y((g=o((_=function(e){function t(){var e,o;n(this,t);for(var r=arguments.length,u=new Array(r),l=0;l<r;l++)u[l]=arguments[l];return o=i(this,(e=s(t)).call.apply(e,[this].concat(u))),a(o,"redHeartNode",g,c(o)),o.state=new h,o}return r(t,e),u(t,[{key:"start",value:function(){this.state.setState("run")}},{key:"frozenHomeIcon",value:function(){this.state.setState("frozen")}},{key:"freeHomeIconn",value:function(){this.state.setState("run")}},{key:"update",value:function(e){"run"===this.state.getState()&&(this.redHeartNode.eulerAngles=this.redHeartNode.eulerAngles.add(f(0,1,0)))}}]),t}(v)).prototype,"redHeartNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=_))||m)),l._RF.pop()}}}));

System.register("chunks:///GameController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./Data/PlayerData.js","./Effect/WinGoldAnimEffect.js","./TowerBuildBase/TowerBuildBase.js","./GroundMapCtl.js","./TowerBuildBaseCtl.js","./Towers/TowerBase.js","./Home/HomeIcon.js","./EnemyController.js"],(function(e,t){var n,o,r,a,i,l,s,u,c,d,m,f,p,h,y,v,g,C,w,b,B,G,S,I,k,P,_,A,D,N,z,E,T,H,L,j,R,x,J,O,F,M,U,W,V,Y,q,X,K,Q,Z,$,ee,te;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_class3:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,d=e._decorator,m=e.Node,f=e.JsonAsset,p=e.Prefab,h=e.Tween,y=e.v3,v=e.isValid,g=e.PhysicsSystem,C=e.instantiate,w=e.SkeletalAnimationComponent,b=e.Component},function(e){B=e.State},function(e){G=e.PlayData},function(e){S=e.WinGoldAnimEffect},function(e){I=e.TowerBuildBase},function(e){k=e.GroundMapCtl},function(e){P=e.TowerBuildBaseCtl},function(e){_=e.TowerBase},function(e){A=e.HomeIcon},function(e){D=e.EnemyController}],execute:function(){c._RF.push({},"5b4c0ApYS1B3bhehBCF/cvX","GameController",void 0),ee=d.ccclass,te=d.property,e("GameController",(N=ee("GameController"),z=te({type:m}),E=te({type:f}),T=te({type:p}),H=te({type:m}),L=te({type:m}),j=te({type:m}),R=te({type:m}),x=te({type:p}),J=te({type:p}),N(($=Z=function(e){function t(){var e,n;r(this,t);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return n=a(this,(e=i(t)).call.apply(e,[this].concat(u))),l(n,"enemyHealthBarCtlNode",M,s(n)),l(n,"gameConfigJson",U,s(n)),l(n,"towersPrefabList",W,s(n)),l(n,"startGameButton",V,s(n)),n.state=new B,l(n,"uiController",Y,s(n)),l(n,"plate",q,s(n)),l(n,"gameStartButtonBase",X,s(n)),l(n,"homeIconPrefab",K,s(n)),n.homeIconNode=null,n.playerData=null,l(n,"goldAnim3dPrefab",Q,s(n)),n.homeIconTw=null,n}return o(t,e),u(t,[{key:"onLoad",value:function(){this.playerData=new G(this);var e=new h(this.plate);e.repeatForever(new h(this.plate).to(20,{eulerAngles:y(0,360,0)}).set({eulerAngles:y(0,0,0)})),e.start()}},{key:"playerClickSaveLifeButton",value:function(){var e=this;return new Promise((function(t,n){t(),v(e.homeIconNode)&&(e.homeIconNode.active=!1),e.node.emit("destroy-all-enemy",(function(t){e.playerData.addGoldCount(t),e.showHomeIconEnterAnim().then((function(){e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(D).continueGame()}))}))}))}},{key:"playerClickShareButton",value:function(){var e=this;return new Promise((function(t,n){t(),e.playerData.addGoldCount(e.playerData.currentGoldCount)}))}},{key:"playerClickRetryButton",value:function(){var e=this;this.playerData.newGame(),this.enterGame().then((function(){e.uiController.emit("refer-red-heart-label"),e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(D).startGame()}))}},{key:"start",value:function(){var e=this;g.instance.enable=!0,this.state.addState("ready",(function(){console.log("enter state ",e.state.getState())})),this.state.setState("ready"),this.node.on("build-one-tower",(function(t,n){if(t<e.towersPrefabList.length){var o=C(e.towersPrefabList[t]);o.parent=e.node,o.getComponent(_).init(e.gameConfigJson.json,e);var r=y(n.position.x,0,n.position.z);o.setPosition(r),n.getComponent(I).setTargetTower(o),o.getComponent(_).setTowerBuildBase(n)}})),this.state.addState("play-start-button-anim",(function(){e.playStatrButtonPressAnim().then((function(){return new Promise((function(t,n){new h(e.startGameButton).by(1,{position:y(0,-10,0)}).call((function(){console.log("play over"),e.startGameButton.destroy(),t()})).start()}))})).then((function(){var t=new h(e.gameStartButtonBase);return t.to(.2,{scale:y(0,0,0)}),t.call((function(){e.gameStartButtonBase.destroy()})),t.start(),e.node.getComponent(k).showGroundEnterAnim()})).then((function(){return e.enterGame()})).then((function(){return e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.showUIEnterAnim()})).then((function(){e.state.setState("run"),e.node.getComponent(D).startGame()}))})),this.state.addState("game-loss",(function(){console.log("进入游戏失败的状态"),e.uiController.emit("close-weapon-info-layer"),e.node.getComponent(D).frozenAllEnemy(),e.node.getComponent(P).frozenAllTowerBuildBase(),e.homeIconNode.getComponent(A).frozenHomeIcon();var t=e.node.getComponent(D).getDeadEnemyData();e.scheduleOnce((function(){e.uiController.emit("show-game-loss-ui",t)}),.6)}))}},{key:"showUIEnterAnim",value:function(){var e=this;return new Promise((function(t,n){e.uiController.emit("show-ui-enter-anim",(function(){t()}))}))}},{key:"showHomeIconEnterAnim",value:function(){var e=this;return new Promise((function(t,n){v(e.homeIconNode)||(e.homeIconNode=C(e.homeIconPrefab),e.homeIconNode.parent=e.node);var o=e.node.getComponent(k);if(o){var r=o.getMapNodeList().getValue(5,5);e.homeIconNode.position=y(r.position.x,20,r.position.z),e.homeIconNode.getComponent(A).freeHomeIconn(),r.active=!1;var a=new h(e.homeIconNode);e.homeIconNode.active=!0,a.call((function(){r.active=!0})),a.to(2,{position:y(r.position.x,0,r.position.z)},{easing:"quadOut"}),a.call((function(){t()})),a.start()}}))}},{key:"playStatrButtonPressAnim",value:function(){var e=this;return new Promise((function(t,n){var o=e.startGameButton.getChildByName("StartGameButton").getComponent(w);if(o){var r=o.defaultClip,a=o.getState(r.name);a.repeatCount=1;var i=a.length;o.play(r.name),e.scheduleOnce((function(){console.log("播放完成"),t()}),i)}else t()}))}},{key:"playerTouch3dObject",value:function(e){if("ready"===this.state.getState())for(var t=0;t<e.length;t++){e[t].collider.node.uuid===this.startGameButton.uuid&&this.state.setState("play-start-button-anim")}else"run"===this.state.getState()&&this.node.emit("touch-screen-to-3d",g.instance.raycastResults)}},{key:"update",value:function(e){}},{key:"getGameConfig",value:function(){return this.gameConfigJson}},{key:"getCurrentLevelNum",value:function(){return this.playerData.currentLevelNum}},{key:"showAddGoldAnimEffect",value:function(e,t){var n=C(this.goldAnim3dPrefab);n.parent=this.node,n.getComponent(S).setGoldCount(e,this),n.position=t}},{key:"showBossEnterState",value:function(){this.node.emit("show-boss-enter-state")}},{key:"gameWin",value:function(e){this.uiController.emit("close-all-ui"),this.uiController.emit("close-weapon-info-layer"),"run"===this.state.getState()&&(this.state.setState("show-game-result"),this.uiController.emit("show-game-win-ui",e))}},{key:"enterNextLevel",value:function(){var e=this;this.playerData.enterNextLevel(),console.log("进入下一关"),this.enterGame().then((function(){e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(D).startGame()}))}},{key:"enterGame",value:function(){var e=this;return new Promise((function(t,n){v(e.homeIconNode)&&(e.homeIconNode.active=!1),e.node.emit("destroy-all-tower"),e.node.emit("destroy-all-tower-build-base"),e.node.emit("destroy-all-enemy"),e.node.emit("init-level-label"),e.node.getComponent(P).showTowerBuildBaseEnterAnim().then((function(){return e.showHomeIconEnterAnim()})).then((function(){return e.showCurrentLevelIconAnim()})).then((function(){t()}))}))}},{key:"showCurrentLevelIconAnim",value:function(){var e=this;return new Promise((function(t,n){e.uiController.emit("show-current-level-icon-anim",(function(){t&&t()}))}))}},{key:"enemyAttacked",value:function(e){(console.log("敌人发动了攻击",e),"run"===this.state.getState())&&(this.playerData.getCurrentRedHeartCount()>0&&(this.playerData.addRedHeartCount(-1),0===this.playerData.getCurrentRedHeartCount()&&(console.log("游戏结束"),this.state.setState("game-loss"))))}},{key:"referRedHeardUI",value:function(){this.uiController.emit("refer-red-heart-label")}},{key:"activeEnemySuccess",value:function(e){console.log("active enemy succcess",e),this.uiController.emit("refer-enemy-info-cell",e)}}]),t}(b),Z.accY=-1,Z.enemyBeLockMaxNum=1,M=n((F=$).prototype,"enemyHealthBarCtlNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=n(F.prototype,"gameConfigJson",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=n(F.prototype,"towersPrefabList",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=n(F.prototype,"startGameButton",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=n(F.prototype,"uiController",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=n(F.prototype,"plate",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=n(F.prototype,"gameStartButtonBase",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=n(F.prototype,"homeIconPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=n(F.prototype,"goldAnim3dPrefab",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=F))||O)),c._RF.pop()}}}));

System.register("chunks:///util/FindPathWithAStart.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./My2Array.js"],(function(t,e){var s,i,n,a,h;return{setters:[function(t){s=t.createClass,i=t.classCallCheck},function(t){n=t.cclegacy},function(t){a=t.default}],execute:function(){n._RF.push({},"9bae92/Z1FGnZ8sEkxwZFcp","FindPathWithAStart",void 0),h=function(){function t(e,s){i(this,t),this.x=0,this.y=0,this.isHaveObs=!1,this.gValue=0,this.hValue=0,this.parent=null,this.x=e,this.y=s}return s(t,[{key:"setParent",value:function(t){this.parent=t}},{key:"getFValue",value:function(){return this.gValue+this.hValue}},{key:"setObs",value:function(t){this.isHaveObs=t}}]),t}(),t("FindPathWithAStart",function(){function t(e,s,n){i(this,t),this.openList=[],this.closeList=[],this.mapNodeList=new a,this.statrNode=null,this.endNode=null;for(var r=e.getHeightLength(),u=e.getWidthLength(),o=0;o<r;o++){for(var l=new Array,c=0;c<u;c++)l.push(new h(c,o));this.mapNodeList.pushList(l)}this.statrNode=this.mapNodeList.getValue(s[0],s[1]),this.endNode=this.mapNodeList.getValue(n[0],n[1])}return s(t,[{key:"findPathList",value:function(){var t=[];for(this.openList.push(this.statrNode);this.openList.length>0;){var e=this.findMinFvalueNode(this.openList),s=this.openList.splice(e,1)[0];if(s.x===this.endNode.x&&s.y===this.endNode.y){var i=s.parent;for(t.push(s);i.x!==this.statrNode.x||i.y!==this.statrNode.y;)t.push(i),i=i.parent;break}this.closeList.push(s);for(var n=this.findNearbyNodeList(s,this.mapNodeList),a=0;a<n.length;a++){var h=n[a];this.checkIsInList(h,this.closeList)||(this.checkIsInList(h,this.openList)?h.parent.gValue<s.gValue&&(h.setParent(s),h.gValue=s.gValue+this.getDistance(h.parent,h),h.hValue=this.getDistance(h,this.endNode)):(h.setParent(s),h.gValue=s.gValue+this.getDistance(h.parent,h),h.hValue=this.getDistance(h,this.endNode),this.openList.push(h)))}}t=t.reverse();for(var r=[],u=0;u<t.length;u++)r.push([t[u].x,t[u].y]);return r}},{key:"getDistance",value:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"findNearbyNodeList",value:function(t,e){for(var s=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],i=[],n=0;n<s.length;n++){var a=s[n],h=t.x+a[0],r=t.y+a[1],u=e.getValue(h,r);u&&!u.isHaveObs&&i.push(u)}return i}},{key:"findMinFvalueNode",value:function(t){for(var e=Number.MAX_VALUE,s=null,i=0;i<t.length;i++){var n=t[i].getFValue();n<e&&(e=n,s=i)}return s}},{key:"checkIsInList",value:function(t,e){for(var s=0;s<e.length;s++){var i=e[s];if(i.x===t.x&&i.y===t.y)return!0}return!1}},{key:"updateObsData",value:function(t){for(var e=0;e<t.length;e++){var s=t[e];this.mapNodeList.getValue(s[0],s[1]).setObs(!0)}}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../util/State.js","../GroundMapCtl.js","../util/BezierN.js","../GameController.js","../util/FindPathWithAStart.js","../EnemyController.js"],(function(e,t){var n,o,a,i,r,s,l,u,c,h,d,m,f,p,g,v,y,C,k,A,M,b,B,w,L,N,S,z,P,T,x,E,O,j,D;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,a=e.classCallCheck,i=e.possibleConstructorReturn,r=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass,c=e.get},function(e){h=e.cclegacy,d=e._decorator,m=e.Node,f=e.v3,p=e.find,g=e.SkeletalAnimationComponent,v=e.Tween,y=e.v2,C=e.Quat,k=e.Vec3,A=e.isValid,M=e.ProgressBarComponent},function(e){b=e.BaseObject},function(e){B=e.State},function(e){w=e.GroundMapCtl},function(e){L=e.BezierN},function(e){N=e.GameController},function(e){S=e.FindPathWithAStart},function(e){z=e.DeadEnemyObj}],execute:function(){h._RF.push({},"c8d3fW25B9NIZ69bxowfjcm","EnemyBase",void 0),j=d.ccclass,D=d.property,e("EnemyBase",(P=j("EnemyBase"),T=D({type:m}),P((O=n((E=function(e){function t(){var e,n;a(this,t);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return(n=i(this,(e=r(t)).call.apply(e,[this].concat(u)))).pathList=[],n.state=new B,n.currentPathIndex=0,n.beLockedMaxNum=N.enemyBeLockMaxNum,n.currentbeLockedCount=0,n.cameraNode=null,n.healthBar=null,n.gameConfigJson=null,n.healthCount=0,n.currentHealthCount=0,n.enemyCtl=null,n.currentMoveTw=null,n.groundMapCtl=null,n.beAttackedCb=null,n.bezierPathList=[],n.currentBoneAnimName="",n.enemyColonyCtl=null,s(n,"caidaiEffect",O,l(n)),n}return o(t,e),u(t,[{key:"init",value:function(e,n,o,a){c(r(t.prototype),"init",this).call(this,e,n),this.getMoveType().indexOf("Fly")>-1&&(this.node.position=f(this.node.position.x,10,this.node.position.z)),this.groundMapCtl=p("GameController").getComponent(w),this.gameConfigJson=e,this.healthCount=this.gameConfigJson[this.objectType].HealthCount,this.beLockedMaxNum=this.gameConfigJson[this.objectType].BeLockedCount,this.currentHealthCount=this.healthCount;var i=this.getLookAtAngle(this.node.position,a);this.node.worldRotation=i}},{key:"enterShowBossEnter",value:function(){this.currentMoveTw&&this.currentMoveTw.stop()}},{key:"contiuePlayMoveAnim",value:function(){var e=this;this.currentMoveTw&&(this.rootNode.getComponent(g).getState(this.currentBoneAnimName).speed=3,this.scheduleOnce((function(){e.rootNode.getComponent(g).getState(e.currentBoneAnimName).speed=1}),3))}},{key:"showEnemyEnterAnim",value:function(e,t,n,o){var a=this,i=this.node;return this.enemyCtl=t,this.enemyCtl.node.on("frozen-all-enemy",this.forzenSelf.bind(this),this),new Promise((function(t,r){var s=new v(i);i.position;s.delay(.1*e),s.show(),s.call((function(){i.active=!0})),s.to(.1,{scale:f(1,1,1)}),s.call((function(){a.startRun(n,o),t()})),s.start()}))}},{key:"startRun",value:function(e,t){console.log("start pos ",e),this.state.setState("run");var n=this.getMoveType();"Walk"===n?this.proceeWalkLogic(e,t):"Fly"===n&&(this.getIsColony()||this.processFlyLogic(e,t))}},{key:"processFlyLogic",value:function(e,t){var n=this;if("run"===this.state.getState()){for(var o=this.groundMapCtl.getMapSize(),a=[y(e.x,e.y)],i=0;i<8;i++)a.push(y(Math.round(Math.random()*(o.x-1)),Math.round(Math.random()*(o.y-1))));a.push(t);for(var r=[],s=0;s<a.length;s++){var l=a[s],u=this.groundMapCtl.getMapNodeList().getValue(l.x,l.y);if(u){var c=u.position;r.push(f(c.x,10,c.z))}}var h=new L(r).getPointList(200);this.currentMoveTw=this.processMoveAction(h),this.currentMoveTw.call((function(){n.currentBoneAnimName="骨架|AttackAnim";n.rootNode.getComponent(g).getState("骨架|AttackAnim").length;n.shootOneBossBullet().then((function(){var e=[y(0,0),y(0,10),y(10,0),y(10,10)],o=Math.round(Math.random()*(e.length-1));n.processFlyLogic(e[o],t)}))})),this.currentMoveTw.start()}}},{key:"getOneRandomMapPos",value:function(){var e=this.groundMapCtl.getMapSize();return y(Math.round(Math.random()*(e.x-1)),Math.round(Math.random()*(e.y-1)))}},{key:"processMoveAction",value:function(e){for(var t=this,n=new v(this.node),o=function(n,o){var a=0;new C;if(0===o){a=f(t.node.position).subtract(e[o]).length()/t.moveSpeed,t.getLookAtAngle(t.node.position,e[o])}else{var i=f(e[o-1]).subtract(e[o]).length();t.getLookAtAngle(e[o-1],e[o]),a=i/t.moveSpeed}n.call((function(){t.node.lookAt(e[o])})),n.to(a,{position:e[o]}),n.call((function(){}))},a=0;a<e.length;a++)o(n,a);return n}},{key:"proceeWalkLogic",value:function(e,t){var n=this;if("run"===this.state.getState()){for(var o=this.groundMapCtl.getMapNodeList(),a=this.groundMapCtl.getObsPosList(),i=new S(o,[e.x,e.y],[t.x,t.y]),r=[],s=0;s<a.length;s++){var l=a[s];r.push([l.x,l.y])}i.updateObsData(r);for(var u=i.findPathList(),c=[],h=0;h<u.length;h++){var d=u[h];c.push(this.groundMapCtl.getMapNodeList().getValue(d[0],d[1]).position)}var m=new L(c);this.bezierPathList=m.getPointList(50),this.bezierPathList=this.bezierPathList.slice(0,this.bezierPathList.length-5),this.node.position.equals(this.bezierPathList[this.bezierPathList.length-1])?(console.log("不用再走一遍逻辑了"),this.toBeAttack().then((function(){n.proceeWalkLogic(e,t)}))):(this.currentMoveTw=this.processMoveAction(this.bezierPathList),this.currentMoveTw.call((function(){n.toBeAttack().then((function(){n.proceeWalkLogic(e,t)}))})),this.currentMoveTw.start())}}},{key:"toBeAttack",value:function(){var e=this;return new Promise((function(t,n){e.currentBoneAnimName="骨架|AttackAnim";var o=e.rootNode.getComponent(g);o.play(e.currentBoneAnimName);var a=o.getState(e.currentBoneAnimName),i=a.length;a.repeatCount=1;var r=new v(e.node);r.delay(e.animSpeedMulOffset*i),r.call((function(){console.log("普通敌人发动攻击",e.getBaseAttackDamage()),e.gameController.enemyAttacked(e.getBaseAttackDamage())})),r.delay((1-e.animSpeedMulOffset)*i),r.call((function(){t()})),r.start()}))}},{key:"getLookAtAngle",value:function(e,t){var n=f(e).subtract(t).normalize(),o=new C;return C.fromViewUp(o,n,k.UP),o}},{key:"forzenSelf",value:function(){if(this.currentMoveTw){this.currentMoveTw.stop(),this.state.setState("forzen");var e=this.rootNode.getComponent(g).getState(this.currentBoneAnimName);e&&e.pause()}}},{key:"shootOneBossBullet",value:function(){var e=this;return new Promise((function(t,n){e.currentBoneAnimName="骨架|AttackAnim";var o=e.rootNode.getComponent(g);o.play(e.currentBoneAnimName);var a=o.getState(e.currentBoneAnimName).length,i=new v(e.node);i.delay(e.animSpeedMulOffset*a),i.call((function(){e.enemyCtl.bossShootOneEgg(e.node)})),i.delay((1-e.animSpeedMulOffset)*a),i.call((function(){e.currentBoneAnimName="骨架|MoveAnim",o.play(e.currentBoneAnimName),t&&t()})),i.start()}))}},{key:"onLoad",value:function(){var e=this;this.state.addState("over",(function(){e.enemyCtl.removeEnemyInList(e.node),e.node.destroy()})),this.state.addState("to-dead",(function(){e.enemyCtl.pushOneEnemyDeadData(new z(e.objectType,e.getCurrentGoldCount())),e.currentMoveTw&&e.currentMoveTw.stop();var t=new v(e.rootNode);e.node.eulerAngles=f(0,0,0),e.unscheduleAllCallbacks(),t.by(.1,{scale:f(1,1,1)}),t.call((function(){e.node.position=f(e.node.position.x,0,e.node.position.z),e.rootNode.active=!1,e.caidaiEffect.eulerAngles=f(0,360*Math.random(),0),f(e.node.position).subtract(f(0,0,0)).length()<18&&(e.caidaiEffect.active=!0),e.gameController.showAddGoldAnimEffect(e.getCurrentGoldCount(),f(e.node.position.x,0,e.node.position.z))})),t.delay(1),t.call((function(){e.state.setState("over")})),t.start()})),this.state.addState("run",(function(){var t=e.rootNode.getComponent(g);t&&(e.currentBoneAnimName="骨架|MoveAnim",console.log(e.objectType+"播放移动动作",e.currentBoneAnimName),t.play(e.currentBoneAnimName))})),this.node.on("be-attacked",(function(t){if("run"===e.state.getState()){e.beAttackedCb=t.cb,e.currentHealthCount-=t.baseAttackNum;var n=t.baseGasNum;e.currentGasNum+=n;var o=new v(e.node);o.to(.05,{scale:f(1.05,.98,1.05)}),o.to(.05,{scale:f(1,1,1)}),o.start(),e.currentHealthCount<=0&&(e.currentHealthCount=0,e.beAttackedCb&&e.beAttackedCb(!0),e.state.setState("to-dead")),A(e.healthBar)&&(e.healthBar.getComponent(M).progress=e.currentHealthCount/e.healthCount)}}))}},{key:"start",value:function(){}},{key:"getIsDead",value:function(){return"over"===this.state.getState()||"to-dead"===this.state.getState()}},{key:"getIsCanLock",value:function(){return this.currentbeLockedCount<this.beLockedMaxNum}},{key:"setBeLocked",value:function(e){this.currentbeLockedCount++}},{key:"unSetBeLocked",value:function(e){this.currentbeLockedCount--}},{key:"update",value:function(e){this.enemyColonyCtl&&this.enemyColonyCtl.update(e)}},{key:"playBossEnterAnim",value:function(){var e=this;return new Promise((function(t,n){for(var o=e.rootNode.getComponent(g),a=o.clips,i=void 0,r=0;r<a.length;r++){var s=a[r];"boss-show"===s.name&&(i=s)}i?(o.play("boss-show"),e.scheduleOnce((function(){t()}),i.length)):(o.play("骨架|MoveAnim"),e.scheduleOnce((function(){t()}),1))}))}},{key:"onDestroy",value:function(){this.enemyCtl&&A(this.enemyCtl.node)&&this.enemyCtl.node.off("frozen-all-enemy",this.forzenSelf,this)}},{key:"getColonyComCtl",value:function(){return this.enemyColonyCtl}}]),t}(b)).prototype,"caidaiEffect",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=E))||x)),h._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyBullet.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../util/State.js","../GameController.js"],(function(t,e){var i,n,a,o,c,s,r,l,d,u,f,h,p,y,v,m,g,E,_,S,k,B,P,b;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inherits,a=t.classCallCheck,o=t.possibleConstructorReturn,c=t.getPrototypeOf,s=t.initializerDefineProperty,r=t.assertThisInitialized,l=t.createClass,d=t.get},function(t){u=t.cclegacy,f=t._decorator,h=t.Node,p=t.Tween,y=t.v3},function(t){v=t.BaseObject},function(t){m=t.State},function(t){g=t.GameController}],execute:function(){u._RF.push({},"17cf4gdnXZPP6GfTwWTkX9d","EnemyBullet",void 0),P=f.ccclass,b=f.property,t("EnemyBullet",(E=P("EnemyBullet"),_=b({type:h}),E((B=i((k=function(t){function e(){var t,i;a(this,e);for(var n=arguments.length,l=new Array(n),d=0;d<n;d++)l[d]=arguments[d];return(i=o(this,(t=c(e)).call.apply(t,[this].concat(l)))).state=new m,i.accY=g.accY,i.currentSpeed=0,i.endPos=null,s(i,"caidaiEffect",B,r(i)),i}return n(e,t),l(e,[{key:"start",value:function(){var t=this;this.state.addState("move-end",(function(){var e=new p(t.rootNode);e.to(.1,{scale:y(2,2,2)}),e.hide(),e.call((function(){t.gameController.enemyAttacked(t.getBaseAttackDamage()),t.caidaiEffect.active=!0})),e.delay(.8+.5*Math.random()),e.call((function(){t.caidaiEffect.active=!1,t.node.destroy()})),e.start()}))}},{key:"init",value:function(t,i,n){d(c(e.prototype),"init",this).call(this,t,i),this.endPos=n,this.caidaiEffect.eulerAngles=y(0,360*Math.random(),0);var a=.2*Math.random()+.8;this.caidaiEffect.scale=y(a,a,a),this.state.setState("run")}},{key:"update",value:function(t){"run"===this.state.getState()&&(this.currentSpeed+=this.accY,this.node.position=y(this.node.position).add(y(0,this.currentSpeed*t,0)),this.node.position.y-this.endPos.y<1&&(console.log("停止"),this.state.setState("move-end")))}}]),e}(v)).prototype,"caidaiEffect",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=k))||S)),u._RF.pop()}}}));

System.register("chunks:///EnemyController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./GroundTiled/GroundTiled.js","./GroundMapCtl.js","./GameController.js","./Enemys/EnemyBase.js","./Enemys/EnemyBullet.js"],(function(e,t){var n,o,i,a,r,s,l,u,m,d,c,y,h,v,p,g,f,C,E,b,L,D,w,P,N,_,k,x,A,W,T,B,I,O,z,G,R,j,M,S,V,F,H,J;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_temp:void 0}),{setters:[function(e){n=e.classCallCheck,o=e.applyDecoratedDescriptor,i=e.inherits,a=e.possibleConstructorReturn,r=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass},function(e){m=e.cclegacy,d=e._decorator,c=e.JsonAsset,y=e.Prefab,h=e.Node,v=e.v3,p=e.Tween,g=e.CameraComponent,f=e.instantiate,C=e.Vec2,E=e.Component},function(e){b=e.State},function(e){L=e.GroundTiled},function(e){D=e.GroundMapCtl},function(e){w=e.GameController},function(e){P=e.EnemyBase},function(e){N=e.EnemyBullet}],execute:function(){m._RF.push({},"9eb73bkCLlAgoJJ0ubFFvcV","EnemyController",void 0),H=d.ccclass,J=d.property,e("DeadEnemyObj",(function e(t,o){n(this,e),this.enemyType="",this.dropGoldCount=0,this.enemyType=t,this.dropGoldCount=o})),e("EnemyController",(_=H("EnemyController"),k=J({type:c}),x=J({type:y}),A=J({type:h}),W=J({type:h}),T=J({type:h}),B=J({type:y}),I=J({type:y}),_((G=o((z=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,u=new Array(i),m=0;m<i;m++)u[m]=arguments[m];return o=a(this,(e=r(t)).call.apply(e,[this].concat(u))),s(o,"gameConfigRes",G,l(o)),s(o,"enemysPrefabList",R,l(o)),o.gameConfig=null,o.currentWaveIndex=0,o.waveData=null,o.state=new b,o.addEnemyDuraction=1,o.enemyNodeList=[],o.currentRandomEnemyTypeList=[],s(o,"startPosNodeList",j,l(o)),o.endPos=null,s(o,"enemyHealthBarCtlNode",M,l(o)),s(o,"cameraNode",S,l(o)),s(o,"bosssPrefabList",V,l(o)),s(o,"enemyBulletPrefabList",F,l(o)),o.gameController=null,o.allWaveAddOverCb=null,o.allEnemyDeadCb=null,o.currentLevelDeadEnemyDataList=[],o}return i(t,e),u(t,[{key:"onLoad",value:function(){var e=this;this.node.on("destroy-all-enemy",(function(t){for(var n=0,o=0;o<e.enemyNodeList.length;o++){var i=e.enemyNodeList[o];n+=i.getComponent(P).getCurrentGoldCount(),i.destroy()}e.enemyNodeList=[],t&&t(n)})),this.node.on("init-level-label",(function(){e.node.emit("refer-current-wave-level",e.gameController.getCurrentLevelNum(),0)}))}},{key:"start",value:function(){var e=this;this.gameConfig=this.gameConfigRes.json,this.gameController=this.node.getComponent(w),this.endPos=v(0,0,0),this.state.addState("enter-next-wave",(function(){e.currentWaveIndex!=e.waveData.EnemyType.length&&(e.currentRandomEnemyTypeList=e.waveData.EnemyType[e.currentWaveIndex],e.addEnemyDuraction=e.waveData.AddEnemyDuraction[e.currentWaveIndex],e.node.emit("refer-current-wave-level",e.gameController.getCurrentLevelNum(),e.currentWaveIndex),e.currentWaveIndex===e.waveData.EnemyType.length-1?e.allWaveAddOverCb&&(e.allWaveAddOverCb(),e.allWaveAddOverCb=null,e.addOneBossEnemy()):e.addOneWaveEnemy().then((function(){e.currentWaveIndex++,e.scheduleOnce((function(){"game-over"!==e.state.getState()&&e.state.setState("enter-next-wave")}),e.addEnemyDuraction)})))}))}},{key:"playBossEnterAnim",value:function(e){var t=this;return new Promise((function(n,o){var i=e.getComponent(P);i?i.playBossEnterAnim().then((function(){n()})):t.scheduleOnce((function(){n()}),1)}))}},{key:"startGame",value:function(){var e=this;this.currentLevelDeadEnemyDataList=[],this.currentWaveIndex=0,this.waveData=this.gameConfig["Level_"+this.gameController.getCurrentLevelNum()],this.state.setState("enter-next-wave"),Promise.all([new Promise((function(t,n){e.allWaveAddOverCb=t})),new Promise((function(t,n){e.allEnemyDeadCb=t}))]).then((function(){console.log("游戏胜利"),e.gameController.gameWin(e.currentLevelDeadEnemyDataList)}))}},{key:"continueGame",value:function(){var e=this;this.currentWaveIndex--,this.waveData=this.gameConfig["Level_"+this.gameController.getCurrentLevelNum()],this.state.setState("enter-next-wave"),Promise.all([new Promise((function(t,n){e.allWaveAddOverCb=t})),new Promise((function(t,n){e.allEnemyDeadCb=t}))]).then((function(){console.log("游戏胜利"),e.gameController.gameWin(e.currentLevelDeadEnemyDataList)}))}},{key:"pushOneEnemyDeadData",value:function(e){console.log("push one enemy dead data",e),this.currentLevelDeadEnemyDataList.push(e),this.gameController.playerData.activeEnemy(e.enemyType)}},{key:"showCameraBackAnim",value:function(){var e=this;return new Promise((function(t,n){var o=new p(e.cameraNode);o.to(.5,{position:v(30,42,30),eulerAngles:v(-45,45,0)}),o.call((function(){t()})),o.start(),new p(e.cameraNode.getComponent(g)).to(.5,{orthoHeight:22}).start()}))}},{key:"addOneBossEnemy",value:function(){var e=this;console.log("增加一个boss");var t=this.node.getComponent(D).getInEdageIndexList(),n=t[Math.round(Math.random()*(t.length-1))],o=this.node.getComponent(D).getMapNodeList().getValue(n.x,n.y),i=this.currentRandomEnemyTypeList[0].type,a=f(this.bosssPrefabList[i]);return a.parent=this.node,a.position=v(o.position.x,0,o.position.z),a.active=!1,a.getComponent(P).init(this.gameConfig,this.gameController,o.position,this.endPos),this.enemyNodeList.push(a),new Promise((function(e,t){e()})).then((function(){})).then((function(){return e.playBossEnterAnim(a)})).then((function(){})).then((function(){e.node.emit("enter-continue-play-move-anim")})).then((function(){a.getComponent(P).showEnemyEnterAnim(1,e,n,new C(5,5))}))}},{key:"addOneWaveEnemy",value:function(){for(var e=[],t=0,n=this.node.getComponent(D).getInEdageIndexList(),o=this.node.getComponent(D).getMapNodeList(),i=Math.round(Math.random()*(n.length-1)),a=0,r=0,s=0,l=0;l<this.currentRandomEnemyTypeList.length;l++)s+=this.currentRandomEnemyTypeList[l].count;if(!(s>=n.length)){for(;t<s;){i>=n.length&&(i=0);var u=n[i],m=o.getValue(u.x,u.y);if(m&&m.getComponent(L)){if(m.getComponent(L).getIsVoid()){var d=this.currentRandomEnemyTypeList[a],c=d.type;r>=d.count&&(r=0,a++);var y=f(this.enemysPrefabList[c]);y.parent=this.node,y.position=v(m.position.x,0,m.position.z),y.active=!1,y.getComponent(P).init(this.gameConfig,this.gameController,m.position,this.endPos),e.push(y.getComponent(P).showEnemyEnterAnim(t,this,u,new C(5,5))),t++,this.enemyNodeList.push(y)}i=Math.round(Math.random()*(n.length-1))}else t++}return Promise.all(e)}console.error("数据错误")}},{key:"removeEnemyInList",value:function(e){for(var t=0;t<this.enemyNodeList.length;t++){this.enemyNodeList[t].uuid===e.uuid&&this.enemyNodeList.splice(t,1)}0===this.enemyNodeList.length&&this.currentWaveIndex==this.waveData.EnemyType.length-1&&this.allEnemyDeadCb&&(this.allEnemyDeadCb(),this.allEnemyDeadCb=null)}},{key:"getCurrentEnemyNodeList",value:function(){return this.enemyNodeList}},{key:"enemyAttacked",value:function(e){this.gameController.getComponent(w).enemyAttacked(e)}},{key:"frozenAllEnemy",value:function(){this.state.setState("game-over"),this.node.emit("frozen-all-enemy")}},{key:"bossShootOneEgg",value:function(e){var t=e.getComponent(P);if(t){var n=t.getEnemyBulletType(),o=f(this.enemyBulletPrefabList[n]);o.parent=this.node,o.position=e.position,o.getComponent(N).init(this.gameController.getGameConfig().json,this.gameController,this.endPos)}}},{key:"getDeadEnemyData",value:function(){return this.currentLevelDeadEnemyDataList}}]),t}(E)).prototype,"gameConfigRes",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(z.prototype,"enemysPrefabList",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=o(z.prototype,"startPosNodeList",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=o(z.prototype,"enemyHealthBarCtlNode",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=o(z.prototype,"cameraNode",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(z.prototype,"bosssPrefabList",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=o(z.prototype,"enemyBulletPrefabList",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=z))||O)),m._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyColonyCom.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/BezierN.js","./EnemyBase.js"],(function(t,e){var i,r,o,s,n,a,h,u,c,l;return{setters:[function(t){i=t.createClass,r=t.classCallCheck},function(t){o=t.cclegacy,s=t._decorator,n=t.Vec3,a=t.v3,h=t.Quat,u=t.Tween},function(t){c=t.BezierN},function(t){l=t.EnemyBase}],execute:function(){o._RF.push({},"dd328sjHD1OM4+6gaUYeHWb","EnemyColonyCom",void 0),s.ccclass,s.property,t("EnemyColonyCom",function(){function t(e,i,o){r(this,t),this.currentCheckDuraction=0,this.currentMoveDir=new n(Math.random()-.5,Math.random()-.5,Math.random()-.5),this.targetNode=null,this.currentNodeList=[],this.isFirstTargetNode=!1,this.movePathList=null,this.currentMoveTw=null,this.fenliForceWeight=10,this.juheliForceWeight=1,this.duilieliWeight=1,this.floowerfirstNodeWeight=5,this.fenliDistance=4,this.juheDistance=6,this.duilieDistance=60,this.currentPathListIndex=0,this.movePathList=new c(o).getPointList(200),this.targetNode=i,this.currentNodeList=e}return i(t,[{key:"update",value:function(t){if(!this.isFirstTargetNode){var e=this.processCheckDir().normalize();this.currentMoveDir=a(this.currentMoveDir).add(e.multiplyScalar(t)),this.targetNode.position=a(this.targetNode.position).add(a(this.currentMoveDir).multiplyScalar(t));var i=new h;h.fromViewUp(i,a(this.currentMoveDir).normalize().multiplyScalar(-1),n.UP);var r=new h;h.lerp(r,new h(this.targetNode.rotation),i,t),this.targetNode.rotation=r}}},{key:"processLisanForce",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.uuid!==this.targetNode.uuid&&i.getComponent(l).getColonyComCtl())a(i.position).subtract(this.targetNode.position).length()<this.fenliDistance&&t.push(i)}if(t.length>0){for(var r=a(0,0,0),o=0;o<t.length;o++){var s=t[o].position,n=a(this.targetNode.position).subtract(s);r.add(n)}return r.multiplyScalar(this.fenliForceWeight),r}return a(0,0,0)}},{key:"processJuHeForce",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.getComponent(l).getColonyComCtl())a(i.position).subtract(this.targetNode.position).length()>this.juheDistance&&t.push(i)}for(var r=a(0,0,0),o=0;o<t.length;o++){var s=t[o].position;r.add(s)}return t.length>0?(r=r.multiplyScalar(1/t.length),a(r).subtract(this.targetNode.position).multiplyScalar(this.juheliForceWeight)):a(0,0,0)}},{key:"processDuiLieForce",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.getComponent(l).getColonyComCtl())a(i.position).subtract(this.targetNode.position).length()<=this.duilieDistance&&t.push(i)}var r=a(0,0,0);if(t.length>0){for(var o=0;o<t.length;o++){var s=t[o].getComponent(l);r.add(s.getColonyComCtl().getCurrentMoveDir())}return r.multiplyScalar(this.duilieliWeight*(1/t.length))}return a(0,0,0)}},{key:"processCheckDir",value:function(){for(var t=[],e=0;e<this.currentNodeList.length;e++){var i=this.currentNodeList[e];if(i.getComponent(l).getColonyComCtl()&&(t.push(i),1===t.length)){if(t[0].uuid===this.targetNode.uuid)return this.isFirstTargetNode=!0,this.processMoveTween(),a(0,0,0);break}}var r=this.processByFirstNodeForce(t[0]),o=this.processLisanForce(),s=this.processDuiLieForce(),n=this.processJuHeForce();return o.add(s).add(n).add(r)}},{key:"processByFirstNodeForce",value:function(t){return a(t.position).subtract(this.targetNode.position).multiplyScalar(this.floowerfirstNodeWeight)}},{key:"processMoveTween",value:function(){var t=new u(this.targetNode);this.currentMoveTw=t,t.set({position:this.movePathList[0]});for(var e=function(t,e,i){var r=a(i).subtract(e).length(),o=a(e).subtract(i).normalize(),s=new h;h.fromViewUp(s,o,n.UP),t.to(r/5,{position:e,rotation:s})},i=1;i<this.movePathList.length-1;i++){e(t,this.movePathList[i],this.movePathList[i+1])}new u(this.targetNode).repeatForever(t).start()}},{key:"processPathListDir",value:function(){}},{key:"getCurrentMoveDir",value:function(){return this.currentMoveDir}}]),t}()),o._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyCube.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./EnemyBase.js"],(function(e,n){var t,s,c,r,u,i,o,a,l,p;return e({_dec:void 0,_class:void 0}),{setters:[function(e){t=e.inherits,s=e.classCallCheck,c=e.possibleConstructorReturn,r=e.getPrototypeOf},function(e){u=e.cclegacy,i=e._decorator},function(e){o=e.EnemyBase}],execute:function(){u._RF.push({},"ac439Ca0GFJGrdHaYw+IQip","EnemyCube",void 0),p=i.ccclass,i.property,e("EnemyCube",(a=p("EnemCube"),a(l=function(e){function n(){return s(this,n),c(this,r(n).apply(this,arguments))}return t(n,e),n}(o))||l)),u._RF.pop()}}}));

System.register("chunks:///Enemys/WinGold.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,o,s,c,r,i,l,u,a,p,d;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,o=t.createClass,s=t.classCallCheck,c=t.possibleConstructorReturn,r=t.getPrototypeOf},function(t){i=t.cclegacy,l=t._decorator,u=t.Component}],execute:function(){i._RF.push({},"cf9deP2StlNm75zKMIn6aZo","WinGold",void 0),d=l.ccclass,l.property,t("WinGold",(a=d("WinGold"),a(p=function(t){function e(){return s(this,e),c(this,r(e).apply(this,arguments))}return n(e,t),o(e,[{key:"start",value:function(){}}]),e}(u))||p)),i._RF.pop()}}}));

System.register("chunks:///SkillComponent/CrazyRotateSkill.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../Towers/TowerBase.js"],(function(e,t){var o,n,r,a,i,l,s,c,u,d,p,h,v,f,g,y,C,k,b,w,R,S;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,d=e._decorator,p=e.Node,h=e.Tween,v=e.v3},function(e){f=e.BaseObject},function(e){g=e.TowerBase}],execute:function(){u._RF.push({},"621d4adyJFG1KkUA3lbByt0","CrazyRotateSkill",void 0),R=d.ccclass,S=d.property,e("CrazyRotateSkill",(y=R("CrazyRotateSkill"),C=S({type:p}),y((w=o((b=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,c=new Array(n),u=0;u<n;u++)c[u]=arguments[u];return o=a(this,(e=i(t)).call.apply(e,[this].concat(c))),l(o,"weaponGunNode",w,s(o)),o}return n(t,e),c(t,[{key:"onLoad",value:function(){var e=this;this.node.on("init",(function(t,o){e.init(t,o)}))}},{key:"start",value:function(){var e=this,t=function(){for(var t=e.node.getComponent(g).bulletStartPosList,o=0;o<t.length;o++){var n=t[o],r=v(n.worldPosition).subtract(e.node.position),a=e.getCurrentAttackNum();e.node.getComponent(g).shootOneBullet(e.baseAttackRate+e.node.getComponent(f).baseAttackRate,r,a)}};this.node.on("release-skill",(function(o){var n=e.getCurrentShootRate()+e.node.getComponent(g).getCurrentShootRate();console.log("shoot rate",n);var r=1/n;e.schedule(t,r);var a=e.getCurrentSkillRotateAngle(),i=a/e.rotateSpeed,l=new h(e.node),s=Math.random()-.5;e.weaponGunNode&&(e.weaponGunNode.eulerAngles=v(0,0,0)),l.by(i,{eulerAngles:v(0,a*(s/Math.abs(s)),0)}),l.call((function(){e.unschedule(t),o&&o()})),l.start()}))}}]),t}(f)).prototype,"weaponGunNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=b))||k)),u._RF.pop()}}}));

System.register("chunks:///UI/AStartFindPath.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/My2Array.js"],(function(t,e){var o,n,r,i,s,a,h,u,l,c,d,p,v,y,f,g,m,L,C,P,N,M,x,V,b,k,A,T;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inherits,r=t.classCallCheck,i=t.possibleConstructorReturn,s=t.getPrototypeOf,a=t.initializerDefineProperty,h=t.assertThisInitialized,u=t.createClass},function(t){l=t.cclegacy,c=t._decorator,d=t.Node,p=t.Color,v=t.instantiate,y=t.v3,f=t.SpriteComponent,g=t.isValid,m=t.UITransformComponent,L=t.v2,C=t.Component},function(t){P=t.default}],execute:function(){l._RF.push({},"aee76uGSzxFLKJAvvNlf0aC","AStartFindPath",void 0),k=c.ccclass,A=c.property,T=function(){function t(e,o,n){r(this,t),this.x=0,this.y=0,this.node=null,this.parentNode=null,this.fValue=0,this.gValue=0,this.hValue=0,this.x=e,this.y=o,this.node=n}return u(t,[{key:"setParentNode",value:function(t){this.parentNode=t}}]),t}(),t("AStartFindPath",(N=k("AStartFindPath"),M=A({type:d}),N((b=o((V=function(t){function e(){var t,o;r(this,e);for(var n=arguments.length,u=new Array(n),l=0;l<n;l++)u[l]=arguments[l];return o=i(this,(t=s(e)).call.apply(t,[this].concat(u))),a(o,"pointNode",b,h(o)),o.my2dArray=null,o.obsColor=p.RED,o.startColor=p.BLUE,o.endColor=p.GREEN,o.currentTouchNode=null,o.openList=[],o.closeList=[],o.startObj=null,o.size=30,o.currentPathList=[],o.checkPointList=[],o}return n(e,t),u(e,[{key:"start",value:function(){var t=this,e=this.size,o=new P;this.my2dArray=o;for(var n=0;n<e;n++){for(var r=[],i=0;i<e;i++){var s=v(this.pointNode);s.active=!0,s.parent=this.node,s.position=y(-.5*(e-1)*22+22*i,-.5*(e-1)*22+22*n,0),r.push(new T(i,n,s))}o.pushList(r)}for(var a=0;a<30;a++)this.randomObs(e);var h=this.getRandomPoint(e);h.node.getComponent(f).color=this.startColor,this.startObj=h,this.node.on(d.EventType.TOUCH_START,(function(o){g(t.currentTouchNode)&&(t.currentTouchNode.node.getComponent(f).color=p.WHITE);var n=o.getUILocation();console.log("touch pos",n);for(var r=0;r<e;r++)for(var i=0;i<e;i++){var s=t.my2dArray.getValue(i,r).node;s.getComponent(m).getBoundingBoxToWorld().contains(n)&&(s.getComponent(f).color=t.endColor,t.currentTouchNode=t.my2dArray.getValue(i,r))}t.currentTouchNode&&(t.openList=[],t.closeList=[],t.processFindPath())}))}},{key:"processFValue",value:function(t,e){var o,n=null;return n=e||t.parentNode,o=t.parentNode.gValue+this.getDistance(t,n),t.gValue=o,t.hValue=this.getDistance(t,this.currentTouchNode),t.gValue+t.hValue}},{key:"getDistance",value:function(t,e){var o=Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2);return Math.sqrt(o)}},{key:"getNearPointObj",value:function(t){for(var e=t.x,o=t.y,n=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],r=[],i=0;i<n.length;i++){var s=e+n[i][0],a=o+n[i][1],h=this.my2dArray.getValue(s,a);h&&!h.node.getComponent(f).color.equals(this.obsColor)&&r.push(h)}return r}},{key:"processFindPath",value:function(){for(this.openList.push(this.startObj);this.openList.length>0;){var t=this.getFvalueMinNode();if(console.log("current obj",t),t.x===this.currentTouchNode.x&&t.y===this.currentTouchNode.y){if(console.log("找到了终点"),this.checkPointList.length>0)for(var e=0;e<this.checkPointList.length;e++){this.checkPointList[e].node.getComponent(f).color=p.WHITE}if(this.currentPathList.length>0)for(var o=0;o<this.currentPathList.length;o++){this.currentPathList[o].node.getComponent(f).color=p.WHITE}for(var n=[];t.x!==this.startObj.x||t.y!==this.startObj.y;)n.push(t.parentNode),(t=t.parentNode).node.getComponent(f).color=p.BLACK;return n.splice(n.length-1,1),void(this.currentPathList=n)}this.closeList.push(t);for(var r=this.getNearPointObj(t),i=0;i<r.length;i++){var s=r[i];if(!this.checkIsInCloseList(s))if(this.checkisInOpenList(s))this.processFValue(s,t)<s.fValue&&(s.setParentNode(t),s.fValue=this.processFValue(s));else s.setParentNode(t),s.fValue=this.processFValue(s),s.node.getComponent(f).color=p.GRAY,this.checkPointList.push(s),this.openList.push(s)}}}},{key:"checkisInOpenList",value:function(t){for(var e=0;e<this.openList.length;e++){var o=this.openList[e];if(o.x===t.x&&o.y===t.y)return!0}return!1}},{key:"checkIsInCloseList",value:function(t){for(var e=0;e<this.closeList.length;e++){var o=this.closeList[e];if(o.x===t.x&&o.y===t.y)return!0}return!1}},{key:"getFvalueMinNode",value:function(){for(var t=Number.MAX_VALUE,e=0,o=0;o<this.openList.length;o++){var n=this.openList[o];n.fValue<t&&(t=n.fValue,e=o)}return this.openList.splice(e,1)[0]}},{key:"getRandomPoint",value:function(t){var e=L(Math.round(Math.random()*(t-1)),Math.round(Math.random()*(t-1)));return this.my2dArray.getValue(e.x,e.y)}},{key:"randomObs",value:function(t){var e={x:Math.round(Math.random()*t-10)+5,y:Math.round(Math.random()*t-10)+5},o=L(0,1),n=[2*Math.PI*45/360,.5*Math.PI,Math.PI];o.rotate(n[Math.round(Math.random()*(n.length-1))]).normalize(),console.log("dir",o),o.x=Math.round(Math.abs(o.x))*Math.abs(o.x)/o.x,o.y=Math.round(Math.abs(o.y))*Math.abs(o.y)/o.y,console.log("dir",o);for(var r=0;r<4;r++){var i=L(o).multiplyScalar(r),s=L(e.x,e.y).add(i),a=this.my2dArray.getValue(s.x,s.y);a&&(a.node.getComponent(f).color=p.RED)}}}]),e}(C)).prototype,"pointNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=V))||x)),l._RF.pop()}}}));

System.register("chunks:///UI/EnemyHealthBarCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var n,r,a,o,i,l,c,u,s,p,d,y,f,m,v,h,_,C,b,B,g,H;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inherits,a=e.classCallCheck,o=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){s=e.cclegacy,p=e._decorator,d=e.Prefab,y=e.CameraComponent,f=e.Component}],execute:function(){s._RF.push({},"6dc3cXIfPpCN6tR8iLaqvBX","EnemyHealthBarCtl",void 0),g=p.ccclass,H=p.property,e("EnemyHealthBarCtl",(m=g("EnemyHealthBarCtl"),v=H({type:d}),h=H({type:y}),m((b=n((C=function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,u=new Array(r),s=0;s<r;s++)u[s]=arguments[s];return n=o(this,(e=i(t)).call.apply(e,[this].concat(u))),l(n,"enemyHealthBarPrefab",b,c(n)),l(n,"cameraNode",B,c(n)),n}return r(t,e),u(t,[{key:"onLoad",value:function(){this.node.on("add-one-enemy",(function(e){})),this.node.on("remove-one-enemy",(function(){}))}},{key:"start",value:function(){}},{key:"update",value:function(e){}}]),t}(f)).prototype,"enemyHealthBarPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(C.prototype,"cameraNode",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=C))||_)),s._RF.pop()}}}));

System.register("chunks:///UI/EnemyInfoCellPrefab.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js"],(function(e,t){var n,o,r,i,l,c,s,a,p,u,f,y,m,d,v,g,h,C,I,b,_,P,j;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,l=e.getPrototypeOf,c=e.initializerDefineProperty,s=e.assertThisInitialized,a=e.createClass,p=e.get},function(e){u=e.cclegacy,f=e._decorator,y=e.Node,m=e.loader,d=e.SpriteFrame,v=e.SpriteComponent},function(e){g=e.BaseObject}],execute:function(){u._RF.push({},"ede41pxC3ZOx6d6u8MOr8l/","EnemyInfoCellPrefab",void 0),P=f.ccclass,j=f.property,e("EnemyInfoCellPrefab",(h=P("EnemyInfoCellPrefab"),C=j({type:y}),h((_=n((b=function(e){function t(){var e,n;r(this,t);for(var o=arguments.length,a=new Array(o),p=0;p<o;p++)a[p]=arguments[p];return n=i(this,(e=l(t)).call.apply(e,[this].concat(a))),c(n,"enemyIconNode",_,s(n)),n}return o(t,e),a(t,[{key:"init",value:function(e,n){var o=this,r=n.enemyType;console.log("enemy type",r);var i=e.getGameConfig().json;p(l(t.prototype),"init",this).call(this,i,e,null,null,r),this.gameController.node.on("refer-enemy-info-cell",(function(){o.referUI()}))}},{key:"referUI",value:function(){var e=this,t=this.getEnemyIsActive();if(console.log("is active",t),t){var n=this.getIconSprteFrame();console.log("sprite frame icon str",n),m.loadRes(n+"/spriteFrame",d,(function(t,n){t||(e.enemyIconNode.getComponent(v).spriteFrame=n)}))}}}]),t}(g)).prototype,"enemyIconNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=b))||I)),u._RF.pop()}}}));

System.register("chunks:///UI/InfoLayerCtlBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js"],(function(e,t){var o,n,i,r,a,c,s,l,u,d,h,f,p,y,v,w,g,b,B,k,S,N,m,_,C,L,I,D,P,z;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,c=e.initializerDefineProperty,s=e.assertThisInitialized,l=e.createClass},function(e){u=e.cclegacy,d=e._decorator,h=e.Node,f=e.v3,p=e.view,y=e.Tween,v=e.SpriteComponent,w=e.Component},function(e){g=e.State}],execute:function(){u._RF.push({},"48a3c0EK8xEhbYTC0+7u64U","InfoLayerCtlBase",void 0),P=d.ccclass,z=d.property,e("InfoLayerCtlBase",(b=P("InfoLayerCtlBase"),B=z({type:h}),k=z({type:h}),S=z({type:h}),N=z({type:""}),b((C=o((_=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return o=r(this,(e=a(t)).call.apply(e,[this].concat(l))),c(o,"bectledLayerNode",C,s(o)),c(o,"blockBgNode",L,s(o)),c(o,"ctlShowButton",I,s(o)),c(o,"hideDir",D,s(o)),o.state=new g,o}return n(t,e),l(t,[{key:"start",value:function(){var e=this;this.bectledLayerNode.position=f(.5*this.bectledLayerNode.width*("Right"===this.hideDir?1:-1),0,0),this.state.setState("close"),this.state.addState("play-open-anim",(function(){console.log("播放武器信息ui打开的动画"),e.hideButton().then((function(){return e.showInfoLayerNode()})).then((function(){e.showBlockBgNode()})).then((function(){e.state.setState("open")}))})),this.state.addState("play-close-anim",(function(){e.hideBlockBgNode().then((function(){return e.hideInfoLayerNode()})).then((function(){return e.showCtlInfoButtonn()})).then((function(){e.state.setState("close")}))})),this.node.on("close-weapon-info-layer",(function(){"open"===e.state.getState()&&e.state.setState("play-close-anim")}))}},{key:"showCtlInfoButtonn",value:function(){var e=this;return new Promise((function(t,o){var n=p.getVisibleSize().width,i=new y(e.ctlShowButton),r="Right"===e.hideDir?1:-1;i.to(.1,{position:f(.5*n*r-100*r,0,0)}),i.call((function(){t()})),i.start()}))}},{key:"hideInfoLayerNode",value:function(){var e=this;return new Promise((function(t,o){var n=new y(e.bectledLayerNode),i="Right"===e.hideDir?1:-1;n.to(.2,{position:f(.5*e.bectledLayerNode.width*i,0,0)}),n.call((function(){t()})),n.start()}))}},{key:"hideBlockBgNode",value:function(){var e=this;return new Promise((function(t,o){t(),e.blockBgNode.active=!1}))}},{key:"showInfoLayerNode",value:function(){var e=this;return new Promise((function(t,o){var n=new y(e.bectledLayerNode);n.to(.2,{position:f(0,0,0)}),n.call((function(){t()})),n.start()}))}},{key:"showBlockBgNode",value:function(){var e=this;return new Promise((function(t,o){e.blockBgNode.active=!0;var n=new y(e.blockBgNode.getComponent(v));n.call((function(){t()})),n.start()}))}},{key:"hideButton",value:function(){var e=this,t=p.getVisibleSize().width;return new Promise((function(o,n){var i=new y(e.ctlShowButton),r="Right"===e.hideDir?1:-1;i.to(.1,{position:f(.5*t*r+100*r,0,0)}),i.call((function(){o()})),i.start()}))}},{key:"onButtonClick",value:function(e,t){switch(t){case"show-info-layer":console.log("武器信息按钮"),"close"===this.state.getState()&&this.state.setState("play-open-anim");break;case"bg-node-click":console.log("背景节点点击 ",this.state.getState()),"open"===this.state.getState()&&this.state.setState("play-close-anim")}}}]),t}(w)).prototype,"bectledLayerNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=o(_.prototype,"blockBgNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=o(_.prototype,"ctlShowButton",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=o(_.prototype,"hideDir",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Right"}}),m=_))||m)),u._RF.pop()}}}));

System.register("chunks:///UI/EnemyInfoLayerCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameController.js","./EnemyInfoCellPrefab.js","./InfoLayerCtlBase.js"],(function(e,n){var o,t,r,l,i,a,s,c,y,f,u,m,p,d,h,C,g,v,I,b,_,E,P,N,k,j,x,B,D;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inherits,r=e.classCallCheck,l=e.possibleConstructorReturn,i=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass,y=e.get},function(e){f=e.cclegacy,u=e._decorator,m=e.Node,p=e.Prefab,d=e.instantiate,h=e.v3},function(e){C=e.GameController},function(e){g=e.EnemyInfoCellPrefab},function(e){v=e.InfoLayerCtlBase}],execute:function(){f._RF.push({},"dd7e3sy4eVGxLt1hsBdjeJ6","EnemyInfoLayerCtl",void 0),B=u.ccclass,D=u.property,e("EnemyInfoLayerCtl",(I=B("EnemyInfoLayerCtl"),b=D({type:C}),_=D({type:m}),E=D({type:p}),I((k=o((N=function(e){function n(){var e,o;r(this,n);for(var t=arguments.length,c=new Array(t),y=0;y<t;y++)c[y]=arguments[y];return o=l(this,(e=i(n)).call.apply(e,[this].concat(c))),a(o,"gameController",k,s(o)),a(o,"enemyInfoNodeParentNode",j,s(o)),a(o,"enemyInfoCellPrefab",x,s(o)),o.enemyInfoCellMap={},o}return t(n,e),c(n,[{key:"start",value:function(){var e=this;y(i(n.prototype),"start",this).call(this),this.initEnemyData(),this.node.on("refer-enemy-data",this.referEnemyData.bind(this),this),this.node.on("refer-enemy-info-cell",(function(n){(console.log("`激活了某个敌人`",n),console.log("enemy info cell map",e.enemyInfoCellMap),e.enemyInfoCellMap[n])&&(console.log("刷新这个敌人的UI"),e.enemyInfoCellMap[n].getComponent(g).referUI())}))}},{key:"initEnemyData",value:function(){var e=this.gameController.getGameConfig().json,n=[];for(var o in e){var t=e[o];(o.indexOf("Enemy")>-1||o.indexOf("Boss")>-1)&&(console.log("iu",o),console.log("data",t),n.push(t))}console.log("enemy list",n),n=n.sort((function(e,n){return e.EnemyIndex-n.EnemyIndex})),console.log("enemy list",n);for(var r=0;r<n.length;r++){console.log("data = ",n[r]);var l=d(this.enemyInfoCellPrefab);l.parent=this.enemyInfoNodeParentNode;var i=n[r].EnemyType;console.log("enemy type",i),l.getComponent(g).init(this.gameController,{enemyType:i}),l.getComponent(g).referUI();var a=r%3,s=Math.floor(r/3);console.log("x",a),console.log("y = ",s),l.position=h(100*a-100,-100*s-70,0),this.enemyInfoNodeParentNode.height=-1*l.position.y+70,this.enemyInfoCellMap[i]=l}}},{key:"referEnemyData",value:function(){}},{key:"onButtonClick",value:function(e,o){y(i(n.prototype),"onButtonClick",this).call(this,e,o)}}]),n}(v)).prototype,"gameController",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(N.prototype,"enemyInfoNodeParentNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(N.prototype,"enemyInfoCellPrefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=N))||P)),f._RF.pop()}}}));

System.register("chunks:///UI/TouchScreenLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameController.js"],(function(e,t){var n,o,r,a,c,s,l,i,u,p,y,m,h,C,d,v;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){n=e.inherits,o=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,c=e.createClass},function(e){s=e.cclegacy,l=e._decorator,i=e.find,u=e.CameraComponent,p=e.Node,y=e.PhysicsSystem,m=e.Component},function(e){h=e.GameController}],execute:function(){s._RF.push({},"5c5e3+MsMZDYpvgjM8gmHSO","TouchScreenLayer",void 0),v=l.ccclass,l.property,e("TouchScreenLayer",(C=v("TouchScreenLayer"),C(d=function(e){function t(){var e,n;o(this,t);for(var c=arguments.length,s=new Array(c),l=0;l<c;l++)s[l]=arguments[l];return(n=r(this,(e=a(t)).call.apply(e,[this].concat(s)))).cameraNode=null,n.gameCtl=null,n}return n(t,e),c(t,[{key:"start",value:function(){var e=this;this.cameraNode=i("Camera").getComponent(u),this.gameCtl=i("GameController"),this.node.on(p.EventType.TOUCH_END,(function(t){var n=t.getLocation(),o=e.cameraNode.getComponent(u).screenPointToRay(n.x,n.y);y.instance.raycast(o,1,1e4,!0),y.instance.raycastResults&&i("GameController").getComponent(h).playerTouch3dObject(y.instance.raycastResults)}))}},{key:"update",value:function(e){}}]),t}(m))||d)),s._RF.pop()}}}));

System.register("chunks:///UI/WeaponUpdateCellPrefab.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js"],(function(e,t){var o,r,i,a,n,l,c,u,p,s,d,v,h,g,b,f,m,y,C,L,_,I,w,F,k,B,D,G,A,S,N,U,z,W,R,x,T,P,j,O,H,E,M,q;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,i=e.classCallCheck,a=e.possibleConstructorReturn,n=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass,p=e.get},function(e){s=e.cclegacy,d=e._decorator,v=e.Node,h=e.SpriteFrame,g=e.loader,b=e.SpriteComponent,f=e.LabelComponent},function(e){m=e.BaseObject}],execute:function(){s._RF.push({},"a6c70AbEx1NLpumxgHfrO6e","WeaponUpdateCellPrefab",void 0),M=d.ccclass,q=d.property,e("WeaponUpdateCellPrefab",(y=M("WeaponUpdateCellPrefab"),C=q({type:v}),L=q({type:v}),_=q({type:v}),I=q({type:v}),w=q({type:h}),F=q({type:h}),k=q({type:v}),B=q({type:h}),D=q({type:h}),G=q({type:v}),A=q({type:v}),y((U=o((N=function(e){function t(){var e,o;i(this,t);for(var r=arguments.length,u=new Array(r),p=0;p<r;p++)u[p]=arguments[p];return o=a(this,(e=n(t)).call.apply(e,[this].concat(u))),l(o,"currentDamageLabel",U,c(o)),l(o,"addDamageLabel",z,c(o)),l(o,"costGoldLabel",W,c(o)),l(o,"weaponIconNode",R,c(o)),l(o,"updateButtonSpriteFrameGray",x,c(o)),l(o,"updateButtonSpriteFrameGreen",T,c(o)),l(o,"updateButtonNode",P,c(o)),l(o,"activeButtonSpriteFrameGray",j,c(o)),l(o,"activeButtonSpriteFrameLight",O,c(o)),l(o,"duidiAttackIcon",H,c(o)),l(o,"duikonngAttackIcon",E,c(o)),o.currentChooseRate=0,o.weaponInfoCtl=null,o}return r(t,e),u(t,[{key:"start",value:function(){}},{key:"updateChooseRate",value:function(e){this.currentChooseRate=e,this.referUILabel()}},{key:"setData",value:function(e,o,r,i){var a=this;console.log("初始化数据",e),this.weaponInfoCtl=i,o.node.on("update-gold-label",(function(){a.referUILabel()}));var l=e.TowerType;this.objectType=l,p(n(t.prototype),"init",this).call(this,r,o),e.isActive&&this.showWeaponIcon(),this.referUILabel()}},{key:"showWeaponIcon",value:function(){var e=this,t=this.getIconSprteFrame();g.loadRes(t+"/spriteFrame",h,(function(t,o){t||(e.weaponIconNode.getComponent(b).spriteFrame=o),console.log("err",t)}))}},{key:"referUILabel",value:function(){for(var e=this.getWeaponIsActive(),t=this.gameController.playerData.getCurrentGoldCount(),o=this.getCanAttackMoveTypeList(),r=0;r<o.length;r++)"Walk"===o[r]&&(this.duidiAttackIcon.active=!0),"Fly"===o[r]&&(this.duikonngAttackIcon.active=!0);if(!e){var i=this.gameController.playerData.getFirstNeedToActiveTowerIndex();console.log("first need active tower",i);var a=this.getActiveCostGoldCount();return this.costGoldLabel.getComponent(f).string=a+"",void(i===this.towerIndexType&&a<=t?this.updateButtonNode.getComponent(b).spriteFrame=this.activeButtonSpriteFrameLight:this.updateButtonNode.getComponent(b).spriteFrame=this.activeButtonSpriteFrameGray)}var n=this.getUpdateLocalLevelCost();this.currentDamageLabel.getComponent(f).string=this.getLocalDamageNum()+"",this.costGoldLabel.getComponent(f).string=n+"",this.addDamageLabel.getComponent(f).string="+"+this.getNextLocallevelAddDamage(),this.updateButtonNode.getComponent(b).spriteFrame=t<n?this.updateButtonSpriteFrameGray:this.updateButtonSpriteFrameGreen}},{key:"onButtonClick",value:function(e,t){switch(t){case"update-button":console.log("升级按钮");var o=this.getWeaponIsActive(),r=this.gameController.playerData.getCurrentGoldCount();if(o){var i=this.getUpdateLocalLevelCost();i<=r&&(this.updateLocalLevel(this.currentChooseRate),this.gameController.playerData.addGoldCount(-i),this.referUILabel())}else{var a=this.getActiveCostGoldCount();a<=r&&(this.activeWeapon(),this.gameController.playerData.addGoldCount(-a),this.referUILabel(),this.showWeaponIcon(),this.weaponInfoCtl.node.emit("refer-current-tower-menu-ui"))}}}},{key:"getUpdateLocalLevelCost",value:function(){var e=p(n(t.prototype),"getUpdateLocalLevelCost",this).call(this);return e*=this.currentChooseRate}},{key:"getNextLocallevelAddDamage",value:function(){var e=p(n(t.prototype),"getNextLocallevelAddDamage",this).call(this);return e*=this.currentChooseRate}}]),t}(m)).prototype,"currentDamageLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(N.prototype,"addDamageLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=o(N.prototype,"costGoldLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(N.prototype,"weaponIconNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(N.prototype,"updateButtonSpriteFrameGray",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=o(N.prototype,"updateButtonSpriteFrameGreen",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=o(N.prototype,"updateButtonNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(N.prototype,"activeButtonSpriteFrameGray",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(N.prototype,"activeButtonSpriteFrameLight",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(N.prototype,"duidiAttackIcon",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=o(N.prototype,"duikonngAttackIcon",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=N))||S)),s._RF.pop()}}}));

System.register("chunks:///UI/道具/KuangBaoSkill.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(t,e){var n,c,s,i,o,u,l,r,a,p;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,c=t.classCallCheck,s=t.possibleConstructorReturn,i=t.getPrototypeOf},function(t){o=t.cclegacy,u=t._decorator},function(t){l=t.BaseObject}],execute:function(){o._RF.push({},"137d7fAtX1CO423/GncRui3","KuangBaoSkill",void 0),p=u.ccclass,u.property,t("KuangBaoSkill",(r=p("KuangBaoSkill"),r(a=function(t){function e(){return c(this,e),s(this,i(e).apply(this,arguments))}return n(e,t),e}(l))||a)),o._RF.pop()}}}));

System.register("chunks:///util/AdsController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var l,n,c;return{setters:[function(e){l=e.createClass,n=e.classCallCheck},function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"00d1d2cCXdJEoYd5l9/lwHa","AdsController",void 0),e("AdsController",function(){function e(){n(this,e)}return l(e,[{key:"watchVideoAds",value:function(){}}]),e}()),c._RF.pop()}}}));

System.register("chunks:///util/Besize.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var i,s,r,l,a;return{setters:[function(t){i=t.createClass,s=t.classCallCheck},function(t){r=t.cclegacy,l=t._decorator,a=t.v3}],execute:function(){r._RF.push({},"b99e6kbi3NK3Y1RRPBDBTEz","Besize",void 0),l.ccclass,l.property,t("Besize",function(){function t(e,i,r){s(this,t),this.startPos=void 0,this.middlePos=void 0,this.endPos=void 0,this.startPos=e,this.middlePos=i,this.endPos=r}return i(t,[{key:"CalculateCubicBezierPoint",value:function(t,e,i,s){var r=1-t,l=t*t,o=r*r,c=a(e).multiplyScalar(o);return c=a(c).add(a(i).multiplyScalar(2*r*t)),c=a(c).add(s.multiplyScalar(l))}},{key:"getBesizePointList",value:function(t){for(var e=[],i=0;i<t;i++){var s=i/t,r=this.CalculateCubicBezierPoint(s,this.startPos,this.middlePos,this.endPos);e.push(r)}return e}}]),t}()),r._RF.pop()}}}));

System.register("chunks:///UI/WeaponInfoCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameController.js","./InfoLayerCtlBase.js","./WeaponUpdateCellPrefab.js"],(function(e,t){var o,r,n,a,i,l,d,u,s,p,c,C,h,f,g,y,b,m,v,R,H,_,I,w,L,D,B,G,P,z,N,W,F,S,k,A,U,j,T,O,x,q,E,J;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,d=e.assertThisInitialized,u=e.createClass,s=e.get},function(e){p=e.cclegacy,c=e._decorator,C=e.Prefab,h=e.Node,f=e.SpriteFrame,g=e.LabelComponent,y=e.SpriteComponent,b=e.instantiate,m=e.v3},function(e){v=e.GameController},function(e){R=e.InfoLayerCtlBase},function(e){H=e.WeaponUpdateCellPrefab}],execute:function(){p._RF.push({},"4185fepR9NDl6TuAmrhxLTe","WeaponInfoCtl",void 0),E=c.ccclass,J=c.property,e("WeaponInfoCtl",(_=E("WeaponInfoCtl"),I=J({type:v}),w=J({type:C}),L=J({type:h}),D=J({type:h}),B=J({type:h}),G=J({type:f}),P=J({type:f}),z=J({type:h}),N=J({type:h}),_((S=o((F=function(e){function t(){var e,o;n(this,t);for(var r=arguments.length,u=new Array(r),s=0;s<r;s++)u[s]=arguments[s];return o=a(this,(e=i(t)).call.apply(e,[this].concat(u))),l(o,"gameController",S,d(o)),l(o,"updateWeaponInfoCellPrefab",k,d(o)),l(o,"weaponCellParentNode",A,d(o)),l(o,"currentInitRedHeartCountLabel",U,d(o)),l(o,"addRedHeartCostGoldCount",j,d(o)),l(o,"addRedHeartButtonSpriteFrameLight",T,d(o)),l(o,"addRedHeartButtonSpriteFrameGray",O,d(o)),l(o,"addRedHeartButton",x,d(o)),l(o,"chooseAddRedHeartCountLabel",q,d(o)),o.weaponIndoCellNodeList=[],o.currentChooseRate=0,o}return r(t,e),u(t,[{key:"start",value:function(){var e=this;s(i(t.prototype),"start",this).call(this),this.node.on("refer-choose-rate-cost",(function(t){console.log("刷新当前选择的倍数",t),console.log("weapon indo cell node list",e.weaponIndoCellNodeList);for(var o=0;o<e.weaponIndoCellNodeList.length;o++){e.weaponIndoCellNodeList[o].getComponent(H).updateChooseRate(t)}e.currentChooseRate=t,e.referCurrentRedHeartCountUI()})),this.initWeaponData()}},{key:"referCurrentRedHeartCountUI",value:function(){var e=this.gameController.getComponent(v),t=e.playerData.getAddOneRedHeartCostGoldCount()*this.currentChooseRate;this.addRedHeartCostGoldCount.getComponent(g).string=t+"";var o=e.playerData.getCurrentGoldCount();console.log("current gold count",o),console.log("cost",t),this.addRedHeartButton.getComponent(y).spriteFrame=o<t?this.addRedHeartButtonSpriteFrameGray:this.addRedHeartButtonSpriteFrameLight,this.currentInitRedHeartCountLabel.getComponent(g).string=e.playerData.getCurrentInitRedHeartCount()+"",this.chooseAddRedHeartCountLabel.getComponent(g).string="+"+this.currentChooseRate}},{key:"initWeaponData",value:function(){for(var e=this,t=this.gameController.getComponent(v),o=this.gameController.getComponent(v).getGameConfig().json,r=this.gameController.playerData.getCurrentTowersLocalLevelData(),n=0;n<r.length;n++){var a=r[n],i=b(this.updateWeaponInfoCellPrefab);i.parent=this.weaponCellParentNode,i.getComponent(H).setData(a,t,o,this),i.position=m(0,-n*(i.height+10)-.5*(i.height+10)-5,0),this.weaponCellParentNode.height=-1*i.position.y+.5*i.height+10,this.weaponIndoCellNodeList.push(i)}this.gameController.node.on("update-gold-label",(function(){e.referCurrentRedHeartCountUI()}))}},{key:"onButtonClick",value:function(e,o){switch(s(i(t.prototype),"onButtonClick",this).call(this,e,o),o){case"add-heart-button":var r=this.gameController.getComponent(v),n=r.playerData.getCurrentGoldCount(),a=r.playerData.getAddOneRedHeartCostGoldCount()*this.currentChooseRate;n<a?this.node.emit("gold-not-enough"):(r.playerData.addGoldCount(-a),r.playerData.addLocalInitRedHeartCount(this.currentChooseRate),this.node.emit("refer-red-heart-label")),this.referCurrentRedHeartCountUI()}}}]),t}(R)).prototype,"gameController",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=o(F.prototype,"updateWeaponInfoCellPrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=o(F.prototype,"weaponCellParentNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=o(F.prototype,"currentInitRedHeartCountLabel",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(F.prototype,"addRedHeartCostGoldCount",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=o(F.prototype,"addRedHeartButtonSpriteFrameLight",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(F.prototype,"addRedHeartButtonSpriteFrameGray",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(F.prototype,"addRedHeartButton",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(F.prototype,"chooseAddRedHeartCountLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=F))||W)),p._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../BaseObject.js","../BossController.js","../util/State.js","../ChooseWeaponInfoRateCtl.js","../Data/PlayerData.js","../Effect/WinGoldAnimEffect.js","../TowerBuildBase/TowerBuildBase.js","../util/My2Array.js","../GroundTiled/GroundTiled.js","../GroundMapCtl.js","../TowerBuildBaseCtl.js","../util/BezierN.js","../BulletBase.js","../UI/Menu/MenuUIBase.js","../util/Tool.js","../UI/GoldCtl.js","../UI/Menu/UpdateTowerUI.js","../UI/Menu/BuildTowerUITowerIcon.js","../UI/Menu/BuildTowerUI.js","../UI/GameWin/GameResultGoldCell.js","../UI/GameWin/GameWinPrefab.js","../UI/UIController.js","../UI/SkillCtl.js","../Towers/TowerBase.js","../Home/HomeIcon.js","../GameController.js","../util/FindPathWithAStart.js","../Enemys/EnemyBase.js","../Enemys/EnemyBullet.js","../EnemyController.js","../Enemys/EnemyColonyCom.js","../Enemys/EnemyCube.js","../Enemys/WinGold.js","../SkillComponent/CrazyRotateSkill.js","../UI/AStartFindPath.js","../UI/EnemyHealthBarCtl.js","../UI/EnemyInfoCellPrefab.js","../UI/InfoLayerCtlBase.js","../UI/EnemyInfoLayerCtl.js","../UI/TouchScreenLayer.js","../UI/WeaponUpdateCellPrefab.js","../UI/道具/KuangBaoSkill.js","../util/AdsController.js","../util/Besize.js","../UI/WeaponInfoCtl.js"],(function(n,t){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/Scripts/BaseObject.js', 'chunks:///BaseObject.js');
  r('project:///assets/Scripts/BossController.js', 'chunks:///BossController.js');
  r('project:///assets/Scripts/util/State.js', 'chunks:///util/State.js');
  r('project:///assets/Scripts/ChooseWeaponInfoRateCtl.js', 'chunks:///ChooseWeaponInfoRateCtl.js');
  r('project:///assets/Scripts/Data/PlayerData.js', 'chunks:///Data/PlayerData.js');
  r('project:///assets/Scripts/Effect/WinGoldAnimEffect.js', 'chunks:///Effect/WinGoldAnimEffect.js');
  r('project:///assets/Scripts/TowerBuildBase/TowerBuildBase.js', 'chunks:///TowerBuildBase/TowerBuildBase.js');
  r('project:///assets/Scripts/util/My2Array.js', 'chunks:///util/My2Array.js');
  r('project:///assets/Scripts/GroundTiled/GroundTiled.js', 'chunks:///GroundTiled/GroundTiled.js');
  r('project:///assets/Scripts/GroundMapCtl.js', 'chunks:///GroundMapCtl.js');
  r('project:///assets/Scripts/TowerBuildBaseCtl.js', 'chunks:///TowerBuildBaseCtl.js');
  r('project:///assets/Scripts/util/BezierN.js', 'chunks:///util/BezierN.js');
  r('project:///assets/Scripts/BulletBase.js', 'chunks:///BulletBase.js');
  r('project:///assets/Scripts/UI/Menu/MenuUIBase.js', 'chunks:///UI/Menu/MenuUIBase.js');
  r('project:///assets/Scripts/util/Tool.js', 'chunks:///util/Tool.js');
  r('project:///assets/Scripts/UI/GoldCtl.js', 'chunks:///UI/GoldCtl.js');
  r('project:///assets/Scripts/UI/Menu/UpdateTowerUI.js', 'chunks:///UI/Menu/UpdateTowerUI.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerUITowerIcon.js', 'chunks:///UI/Menu/BuildTowerUITowerIcon.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerUI.js', 'chunks:///UI/Menu/BuildTowerUI.js');
  r('project:///assets/Scripts/UI/GameWin/GameResultGoldCell.js', 'chunks:///UI/GameWin/GameResultGoldCell.js');
  r('project:///assets/Scripts/UI/GameWin/GameWinPrefab.js', 'chunks:///UI/GameWin/GameWinPrefab.js');
  r('project:///assets/Scripts/UI/UIController.js', 'chunks:///UI/UIController.js');
  r('project:///assets/Scripts/UI/SkillCtl.js', 'chunks:///UI/SkillCtl.js');
  r('project:///assets/Scripts/Towers/TowerBase.js', 'chunks:///Towers/TowerBase.js');
  r('project:///assets/Scripts/Home/HomeIcon.js', 'chunks:///Home/HomeIcon.js');
  r('project:///assets/Scripts/GameController.js', 'chunks:///GameController.js');
  r('project:///assets/Scripts/util/FindPathWithAStart.js', 'chunks:///util/FindPathWithAStart.js');
  r('project:///assets/Scripts/Enemys/EnemyBase.js', 'chunks:///Enemys/EnemyBase.js');
  r('project:///assets/Scripts/Enemys/EnemyBullet.js', 'chunks:///Enemys/EnemyBullet.js');
  r('project:///assets/Scripts/EnemyController.js', 'chunks:///EnemyController.js');
  r('project:///assets/Scripts/Enemys/EnemyColonyCom.js', 'chunks:///Enemys/EnemyColonyCom.js');
  r('project:///assets/Scripts/Enemys/EnemyCube.js', 'chunks:///Enemys/EnemyCube.js');
  r('project:///assets/Scripts/Enemys/WinGold.js', 'chunks:///Enemys/WinGold.js');
  r('project:///assets/Scripts/SkillComponent/CrazyRotateSkill.js', 'chunks:///SkillComponent/CrazyRotateSkill.js');
  r('project:///assets/Scripts/UI/AStartFindPath.js', 'chunks:///UI/AStartFindPath.js');
  r('project:///assets/Scripts/UI/EnemyHealthBarCtl.js', 'chunks:///UI/EnemyHealthBarCtl.js');
  r('project:///assets/Scripts/UI/EnemyInfoCellPrefab.js', 'chunks:///UI/EnemyInfoCellPrefab.js');
  r('project:///assets/Scripts/UI/InfoLayerCtlBase.js', 'chunks:///UI/InfoLayerCtlBase.js');
  r('project:///assets/Scripts/UI/EnemyInfoLayerCtl.js', 'chunks:///UI/EnemyInfoLayerCtl.js');
  r('project:///assets/Scripts/UI/TouchScreenLayer.js', 'chunks:///UI/TouchScreenLayer.js');
  r('project:///assets/Scripts/UI/WeaponUpdateCellPrefab.js', 'chunks:///UI/WeaponUpdateCellPrefab.js');
  r('project:///assets/Scripts/UI/道具/KuangBaoSkill.js', 'chunks:///UI/道具/KuangBaoSkill.js');
  r('project:///assets/Scripts/util/AdsController.js', 'chunks:///util/AdsController.js');
  r('project:///assets/Scripts/util/Besize.js', 'chunks:///util/Besize.js');
  r('project:///assets/Scripts/UI/WeaponInfoCtl.js', 'chunks:///UI/WeaponInfoCtl.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});