System.register("chunks:///BaseObject.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var r,i,o,n,c,a,s,l,p,u,d,f,b,y,v,_,h,j,m,g,O,z;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,i=e.inherits,o=e.classCallCheck,n=e.possibleConstructorReturn,c=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized},function(e){l=e.cclegacy,p=e._decorator,u=e.Node,d=e.Component}],execute:function(){l._RF.push({},"f047fSpjWxIyqfTRsf+Ksl/","BaseObject",void 0),O=p.ccclass,z=p.property,e("BaseObject",(f=O("BaseObject"),b=z({type:""}),y=z({type:u}),v=z({type:Number}),f((j=r((h=function(e){function t(){var e,r;o(this,t);for(var i=arguments.length,l=new Array(i),p=0;p<i;p++)l[p]=arguments[p];return r=n(this,(e=c(t)).call.apply(e,[this].concat(l))),a(r,"objectType",j,s(r)),a(r,"rootNode",m,s(r)),a(r,"animSpeedMulOffset",g,s(r)),r}return i(t,e),t}(d)).prototype,"objectType",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),m=r(h.prototype,"rootNode",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=r(h.prototype,"animSpeedMulOffset",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),_=h))||_)),l._RF.pop()}}}));

System.register("chunks:///util/State.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var a,s,n;return{setters:[function(t){a=t.createClass,s=t.classCallCheck},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"309b9GENMFDhItBZDPdMuEd","State",void 0),t("State",function(){function t(){s(this,t),this.state="",this.handleMap={}}return a(t,[{key:"setState",value:function(t){if(this.state=t,this.handleMap[this.state]){for(var e=this.handleMap[this.state],a=[],s=1;s<arguments.length;s++)a.push(arguments[s]);for(var n=0;n<e.length;n++){var i=e[n];i.apply(this,a)}}}},{key:"getState",value:function(){return this.state}},{key:"addState",value:function(t,e){this.handleMap[t]?this.handleMap[t].push(e):this.handleMap[t]=[e]}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///TowerBuildBase.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var r,o,i,n,a,l,c,s,u,d,p,v,f,g,m,h,y,b,w,C,T,_,B;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,o=e.inherits,i=e.classCallCheck,n=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,s=e.createClass},function(e){u=e.cclegacy,d=e._decorator,p=e.CameraComponent,v=e.Node,f=e.isValid,g=e.Component}],execute:function(){u._RF.push({},"bf2b5yrz6pN7ZEPmB5V4xlb","TowerBuildBase",void 0),_=d.ccclass,B=d.property,e("TowerBuildBase",(m=_("TowerBuildBase"),h=B({type:p}),y=B({type:v}),m((C=r((w=function(e){function t(){var e,r;i(this,t);for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];return r=n(this,(e=a(t)).call.apply(e,[this].concat(s))),l(r,"cameraNodeCom",C,c(r)),l(r,"gameController",T,c(r)),r.targetTower=null,r}return o(t,e),s(t,[{key:"start",value:function(){var e=this;this.gameController.on("touch-screen-to-3d",(function(t){t.node.uuid!==e.node.uuid||f(e.targetTower)||(console.log("点中了 此塔座"),e.gameController.emit("touch-base-build-base",e.node))}))}},{key:"unSetTargetTower",value:function(){this.targetTower=void 0}},{key:"setTargetTower",value:function(e){this.targetTower=e,this.node.active=!1}}]),t}(g)).prototype,"cameraNodeCom",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=r(w.prototype,"gameController",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=w))||b)),u._RF.pop()}}}));

System.register("chunks:///GameController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./TowerBuildBase.js"],(function(e,t){var o,i,r,n,a,s,l,c,u,p,d,f,v,y,b,g,h,m,_,C,w,B,P,S,z,L,k,N,G,T,j,J,x,A;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_class3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,p=e._decorator,d=e.Node,f=e.JsonAsset,v=e.Prefab,y=e.PhysicsSystem,b=e.instantiate,g=e.v3,h=e.Component},function(e){m=e.State},function(e){_=e.TowerBuildBase}],execute:function(){u._RF.push({},"5b4c0ApYS1B3bhehBCF/cvX","GameController",void 0),x=p.ccclass,A=p.property,e("GameController",(C=x("GameController"),w=A({type:d}),B=A({type:d}),P=A({type:f}),S=A({type:v}),C((J=j=function(e){function t(){var e,o;r(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return o=n(this,(e=a(t)).call.apply(e,[this].concat(c))),s(o,"pathNodeList",k,l(o)),s(o,"enemyHealthBarCtlNode",N,l(o)),s(o,"gameConfigJson",G,l(o)),s(o,"towersPrefabList",T,l(o)),o.state=new m,o}return i(t,e),c(t,[{key:"start",value:function(){var e=this;y.instance.enable=!0,this.state.addState("ready",(function(){console.log("enter state ",e.state.getState())})),this.state.setState("run"),this.node.on("build-one-tower",(function(t,o){if(t<e.towersPrefabList.length){var i=b(e.towersPrefabList[t]);i.parent=e.node;var r=g(o.position.x,0,o.position.z);i.setPosition(r),o.getComponent(_).setTargetTower(i)}}))}},{key:"update",value:function(e){}},{key:"getGameConfig",value:function(){return this.gameConfigJson}}]),t}(h),j.accY=-100,j.enemyBeLockMaxNum=1,k=o((L=J).prototype,"pathNodeList",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=o(L.prototype,"enemyHealthBarCtlNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=o(L.prototype,"gameConfigJson",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=o(L.prototype,"towersPrefabList",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z=L))||z)),u._RF.pop()}}}));

System.register("chunks:///BulletBase.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./BaseObject.js","./util/State.js","./GameController.js"],(function(t,e){var i,n,o,s,r,a,c,l,u,d,h,p,m,f,v,g,y,C,b,S,k,B,Y,_;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inherits,o=t.classCallCheck,s=t.possibleConstructorReturn,r=t.getPrototypeOf,a=t.initializerDefineProperty,c=t.assertThisInitialized,l=t.createClass},function(t){u=t.cclegacy,d=t._decorator,h=t.Node,p=t.v2,m=t.ColliderComponent,f=t.v3},function(t){v=t.BaseObject},function(t){g=t.State},function(t){y=t.GameController}],execute:function(){u._RF.push({},"90e683Z9ntM7pLuSDO8IdqW","BulletBase",void 0),Y=d.ccclass,_=d.property,t("BulletBase",(C=Y("BulletBase"),b=_({type:h}),C((B=i((k=function(t){function e(){var t,i;o(this,e);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(i=s(this,(t=r(e)).call.apply(t,[this].concat(l)))).state=new g,i.speedY=0,i.accY=y.accY,i.currentDirection=p(0,0),i.moveSpeed=20,i.currentInitSpeedY=6,i.currentCostAcc=-3,a(i,"bodyNode",B,c(i)),i.maxLeftTime=3+Math.random(),i.colliderComponent=null,i.baseAttackNum=0,i.gameConfigJson={},i}return n(e,t),l(e,[{key:"onLoad",value:function(){var t=this;this.state.addState("sleep",(function(){t.bodyNode.active=!1})),this.scheduleOnce((function(){t.node.destroy()}),this.maxLeftTime)}},{key:"init",value:function(t){var e=t.direction;this.currentDirection=e;var i=t.targetEnemy;this.gameConfigJson=t.gameConfigJson,this.baseAttackNum=this.gameConfigJson[this.objectType].BaseAttackNum,this.state.setState("run");var n=2*this.node.getPosition().y/this.accY*-1,o=Math.sqrt(n),s=p(this.node.position.x,this.node.position.z).subtract(p(i.position.x,i.position.z)).length();this.moveSpeed=s/o,this.colliderComponent=this.node.getComponent(m),this.colliderComponent.on("onTriggerEnter",this.onTriggerEnter.bind(this))}},{key:"onTriggerEnter",value:function(t){var e=t.otherCollider;e&&e.node.emit("be-attacked",this.baseAttackNum)}},{key:"start",value:function(){}},{key:"update",value:function(t){if("run"===this.state.getState()){this.speedY+=this.accY*t;var e=this.node.position,i=e.y+this.speedY*t,n=this.currentDirection.normalize().multiplyScalar(this.moveSpeed*t);this.node.setPosition(f(e.x+n.x,i,e.z+n.y)),this.node.getPosition().y<=0&&(this.speedY=this.currentInitSpeedY,this.currentInitSpeedY+=this.currentCostAcc,this.currentInitSpeedY<0&&this.state.setState("sleep"))}}}]),e}(v)).prototype,"bodyNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=k))||S)),u._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../util/State.js","../GameController.js"],(function(e,t){var n,o,a,s,r,i,c,l,u,h,d,f,m,v,p,C,g,y,k,B,S;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){n=e.inherits,o=e.classCallCheck,a=e.possibleConstructorReturn,s=e.getPrototypeOf,r=e.createClass},function(e){i=e.cclegacy,c=e._decorator,l=e.v3,u=e.Tween,h=e.SkeletalAnimationComponent,d=e.isValid,f=e.Vec3,m=e.Vec2,v=e.v2,p=e.ProgressBarComponent},function(e){C=e.BaseObject},function(e){g=e.State},function(e){y=e.GameController}],execute:function(){i._RF.push({},"c8d3fW25B9NIZ69bxowfjcm","EnemyBase",void 0),S=c.ccclass,c.property,e("EnemyBase",(k=S("EnemyBase"),k(B=function(e){function t(){var e,n;o(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=a(this,(e=s(t)).call.apply(e,[this].concat(i)))).pathList=[],n.state=new g,n.currentPathIndex=0,n.moveSpeed=10,n.beLockedMaxNum=y.enemyBeLockMaxNum,n.currentbeLockedCount=0,n.cameraNode=null,n.healthBar=null,n.gameConfigJson=null,n.healthCount=0,n.currentHealthCount=0,n.endPos=null,n.startPos=null,n}return n(t,e),r(t,[{key:"init",value:function(e,t,n){var o=this;this.gameConfigJson=e,this.moveSpeed=this.gameConfigJson[this.objectType].MoveSpeed,this.healthCount=this.gameConfigJson[this.objectType].HealthCount,this.beLockedMaxNum=this.gameConfigJson[this.objectType].BeLockedCount,this.currentHealthCount=this.healthCount,this.endPos=n,this.startPos=t,this.node.setPosition(t),this.node.scale=l(0,0,0);var a=new u(this.node);a.to(.2,{scale:l(1,1,1)}),a.call((function(){o.state.setState("run");var e=o.rootNode.getComponent(h);if(e&&e.defaultClip){var t=e.defaultClip.name,n=e.getState(t);n.length;n.speed=o.moveSpeed*o.animSpeedMulOffset}})),a.start()}},{key:"onLoad",value:function(){var e=this;this.node.on("set-health-bar",(function(t,n){e.healthBar=t,e.cameraNode=n})),this.state.addState("to-dead",(function(){var t=new u(e.node);t.to(.2,{scale:l(0,0,0)}),t.call((function(){e.state.setState("over"),e.node.emit("destroy-self"),e.node.destroy()})),t.start(),d(e.healthBar)&&e.healthBar.destroy()})),this.state.addState("run",(function(){var t=new u(e.node),n=new f(e.startPos).subtract(e.endPos).length()/e.moveSpeed,o=new f(e.startPos).subtract(e.endPos).normalize(),a=new m(o.x,o.z).signAngle(v(-1,0));e.node.eulerAngles=new f(0,180*a/Math.PI,0),t.to(n,{position:e.endPos}),t.call((function(){e.state.setState("to-dead")})),t.to(.2,{scale:l(0,0,0)}),t.call((function(){e.state.setState("over"),e.node.emit("destroy-self")})).delay(.2).call((function(){e.node.destroy(),e.state.setState("to-dead")})),t.to(1,{position:l(0,0,0)}),t.start(),e.node.emit("run"),e.healthBar})),this.node.on("be-attacked",(function(t){e.currentHealthCount-=t,e.currentHealthCount<=0&&(e.currentHealthCount=0,e.state.setState("to-dead")),d(e.healthBar)&&(e.healthBar.getComponent(p).progress=e.currentHealthCount/e.healthCount)}))}},{key:"start",value:function(){}},{key:"getIsDead",value:function(){return"over"===this.state.getState()||"to-dead"===this.state.getState()}},{key:"getIsCanLock",value:function(){return this.currentbeLockedCount<this.beLockedMaxNum}},{key:"setBeLocked",value:function(e){this.currentbeLockedCount++}},{key:"unSetBeLocked",value:function(e){this.currentbeLockedCount--}},{key:"update",value:function(e){if("run"===this.state.getState()&&this.healthBar&&this.cameraNode){var t=l(0,0,0);this.cameraNode.convertToUINode(this.node.getWorldPosition(),this.healthBar.parent,t),t.y+=50,this.healthBar.setPosition(t),this.healthBar.active=!0}}}]),t}(C))||B)),i._RF.pop()}}}));

System.register("chunks:///EnemyController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./Enemys/EnemyBase.js"],(function(e,t){var n,r,i,a,o,s,u,d,c,l,m,y,h,v,p,f,g,E,C,b,L,N,_,x,w,D,P,I,T,W,k,M,R;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inherits,i=e.classCallCheck,a=e.possibleConstructorReturn,o=e.getPrototypeOf,s=e.initializerDefineProperty,u=e.assertThisInitialized,d=e.createClass},function(e){c=e.cclegacy,l=e._decorator,m=e.JsonAsset,y=e.Prefab,h=e.Node,v=e.instantiate,p=e.v3,f=e.Component},function(e){g=e.State},function(e){E=e.EnemyBase}],execute:function(){c._RF.push({},"9eb73bkCLlAgoJJ0ubFFvcV","EnemyController",void 0),M=l.ccclass,R=l.property,e("EnemyController",(C=M("EnemyController"),b=R({type:m}),L=R({type:y}),N=R({type:h}),_=R({type:h}),x=R({type:h}),C((P=n((D=function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,d=new Array(r),c=0;c<r;c++)d[c]=arguments[c];return n=a(this,(e=o(t)).call.apply(e,[this].concat(d))),s(n,"gameConfigRes",P,u(n)),s(n,"enemysPrefabList",I,u(n)),n.gameConfig=null,n.currentLevelNum=0,n.currentEnemyIndex=0,n.currentWaveMaxEnemyCount=0,n.currentWaveIndex=0,n.waveData=null,n.state=new g,n.currentAddEnemyTime=0,n.addEnemyDuraction=1,n.enemyNodeList=[],n.currentRandomEnemyTypeList=[],s(n,"startPosNodeList",T,u(n)),s(n,"endPosNode",W,u(n)),s(n,"enemyHealthBarCtlNode",k,u(n)),n}return r(t,e),d(t,[{key:"start",value:function(){var e=this;this.gameConfig=this.gameConfigRes.json,this.waveData=this.gameConfig["Level_"+this.currentLevelNum],this.state.addState("enter-next-wave",(function(){e.referCurrentLevelData()})),this.node.on("player-click-game",(function(){e.state.setState("enter-next-wave")}))}},{key:"referCurrentLevelData",value:function(){var e=this;if(this.currentWaveIndex==this.waveData.EnemyType.length)return this.state.setState("add-enemt-over"),void console.log("游戏结束");this.currentRandomEnemyTypeList=this.waveData.EnemyType[this.currentWaveIndex],this.currentWaveMaxEnemyCount=this.waveData.EnemyCount[this.currentWaveIndex],this.addEnemyDuraction=this.waveData.AddEnemyDuraction[this.currentWaveIndex],this.currentWaveIndex++,this.scheduleOnce((function(){e.node.emit("refer-current-wave",e.currentWaveIndex),e.state.setState("run")}),1)}},{key:"getCurrentEnemyNodeList",value:function(){return this.enemyNodeList}},{key:"update",value:function(e){"run"===this.state.getState()&&(this.currentAddEnemyTime>this.addEnemyDuraction?(this.currentAddEnemyTime=0,this.currentEnemyIndex>=this.currentWaveMaxEnemyCount?(this.currentEnemyIndex=0,this.state.setState("enter-next-wave")):this.addOneEnemy()):this.currentAddEnemyTime+=e)}},{key:"addOneEnemy",value:function(){var e=this,t=Math.round(Math.random()*(this.currentRandomEnemyTypeList.length-1)),n=this.enemysPrefabList[t],r=v(n);r.parent=this.node.parent,this.currentEnemyIndex++;var i=Math.round(Math.random()*(this.startPosNodeList.length-1)),a=this.startPosNodeList[i].position,o=10*Math.random()-5,s=10*Math.random()-5,u=this.endPosNode.position;r.getComponent(E).init(this.gameConfig,p(a.x+o,a.y,a.z+s),u),r.on("destroy-self",(function(){for(var t=0;t<e.enemyNodeList.length;t++)e.enemyNodeList[t].uuid===r.uuid&&e.enemyNodeList.splice(t,1)})),this.enemyNodeList.push(r),this.enemyHealthBarCtlNode.emit("add-one-enemy",r)}}]),t}(f)).prototype,"gameConfigRes",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(D.prototype,"enemysPrefabList",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=n(D.prototype,"startPosNodeList",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),W=n(D.prototype,"endPosNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=n(D.prototype,"enemyHealthBarCtlNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=D))||w)),c._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyCube.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./EnemyBase.js"],(function(e,t){var n,s,c,i,r,u,o,a,l,p,y,f;return e({_dec:void 0,_class:void 0}),{setters:[function(e){n=e.inherits,s=e.createClass,c=e.classCallCheck,i=e.possibleConstructorReturn,r=e.getPrototypeOf,u=e.get},function(e){o=e.cclegacy,a=e._decorator},function(e){l=e.EnemyBase}],execute:function(){o._RF.push({},"ac439Ca0GFJGrdHaYw+IQip","EnemyCube",void 0),f=a.ccclass,a.property,e("EnemyCube",(p=f("EnemCube"),p(y=function(e){function t(){return c(this,t),i(this,r(t).apply(this,arguments))}return n(t,e),s(t,[{key:"init",value:function(e,n){u(r(t.prototype),"init",this).call(this,e,n)}}]),t}(l))||y)),o._RF.pop()}}}));

System.register("chunks:///Home/HomeIcon.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var o,n,s,c,r,u,i,l,a,p,d,f;return e({_dec:void 0,_class:void 0}),{setters:[function(e){o=e.inherits,n=e.createClass,s=e.classCallCheck,c=e.possibleConstructorReturn,r=e.getPrototypeOf},function(e){u=e.cclegacy,i=e._decorator,l=e.v3,a=e.Component}],execute:function(){u._RF.push({},"8213do7DSVI0IEO26O7s126","HomeIcon",void 0),f=i.ccclass,i.property,e("HomeIcon",(p=f("HomeIcon"),p(d=function(e){function t(){return s(this,t),c(this,r(t).apply(this,arguments))}return o(t,e),n(t,[{key:"start",value:function(){}},{key:"update",value:function(e){this.node.eulerAngles=this.node.eulerAngles.add(l(0,1,0))}}]),t}(a))||d)),u._RF.pop()}}}));

System.register("chunks:///typescript.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var c,r,s,i,n,o,p,u,l,a,y;return t({_dec:void 0,_class:void 0}),{setters:[function(t){c=t.inherits,r=t.createClass,s=t.classCallCheck,i=t.possibleConstructorReturn,n=t.getPrototypeOf},function(t){o=t.cclegacy,p=t._decorator,u=t.Component}],execute:function(){o._RF.push({},"811405Zvc9D445rfiY0G6tw","typescript",void 0),y=p.ccclass,p.property,t("Typescript",(l=y("Typescript"),l(a=function(t){function e(){return s(this,e),i(this,n(e).apply(this,arguments))}return c(e,t),r(e,[{key:"start",value:function(){}}]),e}(u))||a)),o._RF.pop()}}}));

System.register("chunks:///UI/EnemyHealthBarCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var n,r,a,i,o,c,l,s,u,p,d,f,y,h,m,v,b,_,C,B,H,P,g;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inherits,a=e.classCallCheck,i=e.possibleConstructorReturn,o=e.getPrototypeOf,c=e.initializerDefineProperty,l=e.assertThisInitialized,s=e.createClass},function(e){u=e.cclegacy,p=e._decorator,d=e.Prefab,f=e.CameraComponent,y=e.instantiate,h=e.Component}],execute:function(){u._RF.push({},"6dc3cXIfPpCN6tR8iLaqvBX","EnemyHealthBarCtl",void 0),P=p.ccclass,g=p.property,e("EnemyHealthBarCtl",(m=P("EnemyHealthBarCtl"),v=g({type:d}),b=g({type:f}),m((B=n((C=function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];return n=i(this,(e=o(t)).call.apply(e,[this].concat(s))),c(n,"enemyHealthBarPrefab",B,l(n)),c(n,"cameraNode",H,l(n)),n}return r(t,e),s(t,[{key:"onLoad",value:function(){var e=this;this.node.on("add-one-enemy",(function(t){t.on("run",(function(){var n=y(e.enemyHealthBarPrefab);n.parent=e.node,n.active=!1,t.emit("set-health-bar",n,e.cameraNode)}))})),this.node.on("remove-one-enemy",(function(){}))}},{key:"start",value:function(){}},{key:"update",value:function(e){}}]),t}(h)).prototype,"enemyHealthBarPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=n(C.prototype,"cameraNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=C))||_)),u._RF.pop()}}}));

System.register("chunks:///UI/Menu/MenuUIBase.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../util/State.js"],(function(e,t){var n,o,s,a,i,c,l,u,r,h,p,d,v,f;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){n=e.inherits,o=e.classCallCheck,s=e.possibleConstructorReturn,a=e.getPrototypeOf,i=e.createClass},function(e){c=e.cclegacy,l=e._decorator,u=e.Tween,r=e.v3,h=e.Component},function(e){p=e.State}],execute:function(){c._RF.push({},"22840YoTAVEEoGWokYeLlSX","MenuUIBase",void 0),f=l.ccclass,l.property,e("MenuUIBase",(d=f("MenuUIBase"),d(v=function(e){function t(){var e,n;o(this,t);for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return(n=s(this,(e=a(t)).call.apply(e,[this].concat(c)))).state=new p,n.targetNode=null,n}return n(t,e),i(t,[{key:"start",value:function(){console.log("menu ui base"),this.state.addState("open-ui",this.openUI.bind(this)),this.state.addState("close-ui",this.closeUI.bind(this))}},{key:"open",value:function(e){console.log("打开"),this.targetNode=e,this.state.setState("open-ui")}},{key:"closeUI",value:function(){var e=new u(this.node);e.to(.2,{scale:r(0,0,0)}),e.call((function(){})),e.start()}},{key:"openUI",value:function(){console.log("open ui"),this.node.active=!0;var e=new u(this.node);e.to(.2,{scale:r(1,1,1)}),e.call((function(){})),e.start()}}]),t}(h))||v)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./MenuUIBase.js"],(function(t,e){var o,i,n,s,r,l,u,c,a,h,d,f,p;return t({_dec:void 0,_class:void 0}),{setters:[function(t){o=t.inherits,i=t.createClass,n=t.classCallCheck,s=t.possibleConstructorReturn,r=t.getPrototypeOf,l=t.get},function(t){u=t.cclegacy,c=t._decorator,a=t.find},function(t){h=t.MenuUIBase}],execute:function(){u._RF.push({},"e6405P/+GFGaa0/qmo/iQAc","BuildTowerUI",void 0),p=c.ccclass,c.property,t("BuildTowerUI",(d=p("BuildTowerUI"),d(f=function(t){function e(){return n(this,e),s(this,r(e).apply(this,arguments))}return o(e,t),i(e,[{key:"start",value:function(){console.log("build tower ui"),l(r(e.prototype),"start",this).call(this);for(var t=this.node.children,o=0;o<t.length;o++){t[o].on("click",this.onButtonClick.bind(this))}}},{key:"onButtonClick",value:function(t,e){var o=t.node.name;if("BgNode"===o)this.state.setState("close-ui");else{var i=o.substring(o.length-1,o.length);this.state.setState("close-ui"),a("GameController").emit("build-one-tower",i,this.targetNode)}}}]),e}(h))||f)),u._RF.pop()}}}));

System.register("chunks:///UI/Menu/UpdateTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var r,n,o,s,c,u,i,a,l,p,U;return e({_dec:void 0,_class:void 0}),{setters:[function(e){r=e.inherits,n=e.createClass,o=e.classCallCheck,s=e.possibleConstructorReturn,c=e.getPrototypeOf},function(e){u=e.cclegacy,i=e._decorator,a=e.Component}],execute:function(){u._RF.push({},"18715njxPNA9Ie4NOUMTb2f","UpdateTowerUI",void 0),U=i.ccclass,i.property,e("UpdateTowerUI",(l=U("UpdateTowerUI"),l(p=function(e){function t(){return o(this,t),s(this,c(t).apply(this,arguments))}return r(t,e),n(t,[{key:"start",value:function(){}}]),t}(a))||p)),u._RF.pop()}}}));

System.register("chunks:///UI/TouchScreenLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var o,r,n,c,a,i,s,l,u,p,d,y,v,h,m,f,g,C,_,T,b,S,R;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,c=e.possibleConstructorReturn,a=e.getPrototypeOf,i=e.initializerDefineProperty,s=e.assertThisInitialized,l=e.createClass},function(e){u=e.cclegacy,p=e._decorator,d=e.Node,y=e.CameraComponent,v=e.PhysicsSystem,h=e.Component}],execute:function(){u._RF.push({},"5c5e3+MsMZDYpvgjM8gmHSO","TouchScreenLayer",void 0),S=p.ccclass,R=p.property,e("TouchScreenLayer",(m=S("TouchScreenLayer"),f=R({type:d}),g=R({type:d}),m((T=o((_=function(e){function t(){var e,o;n(this,t);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return o=c(this,(e=a(t)).call.apply(e,[this].concat(l))),i(o,"cameraNode",T,s(o)),i(o,"gameCtl",b,s(o)),o}return r(t,e),l(t,[{key:"start",value:function(){var e=this;this.node.on(d.EventType.TOUCH_START,(function(t){console.log("touch start",t.getLocation());var o=t.getLocation(),r=e.cameraNode.getComponent(y).screenPointToRay(o.x,o.y);v.instance.raycastClosest(r,1,1e4,!0),v.instance.raycastClosestResult.collider&&e.gameCtl.emit("touch-screen-to-3d",v.instance.raycastClosestResult.collider)}))}},{key:"update",value:function(e){}}]),t}(h)).prototype,"cameraNode",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=o(_.prototype,"gameCtl",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=_))||C)),u._RF.pop()}}}));

System.register("chunks:///UI/UIController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./Menu/MenuUIBase.js"],(function(e,o){var t,r,n,i,a,l,u,d,c,s,p,b,f,v,m,g,I,y,C,N,U,h,_,P,w,T,k,z,M,B,D,L,W;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,u=e.assertThisInitialized,d=e.createClass},function(e){c=e.cclegacy,s=e._decorator,p=e.Node,b=e.Prefab,f=e.isValid,v=e.instantiate,m=e.LabelComponent,g=e.CameraComponent,I=e.Component},function(e){y=e.MenuUIBase}],execute:function(){c._RF.push({},"ac456IJb4BOS7ZW+hoJsDui","UIController",void 0),L=s.ccclass,W=s.property,e("UIController",(C=L("UIController"),N=W({type:p}),U=W({type:b}),h=W({type:b}),_=W({type:p}),P=W({type:p}),C((k=t((T=function(e){function o(){var e,t;n(this,o);for(var r=arguments.length,d=new Array(r),c=0;c<r;c++)d[c]=arguments[c];return t=i(this,(e=a(o)).call.apply(e,[this].concat(d))),l(t,"gameController",k,u(t)),l(t,"buildTowerPrefab",z,u(t)),l(t,"updateMenuPrefab",M,u(t)),l(t,"cameraNode",B,u(t)),t.buildUINode=null,t.updateUINode=null,l(t,"currentWaveLabelNode",D,u(t)),t}return r(o,e),d(o,[{key:"start",value:function(){var e=this;this.gameController.on("touch-base-build-base",(function(o){f(e.buildUINode)||(e.buildUINode=v(e.buildTowerPrefab),e.buildUINode.parent=e.node),e.setUINodeTo3dPos(e.buildUINode,o),e.buildUINode.getComponent(y).open(o)})),this.gameController.on("touch-tower",(function(o){f(e.updateUINode)||(e.updateUINode=v(e.updateMenuPrefab),e.updateUINode.parent=e.node),e.setUINodeTo3dPos(e.updateUINode,o)})),this.gameController.on("refer-current-wave",(function(o){e.currentWaveLabelNode.getComponent(m).string=o}))}},{key:"setUINodeTo3dPos",value:function(e,o){var t;t=this.cameraNode.getComponent(g).convertToUINode(o.position,this.node),e.setPosition(t)}},{key:"onButtonClick",value:function(e,o){switch(o){case"start-game":console.log("event",e),e.target.destroy(),this.gameController.emit("player-click-game")}}}]),o}(I)).prototype,"gameController",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(T.prototype,"buildTowerPrefab",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(T.prototype,"updateMenuPrefab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(T.prototype,"cameraNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(T.prototype,"currentWaveLabelNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=T))||w)),c._RF.pop()}}}));

System.register("chunks:///Towers/TowerBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../util/State.js","../GameController.js","../BulletBase.js","../Enemys/EnemyBase.js","../EnemyController.js"],(function(t,e){var n,o,r,i,a,s,l,u,c,h,g,m,p,f,d,y,C,v,T,b,S,E,B,P,w,_,j,k,D,R,O,z,G;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(t){n=t.applyDecoratedDescriptor,o=t.inherits,r=t.classCallCheck,i=t.possibleConstructorReturn,a=t.getPrototypeOf,s=t.initializerDefineProperty,l=t.assertThisInitialized,u=t.createClass},function(t){c=t.cclegacy,h=t._decorator,g=t.Prefab,m=t.Node,p=t.v2,f=t.find,d=t.Vec3,y=t.SkeletalAnimationComponent,C=t.isValid,v=t.instantiate},function(t){T=t.BaseObject},function(t){b=t.State},function(t){S=t.GameController},function(t){E=t.BulletBase},function(t){B=t.EnemyBase},function(t){P=t.EnemyController}],execute:function(){c._RF.push({},"93965WLO/1GpoRxL0uoTS9a","TowerBase",void 0),z=h.ccclass,G=h.property,t("TowerBase",(w=z("TowerBase"),_=G({type:g}),j=G({type:m}),w((R=n((D=function(t){function e(){var t,n;r(this,e);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return(n=i(this,(t=a(e)).call.apply(t,[this].concat(u)))).gameController=null,n.state=new b,n.currentTargetEnemy=null,n.currentShootTime=0,n.shootDuraction=1,s(n,"bulletPrefab",R,l(n)),s(n,"bulletStartPos",O,l(n)),n.bulletMoveTime=null,n.currentShootDiraction=p(0,0),n.attackRate=null,n.gameConfig=null,n}return o(e,t),u(e,[{key:"init",value:function(){}},{key:"start",value:function(){var t=this;this.state.setState("run");this.bulletStartPos.worldPosition.y,S.accY;this.gameController=f("GameController"),this.gameConfig=this.gameController.getComponent(S).getGameConfig().json;var e=this.gameConfig[this.objectType].ShootRate;this.attackRate=e,this.shootDuraction=1/e,this.gameController.on("touch-screen-to-3d",(function(e){e.node.uuid===t.node.uuid&&t.gameController.emit("touch-tower",t.node)}))}},{key:"update",value:function(t){if("run"===this.state.getState()){if(null===this.currentTargetEnemy){for(var e=this.gameController.getComponent(P).getCurrentEnemyNodeList(),n=1e4,o=0;o<e.length;o++){var r=e[o];if(r.getComponent(B).getIsCanLock()&&!r.getComponent(B).getIsDead()){var i=new d(r.position).subtract(this.node.position).length();i<n&&(n=i,this.currentTargetEnemy=r)}}this.currentTargetEnemy&&this.currentTargetEnemy.getComponent(B).setBeLocked(this.node)}if(this.currentTargetEnemy)if(this.currentTargetEnemy.getComponent(B).getIsDead())this.currentTargetEnemy=null;else{this.currentShootDiraction=p(this.currentTargetEnemy.position.x,this.currentTargetEnemy.position.z).subtract(p(this.node.position.x,this.node.position.z));var a=this.currentShootDiraction.signAngle(p(0,-1));this.node.eulerAngles=new d(0,180*a/Math.PI,0)}this.currentTargetEnemy&&(this.currentShootTime>this.shootDuraction?(this.currentShootTime=0,this.shootOneBullet()):this.currentShootTime+=t)}}},{key:"shootOneBullet",value:function(){var t=this,e=this.rootNode.getComponent(y);if(e){var n=e.defaultClip.name,o=e.getState(n),r=1*o.length/this.attackRate;e.play(n),o.repeatCount=1,this.scheduleOnce((function(){if(C(t.currentTargetEnemy)){var e=v(t.bulletPrefab);e.parent=t.node.parent,e.active=!1,e.setPosition(t.bulletStartPos.worldPosition),e.active=!0,e.getComponent(E).init({direction:t.currentShootDiraction,targetEnemy:t.currentTargetEnemy,gameConfigJson:t.gameConfig})}}),.45*r)}}}]),e}(T)).prototype,"bulletPrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=n(D.prototype,"bulletStartPos",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=D))||k)),c._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../BaseObject.js","../util/State.js","../TowerBuildBase.js","../GameController.js","../BulletBase.js","../Enemys/EnemyBase.js","../EnemyController.js","../Enemys/EnemyCube.js","../Home/HomeIcon.js","../typescript.js","../UI/EnemyHealthBarCtl.js","../UI/Menu/MenuUIBase.js","../UI/Menu/BuildTowerUI.js","../UI/Menu/UpdateTowerUI.js","../UI/TouchScreenLayer.js","../UI/UIController.js","../Towers/TowerBase.js"],(function(n,e){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/Scripts/BaseObject.js', 'chunks:///BaseObject.js');
  r('project:///assets/Scripts/util/State.js', 'chunks:///util/State.js');
  r('project:///assets/Scripts/TowerBuildBase.js', 'chunks:///TowerBuildBase.js');
  r('project:///assets/Scripts/GameController.js', 'chunks:///GameController.js');
  r('project:///assets/Scripts/BulletBase.js', 'chunks:///BulletBase.js');
  r('project:///assets/Scripts/Enemys/EnemyBase.js', 'chunks:///Enemys/EnemyBase.js');
  r('project:///assets/Scripts/EnemyController.js', 'chunks:///EnemyController.js');
  r('project:///assets/Scripts/Enemys/EnemyCube.js', 'chunks:///Enemys/EnemyCube.js');
  r('project:///assets/Scripts/Home/HomeIcon.js', 'chunks:///Home/HomeIcon.js');
  r('project:///assets/Scripts/typescript.js', 'chunks:///typescript.js');
  r('project:///assets/Scripts/UI/EnemyHealthBarCtl.js', 'chunks:///UI/EnemyHealthBarCtl.js');
  r('project:///assets/Scripts/UI/Menu/MenuUIBase.js', 'chunks:///UI/Menu/MenuUIBase.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerUI.js', 'chunks:///UI/Menu/BuildTowerUI.js');
  r('project:///assets/Scripts/UI/Menu/UpdateTowerUI.js', 'chunks:///UI/Menu/UpdateTowerUI.js');
  r('project:///assets/Scripts/UI/TouchScreenLayer.js', 'chunks:///UI/TouchScreenLayer.js');
  r('project:///assets/Scripts/UI/UIController.js', 'chunks:///UI/UIController.js');
  r('project:///assets/Scripts/Towers/TowerBase.js', 'chunks:///Towers/TowerBase.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});