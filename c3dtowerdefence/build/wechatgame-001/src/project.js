System.register("chunks:///BossController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,o){var e,s,r,n,c,l,i,u,a,p,C;return t({_dec:void 0,_class:void 0}),{setters:[function(t){e=t.inherits,s=t.createClass,r=t.classCallCheck,n=t.possibleConstructorReturn,c=t.getPrototypeOf},function(t){l=t.cclegacy,i=t._decorator,u=t.Component}],execute:function(){l._RF.push({},"dcc66ytht5FMYgvOIQcQVvo","BossController",void 0),C=i.ccclass,i.property,t("BossController",(a=C("BossController"),a(p=function(t){function o(){return r(this,o),n(this,c(o).apply(this,arguments))}return e(o,t),s(o,[{key:"start",value:function(){}}]),o}(u))||p)),l._RF.pop()}}}));

System.register("chunks:///util/State.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var a,s,n;return{setters:[function(t){a=t.createClass,s=t.classCallCheck},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"309b9GENMFDhItBZDPdMuEd","State",void 0),t("State",function(){function t(){s(this,t),this.state="",this.handleMap={}}return a(t,[{key:"setState",value:function(t){if(this.state=t,this.handleMap[this.state]){for(var e=this.handleMap[this.state],a=[],s=1;s<arguments.length;s++)a.push(arguments[s]);for(var n=0;n<e.length;n++){var i=e[n];i.apply(this,a)}}}},{key:"getState",value:function(){return this.state}},{key:"addState",value:function(t,e){this.handleMap[t]?this.handleMap[t].push(e):this.handleMap[t]=[e]}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///ChooseWeaponInfoRateCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js"],(function(t,e){var r,o,i,n,a,s,u,c,l,p,h,d,f,v,y,m,g,C,_,S,b,B,I,R,w,P,x,L,z,F;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(t){r=t.applyDecoratedDescriptor,o=t.inherits,i=t.classCallCheck,n=t.possibleConstructorReturn,a=t.getPrototypeOf,s=t.initializerDefineProperty,u=t.assertThisInitialized,c=t.createClass},function(t){l=t.cclegacy,p=t._decorator,h=t.Node,d=t.SpriteFrame,f=t.v2,v=t.v3,y=t.Tween,m=t.Component},function(t){g=t.State}],execute:function(){l._RF.push({},"6601aZ3NHFPo42l2cZ4+0Lq","ChooseWeaponInfoRateCtl",void 0),z=p.ccclass,F=p.property,t("ChooseWeaponInfoRateCtl",(C=z("ChooseWeaponInfoRateCtl"),_=F({type:h}),S=F({type:d}),b=F({type:d}),B=F({type:h}),C((w=r((R=function(t){function e(){var t,r;i(this,e);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return r=n(this,(t=a(e)).call.apply(t,[this].concat(c))),s(r,"rateButtonList",w,u(r)),s(r,"rateButtonSpriteFrameLight",P,u(r)),s(r,"rateButtonSpriteFrameGray",x,u(r)),s(r,"rateButtonParentNode",L,u(r)),r.currentRateIndex=0,r.state=new g,r}return o(e,t),c(e,[{key:"start",value:function(){for(var t=this,e=0;e<this.rateButtonList.length;e++){var r=this.rateButtonList[e],o=f(0,1).rotate(2*Math.PI*1/3*e-2*Math.PI*270/360).normalize().multiplyScalar(80);r.position=v(o.x,o.y,0)}this.state.addState("wait",(function(){console.log("current rate index",t.currentRateIndex),t.node.emit("refer-choose-rate-cost",t.getCurrentChooseRate())})),this.state.setState("wait")}},{key:"onButtonClick",value:function(t,e){var r=this;if(e.indexOf("rate")>-1){if(console.log("旋转按钮"),"wait"!==this.state.getState())return;this.currentRateIndex++;var o=this.currentRateIndex%3*120;this.state.setState("move");for(var i=[],n=0;n<this.rateButtonList.length;n++){var a=this.rateButtonList[n],s=f(0,1).rotate(2*Math.PI*1/3*n-2*Math.PI*(270+o)/360).normalize().multiplyScalar(80);i.push(this.moveToAction(a,s))}Promise.all(i).then((function(){r.state.setState("wait")}))}}},{key:"moveToAction",value:function(t,e){return new Promise((function(r,o){var i=new y(t);i.to(.2,{position:v(e.x,e.y,0)}),i.call((function(){r()})),i.start()}))}},{key:"getCurrentChooseRate",value:function(){return[1,10,100][this.currentRateIndex%3]}}]),e}(m)).prototype,"rateButtonList",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=r(R.prototype,"rateButtonSpriteFrameLight",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=r(R.prototype,"rateButtonSpriteFrameGray",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=r(R.prototype,"rateButtonParentNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=R))||I)),l._RF.pop()}}}));

System.register("chunks:///Data/PlayerData.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var r,n,a;return{setters:[function(t){r=t.createClass,n=t.classCallCheck},function(t){a=t.cclegacy}],execute:function(){a._RF.push({},"3f2cezzOStAIpBjPLZ7+fqQ","PlayerData",void 0),t("PlayData",function(){function t(e){n(this,t),this.currentSkillCount=2,this.currentActiveSkillCount=3,this.currentGoldCount=30,this.gameController=null,this.currentLevelNum=0,this.currentTowerLevelData=[],this.currentInitRedHeartCounnt=300,this.currentRedHeardCount=0,this.gameController=e;var r=this.getLocalData("game-time");console.log("game time",r),this.setLocalData("gold-count","99999"),this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt+""),r?(this.currentSkillCount=Number(this.getLocalData("current-skill-count")),this.currentActiveSkillCount=Number(this.getLocalData("current-active-skill-count")),this.currentGoldCount=Number(this.getLocalData("gold-count")),this.currentLevelNum=Number(this.getLocalData("current-level-num")),this.currentTowerLevelData=JSON.parse(this.getLocalData("tower-level-data")),this.currentInitRedHeartCounnt=Number(this.getLocalData("current-init-red-heart-count"))):(this.setLocalData("game-time","1"),this.setLocalData("current-active-skill-count",this.currentActiveSkillCount+""),this.setLocalData("current-skill-count",this.currentSkillCount+""),this.setLocalData("gold-count",this.currentGoldCount+""),this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt+""),this.initTowerLevelLocalData(this.gameController.getGameConfig().json)),this.currentRedHeardCount=this.currentInitRedHeartCounnt}return r(t,[{key:"initTowerLevelLocalData",value:function(t){var e=[];for(var r in t)"Tower"===t[r].Type&&e.push(t[r]);e=e.sort((function(t,e){return t.index-e.index}));for(var n=[],a=0;a<e.length;a++){var o=e[a],u={IconSprteFrame:o.IconSprteFrame,isActive:!1,currentLevel:0,TowerType:o.TowerType};a<2?(u.isActive=!0,u.currentLevel=1):(u.isActive=!1,u.currentLevel=0),n.push(u)}console.log("json",n),this.currentTowerLevelData=n,this.setLocalData("tower-level-data",JSON.stringify(n))}},{key:"clearLocalData",value:function(){localStorage.clear()}},{key:"getLocalData",value:function(t){return console.log("获取游戏数据",t),localStorage.getItem(t)}},{key:"setLocalData",value:function(t,e){localStorage.setItem(t,e)}},{key:"updateGoldCount",value:function(t){this.setLocalData("gold-count",t.toString())}},{key:"getCurrentGoldCount",value:function(){return this.currentGoldCount}},{key:"initGoldCount",value:function(){this.currentGoldCount=0,this.setLocalData("gold-count",this.currentGoldCount+"")}},{key:"addGoldCount",value:function(t){this.currentGoldCount+=t,this.setLocalData("gold-count",this.currentGoldCount+""),this.gameController.node.emit("update-gold-label",this.currentGoldCount,t)}},{key:"newGame",value:function(){this.currentLevelNum=0,this.currentRedHeardCount=this.currentInitRedHeartCounnt,this.setLocalData("current-level-num",this.currentLevelNum+""),this.currentGoldCount=this.gameController.getGameConfig().json["Level_"+this.currentLevelNum].InitGoldCount,this.setLocalData("gold-count",this.currentGoldCount+"")}},{key:"enterNextLevel",value:function(){this.currentLevelNum++;var t=this.gameController.getGameConfig().json["Level_"+this.currentLevelNum].InitGoldCount;this.addGoldCount(t),this.setLocalData("current-level-num",this.currentLevelNum+"")}},{key:"activeTower",value:function(t){console.log("active tower index",t),console.log("current tower level data",this.currentTowerLevelData),this.currentTowerLevelData[t].isActive=!0,this.currentTowerLevelData[t].currentLevel=1,this.setLocalData("tower-level-data",JSON.stringify(this.currentTowerLevelData))}},{key:"getWeaponIsActive",value:function(t){return this.currentTowerLevelData[t].isActive}},{key:"getCurrentTowerLocalLevel",value:function(t){return this.currentTowerLevelData[t].currentLevel}},{key:"getCurrentTowersLocalLevelData",value:function(){return this.currentTowerLevelData}},{key:"updateTowerLocalLevel",value:function(t,e){this.currentTowerLevelData[t].currentLevel=e,this.setLocalData("tower-level-data",JSON.stringify(this.currentTowerLevelData))}},{key:"getFirstNeedToActiveTowerIndex",value:function(){for(var t=0,e=0;e<this.currentTowerLevelData.length;e++){if(!this.currentTowerLevelData[e].isActive){t=e;break}}return t}},{key:"getCurrentInitRedHeartCount",value:function(){return this.currentInitRedHeartCounnt}},{key:"getAddOneRedHeartCostGoldCount",value:function(){var t=this.getCurrentInitRedHeartCount();return(1+t)*t*.5*100}},{key:"addLocalInitRedHeartCount",value:function(t){this.currentInitRedHeartCounnt+=t,this.setLocalData("current-init-red-heart-count",this.currentInitRedHeartCounnt.toString())}},{key:"getCurrentRedHeartCount",value:function(){return this.currentRedHeardCount}},{key:"addRedHeartCount",value:function(t){this.currentRedHeardCount+=t,this.gameController.referRedHeardUI()}},{key:"getCurrentActiveTowerList",value:function(){for(var t=[],e=0;e<this.currentTowerLevelData.length;e++){this.currentTowerLevelData[e].isActive&&t.push(e)}return console.log("current active tower list",t),t}}]),t}()),a._RF.pop()}}}));

System.register("chunks:///Effect/WinGoldAnimEffect.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,o,l,i,a,r,s,c,u,d,f,p,v,h;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){n=t.inherits,o=t.classCallCheck,l=t.possibleConstructorReturn,i=t.getPrototypeOf,a=t.createClass},function(t){r=t.cclegacy,s=t._decorator,c=t.SkeletalAnimationComponent,u=t.Tween,d=t.v3,f=t.Component}],execute:function(){r._RF.push({},"2ee3e+XrHFJlYuGFP9mqdRS","WinGoldAnimEffect",void 0),h=s.ccclass,s.property,t("WinGoldAnimEffect",(p=h("WinGoldAnimEffect"),p(v=function(t){function e(){var t,n;o(this,e);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=l(this,(t=i(e)).call.apply(t,[this].concat(r)))).goldCount=0,n.skelete=null,n}return n(e,t),a(e,[{key:"start",value:function(){var t=this.node.getComponent(c);if(this.skelete=t,t){var e=t.defaultClip;t.getState(e.name).repeatCount=1,t.play(e.name)}}},{key:"setGoldCount",value:function(t,e){var n=this;this.goldCount=t;var o=new u(this.node);o.delay(3),o.to(.4,{position:d(-25,10,0)}),o.call((function(){e.playerData.addGoldCount(t),n.node.destroy()})),o.start()}}]),e}(f))||v)),r._RF.pop()}}}));

System.register("chunks:///TowerBuildBase/TowerBuildBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,o){var t,r,i,n,a,l,s,u,d,c,h,f,m,p,g,w,y,v,B,C,T,b,k;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inherits,i=e.classCallCheck,n=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,c=e._decorator,h=e.Node,f=e.find,m=e.CameraComponent,p=e.SkeletalAnimationComponent,g=e.isValid,w=e.Component}],execute:function(){d._RF.push({},"bf2b5yrz6pN7ZEPmB5V4xlb","TowerBuildBase",void 0),b=c.ccclass,k=c.property,e("TowerBuildBase",(y=b("TowerBuildBase"),v=k({type:h}),y((T=t((C=function(e){function o(){var e,t;i(this,o);for(var r=arguments.length,u=new Array(r),d=0;d<r;d++)u[d]=arguments[d];return(t=n(this,(e=a(o)).call.apply(e,[this].concat(u)))).cameraNodeCom=null,t.gameController=null,t.targetTower=null,l(t,"arrowGuide",T,s(t)),t}return r(o,e),u(o,[{key:"onLoad",value:function(){}},{key:"start",value:function(){this.gameController=f("GameController"),this.cameraNodeCom=f("Camera").getComponent(m),this.gameController.on("touch-screen-to-3d",this.touchScreenTo3d.bind(this),this),this.gameController.on("destroy-all-tower-build-base",this.destroyTowerBuildBase.bind(this),this),this.gameController.on("frozen-tower-build-base",this.forzenTowerBuildBase.bind(this),this)}},{key:"forzenTowerBuildBase",value:function(){var e=this.arrowGuide.getComponent(p),o=e.defaultClip;e.getState(o.name).pause()}},{key:"touchScreenTo3d",value:function(e){if(!g(this.targetTower))for(var o=0;o<e.length;o++){var t=e[o];t.collider.node&&t.collider.node.uuid===this.node.uuid&&(console.log("点中了此塔的基座"),this.gameController.emit("touch-base-build-base",this.node))}}},{key:"onDestroy",value:function(){this.gameController.off("destroy-all-tower-build-base",this.destroyTowerBuildBase,this),this.gameController.off("touch-screen-to-3d",this.touchScreenTo3d,this),this.gameController.off("frozen-tower-build-base",this.forzenTowerBuildBase,this)}},{key:"destroyTowerBuildBase",value:function(){this.node.destroy()}},{key:"unSetTargetTower",value:function(e){this.targetTower=void 0,this.node.active=!0}},{key:"setTargetTower",value:function(e){this.targetTower=e,this.node.active=!1}}]),o}(w)).prototype,"arrowGuide",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=C))||B)),d._RF.pop()}}}));

System.register("chunks:///util/My2Array.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,u,i,s;return{setters:[function(t){n=t.createClass,u=t.classCallCheck},function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"5a822YVyJlDnb5+nCIOK0H/","My2Array",void 0),s=function(){function t(){u(this,t),this.numberList=[],this.heightNum=0}return n(t,[{key:"pushValue",value:function(t){this.numberList[this.numberList.length-1].push(t)}},{key:"pushList",value:function(t){this.numberList.push(t)}},{key:"getValue",value:function(t,e){if(!(e<0||t<0))return e>=this.numberList.length?null:t>=this.numberList[e].length?null:this.numberList[e][t]}},{key:"setValue",value:function(t,e,n){this.numberList[t][e]=n}},{key:"getHeightLength",value:function(){return this.numberList.length}},{key:"getWidthLength",value:function(){return this.numberList.length>0?this.numberList[0].length:0}},{key:"getValueWithLieIndex",value:function(t){return this.numberList[t]}},{key:"convertOneSpaceList",value:function(){for(var t=[],e=0;e<this.getHeightLength();e++)for(var n=0;n<this.getWidthLength();n++)t.push(this.numberList[e][n]);return t}}]),t}(),i._RF.pop(),t("default",s)}}}));

System.register("chunks:///BaseObject.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var o,a,r,i,n,s,l,c,u,p,y,h,v,d,b,T,g,m,C,f,k,j,L,A,w,R,D;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,a=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,n=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,p=e._decorator,y=e.Node,h=e.CCFloat,v=e.v3,d=e.Quat,b=e.Vec3,T=e.Component}],execute:function(){u._RF.push({},"f047fSpjWxIyqfTRsf+Ksl/","BaseObject",void 0),R=p.ccclass,D=p.property,e("BaseObject",(g=R("BaseObject"),m=D({type:""}),C=D({type:y}),f=D({type:h}),g((L=o((j=function(e){function t(){var e,o;r(this,t);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return o=i(this,(e=n(t)).call.apply(e,[this].concat(c))),s(o,"objectType",L,l(o)),s(o,"rootNode",A,l(o)),s(o,"animSpeedMulOffset",w,l(o)),o.currentLevel=1,o.baseGasNum=0,o.baseAttackNum=0,o.baseAttackRate=0,o.baseRotateAngle=0,o.rotateSpeed=0,o.baseGoldCount=0,o.buildCost=0,o.shootDuraction=0,o.baseAttackRange=0,o.towerUpdateMaxLevel=0,o.currentGasNum=0,o.moveSpeed=0,o.isCollisionGround=!1,o.leftTime=0,o.gameController=null,o.towerIndexType=0,o.iconSpriteFrame=null,o.activeCostGoldCount=0,o.enemyMoveType="walk",o.canAttackMoveTypeList=[],o.enemyBulletType=0,o.isCollisionDestroy=!1,o}return a(t,e),c(t,[{key:"init",value:function(e,t,o,a){console.log("base object type",this.objectType),this.gameController=t,e[this.objectType].BaseGasNum&&(this.baseGasNum=e[this.objectType].BaseGasNum),this.currentGasNum=this.baseGasNum,e[this.objectType].MoveSpeed&&(this.moveSpeed=e[this.objectType].MoveSpeed),e[this.objectType].isCollisionGround&&(this.isCollisionGround=e[this.objectType].isCollisionGround),e[this.objectType].BaseAttackNum&&(this.baseAttackNum=e[this.objectType].BaseAttackNum),e[this.objectType].ShootRate&&(this.baseAttackRate=e[this.objectType].ShootRate,this.shootDuraction=1/this.getCurrentShootRate()),e[this.objectType].BaseRotateAngle&&(this.baseRotateAngle=e[this.objectType].BaseRotateAngle),e[this.objectType].LeftTime&&(this.leftTime=e[this.objectType].LeftTime),e[this.objectType].RotateSpeed&&(this.rotateSpeed=e[this.objectType].RotateSpeed),e[this.objectType].BaseGoldCount&&(this.baseGoldCount=e[this.objectType].BaseGoldCount),e[this.objectType].BuildCost&&(this.buildCost=e[this.objectType].BuildCost),e[this.objectType].AttackRange&&(this.baseAttackRange=e[this.objectType].AttackRange),e.TowerMaxLevel&&(this.towerUpdateMaxLevel=e.TowerMaxLevel),e[this.objectType].Index&&(this.towerIndexType=e[this.objectType].Index),e[this.objectType].IconSprteFrame&&(this.iconSpriteFrame=e[this.objectType].IconSprteFrame),e[this.objectType].ActiveCost&&(this.activeCostGoldCount=e[this.objectType].ActiveCost),e[this.objectType].MoveType&&(this.enemyMoveType=e[this.objectType].MoveType),e[this.objectType].CanAttackType&&(this.canAttackMoveTypeList=e[this.objectType].CanAttackType),e[this.objectType].EnemyBulletType&&(this.enemyBulletType=e[this.objectType].EnemyBulletType),e[this.objectType].isCollisionDestroy&&(this.isCollisionDestroy=e[this.objectType].isCollisionDestroy)}},{key:"getBaseAttackDamage",value:function(){return this.baseAttackNum}},{key:"getCurrentAttackNum",value:function(){var e=this.baseAttackNum;console.log("base damage num",e);var t=1*(this.currentLevel+1)*this.currentLevel*.5;return console.log("current level damage",t),e+t+this.getLocalDamageNum()}},{key:"getLocalDamageNum",value:function(){var e=this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType);console.log("local level",e);var t=(1+e)*e*.5;return console.log(this.objectType+":local damage",t),t}},{key:"getCurrentSkillRotateAngle",value:function(){return this.baseRotateAngle}},{key:"getCurrentShootRate",value:function(){var e=this.baseAttackRate;return console.log("current shoot rate",e),e*=1+this.currentLevel*this.currentLevel*.01,console.log("current shoor rate",e),e>10&&(e=10),e}},{key:"getCurrentGoldCount",value:function(){return this.baseGoldCount}},{key:"getCurrentLevel",value:function(){return this.currentLevel}},{key:"getUpdateCost",value:function(){var e=this.currentLevel+1;return this.buildCost+(1+e)*e*.5}},{key:"getUpdateLocalLevelCost",value:function(){var e=this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType);return console.log("local level",e),Math.round(.5*Math.pow(e+1,2))}},{key:"getNextLocallevelAddDamage",value:function(){return this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType)+1}},{key:"getDestroyCount",value:function(){var e=this.buildCost,t=this.currentLevel;return Math.round(.8*(e+(1+t)*t*.5))}},{key:"updateLevel",value:function(){this.currentLevel++;var e=this.getCurrentShootRate();this.shootDuraction=1/e,console.log("升级之后 的 攻击事件间隔",this.shootDuraction)}},{key:"getCurrentAttackRange",value:function(){var e=this.currentLevel;return this.baseAttackRange*(1+e*(e-.5)*.01)}},{key:"getTowerIsMax",value:function(){return console.log("current level",this.currentLevel),console.log("tower update max level",this.towerUpdateMaxLevel),this.currentLevel>=this.towerUpdateMaxLevel}},{key:"getIconSprteFrame",value:function(){return this.iconSpriteFrame}},{key:"getWeaponIsActive",value:function(){return this.gameController.playerData.getWeaponIsActive(this.towerIndexType)}},{key:"updateLocalLevel",value:function(e){var t=this.gameController.playerData.getCurrentTowerLocalLevel(this.towerIndexType);t+=e,console.log("升级的jishu",e),this.gameController.playerData.updateTowerLocalLevel(this.towerIndexType,t)}},{key:"getActiveCostGoldCount",value:function(){return this.activeCostGoldCount}},{key:"activeWeapon",value:function(){this.gameController.playerData.activeTower(this.towerIndexType)}},{key:"getMoveType",value:function(){return this.enemyMoveType}},{key:"getCanAttackEnemy",value:function(e){var o=e.getComponent(t);if(o)for(var a=o.getMoveType(),r=this.canAttackMoveTypeList,i=0;i<r.length;i++){if(r[i]===a)return!0}return!1}},{key:"getIsBoss",value:function(){return this.objectType.indexOf("Boss")>-1}},{key:"getEnemyBulletType",value:function(){return this.enemyBulletType}},{key:"getIsCollisionDestroy",value:function(){return this.isCollisionDestroy}},{key:"getLookAtAngle",value:function(e,t){var o=v(e).subtract(t).normalize(),a=new d;return d.fromViewUp(a,o,b.UP),a}}]),t}(T)).prototype,"objectType",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"default"}}),A=o(j.prototype,"rootNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=o(j.prototype,"animSpeedMulOffset",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),k=j))||k)),u._RF.pop()}}}));

System.register("chunks:///GroundTiled/GroundTiled.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js"],(function(t,e){var r,n,s,i,c,a,u,o,l,p,h,d;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){r=t.inherits,n=t.classCallCheck,s=t.possibleConstructorReturn,i=t.getPrototypeOf,c=t.createClass},function(t){a=t.cclegacy,u=t._decorator,o=t.v2},function(t){l=t.BaseObject}],execute:function(){a._RF.push({},"75b72ybo0hO5rMJsDKDP6W5","GroundTiled",void 0),d=u.ccclass,u.property,t("GroundTiled",(p=d("GroundTiled"),p(h=function(t){function e(){var t,r;n(this,e);for(var c=arguments.length,a=new Array(c),u=0;u<c;u++)a[u]=arguments[u];return(r=s(this,(t=i(e)).call.apply(t,[this].concat(a)))).mapX=0,r.mapY=0,r.targetObjectList=[],r}return r(e,t),c(e,[{key:"getIsVoid",value:function(){return 0===this.targetObjectList.length}},{key:"setMapXY",value:function(t,e){this.mapX=t,this.mapY=e}},{key:"getMapXY",value:function(){return o(this.mapX,this.mapY)}},{key:"getTargetObjectList",value:function(){return this.targetObjectList}},{key:"setTargetObject",value:function(t){this.targetObjectList.push(t)}}]),e}(l))||h)),a._RF.pop()}}}));

System.register("chunks:///GroundMapCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/My2Array.js","./GroundTiled/GroundTiled.js"],(function(e,t){var i,r,n,o,a,s,u,d,l,p,h,c,f,v,m,g,y,b,w,M,T,_,z,C,L,P,x,k,H,E,N,W,G,A,I;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,o=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,u=e.assertThisInitialized,d=e.createClass},function(e){l=e.cclegacy,p=e._decorator,h=e.Prefab,c=e.CCInteger,f=e.CCFloat,v=e.instantiate,m=e.v3,g=e.v2,y=e.Tween,b=e.Component},function(e){w=e.default},function(e){M=e.GroundTiled}],execute:function(){l._RF.push({},"44e5akPt5hEHpdS1j2qoO/6","GroundMapCtl",void 0),A=p.ccclass,I=p.property,e("GroundMapCtl",(T=A("GroundMapCtl"),_=I({type:h}),z=I({type:c}),C=I({type:c}),L=I({type:f}),P=I({type:h}),T((H=i((k=function(e){function t(){var e,i;n(this,t);for(var r=arguments.length,d=new Array(r),l=0;l<r;l++)d[l]=arguments[l];return i=o(this,(e=a(t)).call.apply(e,[this].concat(d))),s(i,"groundMapTiledPrefab",H,u(i)),s(i,"mapWidth",E,u(i)),s(i,"mapHeight",N,u(i)),s(i,"tiledSize",W,u(i)),i.mapNodeList=new w,i.obsNodeList=[],s(i,"treePrefab",G,u(i)),i.groundTiledEdageIndexList=[],i}return r(t,e),d(t,[{key:"start",value:function(){for(var e=0;e<this.mapHeight;e++){for(var t=[],i=0;i<this.mapWidth;i++){var r=v(this.groundMapTiledPrefab);r.parent=this.node;var n=m(-.5*(this.mapWidth-1)*this.tiledSize+i*this.tiledSize,-6,-.5*(this.mapHeight-1)*this.tiledSize+e*this.tiledSize);r.setPosition(n),r.active=!1,t.push(r)}this.mapNodeList.pushList(t)}for(var o=[],a=0;a<this.mapWidth;a++)o.push(g(a,0));for(var s=1;s<this.mapHeight;s++)o.push(g(this.mapWidth-1,s));for(var u=this.mapWidth-2;u>=0;u--)o.push(g(u,this.mapHeight-1));for(var d=this.mapHeight-2;d>0;d--)o.push(g(0,d));this.groundTiledEdageIndexList=o}},{key:"getInEdageIndexList",value:function(){return this.groundTiledEdageIndexList}},{key:"showTreeEnterAnim",value:function(e){return console.log("show tree enter anima"),new Promise((function(t,i){e.active=!0,e.scale=m(1,0,1);var r=new y(e);r.to(.2,{scale:m(1,1,1)},{easing:"elasticOut"}),r.call((function(){t()})),r.start()}))}},{key:"showGroundEnterAnim",value:function(){var e=this;return this.showGroundTiledEnterAnim().then((function(){for(var t=0;t<2;){var i=[0,e.mapHeight-1][Math.round(1*Math.random())],r=Math.round(Math.random()*(e.mapWidth-1)),n=e.mapNodeList.getValue(r,i);if(n){e.obsNodeList.push(g(r,i));var o=n;if(o&&o.getComponent(M)){var a=o.getComponent(M);if(a.getIsVoid()){var s=v(e.treePrefab);s.parent=e.node,a.setTargetObject(s),s.active=!1,s.position=m(o.position.x,0,o.position.z),e.showTreeEnterAnim(s),t++}}}}}))}},{key:"setTowerBuildBaseOnTiled",value:function(e,t,i){var r=this.mapNodeList.getValue(t,i);if(r){this.obsNodeList.push(g(t,i));var n=r;n&&n.getComponent(M)&&n.getComponent(M).setTargetObject(e)}}},{key:"showGroundTiledEnterAnim",value:function(){for(var e=g(Math.floor(this.mapWidth/2),Math.floor(this.mapHeight/2)+1),t=0,i=g(0,-1),r=1,n=0,o=0,a=[];e.x<=this.mapWidth+1&&e.y<=this.mapHeight+1&&e.x>=0&&e.y>=0;){for(var s=0;s<r;){s++;var u=this.mapNodeList.getValue(e.x,e.y);if(u){var d=u;d&&(a.push(this.showEnterAnim(d,o)),o++)}e.add(i)}var l=2*Math.PI/4*t;(i=g(0,1).rotate(l).normalize()).x=i.x<0&&Math.abs(i.x)<1?0:Math.floor(i.x),i.y=i.y<0&&Math.abs(i.y)<1?0:Math.floor(i.y),2==n&&(n=0,r++),n++,t++}return Promise.all(a)}},{key:"showEnterAnim",value:function(e,t){return new Promise((function(i,r){var n=new y(e),o=e.position;n.delay(.03*t),n.call((function(){e.active=!0})),n.to(.4,{position:m(o.x,0,o.z)},{easing:"elasticOut"}),n.call((function(){i()})),n.start()}))}},{key:"getMapNodeList",value:function(){return this.mapNodeList}},{key:"getObsPosList",value:function(){return this.obsNodeList}},{key:"getMapSize",value:function(){return g(this.mapWidth,this.mapHeight)}}]),t}(b)).prototype,"groundMapTiledPrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=i(k.prototype,"mapWidth",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),N=i(k.prototype,"mapHeight",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),W=i(k.prototype,"tiledSize",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),G=i(k.prototype,"treePrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=k))||x)),l._RF.pop()}}}));

System.register("chunks:///TowerBuildBaseCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./GroundMapCtl.js","./GameController.js"],(function(e,t){var o,n,i,r,l,s,a,u,c,d,p,f,h,g,v,C,B,m,w,y,T,b,_,P,z;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,d=e._decorator,p=e.Prefab,f=e.v2,h=e.instantiate,g=e.v3,v=e.Tween,C=e.Component},function(e){B=e.GroundMapCtl},function(e){m=e.GameController}],execute:function(){c._RF.push({},"09d8fCuijNMwIzg+sejpSkn","TowerBuildBaseCtl",void 0),P=d.ccclass,z=d.property,e("TowerBuildBaseCtl",(w=P("TowerBuildBaseCtl"),y=z({type:p}),w((_=o((b=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,u=new Array(n),c=0;c<n;c++)u[c]=arguments[c];return o=r(this,(e=l(t)).call.apply(e,[this].concat(u))),s(o,"towerBuildBasePrefab",_,a(o)),o.groundTiledNodeList=null,o.gameController=null,o}return n(t,e),u(t,[{key:"showTowerBuildBaseEnterAnim",value:function(){this.gameController=this.node.getComponent(m);var e=this.gameController.getGameConfig().json["Level_"+this.gameController.getCurrentLevelNum()].TowerBuildPos;this.groundTiledNodeList=this.node.getComponent(B).getMapNodeList();for(var t=[],o=0;o<e.length;o++){var n=e[o],i=f(n[0],n[1]),r=this.groundTiledNodeList.getValue(i.x,i.y),l=h(this.towerBuildBasePrefab);l.parent=this.node,l.position=g(r.position.x,20,r.position.z),this.node.getComponent(B).setTowerBuildBaseOnTiled(l,i.x,i.y),t.push(this.showEnterAnim(l,o))}return Promise.all(t)}},{key:"showEnterAnim",value:function(e,t){return e.active=!1,new Promise((function(o,n){var i=new v(e),r=e.position;i.delay(.2*t),i.call((function(){e.active=!0})),i.to(.5,{position:g(r.x,0,r.z)},{easing:"bounceOut"}),i.call((function(){o()})),i.start()}))}},{key:"frozenAllTowerBuildBase",value:function(){this.node.emit("frozen-tower-build-base")}}]),t}(C)).prototype,"towerBuildBasePrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=b))||T)),c._RF.pop()}}}));

System.register("chunks:///BulletBase.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./BaseObject.js","./GameController.js","./Enemys/EnemyBase.js"],(function(e,t){var n,s,o,i,a,r,c,l,u,h,d,p,m,g,y,f,C,v,B,b;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){n=e.inherits,s=e.classCallCheck,o=e.possibleConstructorReturn,i=e.getPrototypeOf,a=e.createClass,r=e.get},function(e){c=e.cclegacy,l=e._decorator,u=e.v3,h=e.Quat,d=e.Vec3,p=e.ColliderComponent,m=e.isValid},function(e){g=e.State},function(e){y=e.BaseObject},function(e){f=e.GameController},function(e){C=e.EnemyBase}],execute:function(){c._RF.push({},"90e683Z9ntM7pLuSDO8IdqW","BulletBase",void 0),b=l.ccclass,l.property,e("BulletBase",(v=b("BulletBase"),v(B=function(e){function t(){var e,n;s(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=o(this,(e=i(t)).call.apply(e,[this].concat(r)))).state=new g,n.speedY=0,n.accY=f.accY,n.currentDirection=u(0,0),n.currentInitSpeedY=6,n.currentCostAcc=-3,n.maxLeftTime=1+Math.random(),n.colliderComponent=null,n.gameConfigJson={},n.targetTowerBase=null,n}return n(t,e),a(t,[{key:"onLoad",value:function(){this.state.addState("sleep",(function(){}))}},{key:"init",value:function(e,n,s){var o=this;r(i(t.prototype),"init",this).call(this,e,n),this.baseAttackNum+=s.baseAttackNum,this.targetTowerBase=s.targetTower;var a=s.direction;this.currentDirection=a;var c=new h;h.fromViewUp(c,a,d.UP),this.node.worldRotation=c,this.gameConfigJson=e,this.state.setState("run");this.node.getPosition().y,this.accY;this.colliderComponent=this.node.getComponent(p),this.colliderComponent.on("onTriggerEnter",this.onTriggerEnter.bind(this)),this.scheduleOnce((function(){o.node.destroy()}),this.leftTime)}},{key:"onTriggerEnter",value:function(e){var t=this,n=e.otherCollider;m(n)&&m(n.node)&&n.node.name.indexOf("Wall")>1&&(console.log(" other collier node",n.node.name),this.node.destroy()),n&&n.getComponent(C)&&!n.getComponent(C).getIsDead()&&(console.log("base attack num",this.baseAttackNum),this.getIsCollisionDestroy()&&this.node.destroy(),n.node.emit("be-attacked",{baseAttackNum:this.baseAttackNum,baseGasNum:this.baseGasNum,cb:function(e){console.log("是否死了",e),t.targetTowerBase&&t.targetTowerBase.enemyDeadByThis(e)}}))}},{key:"start",value:function(){}},{key:"update",value:function(e){if("run"===this.state.getState()){this.speedY+=this.accY*e;var t=this.node.position,n=(t.y,this.speedY,this.currentDirection.normalize().multiplyScalar(this.moveSpeed*e));n.y<0&&(n.y=0),this.node.setPosition(u(t.x+n.x,t.y+n.y,t.z+n.z)),this.node.getPosition().y<=0&&this.isCollisionGround&&(this.speedY=this.currentInitSpeedY,this.currentInitSpeedY+=this.currentCostAcc,this.currentInitSpeedY<0&&this.state.setState("sleep"))}}}]),t}(y))||B)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/MenuUIBase.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../util/State.js","../../BaseObject.js","../../Towers/TowerBase.js"],(function(t,e){var o,n,s,a,i,c,u,l,r,h,d,g,p,f,v,y,k;return t({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(t){o=t.inherits,n=t.classCallCheck,s=t.possibleConstructorReturn,a=t.getPrototypeOf,i=t.createClass,c=t.get},function(t){u=t.cclegacy,l=t._decorator,r=t.isValid,h=t.Tween,d=t.v3},function(t){g=t.State},function(t){p=t.BaseObject},function(t){f=t.TowerBase}],execute:function(){u._RF.push({},"22840YoTAVEEoGWokYeLlSX","MenuUIBase",void 0),k=l.ccclass,l.property,t("MenuUIBase",(v=k("MenuUIBase"),v(y=function(t){function e(){var t,o;n(this,e);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return(o=s(this,(t=a(e)).call.apply(t,[this].concat(c)))).state=new g,o.targetNode=null,o}return o(e,t),i(e,[{key:"init",value:function(t,o){c(a(e.prototype),"init",this).call(this,t,o),this.state.addState("open-ui",this.openUI.bind(this)),this.state.addState("close-ui",this.closeUI.bind(this))}},{key:"open",value:function(t){console.log("打开"),r(this.targetNode)&&this.targetNode.getComponent(f)&&this.targetNode.uuid!==t.uuid&&this.targetNode.getComponent(f).closeAttackRange(),t.getComponent(f)&&t.getComponent(f).showAttackRange(),this.targetNode=t,this.state.setState("open-ui")}},{key:"close",value:function(){this.state.setState("close-ui")}},{key:"closeUI",value:function(){r(this.targetNode)&&this.targetNode.getComponent(f)&&this.targetNode.getComponent(f).closeAttackRange();var t=new h(this.node);t.to(.2,{scale:d(0,0,0)}),t.call((function(){})),t.start()}},{key:"openUI",value:function(){console.log("open ui"),this.node.active=!0;var t=new h(this.node);t.to(.2,{scale:d(1,1,1)}),t.call((function(){})),t.start()}}]),e}(p))||y)),u._RF.pop()}}}));

System.register("chunks:///util/Tool.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,o){var n,t,l;return{setters:[function(e){n=e.createClass,t=e.classCallCheck},function(e){l=e.cclegacy}],execute:function(){l._RF.push({},"a5b9421aLlB+qBZsaa/3PZA","Tool",void 0),e("Tool",function(){function e(){t(this,e)}return n(e,null,[{key:"convertNumToK",value:function(e){for(var o=(e=Math.abs(e))+"",n=e,t=0;n>0;)n=Math.floor(n/1e3),t++;return o=e/Math.pow(1e3,t-1)+"",console.log("end Str",o),o.length>4&&(o=o.substring(0,4)),t>=1&&(o+=["","K","M","B"][t-1]),console.log("end Str",o),o}}]),e}()),l._RF.pop()}}}));

System.register("chunks:///UI/GoldCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/Tool.js","../GameController.js"],(function(e,t){var r,o,n,i,l,a,d,u,c,s,p,f,b,v,g,y,C,h,m,L,_,G,w,N,z,H,E,P,k,T,B,D,I,R,j,S,A,F,K,x;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,o=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,d=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,s=e._decorator,p=e.Node,f=e.find,b=e.Tween,v=e.v3,g=e.LabelComponent,y=e.ProgressBarComponent,C=e.instantiate,h=e.view,m=e.Component},function(e){L=e.Tool},function(e){_=e.GameController}],execute:function(){c._RF.push({},"76e03n/eNtMAopLI1ZIiGNs","GoldCtl",void 0),K=s.ccclass,x=s.property,e("GoldCtl",(G=K("GoldCtl"),w=x({type:p}),N=x({type:p}),z=x({type:p}),H=x({type:p}),E=x({type:p}),P=x({type:p}),k=x({type:p}),G((D=r((B=function(e){function t(){var e,r;n(this,t);for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return r=i(this,(e=l(t)).call.apply(e,[this].concat(u))),a(r,"goldsNode",D,d(r)),a(r,"currentLevelLabel",I,d(r)),a(r,"currentScoreLabel",R,d(r)),a(r,"currentGoldLabel",j,d(r)),a(r,"addGoldEffectLabel",S,d(r)),a(r,"redHeartProgressBar",A,d(r)),a(r,"redHeartCountLabel",F,d(r)),r.addGoldEffectNodeCount=0,r}return o(t,e),u(t,[{key:"start",value:function(){var e=this,t=f("GameController");t.on("refer-current-wave-level",(function(t,r){e.updateLevelLabel(t,r)})),t.on("update-gold-label",(function(t,r){e.updateGoldCountLabel(t,r)})),this.node.on("gold-not-enough",(function(){var t=new b(e.currentGoldLabel);t.to(.1,{scale:v(1.5,1.5,1.5)}),t.to(.1,{scale:v(1,1,1)}),t.start()})),this.node.on("refer-red-heart-label",(function(){var r=t.getComponent(_),o=r.playerData.getCurrentRedHeartCount(),n=r.playerData.getCurrentInitRedHeartCount();e.redHeartCountLabel.getComponent(g).string=n+"/"+o;var i=o/n;e.redHeartProgressBar.getComponent(y).progress=i}))}},{key:"updateLevelLabel",value:function(e,t){this.currentLevelLabel.getComponent(g).string=e+1+"-"+(t+1)}},{key:"updateGoldCountLabel",value:function(e,t){var r=this,o=L.convertNumToK(e);if(this.currentGoldLabel.getComponent(g).string=o,t){if(this.addGoldEffectNodeCount>20)return;this.addGoldEffectNodeCount++;var n=C(this.addGoldEffectLabel);n.parent=this.goldsNode;var i="-";t>0&&(i="+");var l=L.convertNumToK(t);n.getComponent(g).string=i+l+"";var a=new b(n);a.by(.2,{position:v(0,20,0)}),a.delay(.5),a.by(.2,{position:v(0,20,0),opacity:-.5}),a.call((function(){n.destroy(),r.addGoldEffectNodeCount--})),a.start()}}},{key:"showEnterAnim",value:function(){var e=this,t=h.getVisibleSize().height;return console.log("播放金币ui的进场动画"),this.node.emit("refer-red-heart-label"),new Promise((function(r,o){var n=new b(e.goldsNode);n.to(.2,{position:v(0,.5*t-65,0)}),n.call((function(){r()})),n.start()}))}}]),t}(m)).prototype,"goldsNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=r(B.prototype,"currentLevelLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=r(B.prototype,"currentScoreLabel",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=r(B.prototype,"currentGoldLabel",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=r(B.prototype,"addGoldEffectLabel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=r(B.prototype,"redHeartProgressBar",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=r(B.prototype,"redHeartCountLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=B))||T)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/UpdateTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js","./MenuUIBase.js","../../util/Tool.js","../../Towers/TowerBase.js","../../GameController.js"],(function(e,t){var o,n,r,i,a,s,l,u,p,c,d,g,C,m,h,y,v,f,b,_,w,B,T,U,k,I,N,L,S,F,M,j,x,z,D,G;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass,p=e.get},function(e){c=e.cclegacy,d=e._decorator,g=e.Node,C=e.SpriteFrame,m=e.find,h=e.SpriteComponent,y=e.LabelComponent},function(e){v=e.BaseObject},function(e){f=e.MenuUIBase},function(e){b=e.Tool},function(e){_=e.TowerBase},function(e){w=e.GameController}],execute:function(){c._RF.push({},"18715njxPNA9Ie4NOUMTb2f","UpdateTowerUI",void 0),D=d.ccclass,G=d.property,e("UpdateTowerUI",(B=D("UpdateTowerUI"),T=G({type:g}),U=G({type:g}),k=G({type:C}),I=G({type:C}),N=G({type:g}),B((F=o((S=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,u=new Array(n),p=0;p<n;p++)u[p]=arguments[p];return o=i(this,(e=a(t)).call.apply(e,[this].concat(u))),s(o,"updateCostLabel",F,l(o)),s(o,"destroyWinLabel",M,l(o)),o.gameController=null,o.updateCostCount=null,o.destroyWinCount=null,s(o,"updateMaxLevelSpriteFrame",j,l(o)),s(o,"updateButtonSpriteFrame",x,l(o)),s(o,"updateButtonNode",z,l(o)),o}return n(t,e),u(t,[{key:"onLoad",value:function(){this.gameController=m("GameController").getComponent(w)}},{key:"start",value:function(){}},{key:"init",value:function(e,o){p(a(t.prototype),"init",this).call(this,e,o)}},{key:"onButtonClick",value:function(e,t){console.log("custom data",t);var o=this.gameController.playerData.getCurrentGoldCount();switch(t){case"bg":console.log("点中了背景"),this.state.setState("close-ui");break;case"update":if(this.targetNode.getComponent(v).getTowerIsMax())return;o>=this.updateCostCount?(this.gameController.playerData.addGoldCount(-1*this.updateCostCount),this.state.setState("close-ui"),this.targetNode.getComponent(_).updateLevel()):m("Canvas").emit("gold-not-enough");break;case"destroy":this.state.setState("close-ui"),this.targetNode.getComponent(_).toDestroy()}}},{key:"checkIsUpdateMax",value:function(){var e=this.targetNode.getComponent(v).getTowerIsMax();console.log("is max",e),e?(console.log("更新按钮 贴图"),this.updateButtonNode.getComponent(h).spriteFrame=this.updateMaxLevelSpriteFrame):this.updateButtonNode.getComponent(h).spriteFrame=this.updateButtonSpriteFrame}},{key:"open",value:function(e){p(a(t.prototype),"open",this).call(this,e),this.checkIsUpdateMax();var o=e.getComponent(_),n=o.getUpdateCost(),r=o.getDestroyCount();this.updateCostLabel.getComponent(y).string=b.convertNumToK(n)+"",this.destroyWinLabel.getComponent(y).string=b.convertNumToK(r)+"",this.updateCostCount=n,this.destroyWinCount=r}}]),t}(f)).prototype,"updateCostLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(S.prototype,"destroyWinLabel",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=o(S.prototype,"updateMaxLevelSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(S.prototype,"updateButtonSpriteFrame",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(S.prototype,"updateButtonNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=S))||L)),c._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerUITowerIcon.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(e,t){var o,i,r,n,l,s,a,c,u,p,d,y,f,h,w,b,g,v,T,m,C,_,I,L,B,j,k,A;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,a=e.assertThisInitialized,c=e.createClass,u=e.get},function(e){p=e.cclegacy,d=e._decorator,y=e.Node,f=e.Prefab,h=e.instantiate,w=e.v3,b=e.LabelComponent},function(e){g=e.BaseObject}],execute:function(){p._RF.push({},"960c8xSpalMJZbfb3XktNJx","BuildTowerUITowerIcon",void 0),k=d.ccclass,A=d.property,e("BuildTowerUITowerIcon",(v=k("BuildTowerUITowerIcon"),T=A({type:y}),m=A({type:f}),C=A({type:y}),v((L=o((I=function(e){function t(){var e,o;r(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return o=n(this,(e=l(t)).call.apply(e,[this].concat(c))),s(o,"costGoldLabel",L,a(o)),s(o,"towerShowAnimList",B,a(o)),s(o,"showTowerAnimLayer",j,a(o)),o.gameConfig=void 0,o.currentBuildCost=null,o.towerType=null,o}return i(t,e),c(t,[{key:"onLoad",value:function(){}},{key:"start",value:function(){}},{key:"init",value:function(e,o,i){this.gameConfig=i,this.towerType=e;var r=h(this.towerShowAnimList[e]);for(var n in r.scale=w(.5,.5,.5),r.parent=this.showTowerAnimLayer,console.log("type",e),this.gameConfig)n.indexOf("Tower")>-1&&this.gameConfig[n].Index===e&&(this.objectType=n);console.log("object type",this.objectType),u(l(t.prototype),"init",this).call(this,this.gameConfig,o),this.costGoldLabel.getComponent(b).string=this.buildCost+""}},{key:"getCurrentBuildCost",value:function(){return this.buildCost}},{key:"getTowerType",value:function(){return this.towerType}}]),t}(g)).prototype,"costGoldLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=o(I.prototype,"towerShowAnimList",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=o(I.prototype,"showTowerAnimLayer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=I))||_)),p._RF.pop()}}}));

System.register("chunks:///UI/Menu/BuildTowerUI.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./MenuUIBase.js","./BuildTowerUITowerIcon.js"],(function(e,t){var o,i,r,n,l,a,s,u,c,d,p,h,w,g,v,f,C,m,y,T,B,I,b,_,U,k,P,D;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,u=e.createClass,c=e.get},function(e){d=e.cclegacy,p=e._decorator,h=e.Prefab,w=e.instantiate,g=e.ButtonComponent,v=e.v3,f=e.v2,C=e.find},function(e){m=e.MenuUIBase},function(e){y=e.BuildTowerUITowerIcon}],execute:function(){d._RF.push({},"e6405P/+GFGaa0/qmo/iQAc","BuildTowerUI",void 0),P=p.ccclass,D=p.property,e("BuildTowerUI",(T=P("BuildTowerUI"),B=D({type:h}),I=D({type:h}),T((U=o((_=function(e){function t(){var e,o;r(this,t);for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return o=n(this,(e=l(t)).call.apply(e,[this].concat(u))),a(o,"towerShowAnimPrefabList",U,s(o)),a(o,"buildTowerUITowerIcon",k,s(o)),o}return i(t,e),u(t,[{key:"init",value:function(e,o){this.gameController=o;for(var i=this.gameController.playerData.getCurrentActiveTowerList(),r=i.length,n=0;n<r;n++){var a=w(this.buildTowerUITowerIcon);a.name="tower_"+i[n],a.addComponent(g),a.on("click",this.onButtonClick.bind(this)),a.parent=this.node,a.getComponent(y).init(i[n],o,e);var s=76/a.width;a.scale=v(s,s,1);var u=f(0,1),d=(u=u.rotate(2*Math.PI/r*n).normalize()).multiplyScalar(60);a.setPosition(v(d.x,d.y,0))}console.log("build tower ui"),this.node.getChildByName("BuildTowerBgNode").on("click",this.onButtonClick.bind(this)),c(l(t.prototype),"init",this).call(this,e,o)}},{key:"start",value:function(){}},{key:"onButtonClick",value:function(e,t){if("BuildTowerBgNode"===e.node.name)this.state.setState("close-ui");else{var o=e.node.getComponent(y);if(o){var i=o.getTowerType(),r=o.getCurrentBuildCost(),n=this.gameController.playerData.getCurrentGoldCount();console.log("current gold count",n),r<=n?(this.gameController.playerData.addGoldCount(-1*r),this.state.setState("close-ui"),C("GameController").emit("build-one-tower",i,this.targetNode)):C("Canvas").emit("gold-not-enough")}}}}]),t}(m)).prototype,"towerShowAnimPrefabList",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=o(_.prototype,"buildTowerUITowerIcon",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=_))||b)),d._RF.pop()}}}));

System.register("chunks:///UI/GameWin/GameResultGoldCell.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var o,n,r,i,l,a,s,c,u,p,d,m,y,C,b,f,v,g,_,h,G,R,w,F,L,z,I;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,p=e._decorator,d=e.Node,m=e.LabelComponent,y=e.loader,C=e.SpriteFrame,b=e.SpriteComponent,f=e.Component}],execute:function(){u._RF.push({},"00a24DEoTFIC42oXzjaFqsy","GameResultGoldCell",void 0),z=p.ccclass,I=p.property,e("GameResultGoldCell",(v=z("GameResultGoldCell"),g=I({type:d}),_=I({type:d}),h=I({type:d}),v((w=o((R=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,c=new Array(n),u=0;u<n;u++)c[u]=arguments[u];return o=i(this,(e=l(t)).call.apply(e,[this].concat(c))),a(o,"enemyIconNode",w,s(o)),a(o,"enemyCountLabel",F,s(o)),a(o,"winGoldCountLabel",L,s(o)),o}return n(t,e),c(t,[{key:"start",value:function(){}},{key:"setData",value:function(e,t,o){var n=this;this.enemyCountLabel.getComponent(m).string=e+"",this.winGoldCountLabel.getComponent(m).string=t+"",console.log("icon str",o),y.loadRes(o+"/spriteFrame",C,(function(e,t){console.log("err",e),console.log("result",t),e||(n.enemyIconNode.getComponent(b).spriteFrame=t)}))}}]),t}(f)).prototype,"enemyIconNode",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=o(R.prototype,"enemyCountLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=o(R.prototype,"winGoldCountLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=R))||G)),u._RF.pop()}}}));

System.register("chunks:///UI/GameWin/GameWinPrefab.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./GameResultGoldCell.js"],(function(e,t){var o,n,r,i,l,a,u,s,c,p,d,m,g,f,h,y,b,v,C,_,w,S,F,G,L,B,R,z,N,k,I,P,W,T,x,E,j,A,D,M,O,V,H,J,U,Z,q,K,Q,X,Y,$,ee,te,oe;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_dec14:void 0,_dec15:void 0,_dec16:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_descriptor13:void 0,_descriptor14:void 0,_descriptor15:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,u=e.assertThisInitialized,s=e.createClass},function(e){c=e.cclegacy,p=e._decorator,d=e.Prefab,m=e.Node,g=e.SpriteFrame,f=e.SpriteComponent,h=e.LabelComponent,y=e.instantiate,b=e.Tween,v=e.v3,C=e.Component},function(e){_=e.GameResultGoldCell}],execute:function(){c._RF.push({},"fa8f9h1LBJLMZap+sTSLCS2","GameWinPrefab",void 0),te=p.ccclass,oe=p.property,e("GameWinPrefab",(w=te("GameWinPrefab"),S=oe({type:d}),F=oe({type:m}),G=oe({type:m}),L=oe({type:g}),B=oe({type:g}),R=oe({type:g}),z=oe({type:g}),N=oe({type:g}),k=oe({type:g}),I=oe({type:m}),P=oe({type:m}),W=oe({type:m}),T=oe({type:m}),x=oe({type:m}),E=oe({type:m}),w((D=o((A=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return o=i(this,(e=l(t)).call.apply(e,[this].concat(s))),a(o,"winGoldCellPrefab",D,u(o)),a(o,"leftButton",M,u(o)),a(o,"rightButton",O,u(o)),a(o,"retryGameButtonSpriteFrame",V,u(o)),a(o,"shareButtonSpriteFrame",H,u(o)),a(o,"nextLevelSpriteFrame",J,u(o)),a(o,"saveLifeButtonSpriteFrame",U,u(o)),a(o,"gameWinIconSpriteFrame",Z,u(o)),a(o,"gameLossIconSpriteFrame",q,u(o)),a(o,"gameResultIconNode",K,u(o)),a(o,"gameResultNode",Q,u(o)),a(o,"sumNode",X,u(o)),a(o,"totalEnemyCountLabel",Y,u(o)),a(o,"totalGoldCountLabel",$,u(o)),o.gameConfig=null,a(o,"scrollViewNode",ee,u(o)),o.gameResultState=null,o.uiController=null,o.gameController=null,o.nodeList=[],o}return n(t,e),s(t,[{key:"start",value:function(){}},{key:"setGameResult",value:function(e,t,o,n,r){var i=this;this.uiController=n,this.gameController=r,this.gameResultState=e,this.gameConfig=o,console.log("游戏状态时",e);var l=t.length,a=0;console.log("游戏结果数据是",t),console.log("当前关卡打死的敌人数目种类，获得的金币数目 "),e?(this.gameResultIconNode.getComponent(f).spriteFrame=this.gameWinIconSpriteFrame,this.leftButton.getComponent(f).spriteFrame=this.shareButtonSpriteFrame,this.rightButton.getComponent(f).spriteFrame=this.nextLevelSpriteFrame):(this.gameResultIconNode.getComponent(f).spriteFrame=this.gameLossIconSpriteFrame,this.leftButton.getComponent(f).spriteFrame=this.retryGameButtonSpriteFrame,this.rightButton.getComponent(f).spriteFrame=this.saveLifeButtonSpriteFrame);for(var u={},s=0;s<t.length;s++)u[t[s].enemyType]?(u[t[s].enemyType].count+=1,u[t[s].enemyType].winGoldCount+=t[s].dropGoldCount):u[t[s].enemyType]={count:1,winGoldCount:t[s].dropGoldCount},a+=t[s].dropGoldCount;this.showCellEnterAnim(u,(function(){return console.log("展示结束"),i.showSumResult(l,a)}))}},{key:"showSumResult",value:function(e,t){var o=this;return new Promise((function(n,r){o.sumNode.active=!0,o.totalEnemyCountLabel.getComponent(h).string=e+"",o.totalGoldCountLabel.getComponent(h).string=t+""}))}},{key:"showCellEnterAnim",value:function(e,t){var o=this;if(0!==Object.keys(e).length){var n=Object.keys(e),r=n[Math.round(Math.random()*(n.length-1))],i=e[r];delete e[r];var l=y(this.winGoldCellPrefab);l.parent=this.gameResultNode;var a=new b(l),u=this.gameConfig[r].IconSpriteFrameName;l.getComponent(_).setData(i.count,i.winGoldCount,u),l.position=v(0,-100*this.nodeList.length-50,0),this.nodeList.push(l),a.delay(.2),a.call((function(){o.showCellEnterAnim(e,t)})),a.start()}else t&&t()}},{key:"onButtonClick",value:function(e,t){var o=this;switch(t){case"left-button":console.log("分享游戏结果"),this.gameResultState?this.gameController.playerClickShareButton().then((function(){o.gameController.enterNextLevel(),o.node.destroy()})):(this.gameController.playerClickRetryButton(),this.node.destroy());break;case"right-button":this.gameResultState?(console.log("进入下一关"),this.node.destroy(),this.uiController.playerClickNextLevelButton()):this.gameController.playerClickSaveLifeButton().then((function(){o.node.destroy()}))}}}]),t}(C)).prototype,"winGoldCellPrefab",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(A.prototype,"leftButton",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(A.prototype,"rightButton",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(A.prototype,"retryGameButtonSpriteFrame",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=o(A.prototype,"shareButtonSpriteFrame",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=o(A.prototype,"nextLevelSpriteFrame",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=o(A.prototype,"saveLifeButtonSpriteFrame",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=o(A.prototype,"gameWinIconSpriteFrame",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(A.prototype,"gameLossIconSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(A.prototype,"gameResultIconNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=o(A.prototype,"gameResultNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=o(A.prototype,"sumNode",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=o(A.prototype,"totalEnemyCountLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=o(A.prototype,"totalGoldCountLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=o(A.prototype,"scrollViewNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=A))||j)),c._RF.pop()}}}));

System.register("chunks:///UI/UIController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./Menu/MenuUIBase.js","./GoldCtl.js","./Menu/UpdateTowerUI.js","./Menu/BuildTowerUI.js","./GameWin/GameWinPrefab.js","./SkillCtl.js","../GameController.js"],(function(e,t){var o,n,i,r,l,a,s,u,c,d,p,m,h,f,b,g,v,I,C,w,y,U,N,k,_,P,L,B,G,j,S,T,z,R,A,M,E,H,W,D,F,x,O,V,J,Z,q,K,Q,X,Y;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,i=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,u=e.createClass},function(e){c=e.cclegacy,d=e._decorator,p=e.Prefab,m=e.Node,h=e.SpriteFrame,f=e.find,b=e.view,g=e.v3,v=e.isValid,I=e.instantiate,C=e.Tween,w=e.LabelComponent,y=e.CameraComponent,U=e.SpriteComponent,N=e.Component},function(e){k=e.MenuUIBase},function(e){_=e.GoldCtl},function(e){P=e.UpdateTowerUI},function(e){L=e.BuildTowerUI},function(e){B=e.GameWinPrefab},function(e){G=e.SkillCtl},function(e){j=e.GameController}],execute:function(){c._RF.push({},"ac456IJb4BOS7ZW+hoJsDui","UIController",void 0),X=d.ccclass,Y=d.property,e("UIController",(S=X("UIController"),T=Y({type:p}),z=Y({type:p}),R=Y({type:m}),A=Y({type:m}),M=Y({type:m}),E=Y({type:h}),H=Y({type:p}),W=Y({type:m}),S((x=o((F=function(e){function t(){var e,o;i(this,t);for(var n=arguments.length,u=new Array(n),c=0;c<n;c++)u[c]=arguments[c];return o=r(this,(e=l(t)).call.apply(e,[this].concat(u))),a(o,"buildTowerPrefab",x,s(o)),a(o,"updateMenuPrefab",O,s(o)),o.gameController=null,a(o,"cameraNode",V,s(o)),o.buildUINode=null,o.updateUINode=null,a(o,"enemyInfoButton",J,s(o)),a(o,"towerInfoButton",Z,s(o)),o.isHoldSkillIcon=!1,a(o,"bossIcon",q,s(o)),a(o,"gameResultPrefab",K,s(o)),a(o,"currentLevelLabelIcon",Q,s(o)),o}return n(t,e),u(t,[{key:"start",value:function(){var e=this;this.gameController=f("GameController").getComponent(j);var t=b.getVisibleSize().width;this.enemyInfoButton.position=g(-.5*t-100,0,0),this.towerInfoButton.position=g(.5*t+100,0,0),console.log("ui controller start"),this.gameController.node.on("touch-base-build-base",(function(t){e.isHoldSkillIcon||(v(e.updateUINode)&&e.updateUINode.getComponent(k).close(),v(e.buildUINode)||(e.buildUINode=I(e.buildTowerPrefab),e.buildUINode.parent=e.node,e.buildUINode.getComponent(L).init(e.gameController.getGameConfig().json,e.gameController)),e.setUINodeTo3dPos(e.buildUINode,t),e.buildUINode.getComponent(k).open(t))})),this.gameController.node.on("touch-tower",(function(t){e.isHoldSkillIcon||(v(e.buildUINode)&&e.buildUINode.getComponent(k).close(),v(e.updateUINode)||(e.updateUINode=I(e.updateMenuPrefab),e.updateUINode.parent=e.node,e.updateUINode.getComponent(P).init(e.gameController.getGameConfig().json,e.gameController)),e.setUINodeTo3dPos(e.updateUINode,t),e.updateUINode.getComponent(P).open(t))})),this.node.on("show-ui-enter-anim",this.showUIEnterAnim.bind(this),this),this.node.on("show-game-loss-ui",this.showGameLossUI.bind(this),this),this.node.on("show-game-win-ui",this.showGameWinUI.bind(this),this),this.node.on("show-current-level-icon-anim",this.showCurrentLevelIconAnim.bind(this),this)}},{key:"showCurrentLevelIconAnim",value:function(e){var t=this,o=new C(this.currentLevelLabelIcon);this.currentLevelLabelIcon.active=!0,this.currentLevelLabelIcon.getComponent(w).string="第"+(this.gameController.getCurrentLevelNum()+1)+"关",o.set({scale:g(2,2,2)}),o.to(.5,{scale:g(1,1,1)},{easing:"backOut"}),o.delay(.8),o.call((function(){t.currentLevelLabelIcon.active=!1,e()})),o.start()}},{key:"showGameWinUI",value:function(e){var t=I(this.gameResultPrefab);t.parent=this.node;var o=this.gameController.getGameConfig().json;t.getComponent(B).setGameResult(!0,e,o,this,this.gameController)}},{key:"showGameLossUI",value:function(e){var t=I(this.gameResultPrefab);t.parent=this.node;var o=this.gameController.getGameConfig().json;t.getComponent(B).setGameResult(!1,e,o,this,this.gameController)}},{key:"showUIEnterAnim",value:function(e){var t=this;return this.node.emit("enter-game"),this.node.getComponent(G).showEnterAnim().then((function(){return t.node.getComponent(_).showEnterAnim()})).then((function(){return t.showButtonUIEnter()})).then((function(){e&&e()}))}},{key:"showButtonUIEnter",value:function(){var e=this;return new Promise((function(t,o){for(var n=[e.enemyInfoButton,e.towerInfoButton],i=b.getVisibleSize().width,r=[],l=function(e,t){return new Promise((function(o,n){var r=0===t?-1:1,l=new C(e);l.to(.4,{position:g(100*-r+.5*i*r,0,0)}),l.call((function(){console.log("进场结束"),o()})),l.start()}))},a=0;a<n.length;a++){var s=n[a];r.push(l(s,a))}Promise.all(r).then((function(){t()}))}))}},{key:"setUINodeTo3dPos",value:function(e,t){var o;o=this.cameraNode.getComponent(y).convertToUINode(t.position,this.node),e.setPosition(o)}},{key:"onButtonClick",value:function(e,t){switch(console.log("on button click",t),t){case"start-game":console.log("event",e),e.target.destroy(),this.gameController.node.emit("player-click-game")}}},{key:"setHoldSkillIcon",value:function(e){this.isHoldSkillIcon=e}},{key:"showBossIconAnim",value:function(){var e=this;return new Promise((function(t,o){var n=new m;n.addComponent(U).spriteFrame=e.bossIcon,n.parent=e.node;var i=new C(n);i.set({scale:g(2,2,2),position:g(0,240,0)}),i.to(.2,{scale:g(1,1,1)},{easing:"backIn"}),i.delay(.8),i.hide(),i.call((function(){n.destroy(),t()})),i.start()}))}},{key:"playerClickNextLevelButton",value:function(){this.gameController.enterNextLevel()}}]),t}(N)).prototype,"buildTowerPrefab",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(F.prototype,"updateMenuPrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(F.prototype,"cameraNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=o(F.prototype,"enemyInfoButton",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=o(F.prototype,"towerInfoButton",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(F.prototype,"bossIcon",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(F.prototype,"gameResultPrefab",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=o(F.prototype,"currentLevelLabelIcon",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=F))||D)),c._RF.pop()}}}));

System.register("chunks:///UI/SkillCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js","./UIController.js","../Towers/TowerBase.js","../GameController.js"],(function(e,o){var t,i,n,r,l,s,c,a,u,d,p,v,f,h,k,g,m,y,w,C,b,S,_,N,T,P,R,B,z,I,L,E,F,U,x,D,A,j,H,O,G,V,J,M,W,Y,Z,q,K,Q,X,$;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,s=e.initializerDefineProperty,c=e.assertThisInitialized,a=e.createClass},function(e){u=e.cclegacy,d=e._decorator,p=e.Prefab,v=e.SpriteFrame,f=e.Node,h=e.CCInteger,k=e.view,g=e.v3,m=e.find,y=e.CameraComponent,w=e.UITransformComponent,C=e.Tween,b=e.isValid,S=e.instantiate,_=e.Component},function(e){N=e.State},function(e){T=e.UIController},function(e){P=e.TowerBase},function(e){R=e.GameController}],execute:function(){u._RF.push({},"40520LpyUZJx6EmYjb+U/Iw","SkillCtl",void 0),X=d.ccclass,$=d.property,e("SkillCtl",(B=X("SkillCtl"),z=$({type:p}),I=$({type:v}),L=$({type:v}),E=$({type:f}),F=$({type:h}),U=$({type:f}),x=$({type:f}),D=$({type:f}),A=$({type:p}),j=$({type:f}),B((G=t((O=function(e){function o(){var e,t;n(this,o);for(var i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=r(this,(e=l(o)).call.apply(e,[this].concat(a))),s(t,"狂暴道具Prefab",G,c(t)),s(t,"狂暴道具SpriteFrameRed",V,c(t)),s(t,"狂暴道具SpriteFrameGray",J,c(t)),s(t,"skillsNode",M,c(t)),s(t,"currentSkillCount",W,c(t)),s(t,"skillRedBgList",Y,c(t)),s(t,"skillButtonNode",Z,c(t)),t.skillNodeList=[],t.currentTouchNode=null,t.cameraNodeCom=null,t.gameController=null,t.timeoutResolve=void 0,t.rayCheckResolve=void 0,t.targetTower=void 0,t.currentSkillPower=0,s(t,"skillPowerFullEffect",q,c(t)),t.state=new N,s(t,"addPowerAnim3dPrefab",K,c(t)),s(t,"skillDouIcon",Q,c(t)),t}return i(o,e),a(o,[{key:"onLoad",value:function(){}},{key:"start",value:function(){var e=this,o=k.getVisibleSize().width;this.skillButtonNode.position=g(.5*o+100,this.skillButtonNode.position.y,this.skillButtonNode.position.z),this.gameController=m("GameController").getComponent(R),this.gameController.node.on("touch-screen-to-3d",(function(o){for(var t=0;t<o.length;t++){var i=o[t];if(i.collider&&i.collider.node&&i.collider.node.getComponent(P)&&e.rayCheckResolve){e.targetTower=i.collider.node,e.rayCheckResolve("check-succ"),e.rayCheckResolve=void 0;break}}})),this.cameraNodeCom=m("Camera").getComponent(y),this.node.on(f.EventType.TOUCH_START,(function(o){console.log("touch start",o);var t=e.skillDouIcon.getComponent(w).getBoundingBoxToWorld(),i=o.getUILocation();t.contains(i)&&(console.log("点中了 技能点"),e.currentTouchNode=e.skillDouIcon,e.startCheckSkillNode(),e.node.getComponent(T).setHoldSkillIcon(!0))})),this.node.on(f.EventType.TOUCH_MOVE,(function(o){if(e.currentTouchNode){var t=o.getUILocation(),i=e.node.getComponent(w).convertToNodeSpaceAR(g(t.x,t.y,0));e.currentTouchNode.position=g(i.x,i.y,0)}})),this.node.on(f.EventType.TOUCH_END,(function(o){e.currentTouchNode&&(console.log("释放"),e.scheduleOnce((function(){e.node.getComponent(T).setHoldSkillIcon(!1),e.timeoutResolve&&(e.timeoutResolve("timeout"),e.timeoutResolve=void 0)}),.1))}))}},{key:"startCheckSkillNode",value:function(){var e=this,o=[new Promise((function(o,t){e.rayCheckResolve=o})),new Promise((function(o,t){e.timeoutResolve=o}))];Promise.race(o).then((function(o){if("timeout"===o){console.log("超市了");var t=new C(e.currentTouchNode);t.to(.2,{position:e.skillButtonNode.position}),t.call((function(){e.currentTouchNode=void 0})),t.start()}else if(console.log("释放技能成功"),b(e.targetTower)){console.log("给目标塔发送消息，释放技能"),e.targetTower.getComponent(P).releaseSkill(),e.currentTouchNode.active=!1,e.currentTouchNode.position=e.skillButtonNode.position,e.skillPowerFullEffect.active=!1,e.currentSkillPower=0;for(var i=0;i<e.skillRedBgList.length;i++){var n=e.skillRedBgList[i];n.position=g(n.position.x,-80,n.position.z)}e.currentTouchNode=void 0}}))}},{key:"showEnterAnim",value:function(){var e=this;return new Promise((function(o,t){var i=k.getVisibleSize(),n=i.height;console.log("height",n);var r=new C(e.skillButtonNode);r.to(.2,{position:g(.5*i.width-110,e.skillButtonNode.position.y,e.skillButtonNode.position.z)}),r.call((function(){o(),e.state.setState("run")})),r.start()}))}},{key:"addSkillPower",value:function(e){if(!(this.currentSkillPower>=80)){this.currentSkillPower+=e;var o=this.currentSkillPower/80;1===o&&(this.skillPowerFullEffect.active=!0,this.skillDouIcon.active=!0,this.skillDouIcon.position=this.skillButtonNode.position);for(var t=0;t<this.skillRedBgList.length;t++){var i=this.skillRedBgList[t];i.position=g(i.position.x,80*o-80,i.position.z)}}}},{key:"showAddPowerAnimEffect",value:function(e,o){var t=this,i=S(this.addPowerAnim3dPrefab);i.parent=this.gameController.node,i.position=o;var n=new C(i);n.by(.4,{position:g(0,5,0)}),n.delay(.6),n.to(.6,{position:g(45,10,0)}),n.call((function(){i.destroy(),t.addSkillPower(e)})),n.start()}},{key:"update",value:function(e){if("run"===this.state.getState())for(var o=0;o<this.skillRedBgList.length;o++){var t=this.skillRedBgList[o];if(t.position=g(t.position.x+20*e,t.position.y,t.position.z),t.position.x>153){var i=0===o?1:0,n=this.skillRedBgList[i];t.position=g(n.position.x-152,n.position.y,n.position.z)}}}}]),o}(_)).prototype,"狂暴道具Prefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(O.prototype,"狂暴道具SpriteFrameRed",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(O.prototype,"狂暴道具SpriteFrameGray",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(O.prototype,"skillsNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(O.prototype,"currentSkillCount",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Y=t(O.prototype,"skillRedBgList",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Z=t(O.prototype,"skillButtonNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(O.prototype,"skillPowerFullEffect",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(O.prototype,"addPowerAnim3dPrefab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(O.prototype,"skillDouIcon",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=O))||H)),u._RF.pop()}}}));

System.register("chunks:///Towers/TowerBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js","../TowerBuildBase/TowerBuildBase.js","../BaseObject.js","../BulletBase.js","../UI/SkillCtl.js","../GameController.js","../Enemys/EnemyBase.js","../EnemyController.js"],(function(t,e){var o,n,i,r,a,s,l,u,c,h,d,g,m,f,y,p,v,k,C,T,w,b,B,S,A,E,R,_,D,P,N,O,j,z,L,x,I,G,F,M,V,H,U;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inherits,i=t.classCallCheck,r=t.possibleConstructorReturn,a=t.getPrototypeOf,s=t.initializerDefineProperty,l=t.assertThisInitialized,u=t.createClass,c=t.get},function(t){h=t.cclegacy,d=t._decorator,g=t.Prefab,m=t.Node,f=t.CCFloat,y=t.v3,p=t.find,v=t.SkeletalAnimationComponent,k=t.isValid,C=t.Vec3,T=t.v2,w=t.instantiate,b=t.Tween},function(t){B=t.State},function(t){S=t.TowerBuildBase},function(t){A=t.BaseObject},function(t){E=t.BulletBase},function(t){R=t.SkillCtl},function(t){_=t.GameController},function(t){D=t.EnemyBase},function(t){P=t.EnemyController}],execute:function(){h._RF.push({},"93965WLO/1GpoRxL0uoTS9a","TowerBase",void 0),H=d.ccclass,U=d.property,t("TowerBase",(N=H("TowerBase"),O=U({type:g}),j=U({type:m}),z=U({type:f}),L=U({type:m}),N((G=o((I=function(t){function e(){var t,o;i(this,e);for(var n=arguments.length,u=new Array(n),c=0;c<n;c++)u[c]=arguments[c];return(o=r(this,(t=a(e)).call.apply(t,[this].concat(u)))).state=new B,o.currentTargetEnemy=null,o.currentShootTime=0,s(o,"bulletPrefab",G,l(o)),s(o,"bulletStartPosList",F,l(o)),o.currentShootDiraction=y(0,0,0),o.gameConfig=null,s(o,"attackAnimEventTimeOffset",M,l(o)),o.towerBuildBase=null,s(o,"attackRangeNode",V,l(o)),o.skillCtl=null,o}return n(e,t),u(e,[{key:"init",value:function(t,o){c(a(e.prototype),"init",this).call(this,t,o),this.skillCtl=p("Canvas").getComponent(R),this.gameConfig=t,console.log("tower base init"),this.node.emit("init",t,o)}},{key:"start",value:function(){var t=this;console.log("tower base start"),this.state.setState("run"),this.gameController=p("GameController").getComponent(_),this.gameController.node.on("touch-screen-to-3d",this.touchScreenTo3d.bind(this),this),this.gameController.node.on("destroy-all-tower",this.destroyAllTower.bind(this),this),this.state.addState("releas-skill",(function(){t.currentTargetEnemy&&(t.currentTargetEnemy=null),t.node.emit("release-skill",(function(){t.state.setState("run")}))})),this.state.addState("destroy",(function(){var e=t.rootNode.getComponent(v),o=e.getState("骨架|todestroy");o?(o.repeatCount=1,e.play("骨架|todestroy"),t.scheduleOnce((function(){t.towerBuildBase&&t.towerBuildBase.getComponent(S).unSetTargetTower(t.node);var e=y(2*Math.random(),0,2*Math.random());t.gameController.getComponent(_).showAddGoldAnimEffect(t.getDestroyCount(),y(t.node.position.x,0,t.node.position.z).add(e)),t.node.destroy()}),o.length)):(t.node.destroy(),t.towerBuildBase&&t.towerBuildBase.getComponent(S).unSetTargetTower(t.node))}))}},{key:"destroyAllTower",value:function(){this.node.destroy()}},{key:"touchScreenTo3d",value:function(t){if(console.log("射线检测到了 tower"),"run"===this.state.getState())for(var e=0;e<t.length;e++){if(t[e].collider.node.uuid===this.node.uuid){this.gameController.node.emit("touch-tower",this.node);break}}}},{key:"onDestroy",value:function(){console.log("销毁"),this.gameController.node.off("touch-screen-to-3d",this.touchScreenTo3d,this),this.gameController.node.on("destroy-all-tower",this.destroyAllTower,this)}},{key:"toDestroy",value:function(){this.state.setState("destroy")}},{key:"update",value:function(t){if("run"===this.state.getState()){if(null===this.currentTargetEnemy){for(var e=this.gameController.getComponent(P).getCurrentEnemyNodeList(),o=1e4,n=void 0,i=0;i<e.length;i++){var r=e[i];if(k(r)&&r.getComponent(D).getIsCanLock()&&!r.getComponent(D).getIsDead()&&this.getCanAttackEnemy(r)){var a=new C(r.position).subtract(this.node.position).length();a<o&&(o=a,n=r)}}if(n)T(n.position.x,n.position.z).subtract(T(this.node.position.x,this.node.position.z)).length()<this.getCurrentAttackRange()&&(this.currentTargetEnemy=n)}if(k(this.currentTargetEnemy))if(this.rootNode.lookAt(this.currentTargetEnemy.position),this.currentTargetEnemy.getComponent(D)&&this.currentTargetEnemy.getComponent(D).getIsDead())this.currentTargetEnemy=null;else{this.currentShootDiraction=y(this.currentTargetEnemy.position).subtract(y(this.node.position));var s=T(this.currentShootDiraction.x,this.currentShootDiraction.z).signAngle(T(0,-1));this.node.eulerAngles=new C(0,180*s/Math.PI,0)}if(k(this.currentTargetEnemy))if(this.currentShootTime>this.shootDuraction){if(T(this.currentTargetEnemy.position.x,this.currentTargetEnemy.position.z).subtract(T(this.node.position.x,this.node.position.z)).length()>this.getCurrentAttackRange())return void(this.currentTargetEnemy=void 0);this.currentShootTime=0,this.shootOneBullet(this.getCurrentAttackRate(),this.currentShootDiraction,this.getCurrentAttackNum())}else this.currentShootTime+=t;else this.currentTargetEnemy=null}}},{key:"getCurrentAttackRate",value:function(){return this.baseAttackRate}},{key:"shootOneBullet",value:function(t,e,o){var n=this,i=this.rootNode.getComponent(v);if(i){var r=i.getState("骨架|AttackAnim"),a=1*r.length/t;i.play("骨架|AttackAnim"),r.repeatCount=1;i.getState("骨架|AttackAnim");this.scheduleOnce((function(){n.createOneTimeBullet(e,n.getCurrentAttackNum())}),a*this.attackAnimEventTimeOffset)}}},{key:"createOneTimeBullet",value:function(t,e){for(var o=0;o<this.bulletStartPosList.length;o++){var n=this.bulletStartPosList[o],i=w(this.bulletPrefab);i.parent=this.node.parent,i.active=!1,i.setPosition(n.worldPosition),i.active=!0,console.log("createOneBullet base attack num",e),i.getComponent(E).init(this.gameConfig,this.gameController,{direction:t,targetEnemy:this.currentTargetEnemy,baseAttackNum:e,targetTower:this})}}},{key:"enemyDeadByThis",value:function(t){t&&this.skillCtl.showAddPowerAnimEffect(2,this.node.position)}},{key:"releaseSkill",value:function(){console.log("release skill",this.objectType),this.state.setState("releas-skill")}},{key:"setTowerBuildBase",value:function(t){this.towerBuildBase=t}},{key:"updateLevel",value:function(){c(a(e.prototype),"updateLevel",this).call(this)}},{key:"showAttackRange",value:function(){var t=this.getCurrentAttackRange();console.log("attack range",t),this.attackRangeNode.active=!0;var e=new b(this.attackRangeNode);e.to(.1,{scale:y(2*t,2*t,2*t)}),e.start()}},{key:"closeAttackRange",value:function(){var t=this,e=new b(this.attackRangeNode);e.to(.1,{scale:y(1,1,1)}),e.call((function(){t.attackRangeNode.active=!1})),e.start()}}]),e}(A)).prototype,"bulletPrefab",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=o(I.prototype,"bulletStartPosList",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=o(I.prototype,"attackAnimEventTimeOffset",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),V=o(I.prototype,"attackRangeNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=I))||x)),h._RF.pop()}}}));

System.register("chunks:///Home/HomeIcon.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js"],(function(e,t){var o,r,n,i,s,a,c,u,l,d,p,f,v,h,y,H,m,_,g,I,S;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,s=e.getPrototypeOf,a=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){l=e.cclegacy,d=e._decorator,p=e.Node,f=e.v3,v=e.Component},function(e){h=e.State}],execute:function(){l._RF.push({},"8213do7DSVI0IEO26O7s126","HomeIcon",void 0),I=d.ccclass,S=d.property,e("HomeIcon",(y=I("HomeIcon"),H=S({type:p}),y((g=o((_=function(e){function t(){var e,o;n(this,t);for(var r=arguments.length,u=new Array(r),l=0;l<r;l++)u[l]=arguments[l];return o=i(this,(e=s(t)).call.apply(e,[this].concat(u))),a(o,"redHeartNode",g,c(o)),o.state=new h,o}return r(t,e),u(t,[{key:"start",value:function(){this.state.setState("run")}},{key:"frozenHomeIcon",value:function(){this.state.setState("frozen")}},{key:"freeHomeIconn",value:function(){this.state.setState("run")}},{key:"update",value:function(e){"run"===this.state.getState()&&(this.redHeartNode.eulerAngles=this.redHeartNode.eulerAngles.add(f(0,1,0)))}}]),t}(v)).prototype,"redHeartNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=_))||m)),l._RF.pop()}}}));

System.register("chunks:///GameController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./Data/PlayerData.js","./Effect/WinGoldAnimEffect.js","./TowerBuildBase/TowerBuildBase.js","./GroundMapCtl.js","./TowerBuildBaseCtl.js","./Towers/TowerBase.js","./Home/HomeIcon.js","./EnemyController.js"],(function(e,t){var n,o,r,a,i,l,u,s,c,d,m,f,p,h,y,g,v,C,w,b,B,G,S,I,k,P,_,A,D,N,z,T,E,H,L,j,R,x,J,O,F,M,U,W,V,Y,q,X,K,Q,Z,$,ee,te;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_class3:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,u=e.assertThisInitialized,s=e.createClass},function(e){c=e.cclegacy,d=e._decorator,m=e.Node,f=e.JsonAsset,p=e.Prefab,h=e.Tween,y=e.v3,g=e.isValid,v=e.PhysicsSystem,C=e.instantiate,w=e.SkeletalAnimationComponent,b=e.Component},function(e){B=e.State},function(e){G=e.PlayData},function(e){S=e.WinGoldAnimEffect},function(e){I=e.TowerBuildBase},function(e){k=e.GroundMapCtl},function(e){P=e.TowerBuildBaseCtl},function(e){_=e.TowerBase},function(e){A=e.HomeIcon},function(e){D=e.EnemyController}],execute:function(){c._RF.push({},"5b4c0ApYS1B3bhehBCF/cvX","GameController",void 0),ee=d.ccclass,te=d.property,e("GameController",(N=ee("GameController"),z=te({type:m}),T=te({type:f}),E=te({type:p}),H=te({type:m}),L=te({type:m}),j=te({type:m}),R=te({type:m}),x=te({type:p}),J=te({type:p}),N(($=Z=function(e){function t(){var e,n;r(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return n=a(this,(e=i(t)).call.apply(e,[this].concat(s))),l(n,"enemyHealthBarCtlNode",M,u(n)),l(n,"gameConfigJson",U,u(n)),l(n,"towersPrefabList",W,u(n)),l(n,"startGameButton",V,u(n)),n.state=new B,l(n,"uiController",Y,u(n)),l(n,"plate",q,u(n)),l(n,"gameStartButtonBase",X,u(n)),l(n,"homeIconPrefab",K,u(n)),n.homeIconNode=null,n.playerData=null,l(n,"goldAnim3dPrefab",Q,u(n)),n.homeIconTw=null,n}return o(t,e),s(t,[{key:"onLoad",value:function(){this.playerData=new G(this);var e=new h(this.plate);e.repeatForever(new h(this.plate).to(20,{eulerAngles:y(0,360,0)}).set({eulerAngles:y(0,0,0)})),e.start()}},{key:"playerClickSaveLifeButton",value:function(){var e=this;return new Promise((function(t,n){t(),g(e.homeIconNode)&&(e.homeIconNode.active=!1),e.node.emit("destroy-all-enemy",(function(t){e.playerData.addGoldCount(t),e.showHomeIconEnterAnim().then((function(){e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(D).continueGame()}))}))}))}},{key:"playerClickShareButton",value:function(){var e=this;return new Promise((function(t,n){t(),e.playerData.addGoldCount(e.playerData.currentGoldCount)}))}},{key:"playerClickRetryButton",value:function(){var e=this;this.playerData.newGame(),this.enterGame().then((function(){e.uiController.emit("refer-red-heart-label"),e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(D).startGame()}))}},{key:"start",value:function(){var e=this;v.instance.enable=!0,this.state.addState("ready",(function(){console.log("enter state ",e.state.getState())})),this.state.setState("ready"),this.node.on("build-one-tower",(function(t,n){if(t<e.towersPrefabList.length){var o=C(e.towersPrefabList[t]);o.parent=e.node,o.getComponent(_).init(e.gameConfigJson.json,e);var r=y(n.position.x,0,n.position.z);o.setPosition(r),n.getComponent(I).setTargetTower(o),o.getComponent(_).setTowerBuildBase(n)}})),this.state.addState("play-start-button-anim",(function(){e.playStatrButtonPressAnim().then((function(){return new Promise((function(t,n){new h(e.startGameButton).by(1,{position:y(0,-10,0)}).call((function(){console.log("play over"),e.startGameButton.destroy(),t()})).start()}))})).then((function(){var t=new h(e.gameStartButtonBase);return t.to(.2,{scale:y(0,0,0)}),t.call((function(){e.gameStartButtonBase.destroy()})),t.start(),e.node.getComponent(k).showGroundEnterAnim()})).then((function(){return e.enterGame()})).then((function(){return e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.showUIEnterAnim()})).then((function(){e.state.setState("run"),e.node.getComponent(D).startGame()}))})),this.state.addState("game-loss",(function(){console.log("进入游戏失败的状态"),e.uiController.emit("close-weapon-info-layer"),e.node.getComponent(D).frozenAllEnemy(),e.node.getComponent(P).frozenAllTowerBuildBase(),e.homeIconNode.getComponent(A).frozenHomeIcon();var t=e.node.getComponent(D).getDeadEnemyData();e.scheduleOnce((function(){e.uiController.emit("show-game-loss-ui",t)}),.6)}))}},{key:"showUIEnterAnim",value:function(){var e=this;return new Promise((function(t,n){e.uiController.emit("show-ui-enter-anim",(function(){t()}))}))}},{key:"showHomeIconEnterAnim",value:function(){var e=this;return new Promise((function(t,n){g(e.homeIconNode)||(e.homeIconNode=C(e.homeIconPrefab),e.homeIconNode.parent=e.node);var o=e.node.getComponent(k);if(o){var r=o.getMapNodeList().getValue(5,5);e.homeIconNode.position=y(r.position.x,20,r.position.z),e.homeIconNode.getComponent(A).freeHomeIconn(),r.active=!1;var a=new h(e.homeIconNode);e.homeIconNode.active=!0,a.call((function(){r.active=!0})),a.to(2,{position:y(r.position.x,0,r.position.z)},{easing:"quadOut"}),a.call((function(){t()})),a.start()}}))}},{key:"playStatrButtonPressAnim",value:function(){var e=this;return new Promise((function(t,n){var o=e.startGameButton.getChildByName("StartGameButton").getComponent(w);if(o){var r=o.defaultClip,a=o.getState(r.name);a.repeatCount=1;var i=a.length;o.play(r.name),e.scheduleOnce((function(){console.log("播放完成"),t()}),i)}else t()}))}},{key:"playerTouch3dObject",value:function(e){if("ready"===this.state.getState())for(var t=0;t<e.length;t++){e[t].collider.node.uuid===this.startGameButton.uuid&&this.state.setState("play-start-button-anim")}else"run"===this.state.getState()&&this.node.emit("touch-screen-to-3d",v.instance.raycastResults)}},{key:"update",value:function(e){}},{key:"getGameConfig",value:function(){return this.gameConfigJson}},{key:"getCurrentLevelNum",value:function(){return this.playerData.currentLevelNum}},{key:"showAddGoldAnimEffect",value:function(e,t){var n=C(this.goldAnim3dPrefab);n.parent=this.node,n.getComponent(S).setGoldCount(e,this),n.position=t}},{key:"showBossEnterState",value:function(){this.node.emit("show-boss-enter-state")}},{key:"gameWin",value:function(e){this.uiController.emit("close-weapon-info-layer"),"run"===this.state.getState()&&(this.state.setState("show-game-result"),this.uiController.emit("show-game-win-ui",e))}},{key:"enterNextLevel",value:function(){var e=this;this.playerData.enterNextLevel(),console.log("进入下一关"),this.enterGame().then((function(){e.node.emit("update-gold-label",e.playerData.getCurrentGoldCount()),e.state.setState("run"),e.node.getComponent(D).startGame()}))}},{key:"enterGame",value:function(){var e=this;return new Promise((function(t,n){g(e.homeIconNode)&&(e.homeIconNode.active=!1),e.node.emit("destroy-all-tower"),e.node.emit("destroy-all-tower-build-base"),e.node.emit("destroy-all-enemy"),e.node.emit("init-level-label"),e.node.getComponent(P).showTowerBuildBaseEnterAnim().then((function(){return e.showHomeIconEnterAnim()})).then((function(){return e.showCurrentLevelIconAnim()})).then((function(){t()}))}))}},{key:"showCurrentLevelIconAnim",value:function(){var e=this;return new Promise((function(t,n){e.uiController.emit("show-current-level-icon-anim",(function(){t&&t()}))}))}},{key:"enemyAttacked",value:function(e){(console.log("敌人发动了攻击",e),"run"===this.state.getState())&&(this.playerData.getCurrentRedHeartCount()>0&&(this.playerData.addRedHeartCount(-1),0===this.playerData.getCurrentRedHeartCount()&&(console.log("游戏结束"),this.state.setState("game-loss"))))}},{key:"referRedHeardUI",value:function(){this.uiController.emit("refer-red-heart-label")}}]),t}(b),Z.accY=-1,Z.enemyBeLockMaxNum=1,M=n((F=$).prototype,"enemyHealthBarCtlNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=n(F.prototype,"gameConfigJson",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=n(F.prototype,"towersPrefabList",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=n(F.prototype,"startGameButton",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=n(F.prototype,"uiController",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=n(F.prototype,"plate",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=n(F.prototype,"gameStartButtonBase",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=n(F.prototype,"homeIconPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=n(F.prototype,"goldAnim3dPrefab",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=F))||O)),c._RF.pop()}}}));

System.register("chunks:///util/BezierN.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,r){var e,n,o,i,l;return{setters:[function(t){e=t.createClass,n=t.classCallCheck},function(t){o=t.cclegacy,i=t._decorator,l=t.v3}],execute:function(){o._RF.push({},"e43e2vpRCtNoZCKx8bvmJ4Z","BezierN",void 0),i.ccclass,i.property,t("BezierN",function(){function t(r){n(this,t),this.controllerPointList=[],this.controllerPointList=r}return e(t,[{key:"getPointList",value:function(t){for(var r=this.controllerPointList.length,e=[1,1],n=3;n<r+1;n++){for(var o=[],i=0;i<e.length;i++)o.push(e[i]);e[0]=1,e[n-1]=1;for(var c=0;c<o.length-1;c++)e[c+1]=o[c]+o[c+1]}for(var s=[],a=0;a<t;a++){for(var u=a/t,h=l(0,0,0),f=0;f<r;f++){var v=r-1-f,p=f,g=e[f]*Math.pow(1-u,v)*Math.pow(u,p);h.add(l(this.controllerPointList[f]).multiplyScalar(g))}s.push(h)}return s}}],[{key:"getPathLength",value:function(t){for(var r=0,e=0;e<t.length;e++){if(0!==e)r+=l(t[e]).subtract(t[e-1]).length()}return r}}]),t}()),o._RF.pop()}}}));

System.register("chunks:///util/FindPathWithAStart.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./My2Array.js"],(function(t,e){var s,i,n,a,h;return{setters:[function(t){s=t.createClass,i=t.classCallCheck},function(t){n=t.cclegacy},function(t){a=t.default}],execute:function(){n._RF.push({},"9bae92/Z1FGnZ8sEkxwZFcp","FindPathWithAStart",void 0),h=function(){function t(e,s){i(this,t),this.x=0,this.y=0,this.isHaveObs=!1,this.gValue=0,this.hValue=0,this.parent=null,this.x=e,this.y=s}return s(t,[{key:"setParent",value:function(t){this.parent=t}},{key:"getFValue",value:function(){return this.gValue+this.hValue}},{key:"setObs",value:function(t){this.isHaveObs=t}}]),t}(),t("FindPathWithAStart",function(){function t(e,s,n){i(this,t),this.openList=[],this.closeList=[],this.mapNodeList=new a,this.statrNode=null,this.endNode=null;for(var r=e.getHeightLength(),u=e.getWidthLength(),o=0;o<r;o++){for(var l=new Array,c=0;c<u;c++)l.push(new h(c,o));this.mapNodeList.pushList(l)}this.statrNode=this.mapNodeList.getValue(s[0],s[1]),this.endNode=this.mapNodeList.getValue(n[0],n[1])}return s(t,[{key:"findPathList",value:function(){var t=[];for(this.openList.push(this.statrNode);this.openList.length>0;){var e=this.findMinFvalueNode(this.openList),s=this.openList.splice(e,1)[0];if(s.x===this.endNode.x&&s.y===this.endNode.y){var i=s.parent;for(t.push(s);i.x!==this.statrNode.x||i.y!==this.statrNode.y;)t.push(i),i=i.parent;break}this.closeList.push(s);for(var n=this.findNearbyNodeList(s,this.mapNodeList),a=0;a<n.length;a++){var h=n[a];this.checkIsInList(h,this.closeList)||(this.checkIsInList(h,this.openList)?h.parent.gValue<s.gValue&&(h.setParent(s),h.gValue=s.gValue+this.getDistance(h.parent,h),h.hValue=this.getDistance(h,this.endNode)):(h.setParent(s),h.gValue=s.gValue+this.getDistance(h.parent,h),h.hValue=this.getDistance(h,this.endNode),this.openList.push(h)))}}t=t.reverse();for(var r=[],u=0;u<t.length;u++)r.push([t[u].x,t[u].y]);return r}},{key:"getDistance",value:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"findNearbyNodeList",value:function(t,e){for(var s=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],i=[],n=0;n<s.length;n++){var a=s[n],h=t.x+a[0],r=t.y+a[1],u=e.getValue(h,r);u&&!u.isHaveObs&&i.push(u)}return i}},{key:"findMinFvalueNode",value:function(t){for(var e=Number.MAX_VALUE,s=null,i=0;i<t.length;i++){var n=t[i].getFValue();n<e&&(e=n,s=i)}return s}},{key:"checkIsInList",value:function(t,e){for(var s=0;s<e.length;s++){var i=e[s];if(i.x===t.x&&i.y===t.y)return!0}return!1}},{key:"updateObsData",value:function(t){for(var e=0;e<t.length;e++){var s=t[e];this.mapNodeList.getValue(s[0],s[1]).setObs(!0)}}}]),t}()),n._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyBase.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js","../BaseObject.js","../GroundMapCtl.js","../GameController.js","../util/BezierN.js","../util/FindPathWithAStart.js","../EnemyController.js"],(function(e,t){var n,o,a,i,r,s,u,c,l,h,d,m,f,p,g,v,y,C,k,A,M,b,B,N,w,L,S,P,z,O,T,E,x,j,G;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,a=e.classCallCheck,i=e.possibleConstructorReturn,r=e.getPrototypeOf,s=e.initializerDefineProperty,u=e.assertThisInitialized,c=e.createClass,l=e.get},function(e){h=e.cclegacy,d=e._decorator,m=e.Node,f=e.find,p=e.SkeletalAnimationComponent,g=e.Tween,v=e.v3,y=e.v2,C=e.Quat,k=e.Vec3,A=e.isValid,M=e.ProgressBarComponent},function(e){b=e.State},function(e){B=e.BaseObject},function(e){N=e.GroundMapCtl},function(e){w=e.GameController},function(e){L=e.BezierN},function(e){S=e.FindPathWithAStart},function(e){P=e.DeadEnemyObj}],execute:function(){h._RF.push({},"c8d3fW25B9NIZ69bxowfjcm","EnemyBase",void 0),j=d.ccclass,G=d.property,e("EnemyBase",(z=j("EnemyBase"),O=G({type:m}),z((x=n((E=function(e){function t(){var e,n;a(this,t);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return(n=i(this,(e=r(t)).call.apply(e,[this].concat(c)))).pathList=[],n.state=new b,n.currentPathIndex=0,n.beLockedMaxNum=w.enemyBeLockMaxNum,n.currentbeLockedCount=0,n.cameraNode=null,n.healthBar=null,n.gameConfigJson=null,n.healthCount=0,n.currentHealthCount=0,n.enemyCtl=null,n.currentMoveTw=null,n.groundMapCtl=null,n.beAttackedCb=null,n.bezierPathList=[],n.currentBoneAnimName="",s(n,"caidaiEffect",x,u(n)),n}return o(t,e),c(t,[{key:"init",value:function(e,n,o,a){l(r(t.prototype),"init",this).call(this,e,n),this.groundMapCtl=f("GameController").getComponent(N),this.gameConfigJson=e,this.healthCount=this.gameConfigJson[this.objectType].HealthCount,this.beLockedMaxNum=this.gameConfigJson[this.objectType].BeLockedCount,this.currentHealthCount=this.healthCount;var i=this.getLookAtAngle(this.node.position,a);this.node.worldRotation=i}},{key:"enterShowBossEnter",value:function(){this.currentMoveTw&&this.currentMoveTw.stop()}},{key:"contiuePlayMoveAnim",value:function(){var e=this;this.currentMoveTw&&(this.rootNode.getComponent(p).getState(this.currentBoneAnimName).speed=3,this.scheduleOnce((function(){e.rootNode.getComponent(p).getState(e.currentBoneAnimName).speed=1}),3))}},{key:"showEnemyEnterAnim",value:function(e,t,n,o){var a=this,i=this.node;return this.enemyCtl=t,this.enemyCtl.node.on("frozen-all-enemy",this.forzenSelf.bind(this),this),new Promise((function(t,r){var s=new g(i),u=i.position;s.delay(.1*e),s.set({scale:v(0,0,0)}),s.show(),s.call((function(){i.active=!0})),s.to(.1,{scale:v(1,1,1)}),s.to(.4,{position:v(u.x,0,u.z)}),s.call((function(){a.startRun(n,o),t()})),s.start()}))}},{key:"startRun",value:function(e,t){console.log("start pos ",e),this.state.setState("run");var n=this.getMoveType();"Walk"===n?this.proceeWalkLogic(e,t):"Fly"===n&&this.processFlyLogic(e,t)}},{key:"processFlyLogic",value:function(e,t){var n=this;if("run"===this.state.getState()){for(var o=this.groundMapCtl.getMapSize(),a=[y(e.x,e.y)],i=0;i<5;i++)a.push(y(Math.round(Math.random()*(o.x-1)),Math.round(Math.random()*(o.y-1))));a.push(t);for(var r=[],s=0;s<a.length;s++){var u=a[s],c=this.groundMapCtl.getMapNodeList().getValue(u.x,u.y);if(c){var l=c.position;r.push(v(l.x,10,l.z))}}var h=new L(r).getPointList(100);this.currentMoveTw=this.processMoveAction(h),this.currentMoveTw.call((function(){n.currentBoneAnimName="骨架|AttackAnim";n.rootNode.getComponent(p).getState("骨架|AttackAnim").length;n.shootOneBossBullet().then((function(){var e=[y(0,0),y(0,10),y(10,0),y(10,10)],o=Math.round(Math.random()*(e.length-1));n.processFlyLogic(e[o],t)}))})),this.currentMoveTw.start()}}},{key:"getOneRandomMapPos",value:function(){var e=this.groundMapCtl.getMapSize();return y(Math.round(Math.random()*(e.x-1)),Math.round(Math.random()*(e.y-1)))}},{key:"processMoveAction",value:function(e){for(var t=this,n=new g(this.node),o=function(n,o){var a=0;new C;if(0===o){a=v(t.node.position).subtract(e[o]).length()/t.moveSpeed,t.getLookAtAngle(t.node.position,e[o])}else{var i=v(e[o-1]).subtract(e[o]).length();t.getLookAtAngle(e[o-1],e[o]),a=i/t.moveSpeed}n.call((function(){t.node.lookAt(e[o])})),n.to(a,{position:e[o]})},a=0;a<e.length;a++)o(n,a);return n}},{key:"proceeWalkLogic",value:function(e,t){var n=this;if("run"===this.state.getState()){for(var o=this.groundMapCtl.getMapNodeList(),a=this.groundMapCtl.getObsPosList(),i=new S(o,[e.x,e.y],[t.x,t.y]),r=[],s=0;s<a.length;s++){var u=a[s];r.push([u.x,u.y])}i.updateObsData(r);for(var c=i.findPathList(),l=[],h=0;h<c.length;h++){var d=c[h];l.push(this.groundMapCtl.getMapNodeList().getValue(d[0],d[1]).position)}var m=new L(l);this.bezierPathList=m.getPointList(30),this.bezierPathList=this.bezierPathList.slice(0,this.bezierPathList.length-5),this.node.position.equals(this.bezierPathList[this.bezierPathList.length-1])?(console.log("不用再走一遍逻辑了"),this.toBeAttack().then((function(){n.proceeWalkLogic(e,t)}))):(this.currentMoveTw=this.processMoveAction(this.bezierPathList),this.currentMoveTw.call((function(){n.toBeAttack().then((function(){n.proceeWalkLogic(e,t)}))})),this.currentMoveTw.start())}}},{key:"toBeAttack",value:function(){var e=this;return new Promise((function(t,n){e.currentBoneAnimName="骨架|AttackAnim";var o=e.rootNode.getComponent(p);o.play(e.currentBoneAnimName);var a=o.getState(e.currentBoneAnimName),i=a.length;a.repeatCount=1;var r=new g(e.node);r.delay(e.animSpeedMulOffset*i),r.call((function(){console.log("普通敌人发动攻击",e.getBaseAttackDamage()),e.gameController.enemyAttacked(e.getBaseAttackDamage())})),r.delay((1-e.animSpeedMulOffset)*i),r.call((function(){t()})),r.start()}))}},{key:"getLookAtAngle",value:function(e,t){var n=v(e).subtract(t).normalize(),o=new C;return C.fromViewUp(o,n,k.UP),o}},{key:"forzenSelf",value:function(){if(this.currentMoveTw){this.currentMoveTw.stop();var e=this.rootNode.getComponent(p).getState(this.currentBoneAnimName);e&&e.pause()}}},{key:"shootOneBossBullet",value:function(){var e=this;return new Promise((function(t,n){e.currentBoneAnimName="骨架|AttackAnim";var o=e.rootNode.getComponent(p);o.play(e.currentBoneAnimName);var a=o.getState(e.currentBoneAnimName).length,i=new g(e.node);i.delay(e.animSpeedMulOffset*a),i.call((function(){e.enemyCtl.bossShootOneEgg(e.node)})),i.delay((1-e.animSpeedMulOffset)*a),i.call((function(){e.currentBoneAnimName="骨架|MoveAnim",o.play(e.currentBoneAnimName),t&&t()})),i.start()}))}},{key:"onLoad",value:function(){var e=this;this.state.addState("enter-attack-state",(function(){console.log("移动结束"),e.currentBoneAnimName="骨架|AttackAnim";var t=e.rootNode.getComponent(p);t.play(e.currentBoneAnimName);var n=t.getState(e.currentBoneAnimName).length;e.scheduleOnce((function(){e.enemyCtl.enemyAttacked()}),e.animSpeedMulOffset*n)})),this.state.addState("over",(function(){e.enemyCtl.removeEnemyInList(e.node),e.node.destroy()})),this.state.addState("to-dead",(function(){e.enemyCtl.pushOneEnemyDeadData(new P(e.objectType,e.getCurrentGoldCount())),e.currentMoveTw&&e.currentMoveTw.stop();var t=new g(e.rootNode);t.by(.1,{scale:v(1,1,1)}),t.call((function(){e.rootNode.active=!1,e.caidaiEffect.eulerAngles=v(0,360*Math.random(),0),v(e.node.position).subtract(v(0,0,0)).length()<18&&(e.caidaiEffect.active=!0),e.gameController.showAddGoldAnimEffect(e.getCurrentGoldCount(),v(e.node.position.x,0,e.node.position.z))})),t.delay(1),t.call((function(){e.state.setState("over")})),t.start()})),this.state.addState("run",(function(){var t=e.rootNode.getComponent(p);t&&(e.currentBoneAnimName="骨架|MoveAnim",t.play(e.currentBoneAnimName))})),this.node.on("be-attacked",(function(t){if("run"===e.state.getState()){e.beAttackedCb=t.cb,e.currentHealthCount-=t.baseAttackNum;var n=t.baseGasNum;e.currentGasNum+=n;var o=e.currentGasNum/e.baseGasNum,a=new g(e.node);a.to(.2,{scale:v(o,o,o)}),a.start(),e.currentHealthCount<=0&&(e.currentHealthCount=0,e.beAttackedCb&&e.beAttackedCb(!0),e.state.setState("to-dead")),A(e.healthBar)&&(e.healthBar.getComponent(M).progress=e.currentHealthCount/e.healthCount)}}))}},{key:"start",value:function(){}},{key:"getIsDead",value:function(){return"over"===this.state.getState()||"to-dead"===this.state.getState()}},{key:"getIsCanLock",value:function(){return this.currentbeLockedCount<this.beLockedMaxNum}},{key:"setBeLocked",value:function(e){this.currentbeLockedCount++}},{key:"unSetBeLocked",value:function(e){this.currentbeLockedCount--}},{key:"update",value:function(e){}},{key:"playBossEnterAnim",value:function(){var e=this;return new Promise((function(t,n){for(var o=e.rootNode.getComponent(p),a=o.clips,i=void 0,r=0;r<a.length;r++){var s=a[r];"boss-show"===s.name&&(i=s)}i?(o.play("boss-show"),e.scheduleOnce((function(){t()}),i.length)):(o.play("骨架|MoveAnim"),e.scheduleOnce((function(){t()}),1))}))}},{key:"onDestroy",value:function(){this.enemyCtl.node.off("frozen-all-enemy",this.forzenSelf,this)}}]),t}(B)).prototype,"caidaiEffect",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=E))||T)),h._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyBullet.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/State.js","../BaseObject.js","../GameController.js"],(function(t,e){var i,n,a,o,c,s,r,l,d,u,f,h,p,y,v,m,g,E,_,S,k,B,P,b;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inherits,a=t.classCallCheck,o=t.possibleConstructorReturn,c=t.getPrototypeOf,s=t.initializerDefineProperty,r=t.assertThisInitialized,l=t.createClass,d=t.get},function(t){u=t.cclegacy,f=t._decorator,h=t.Node,p=t.Tween,y=t.v3},function(t){v=t.State},function(t){m=t.BaseObject},function(t){g=t.GameController}],execute:function(){u._RF.push({},"17cf4gdnXZPP6GfTwWTkX9d","EnemyBullet",void 0),P=f.ccclass,b=f.property,t("EnemyBullet",(E=P("EnemyBullet"),_=b({type:h}),E((B=i((k=function(t){function e(){var t,i;a(this,e);for(var n=arguments.length,l=new Array(n),d=0;d<n;d++)l[d]=arguments[d];return(i=o(this,(t=c(e)).call.apply(t,[this].concat(l)))).state=new v,i.accY=g.accY,i.currentSpeed=0,i.endPos=null,s(i,"caidaiEffect",B,r(i)),i}return n(e,t),l(e,[{key:"start",value:function(){var t=this;this.state.addState("move-end",(function(){var e=new p(t.rootNode);e.to(.1,{scale:y(2,2,2)}),e.hide(),e.call((function(){t.gameController.enemyAttacked(t.getBaseAttackDamage()),t.caidaiEffect.active=!0})),e.delay(.8+.5*Math.random()),e.call((function(){t.caidaiEffect.active=!1,t.node.destroy()})),e.start()}))}},{key:"init",value:function(t,i,n){d(c(e.prototype),"init",this).call(this,t,i),this.endPos=n,this.caidaiEffect.eulerAngles=y(0,360*Math.random(),0);var a=.2*Math.random()+.8;this.caidaiEffect.scale=y(a,a,a),this.state.setState("run")}},{key:"update",value:function(t){"run"===this.state.getState()&&(this.currentSpeed+=this.accY,this.node.position=y(this.node.position).add(y(0,this.currentSpeed*t,0)),this.node.position.y-this.endPos.y<1&&(console.log("停止"),this.state.setState("move-end")))}}]),e}(m)).prototype,"caidaiEffect",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=k))||S)),u._RF.pop()}}}));

System.register("chunks:///EnemyController.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./GroundTiled/GroundTiled.js","./GroundMapCtl.js","./GameController.js","./Enemys/EnemyBase.js","./Enemys/EnemyBullet.js"],(function(e,t){var n,o,i,r,a,s,l,u,d,m,c,y,h,v,p,g,f,C,E,b,L,w,D,P,N,_,k,x,A,W,B,T,I,O,z,G,R,j,M,S,V,F,H,J;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_temp:void 0}),{setters:[function(e){n=e.classCallCheck,o=e.applyDecoratedDescriptor,i=e.inherits,r=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,l=e.assertThisInitialized,u=e.createClass},function(e){d=e.cclegacy,m=e._decorator,c=e.JsonAsset,y=e.Prefab,h=e.Node,v=e.v3,p=e.Tween,g=e.CameraComponent,f=e.instantiate,C=e.Vec2,E=e.Component},function(e){b=e.State},function(e){L=e.GroundTiled},function(e){w=e.GroundMapCtl},function(e){D=e.GameController},function(e){P=e.EnemyBase},function(e){N=e.EnemyBullet}],execute:function(){d._RF.push({},"9eb73bkCLlAgoJJ0ubFFvcV","EnemyController",void 0),H=m.ccclass,J=m.property,e("DeadEnemyObj",(function e(t,o){n(this,e),this.enemyType="",this.dropGoldCount=0,this.enemyType=t,this.dropGoldCount=o})),e("EnemyController",(_=H("EnemyController"),k=J({type:c}),x=J({type:y}),A=J({type:h}),W=J({type:h}),B=J({type:h}),T=J({type:y}),I=J({type:y}),_((G=o((z=function(e){function t(){var e,o;n(this,t);for(var i=arguments.length,u=new Array(i),d=0;d<i;d++)u[d]=arguments[d];return o=r(this,(e=a(t)).call.apply(e,[this].concat(u))),s(o,"gameConfigRes",G,l(o)),s(o,"enemysPrefabList",R,l(o)),o.gameConfig=null,o.currentWaveIndex=0,o.waveData=null,o.state=new b,o.addEnemyDuraction=1,o.enemyNodeList=[],o.currentRandomEnemyTypeList=[],s(o,"startPosNodeList",j,l(o)),o.endPos=null,s(o,"enemyHealthBarCtlNode",M,l(o)),s(o,"cameraNode",S,l(o)),s(o,"bosssPrefabList",V,l(o)),s(o,"enemyBulletPrefabList",F,l(o)),o.gameController=null,o.allWaveAddOverCb=null,o.allEnemyDeadCb=null,o.currentLevelDeadEnemyDataList=[],o}return i(t,e),u(t,[{key:"onLoad",value:function(){var e=this;this.node.on("destroy-all-enemy",(function(t){for(var n=0,o=0;o<e.enemyNodeList.length;o++){var i=e.enemyNodeList[o];n+=i.getComponent(P).getCurrentGoldCount(),i.destroy()}e.enemyNodeList=[],t&&t(n)})),this.node.on("init-level-label",(function(){e.node.emit("refer-current-wave-level",e.gameController.getCurrentLevelNum(),0)}))}},{key:"start",value:function(){var e=this;this.gameConfig=this.gameConfigRes.json,this.gameController=this.node.getComponent(D),this.endPos=v(0,0,0),this.state.addState("enter-next-wave",(function(){e.currentWaveIndex!=e.waveData.EnemyType.length&&(e.currentRandomEnemyTypeList=e.waveData.EnemyType[e.currentWaveIndex],e.addEnemyDuraction=e.waveData.AddEnemyDuraction[e.currentWaveIndex],e.node.emit("refer-current-wave-level",e.gameController.getCurrentLevelNum(),e.currentWaveIndex),e.currentWaveIndex===e.waveData.EnemyType.length-1?e.allWaveAddOverCb&&(e.allWaveAddOverCb(),e.allWaveAddOverCb=null,e.addOneBossEnemy()):e.addOneWaveEnemy().then((function(){e.currentWaveIndex++,e.scheduleOnce((function(){e.state.setState("enter-next-wave")}),e.addEnemyDuraction)})))}))}},{key:"playBossEnterAnim",value:function(e){var t=this;return new Promise((function(n,o){var i=e.getComponent(P);i?i.playBossEnterAnim().then((function(){n()})):t.scheduleOnce((function(){n()}),1)}))}},{key:"startGame",value:function(){var e=this;this.currentLevelDeadEnemyDataList=[],this.currentWaveIndex=0,this.waveData=this.gameConfig["Level_"+this.gameController.getCurrentLevelNum()],this.state.setState("enter-next-wave"),Promise.all([new Promise((function(t,n){e.allWaveAddOverCb=t})),new Promise((function(t,n){e.allEnemyDeadCb=t}))]).then((function(){console.log("游戏胜利"),e.gameController.gameWin(e.currentLevelDeadEnemyDataList)}))}},{key:"continueGame",value:function(){var e=this;this.currentWaveIndex--,this.waveData=this.gameConfig["Level_"+this.gameController.getCurrentLevelNum()],this.state.setState("enter-next-wave"),Promise.all([new Promise((function(t,n){e.allWaveAddOverCb=t})),new Promise((function(t,n){e.allEnemyDeadCb=t}))]).then((function(){console.log("游戏胜利"),e.gameController.gameWin(e.currentLevelDeadEnemyDataList)}))}},{key:"pushOneEnemyDeadData",value:function(e){console.log("push one enemy dead data",e),this.currentLevelDeadEnemyDataList.push(e)}},{key:"showCameraBackAnim",value:function(){var e=this;return new Promise((function(t,n){var o=new p(e.cameraNode);o.to(.5,{position:v(30,42,30),eulerAngles:v(-45,45,0)}),o.call((function(){t()})),o.start(),new p(e.cameraNode.getComponent(g)).to(.5,{orthoHeight:22}).start()}))}},{key:"addOneBossEnemy",value:function(){var e=this;console.log("增加一个boss");var t=this.node.getComponent(w).getInEdageIndexList(),n=t[Math.round(Math.random()*(t.length-1))],o=this.node.getComponent(w).getMapNodeList().getValue(n.x,n.y),i=this.currentRandomEnemyTypeList[0].type,r=f(this.bosssPrefabList[i]);return r.parent=this.node,r.position=v(o.position.x,0,o.position.z),r.active=!1,r.getComponent(P).init(this.gameConfig,this.gameController,o.position,this.endPos),this.enemyNodeList.push(r),new Promise((function(e,t){e()})).then((function(){})).then((function(){return e.playBossEnterAnim(r)})).then((function(){})).then((function(){e.node.emit("enter-continue-play-move-anim")})).then((function(){r.getComponent(P).showEnemyEnterAnim(1,e,n,new C(5,5))}))}},{key:"addOneWaveEnemy",value:function(){for(var e=[],t=0,n=this.node.getComponent(w).getInEdageIndexList(),o=this.node.getComponent(w).getMapNodeList(),i=Math.round(Math.random()*(n.length-1)),r=0,a=0,s=0,l=0;l<this.currentRandomEnemyTypeList.length;l++)s+=this.currentRandomEnemyTypeList[l].count;if(!(s>=n.length)){for(;t<s;){i>=n.length&&(i=0);var u=n[i],d=o.getValue(u.x,u.y);if(d&&d.getComponent(L)){if(d.getComponent(L).getIsVoid()){var m=this.currentRandomEnemyTypeList[r],c=m.type;a>=m.count&&(a=0,r++);var y=f(this.enemysPrefabList[c]);y.parent=this.node,y.position=v(d.position.x,0,d.position.z),y.active=!1,y.getComponent(P).init(this.gameConfig,this.gameController,d.position,this.endPos),e.push(y.getComponent(P).showEnemyEnterAnim(t,this,u,new C(5,5))),t++,this.enemyNodeList.push(y)}i=Math.round(Math.random()*(n.length-1))}else t++}return Promise.all(e)}console.error("数据错误")}},{key:"removeEnemyInList",value:function(e){for(var t=0;t<this.enemyNodeList.length;t++){this.enemyNodeList[t].uuid===e.uuid&&this.enemyNodeList.splice(t,1)}0===this.enemyNodeList.length&&this.allEnemyDeadCb&&(this.allEnemyDeadCb(),this.allEnemyDeadCb=null)}},{key:"getCurrentEnemyNodeList",value:function(){return this.enemyNodeList}},{key:"enemyAttacked",value:function(e){this.gameController.getComponent(D).enemyAttacked(e)}},{key:"frozenAllEnemy",value:function(){this.node.emit("frozen-all-enemy")}},{key:"bossShootOneEgg",value:function(e){var t=e.getComponent(P);if(t){var n=t.getEnemyBulletType(),o=f(this.enemyBulletPrefabList[n]);o.parent=this.node,o.position=e.position,o.getComponent(N).init(this.gameController.getGameConfig().json,this.gameController,this.endPos)}}},{key:"getDeadEnemyData",value:function(){return this.currentLevelDeadEnemyDataList}}]),t}(E)).prototype,"gameConfigRes",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(z.prototype,"enemysPrefabList",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=o(z.prototype,"startPosNodeList",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=o(z.prototype,"enemyHealthBarCtlNode",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=o(z.prototype,"cameraNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(z.prototype,"bosssPrefabList",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=o(z.prototype,"enemyBulletPrefabList",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=z))||O)),d._RF.pop()}}}));

System.register("chunks:///Enemys/EnemyCube.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./EnemyBase.js"],(function(e,n){var t,s,c,r,u,i,o,a,l,p;return e({_dec:void 0,_class:void 0}),{setters:[function(e){t=e.inherits,s=e.classCallCheck,c=e.possibleConstructorReturn,r=e.getPrototypeOf},function(e){u=e.cclegacy,i=e._decorator},function(e){o=e.EnemyBase}],execute:function(){u._RF.push({},"ac439Ca0GFJGrdHaYw+IQip","EnemyCube",void 0),p=i.ccclass,i.property,e("EnemyCube",(a=p("EnemCube"),a(l=function(e){function n(){return s(this,n),c(this,r(n).apply(this,arguments))}return t(n,e),n}(o))||l)),u._RF.pop()}}}));

System.register("chunks:///Enemys/WinGold.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,o,s,c,r,i,l,u,a,p,d;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,o=t.createClass,s=t.classCallCheck,c=t.possibleConstructorReturn,r=t.getPrototypeOf},function(t){i=t.cclegacy,l=t._decorator,u=t.Component}],execute:function(){i._RF.push({},"cf9deP2StlNm75zKMIn6aZo","WinGold",void 0),d=l.ccclass,l.property,t("WinGold",(a=d("WinGold"),a(p=function(t){function e(){return s(this,e),c(this,r(e).apply(this,arguments))}return n(e,t),o(e,[{key:"start",value:function(){}}]),e}(u))||p)),i._RF.pop()}}}));

System.register("chunks:///SkillComponent/CrazyRotateSkill.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js","../Towers/TowerBase.js"],(function(t,e){var o,n,a,r,s,l,i,c,u,d,h,p,C,f,g;return t({_dec:void 0,_class:void 0}),{setters:[function(t){o=t.inherits,n=t.createClass,a=t.classCallCheck,r=t.possibleConstructorReturn,s=t.getPrototypeOf},function(t){l=t.cclegacy,i=t._decorator,c=t.Tween,u=t.v3,d=t.v2},function(t){h=t.BaseObject},function(t){p=t.TowerBase}],execute:function(){l._RF.push({},"621d4adyJFG1KkUA3lbByt0","CrazyRotateSkill",void 0),g=i.ccclass,i.property,t("CrazyRotateSkill",(C=g("CrazyRotateSkill"),C(f=function(t){function e(){return a(this,e),r(this,s(e).apply(this,arguments))}return o(e,t),n(e,[{key:"onLoad",value:function(){var t=this;this.node.on("init",(function(e,o){t.init(e,o)}))}},{key:"start",value:function(){var t=this,e=function(){var e=t.node.getComponent(p).bulletStartPos,o=u(e.worldPosition).subtract(t.node.position),n=t.getCurrentAttackNum();t.node.getComponent(p).shootOneBullet(t.baseAttackRate+t.node.getComponent(h).baseAttackRate,d(o.x,o.z),n)};this.node.on("release-skill",(function(o){var n=t.getCurrentShootRate()+t.node.getComponent(p).getCurrentShootRate();console.log("shoot rate",n);var a=1/n;t.schedule(e,a);var r=t.getCurrentSkillRotateAngle(),s=r/t.rotateSpeed,l=new c(t.node),i=Math.random()-.5;l.by(s,{eulerAngles:u(0,r*(i/Math.abs(i)),0)}),l.call((function(){t.unschedule(e),o&&o()})),l.start()}))}}]),e}(h))||f)),l._RF.pop()}}}));

System.register("chunks:///UI/AStartFindPath.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../util/My2Array.js"],(function(t,e){var o,n,r,i,s,a,h,u,l,c,d,p,v,y,f,g,m,L,C,P,N,M,x,V,b,k,A,T;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inherits,r=t.classCallCheck,i=t.possibleConstructorReturn,s=t.getPrototypeOf,a=t.initializerDefineProperty,h=t.assertThisInitialized,u=t.createClass},function(t){l=t.cclegacy,c=t._decorator,d=t.Node,p=t.Color,v=t.instantiate,y=t.v3,f=t.SpriteComponent,g=t.isValid,m=t.UITransformComponent,L=t.v2,C=t.Component},function(t){P=t.default}],execute:function(){l._RF.push({},"aee76uGSzxFLKJAvvNlf0aC","AStartFindPath",void 0),k=c.ccclass,A=c.property,T=function(){function t(e,o,n){r(this,t),this.x=0,this.y=0,this.node=null,this.parentNode=null,this.fValue=0,this.gValue=0,this.hValue=0,this.x=e,this.y=o,this.node=n}return u(t,[{key:"setParentNode",value:function(t){this.parentNode=t}}]),t}(),t("AStartFindPath",(N=k("AStartFindPath"),M=A({type:d}),N((b=o((V=function(t){function e(){var t,o;r(this,e);for(var n=arguments.length,u=new Array(n),l=0;l<n;l++)u[l]=arguments[l];return o=i(this,(t=s(e)).call.apply(t,[this].concat(u))),a(o,"pointNode",b,h(o)),o.my2dArray=null,o.obsColor=p.RED,o.startColor=p.BLUE,o.endColor=p.GREEN,o.currentTouchNode=null,o.openList=[],o.closeList=[],o.startObj=null,o.size=30,o.currentPathList=[],o.checkPointList=[],o}return n(e,t),u(e,[{key:"start",value:function(){var t=this,e=this.size,o=new P;this.my2dArray=o;for(var n=0;n<e;n++){for(var r=[],i=0;i<e;i++){var s=v(this.pointNode);s.active=!0,s.parent=this.node,s.position=y(-.5*(e-1)*22+22*i,-.5*(e-1)*22+22*n,0),r.push(new T(i,n,s))}o.pushList(r)}for(var a=0;a<30;a++)this.randomObs(e);var h=this.getRandomPoint(e);h.node.getComponent(f).color=this.startColor,this.startObj=h,this.node.on(d.EventType.TOUCH_START,(function(o){g(t.currentTouchNode)&&(t.currentTouchNode.node.getComponent(f).color=p.WHITE);var n=o.getUILocation();console.log("touch pos",n);for(var r=0;r<e;r++)for(var i=0;i<e;i++){var s=t.my2dArray.getValue(i,r).node;s.getComponent(m).getBoundingBoxToWorld().contains(n)&&(s.getComponent(f).color=t.endColor,t.currentTouchNode=t.my2dArray.getValue(i,r))}t.currentTouchNode&&(t.openList=[],t.closeList=[],t.processFindPath())}))}},{key:"processFValue",value:function(t,e){var o,n=null;return n=e||t.parentNode,o=t.parentNode.gValue+this.getDistance(t,n),t.gValue=o,t.hValue=this.getDistance(t,this.currentTouchNode),t.gValue+t.hValue}},{key:"getDistance",value:function(t,e){var o=Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2);return Math.sqrt(o)}},{key:"getNearPointObj",value:function(t){for(var e=t.x,o=t.y,n=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],r=[],i=0;i<n.length;i++){var s=e+n[i][0],a=o+n[i][1],h=this.my2dArray.getValue(s,a);h&&!h.node.getComponent(f).color.equals(this.obsColor)&&r.push(h)}return r}},{key:"processFindPath",value:function(){for(this.openList.push(this.startObj);this.openList.length>0;){var t=this.getFvalueMinNode();if(console.log("current obj",t),t.x===this.currentTouchNode.x&&t.y===this.currentTouchNode.y){if(console.log("找到了终点"),this.checkPointList.length>0)for(var e=0;e<this.checkPointList.length;e++){this.checkPointList[e].node.getComponent(f).color=p.WHITE}if(this.currentPathList.length>0)for(var o=0;o<this.currentPathList.length;o++){this.currentPathList[o].node.getComponent(f).color=p.WHITE}for(var n=[];t.x!==this.startObj.x||t.y!==this.startObj.y;)n.push(t.parentNode),(t=t.parentNode).node.getComponent(f).color=p.BLACK;return n.splice(n.length-1,1),void(this.currentPathList=n)}this.closeList.push(t);for(var r=this.getNearPointObj(t),i=0;i<r.length;i++){var s=r[i];if(!this.checkIsInCloseList(s))if(this.checkisInOpenList(s))this.processFValue(s,t)<s.fValue&&(s.setParentNode(t),s.fValue=this.processFValue(s));else s.setParentNode(t),s.fValue=this.processFValue(s),s.node.getComponent(f).color=p.GRAY,this.checkPointList.push(s),this.openList.push(s)}}}},{key:"checkisInOpenList",value:function(t){for(var e=0;e<this.openList.length;e++){var o=this.openList[e];if(o.x===t.x&&o.y===t.y)return!0}return!1}},{key:"checkIsInCloseList",value:function(t){for(var e=0;e<this.closeList.length;e++){var o=this.closeList[e];if(o.x===t.x&&o.y===t.y)return!0}return!1}},{key:"getFvalueMinNode",value:function(){for(var t=Number.MAX_VALUE,e=0,o=0;o<this.openList.length;o++){var n=this.openList[o];n.fValue<t&&(t=n.fValue,e=o)}return this.openList.splice(e,1)[0]}},{key:"getRandomPoint",value:function(t){var e=L(Math.round(Math.random()*(t-1)),Math.round(Math.random()*(t-1)));return this.my2dArray.getValue(e.x,e.y)}},{key:"randomObs",value:function(t){var e={x:Math.round(Math.random()*t-10)+5,y:Math.round(Math.random()*t-10)+5},o=L(0,1),n=[2*Math.PI*45/360,.5*Math.PI,Math.PI];o.rotate(n[Math.round(Math.random()*(n.length-1))]).normalize(),console.log("dir",o),o.x=Math.round(Math.abs(o.x))*Math.abs(o.x)/o.x,o.y=Math.round(Math.abs(o.y))*Math.abs(o.y)/o.y,console.log("dir",o);for(var r=0;r<4;r++){var i=L(o).multiplyScalar(r),s=L(e.x,e.y).add(i),a=this.my2dArray.getValue(s.x,s.y);a&&(a.node.getComponent(f).color=p.RED)}}}]),e}(C)).prototype,"pointNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=V))||x)),l._RF.pop()}}}));

System.register("chunks:///UI/EnemyHealthBarCtl.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var n,r,a,o,i,l,c,u,s,p,d,y,f,m,v,h,_,C,b,B,g,H;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inherits,a=e.classCallCheck,o=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.createClass},function(e){s=e.cclegacy,p=e._decorator,d=e.Prefab,y=e.CameraComponent,f=e.Component}],execute:function(){s._RF.push({},"6dc3cXIfPpCN6tR8iLaqvBX","EnemyHealthBarCtl",void 0),g=p.ccclass,H=p.property,e("EnemyHealthBarCtl",(m=g("EnemyHealthBarCtl"),v=H({type:d}),h=H({type:y}),m((b=n((C=function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,u=new Array(r),s=0;s<r;s++)u[s]=arguments[s];return n=o(this,(e=i(t)).call.apply(e,[this].concat(u))),l(n,"enemyHealthBarPrefab",b,c(n)),l(n,"cameraNode",B,c(n)),n}return r(t,e),u(t,[{key:"onLoad",value:function(){this.node.on("add-one-enemy",(function(e){})),this.node.on("remove-one-enemy",(function(){}))}},{key:"start",value:function(){}},{key:"update",value:function(e){}}]),t}(f)).prototype,"enemyHealthBarPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(C.prototype,"cameraNode",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=C))||_)),s._RF.pop()}}}));

System.register("chunks:///UI/TouchScreenLayer.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../GameController.js"],(function(e,t){var n,o,r,a,c,s,l,i,u,p,y,m,h,C,d,v;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){n=e.inherits,o=e.classCallCheck,r=e.possibleConstructorReturn,a=e.getPrototypeOf,c=e.createClass},function(e){s=e.cclegacy,l=e._decorator,i=e.find,u=e.CameraComponent,p=e.Node,y=e.PhysicsSystem,m=e.Component},function(e){h=e.GameController}],execute:function(){s._RF.push({},"5c5e3+MsMZDYpvgjM8gmHSO","TouchScreenLayer",void 0),v=l.ccclass,l.property,e("TouchScreenLayer",(C=v("TouchScreenLayer"),C(d=function(e){function t(){var e,n;o(this,t);for(var c=arguments.length,s=new Array(c),l=0;l<c;l++)s[l]=arguments[l];return(n=r(this,(e=a(t)).call.apply(e,[this].concat(s)))).cameraNode=null,n.gameCtl=null,n}return n(t,e),c(t,[{key:"start",value:function(){var e=this;this.cameraNode=i("Camera").getComponent(u),this.gameCtl=i("GameController"),this.node.on(p.EventType.TOUCH_END,(function(t){var n=t.getLocation(),o=e.cameraNode.getComponent(u).screenPointToRay(n.x,n.y);y.instance.raycast(o,1,1e4,!0),y.instance.raycastResults&&i("GameController").getComponent(h).playerTouch3dObject(y.instance.raycastResults)}))}},{key:"update",value:function(e){}}]),t}(m))||d)),s._RF.pop()}}}));

System.register("chunks:///UI/WeaponUpdateCellPrefab.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../BaseObject.js"],(function(e,t){var o,r,a,i,n,l,u,p,c,s,d,v,h,g,m,b,f,y,C,L,_,F,w,B,D,G,I,S,N,U,k,z,A,R,W,x,P,T,j,O;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,r=e.inherits,a=e.classCallCheck,i=e.possibleConstructorReturn,n=e.getPrototypeOf,l=e.initializerDefineProperty,u=e.assertThisInitialized,p=e.createClass,c=e.get},function(e){s=e.cclegacy,d=e._decorator,v=e.Node,h=e.SpriteFrame,g=e.loader,m=e.SpriteComponent,b=e.LabelComponent},function(e){f=e.BaseObject}],execute:function(){s._RF.push({},"a6c70AbEx1NLpumxgHfrO6e","WeaponUpdateCellPrefab",void 0),j=d.ccclass,O=d.property,e("WeaponUpdateCellPrefab",(y=j("WeaponUpdateCellPrefab"),C=O({type:v}),L=O({type:v}),_=O({type:v}),F=O({type:v}),w=O({type:h}),B=O({type:h}),D=O({type:v}),G=O({type:h}),I=O({type:h}),y((U=o((N=function(e){function t(){var e,o;a(this,t);for(var r=arguments.length,p=new Array(r),c=0;c<r;c++)p[c]=arguments[c];return o=i(this,(e=n(t)).call.apply(e,[this].concat(p))),l(o,"currentDamageLabel",U,u(o)),l(o,"addDamageLabel",k,u(o)),l(o,"costGoldLabel",z,u(o)),l(o,"weaponIconNode",A,u(o)),l(o,"updateButtonSpriteFrameGray",R,u(o)),l(o,"updateButtonSpriteFrameGreen",W,u(o)),l(o,"updateButtonNode",x,u(o)),l(o,"activeButtonSpriteFrameGray",P,u(o)),l(o,"activeButtonSpriteFrameLight",T,u(o)),o.currentChooseRate=0,o}return r(t,e),p(t,[{key:"start",value:function(){}},{key:"updateChooseRate",value:function(e){this.currentChooseRate=e,this.referUILabel()}},{key:"setData",value:function(e,o,r){var a=this;console.log("初始化数据",e),o.node.on("update-gold-label",(function(){a.referUILabel()}));var i=e.TowerType;this.objectType=i,c(n(t.prototype),"init",this).call(this,r,o),e.isActive&&this.showWeaponIcon(),this.referUILabel()}},{key:"showWeaponIcon",value:function(){var e=this,t=this.getIconSprteFrame();g.loadRes(t+"/spriteFrame",h,(function(t,o){t||(e.weaponIconNode.getComponent(m).spriteFrame=o),console.log("err",t)}))}},{key:"referUILabel",value:function(){var e=this.getWeaponIsActive(),t=this.gameController.playerData.getCurrentGoldCount();if(!e){var o=this.gameController.playerData.getFirstNeedToActiveTowerIndex();console.log("first need active tower",o);var r=this.getActiveCostGoldCount();return this.costGoldLabel.getComponent(b).string=r+"",void(o===this.towerIndexType&&r<=t?this.updateButtonNode.getComponent(m).spriteFrame=this.activeButtonSpriteFrameLight:this.updateButtonNode.getComponent(m).spriteFrame=this.activeButtonSpriteFrameGray)}var a=this.getUpdateLocalLevelCost();this.currentDamageLabel.getComponent(b).string=this.getLocalDamageNum()+"",this.costGoldLabel.getComponent(b).string=a+"",this.addDamageLabel.getComponent(b).string="+"+this.getNextLocallevelAddDamage(),this.updateButtonNode.getComponent(m).spriteFrame=t<a?this.updateButtonSpriteFrameGray:this.updateButtonSpriteFrameGreen}},{key:"onButtonClick",value:function(e,t){switch(t){case"update-button":console.log("升级按钮");var o=this.getWeaponIsActive(),r=this.gameController.playerData.getCurrentGoldCount();if(o){var a=this.getUpdateLocalLevelCost();a<=r&&(this.updateLocalLevel(this.currentChooseRate),this.gameController.playerData.addGoldCount(-a),this.referUILabel())}else{var i=this.getActiveCostGoldCount();i<=r&&(this.activeWeapon(),this.gameController.playerData.addGoldCount(-i),this.referUILabel(),this.showWeaponIcon())}}}},{key:"getUpdateLocalLevelCost",value:function(){var e=c(n(t.prototype),"getUpdateLocalLevelCost",this).call(this);return e*=this.currentChooseRate}},{key:"getNextLocallevelAddDamage",value:function(){var e=c(n(t.prototype),"getNextLocallevelAddDamage",this).call(this);return e*=this.currentChooseRate}}]),t}(f)).prototype,"currentDamageLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=o(N.prototype,"addDamageLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=o(N.prototype,"costGoldLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=o(N.prototype,"weaponIconNode",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=o(N.prototype,"updateButtonSpriteFrameGray",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=o(N.prototype,"updateButtonSpriteFrameGreen",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(N.prototype,"updateButtonNode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=o(N.prototype,"activeButtonSpriteFrameGray",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=o(N.prototype,"activeButtonSpriteFrameLight",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=N))||S)),s._RF.pop()}}}));

System.register("chunks:///UI/道具/KuangBaoSkill.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../BaseObject.js"],(function(t,e){var n,c,s,i,o,u,l,r,a,p;return t({_dec:void 0,_class:void 0}),{setters:[function(t){n=t.inherits,c=t.classCallCheck,s=t.possibleConstructorReturn,i=t.getPrototypeOf},function(t){o=t.cclegacy,u=t._decorator},function(t){l=t.BaseObject}],execute:function(){o._RF.push({},"137d7fAtX1CO423/GncRui3","KuangBaoSkill",void 0),p=u.ccclass,u.property,t("KuangBaoSkill",(r=p("KuangBaoSkill"),r(a=function(t){function e(){return c(this,e),s(this,i(e).apply(this,arguments))}return n(e,t),e}(l))||a)),o._RF.pop()}}}));

System.register("chunks:///util/AdsController.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var l,n,c;return{setters:[function(e){l=e.createClass,n=e.classCallCheck},function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"00d1d2cCXdJEoYd5l9/lwHa","AdsController",void 0),e("AdsController",function(){function e(){n(this,e)}return l(e,[{key:"watchVideoAds",value:function(){}}]),e}()),c._RF.pop()}}}));

System.register("chunks:///util/Besize.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var i,s,r,l,a;return{setters:[function(t){i=t.createClass,s=t.classCallCheck},function(t){r=t.cclegacy,l=t._decorator,a=t.v3}],execute:function(){r._RF.push({},"b99e6kbi3NK3Y1RRPBDBTEz","Besize",void 0),l.ccclass,l.property,t("Besize",function(){function t(e,i,r){s(this,t),this.startPos=void 0,this.middlePos=void 0,this.endPos=void 0,this.startPos=e,this.middlePos=i,this.endPos=r}return i(t,[{key:"CalculateCubicBezierPoint",value:function(t,e,i,s){var r=1-t,l=t*t,o=r*r,c=a(e).multiplyScalar(o);return c=a(c).add(a(i).multiplyScalar(2*r*t)),c=a(c).add(s.multiplyScalar(l))}},{key:"getBesizePointList",value:function(t){for(var e=[],i=0;i<t;i++){var s=i/t,r=this.CalculateCubicBezierPoint(s,this.startPos,this.middlePos,this.endPos);e.push(r)}return e}}]),t}()),r._RF.pop()}}}));

System.register("chunks:///WeaponInfoCtl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./util/State.js","./GameController.js","./UI/WeaponUpdateCellPrefab.js"],(function(e,t){var o,n,r,a,i,l,d,u,s,c,p,f,h,C,g,v,b,w,m,y,I,R,_,B,N,H,k,S,L,P,W,z,D,G,F,A,U,j,T,O,x,V,q,E,J,K,M,Q,X,Y,Z,$;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inherits,r=e.classCallCheck,a=e.possibleConstructorReturn,i=e.getPrototypeOf,l=e.initializerDefineProperty,d=e.assertThisInitialized,u=e.createClass},function(e){s=e.cclegacy,c=e._decorator,p=e.Node,f=e.Prefab,h=e.SpriteFrame,C=e.v3,g=e.LabelComponent,v=e.SpriteComponent,b=e.instantiate,w=e.view,m=e.Tween,y=e.Component},function(e){I=e.State},function(e){R=e.GameController},function(e){_=e.WeaponUpdateCellPrefab}],execute:function(){s._RF.push({},"4185fepR9NDl6TuAmrhxLTe","WeaponInfoCtl",void 0),Z=c.ccclass,$=c.property,e("WeaponInfoCtl",(B=Z("WeaponInfoCtl"),N=$({type:p}),H=$({type:p}),k=$({type:p}),S=$({type:R}),L=$({type:f}),P=$({type:p}),W=$({type:p}),z=$({type:p}),D=$({type:h}),G=$({type:h}),F=$({type:p}),A=$({type:p}),B((T=o((j=function(e){function t(){var e,o;r(this,t);for(var n=arguments.length,u=new Array(n),s=0;s<n;s++)u[s]=arguments[s];return o=a(this,(e=i(t)).call.apply(e,[this].concat(u))),l(o,"blockBgNode",T,d(o)),l(o,"weaponInfoNode",O,d(o)),l(o,"weaponInfoButton",x,d(o)),o.state=new I,l(o,"gameController",V,d(o)),l(o,"updateWeaponInfoCellPrefab",q,d(o)),l(o,"weaponCellParentNode",E,d(o)),l(o,"currentInitRedHeartCountLabel",J,d(o)),l(o,"addRedHeartCostGoldCount",K,d(o)),l(o,"addRedHeartButtonSpriteFrameLight",M,d(o)),l(o,"addRedHeartButtonSpriteFrameGray",Q,d(o)),l(o,"addRedHeartButton",X,d(o)),l(o,"chooseAddRedHeartCountLabel",Y,d(o)),o.weaponIndoCellNodeList=[],o.currentChooseRate=0,o}return n(t,e),u(t,[{key:"start",value:function(){var e=this;this.weaponInfoNode.position=C(.5*this.weaponInfoNode.width,0,0),this.state.setState("close"),this.state.addState("play-open-anim",(function(){console.log("播放武器信息ui打开的动画"),e.hideButton().then((function(){return e.showWeaponInfoNode()})).then((function(){e.showBlockBgNode()})).then((function(){e.state.setState("open")}))})),this.state.addState("play-close-anim",(function(){e.hideBlockBgNode().then((function(){return e.hideWeaponInfoNode()})).then((function(){return e.showWeaponInfoButtonn()})).then((function(){e.state.setState("close")}))})),this.node.on("close-weapon-info-layer",(function(){"open"===e.state.getState()&&e.state.setState("play-close-anim")})),this.node.on("refer-choose-rate-cost",(function(t){console.log("刷新当前选择的倍数",t),console.log("weapon indo cell node list",e.weaponIndoCellNodeList);for(var o=0;o<e.weaponIndoCellNodeList.length;o++){e.weaponIndoCellNodeList[o].getComponent(_).updateChooseRate(t)}e.currentChooseRate=t,e.referCurrentRedHeartCountUI()})),this.initWeaponData()}},{key:"referCurrentRedHeartCountUI",value:function(){var e=this.gameController.getComponent(R),t=e.playerData.getAddOneRedHeartCostGoldCount()*this.currentChooseRate;this.addRedHeartCostGoldCount.getComponent(g).string=t+"";var o=e.playerData.getCurrentGoldCount();console.log("current gold count",o),console.log("cost",t),this.addRedHeartButton.getComponent(v).spriteFrame=o<t?this.addRedHeartButtonSpriteFrameGray:this.addRedHeartButtonSpriteFrameLight,this.currentInitRedHeartCountLabel.getComponent(g).string=e.playerData.getCurrentInitRedHeartCount()+"",this.chooseAddRedHeartCountLabel.getComponent(g).string="+"+this.currentChooseRate}},{key:"initWeaponData",value:function(){for(var e=this,t=this.gameController.getComponent(R),o=this.gameController.getComponent(R).getGameConfig().json,n=this.gameController.playerData.getCurrentTowersLocalLevelData(),r=0;r<n.length;r++){var a=n[r],i=b(this.updateWeaponInfoCellPrefab);i.parent=this.weaponCellParentNode,i.getComponent(_).setData(a,t,o),i.position=C(0,-r*(i.height+10)-.5*(i.height+10)-5,0),this.weaponCellParentNode.height=-1*i.position.y+.5*i.height,this.weaponIndoCellNodeList.push(i)}this.gameController.node.on("update-gold-label",(function(){e.referCurrentRedHeartCountUI()}))}},{key:"showWeaponInfoButtonn",value:function(){var e=this;return new Promise((function(t,o){var n=w.getVisibleSize().width,r=new m(e.weaponInfoButton);r.to(.1,{position:C(.5*n-100,0,0)}),r.call((function(){t()})),r.start()}))}},{key:"hideWeaponInfoNode",value:function(){var e=this;return new Promise((function(t,o){var n=new m(e.weaponInfoNode);n.to(.2,{position:C(.5*e.weaponInfoNode.width,0,0)}),n.call((function(){t()})),n.start()}))}},{key:"hideBlockBgNode",value:function(){var e=this;return new Promise((function(t,o){t(),e.blockBgNode.active=!1}))}},{key:"showWeaponInfoNode",value:function(){var e=this;return new Promise((function(t,o){var n=new m(e.weaponInfoNode);n.to(.2,{position:C(0,0,0)}),n.call((function(){t()})),n.start()}))}},{key:"showBlockBgNode",value:function(){var e=this;return new Promise((function(t,o){e.blockBgNode.active=!0;var n=new m(e.blockBgNode.getComponent(v));n.call((function(){t()})),n.start()}))}},{key:"hideButton",value:function(){var e=this,t=w.getVisibleSize().width;return new Promise((function(o,n){var r=new m(e.weaponInfoButton);r.to(.1,{position:C(.5*t+100,0,0)}),r.call((function(){o()})),r.start()}))}},{key:"onButtonClick",value:function(e,t){switch(t){case"show-weapon-info":console.log("武器信息按钮"),"close"===this.state.getState()&&this.state.setState("play-open-anim");break;case"bg-node-click":console.log("背景节点点击 "),"open"===this.state.getState()&&this.state.setState("play-close-anim");break;case"add-heart-button":var o=this.gameController.getComponent(R),n=o.playerData.getCurrentGoldCount(),r=o.playerData.getAddOneRedHeartCostGoldCount()*this.currentChooseRate;n<r?this.node.emit("gold-not-enough"):(o.playerData.addGoldCount(-r),o.playerData.addLocalInitRedHeartCount(this.currentChooseRate),this.node.emit("refer-red-heart-label")),this.referCurrentRedHeartCountUI()}}}]),t}(y)).prototype,"blockBgNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=o(j.prototype,"weaponInfoNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=o(j.prototype,"weaponInfoButton",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=o(j.prototype,"gameController",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=o(j.prototype,"updateWeaponInfoCellPrefab",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=o(j.prototype,"weaponCellParentNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=o(j.prototype,"currentInitRedHeartCountLabel",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=o(j.prototype,"addRedHeartCostGoldCount",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=o(j.prototype,"addRedHeartButtonSpriteFrameLight",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=o(j.prototype,"addRedHeartButtonSpriteFrameGray",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=o(j.prototype,"addRedHeartButton",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=o(j.prototype,"chooseAddRedHeartCountLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=j))||U)),s._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../BossController.js","../util/State.js","../ChooseWeaponInfoRateCtl.js","../Data/PlayerData.js","../Effect/WinGoldAnimEffect.js","../TowerBuildBase/TowerBuildBase.js","../util/My2Array.js","../BaseObject.js","../GroundTiled/GroundTiled.js","../GroundMapCtl.js","../TowerBuildBaseCtl.js","../BulletBase.js","../UI/Menu/MenuUIBase.js","../util/Tool.js","../UI/GoldCtl.js","../UI/Menu/UpdateTowerUI.js","../UI/Menu/BuildTowerUITowerIcon.js","../UI/Menu/BuildTowerUI.js","../UI/GameWin/GameResultGoldCell.js","../UI/GameWin/GameWinPrefab.js","../UI/UIController.js","../UI/SkillCtl.js","../Towers/TowerBase.js","../Home/HomeIcon.js","../GameController.js","../util/BezierN.js","../util/FindPathWithAStart.js","../Enemys/EnemyBase.js","../Enemys/EnemyBullet.js","../EnemyController.js","../Enemys/EnemyCube.js","../Enemys/WinGold.js","../SkillComponent/CrazyRotateSkill.js","../UI/AStartFindPath.js","../UI/EnemyHealthBarCtl.js","../UI/TouchScreenLayer.js","../UI/WeaponUpdateCellPrefab.js","../UI/道具/KuangBaoSkill.js","../util/AdsController.js","../util/Besize.js","../WeaponInfoCtl.js"],(function(n,t){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/Scripts/BossController.js', 'chunks:///BossController.js');
  r('project:///assets/Scripts/util/State.js', 'chunks:///util/State.js');
  r('project:///assets/Scripts/ChooseWeaponInfoRateCtl.js', 'chunks:///ChooseWeaponInfoRateCtl.js');
  r('project:///assets/Scripts/Data/PlayerData.js', 'chunks:///Data/PlayerData.js');
  r('project:///assets/Scripts/Effect/WinGoldAnimEffect.js', 'chunks:///Effect/WinGoldAnimEffect.js');
  r('project:///assets/Scripts/TowerBuildBase/TowerBuildBase.js', 'chunks:///TowerBuildBase/TowerBuildBase.js');
  r('project:///assets/Scripts/util/My2Array.js', 'chunks:///util/My2Array.js');
  r('project:///assets/Scripts/BaseObject.js', 'chunks:///BaseObject.js');
  r('project:///assets/Scripts/GroundTiled/GroundTiled.js', 'chunks:///GroundTiled/GroundTiled.js');
  r('project:///assets/Scripts/GroundMapCtl.js', 'chunks:///GroundMapCtl.js');
  r('project:///assets/Scripts/TowerBuildBaseCtl.js', 'chunks:///TowerBuildBaseCtl.js');
  r('project:///assets/Scripts/BulletBase.js', 'chunks:///BulletBase.js');
  r('project:///assets/Scripts/UI/Menu/MenuUIBase.js', 'chunks:///UI/Menu/MenuUIBase.js');
  r('project:///assets/Scripts/util/Tool.js', 'chunks:///util/Tool.js');
  r('project:///assets/Scripts/UI/GoldCtl.js', 'chunks:///UI/GoldCtl.js');
  r('project:///assets/Scripts/UI/Menu/UpdateTowerUI.js', 'chunks:///UI/Menu/UpdateTowerUI.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerUITowerIcon.js', 'chunks:///UI/Menu/BuildTowerUITowerIcon.js');
  r('project:///assets/Scripts/UI/Menu/BuildTowerUI.js', 'chunks:///UI/Menu/BuildTowerUI.js');
  r('project:///assets/Scripts/UI/GameWin/GameResultGoldCell.js', 'chunks:///UI/GameWin/GameResultGoldCell.js');
  r('project:///assets/Scripts/UI/GameWin/GameWinPrefab.js', 'chunks:///UI/GameWin/GameWinPrefab.js');
  r('project:///assets/Scripts/UI/UIController.js', 'chunks:///UI/UIController.js');
  r('project:///assets/Scripts/UI/SkillCtl.js', 'chunks:///UI/SkillCtl.js');
  r('project:///assets/Scripts/Towers/TowerBase.js', 'chunks:///Towers/TowerBase.js');
  r('project:///assets/Scripts/Home/HomeIcon.js', 'chunks:///Home/HomeIcon.js');
  r('project:///assets/Scripts/GameController.js', 'chunks:///GameController.js');
  r('project:///assets/Scripts/util/BezierN.js', 'chunks:///util/BezierN.js');
  r('project:///assets/Scripts/util/FindPathWithAStart.js', 'chunks:///util/FindPathWithAStart.js');
  r('project:///assets/Scripts/Enemys/EnemyBase.js', 'chunks:///Enemys/EnemyBase.js');
  r('project:///assets/Scripts/Enemys/EnemyBullet.js', 'chunks:///Enemys/EnemyBullet.js');
  r('project:///assets/Scripts/EnemyController.js', 'chunks:///EnemyController.js');
  r('project:///assets/Scripts/Enemys/EnemyCube.js', 'chunks:///Enemys/EnemyCube.js');
  r('project:///assets/Scripts/Enemys/WinGold.js', 'chunks:///Enemys/WinGold.js');
  r('project:///assets/Scripts/SkillComponent/CrazyRotateSkill.js', 'chunks:///SkillComponent/CrazyRotateSkill.js');
  r('project:///assets/Scripts/UI/AStartFindPath.js', 'chunks:///UI/AStartFindPath.js');
  r('project:///assets/Scripts/UI/EnemyHealthBarCtl.js', 'chunks:///UI/EnemyHealthBarCtl.js');
  r('project:///assets/Scripts/UI/TouchScreenLayer.js', 'chunks:///UI/TouchScreenLayer.js');
  r('project:///assets/Scripts/UI/WeaponUpdateCellPrefab.js', 'chunks:///UI/WeaponUpdateCellPrefab.js');
  r('project:///assets/Scripts/UI/道具/KuangBaoSkill.js', 'chunks:///UI/道具/KuangBaoSkill.js');
  r('project:///assets/Scripts/util/AdsController.js', 'chunks:///util/AdsController.js');
  r('project:///assets/Scripts/util/Besize.js', 'chunks:///util/Besize.js');
  r('project:///assets/Scripts/WeaponInfoCtl.js', 'chunks:///WeaponInfoCtl.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});